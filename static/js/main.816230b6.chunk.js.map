{"version":3,"sources":["components/config.js","components/Home.js","components/Spinner.js","components/Search.js","components/utils.js","components/Queries.js","components/SearchQuery.js","components/SearchWrapper.js","components/Image.js","components/LineText.js","components/ImageTextWrapper.js","components/Surface2.js","components/Surface3.js","components/Surface3Wrapper.js","components/XmlView.js","components/WindowNavBar.js","components/NextPrevBar.js","components/TextCompareItem.js","components/TextCompare.js","components/TextCompareWrapper.js","components/CommentItem.js","components/CommentCreate.js","components/Comments.js","components/Citation.js","components/CitationExplanation.js","components/ManifestationList.js","components/CitationWrapper.js","components/TextOutline.js","components/TextOutlineWrapper.js","components/TextPreviewWrapper.js","queries/TextPreviewWrapperQueries.js","components/Window.js","components/TextNavBar.js","components/Text.js","components/VersionChain.js","components/TextWrapper.js","components/TextArticle.js","components/Item.js","components/Collection.js","components/AuthorCollection.js","components/SurfaceInfo.js","queries/SurfaceInfoQuery.js","components/Codex.js","components/TextSwitch.js","components/About.js","components/CodexListItem.js","components/Codices.js","components/NavBar.js","components/Footer.js","components/AppRouter.js","serviceWorker.js","index.js"],"names":["sparqlEndpoint","resourceEndpoint","Home","props","react_default","a","createElement","className","Container_default","id","fluid","Jumbotron_default","Button_default","react_router_dom","to","style","color","Spinner","padding","Spinner_default","animation","role","variant","Search","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","retrieveExpressionResults","bind","assertThisInitialized","retrieveAuthorResults","state","searchResults","count","fetching","query","expressionid","setState","Axios","get","then","d","data","results","authorid","authorShortId","split","eid","authorFocusId","nextProps","_this2","components_Spinner","length","map","r","i","key","pid","dangerouslySetInnerHTML","__html","text","React","Component","loadXMLDoc","url","Promise","resolve","req","XMLHttpRequest","open","XSLTProcessor","responseType","e","console","log","onload","responseXML","send","convertXMLDoc","xmlurl","xslurl","reject","all","xsltProcessor","importStylesheet","resultDocument","transformToFragment","document","reason","Error","copyToClipboard","string","dummy","body","appendChild","value","select","execCommand","removeChild","runQuery","params","output","scrollToParagraph","hash","highlight","element","$","addClass","removeClass","children","setTimeout","stop","animate","scrollTop","offset","top","basicInfoQuery","itemExpressionUri","join","partsInfoQuery","resourceurl","getSurfaceInfo","surfaceid","SearchQuery","handleQueryUpdate","handleEidUpdate","handleRunSearch","getAvailableExpressions","handleAuthorUpdate","handleToggleFilterOptions","eidFull","availableExpressions","availableAuthors","showFilterOptions","preventDefault","target","filter","filters","authorFilter","authorId","getSearchExpressionList","bindings","b","expression","expressionTitle","author","authorTitle","_this3","prevState","prevProps","getAvailableAuthors","_this4","Form_default","onSubmit","Group","Label","Control","type","placeholder","onChange","as","onClick","SearchWrapper","hidden","components_SearchQuery","topLevel","components_Search","Image","newCoords","coords","coordsSplitArray","parseInt","imageLink","imageUrl","displayWidth","alt","src","LineText","whiteSpace","ImageTextWrapper","searchText","targetLabel","label","components_Image","canvas","canvasShort","components_LineText","Surface2","mount","handleNext","handlePrevious","handleToggleTextLines","handleToggleAllLines","currentSurfaceId","manifest","region","width","next","previous","imageurl","annotationsDisplay","showAllLines","handleSurfaceFocusChange","alUrl","d2","surfaceTitle","next_surface","previous_surface","annotations","resources","catch","error","retrieveSurfaceInfo","size","lineFocusId","h","resource","chars","on","components_ImageTextWrapper","surfaceButton","displayImages","defaultProps","Surface3","mounted","surfaces","manifestationid","d1","forEach","z","surface","firstLine","first","lastLine","last","order","newSurface","concat","toConsumableArray","fl","flcanvas","flcanvasShort","flcoords","y","ll","llcoords","lly","llh","llbottom","sort","Surface3Wrapper","handleChangeManifestation","handleToggleTextLinesView","focusedManifestation","view","manifestations","m","manifestation","manifestationTitle","title","index_esm","components_Surface3","XmlView","retrieveXML","xmlstring","tresourceid","light","language","docco","showLineNumbers","WindowNavBar","Nav_default","focusSet","Item","Link","active","windowLoad","handleTabChange","windowId","openWidthHeight","handleMinimize","handleMiddlize","handleMaximize","handleClose","altWindowState","handleDuplicateWindow","windowType","NextPrevBar","info","handleBlockFocusChange","resourceid","TextCompareItem","handleToggleShow","compareText","rawText","show","base","transcription","dmp","Diff","diff_match_patch","diff","diff_main","diff_cleanupSemantic","ds","diff_prettyHtml","createCompare","compareTranscription","newProps","handleChangeBase","ref","TextCompare","handleToggleShowAll","baseText","manifestationCTranscription","structureType","inbox","cdoc","cxml","topLevelExpression","cmanifestation","ctranscription","arrangeTextInfo","isMainText","getTextInfo","relationLabel","components_TextCompareItem","displayComparisons","TextCompareWrapper","handleCompare","handleToggleCompare","getText","expressions","newExpressions","objectSpread","relatedExpressions","exObject","keys","components_TextCompare","displayExpressions","rel","href","CommentItem","n","motivation","CommentCreate","handleCommentUpdate","handleSubmitComment","comment","handleSumbitComment","FormControl_default","block","Comments","notifications","annotat","@context","uuidv4","method","config","headers","Content-Type","response","retrieveComments","components_CommentCreate","components_CommentItem","Citation","eurl","etitle","murl","mtitle","turl","transcriptionid","allBindings","eLongTitle","datasource","codexTitle","start","end","retrieveCitation","fullCitationString","CitationExplanation","toggleCitationExplanation","showCitationExplanation","ManifestationList","toggleAlternativeManifestations","showAlternativeManifestations","optionalDisplay","handleFocusChange","displayManifestations","propTypes","PropTypes","isRequired","array","bool","func","CitationWrapper","components_Citation","components_CitationExplanation","components_ManifestationList","TextOutline","handleToggleChildren","parts","showChildren","getChildParts","newData","part","level","questionTitle","retrieveParts","membersOf","includes","indent","paddingLeft","bold","collectionLink","mtFocus","p","focusResourceid","TextOutlineWrapper","getMembersOf","memberOf","retrieveMembersOf","components_TextOutline","TextPreviewWrapper","textPreviewResourceId","getTranscriptionId","TextPreview_default","Window","mountStatus","textCompare","surface3","comments","xml","search","textOutline","citation","manifestationSlug","newMountStatus","tempNewMount","components_WindowNavBar","focus","handleSwitchWindow","components_NextPrevBar","components_TextCompareWrapper","components_CitationWrapper","components_Surface2","components_Surface3Wrapper","defaultManifestationSlug","components_Comments","xmls","components_XmlView","itemFocus","components_TextOutlineWrapper","components_SearchWrapper","components_TextPreviewWrapper","TextNavBar","Navbar_default","bg","expand","fixed","Toggle","aria-controls","Collapse","Text","retrieveText","doc","scrollTo","docFragment","topLevelFragment","getElementById","innerHTML","click","parent","attr","setFocus","openWindow","paragraphid","closest","ln","handleLineFocusChange","link","html","targetText","toggleClass","noteDisplay","targetParagraph","handleTextPreviewFocusChange","VersionChain","getVersionHistory","handleToggleShowVersions","versions","currentVersion","showVersions","transcriptionUri","reviewUrl","reviewObject","img_url","reviewid","ipfsHash","html_link","rubric_link","summary","newVersion","versionTranscription","version","versionLabel","version_label","versionOrderNumber","order_number","versionReview","review","versionDoc","versionReviewInfo","Alert_default","v","currentlyViewing","displayAlert","TextWrapper","setFocus2","windows","window1","position","window2","blockFocus","altWindowId","fullid","handleUpdateUrlResource","newid","arrangeFocusInfo","isRelatedTo","longTitle","arrangeItemFocusInfo","itemFocusInfo","t","setItemFocus","mFocus","tFocus","blockDivFocus","retrieveFocusInfo","components_VersionChain","aSideWindowOpen","textClass","components_Text","itemid","components_TextNavBar","components_Window","TextArticle","articleType","item","Collection","retrieveCollectionInfo","makeRequests","handleFilter","createRef","items","partsPromise","partsObject","pId","partTitle","partType","partQuestionTitle","partLevel","itemsPromise","itemsObject","itemId","itemTitle","itemType","itemQuestionTitle","itemAuthor","itemAuthorTitle","cm","cmTitle","ct","err","expressionsInfo","partsInfo","arrangeParts","arrangeItems","collectionInfo","newResourceId","retrieveWorkGroupInfo","current","questions","toLowerCase","push","components_Item","testPart","Table_default","striped","bordered","hover","displayParts","displayQuestions","AuthorCollection","retrieveAuthorCollectionInfo","handleItemFilter","itemFilter","authorArticles","textArticles","Array","isArray","authorArticle","textArticle","hasTopLevelExpression","authorCollectionInfo","refs","displayItems","list","SurfaceInfo","handleToggleRelatedDiscussion","handleSurface3Manifestations","handleToggleShowQuery","surfaceMap","showTextRegion","showQuery","newManifestations","find","showComments","showRelatedSurfaces","hasManifestation","isOnSurface","fontSize","clasName","textIndent","handleToggleRelatedSurfaces","Codex","retrieveCodexInfo","handleToggleShowContents","focusedSurface","relatedCodices","showContents","surface3Manifestations","surface3FocusedManifestation","codexSlug","unique","indexOf","expressionList","item_expression_title","surface_title","item_expression_question_title","surfaceFocus","canvasid","manifestid","codexid","components_SurfaceInfo","TextSwitch","displayType","itemTranscriptionId","resourceTitle","history","itemParent","articleDoc","getItemTranscription","getItemTranscriptionFromBlockDiv","blockDivExpression","Qs","parse","location","ignoreQueryPrefix","getInfo","components_AuthorCollection","components_TextArticle","components_Collection","components_TextWrapper","components_Codex","About","CodexListItem","Codices","codices","arrangeCodexInfo","codex","codex_title","retrieveCodices","components_CodexListItem","NavBar","Footer","zIndex","display","justifyContent","AppRouter","forceRefresh","components_NavBar","react_router","path","exact","component","render","assign","components_Footer","Boolean","window","hostname","match","ReactDOM","components_AppRouter","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.816230b6.chunk.js","sourcesContent":["//export const sparqlEndpoint = \"http://localhost:3030/ds/query\"\nexport const sparqlEndpoint = \"https://sparql-docker.scta.info/ds/query\"\n//export const sparqlEndpoint = \"https://sparql-staging.scta.info/ds/query\"\n\nexport const resourceEndpoint = \"http://scta.info/resource/scta\"\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport Jumbotron from 'react-bootstrap/Jumbotron';\nimport Button from 'react-bootstrap/Button';\nimport {Link} from 'react-router-dom';\nimport {resourceEndpoint} from './config';\n\n\n\nfunction Home(props) {\n  //const resourceid = props.location ? Qs.parse(props.location.search, { ignoreQueryPrefix: true }).resourceid : null;\n  const displayBody = () => {\n    // if (resourceid){\n    //   return <Text resourceid={props.location.search.resourceid}/>\n    // }\n    // else\n    return (\n      <div className=\"Home\">\n        <Container id=\"lbp-home\" fluid>\n            <Container>\n              <Jumbotron id=\"lbp-jumbo\">\n              \t<h1>The SCTA Reading Room</h1>\n              \t<p>A site for reading, viewing, and studying the scholastic tradition</p>\n                <Button><Link className=\"nav-link\" to={\"/text?resourceid=\" + resourceEndpoint} style={{color: \"black\"}}>Enter</Link></Button>\n              </Jumbotron>\n            </Container>\n          </Container>\n          </div>\n    )\n  }\n  return (\n    displayBody()\n  )\n}\n\nexport default Home;\n","import React from 'react';\nimport BSpinner from 'react-bootstrap/Spinner';\n\nfunction Spinner() {\n  return (\n    <div className=\"spinner\" style={{\"padding\": \"20px 5px\"}}>\n      <BSpinner animation=\"grow\" role=\"status\">\n        <span className=\"sr-only\">Loading...</span>\n      </BSpinner>\n      <BSpinner animation=\"grow\" variant=\"primary\" />\n      <BSpinner animation=\"grow\" variant=\"secondary\" />\n      <BSpinner animation=\"grow\" variant=\"success\" />\n      <BSpinner animation=\"grow\" variant=\"danger\" />\n      <BSpinner animation=\"grow\" variant=\"warning\" />\n      <BSpinner animation=\"grow\" variant=\"info\" />\n    </div>\n  );\n}\n\nexport default Spinner;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Axios from 'axios';\nimport Spinner from './Spinner';\nimport {Link} from 'react-router-dom';\n\nclass Search extends React.Component {\n  constructor(props){\n    super(props)\n    this.retrieveExpressionResults = this.retrieveExpressionResults.bind(this)\n    this.retrieveAuthorResults = this.retrieveAuthorResults.bind(this)\n    this.state = {\n      searchResults: [],\n      count: \"\",\n      fetching: false\n    }\n  }\n  retrieveExpressionResults(query, expressionid){\n    const _this = this\n    this.setState({fetching: true})\n    Axios.get(\"http://exist.scta.info/exist/apps/scta-app/jsonsearch/json-search-text-by-expressionid.xq?query=\" + query + \"&expressionid=\" + expressionid)\n      .then((d) => {\n            _this.setState({searchResults: d.data.results, count: d.data.count, fetching: false})\n          })\n  }\n  retrieveAuthorResults(query, authorid){\n    const _this = this\n    this.setState({fetching: true})\n    const authorShortId = authorid.split(\"/resource/\")[1]\n    Axios.get(\"http://exist.scta.info/exist/apps/scta-app/jsonsearch/json-search-text-by-authorid.xq?query=\" + query + \"&authorid=\" + authorShortId)\n      .then((d) => {\n            _this.setState({searchResults: d.data.results, count: d.data.count, fetching: false})\n          })\n  }\n  componentDidMount(){\n    // const query = Qs.parse(this.props.location.search, { ignoreQueryPrefix: true }).query\n    // const eid = Qs.parse(this.props.location.search, { ignoreQueryPrefix: true }).eid\n    const query = this.props.query\n    const eid =  this.props.eid\n    const authorFocusId =  this.props.authorFocusId\n    if (eid){\n      this.retrieveExpressionResults(query, eid)\n    }\n    else if (authorFocusId){\n      this.retrieveAuthorResults(query, authorFocusId)\n    }\n    else{\n      this.retrieveExpressionResults(query, \"all\")\n\n    }\n  }\n  componentWillReceiveProps(nextProps){\n    if ((nextProps.query !== this.props.query) || (nextProps.eid !== this.props.eid) || (nextProps.authorFocusId !== this.props.authorFocusId)){\n      const query = nextProps.query\n      const eid =  nextProps.eid\n      const authorFocusId =  nextProps.authorFocusId\n      if (eid){\n        this.retrieveExpressionResults(query, eid)\n      }\n      else if (authorFocusId){\n        this.retrieveAuthorResults(query, authorFocusId)\n      }\n    }\n  }\n  render(){\n    const displayResults = () => {\n      if (!this.state.searchResults){\n        return (<div>\n          <p>No results found</p>\n        </div>)\n      }\n      else if (this.state.searchResults.length > 1){\n        const results = this.state.searchResults.map((r, i) => {\n          return (\n            <div key={i}>\n            <p><Link to={\"/text?resourceid=http://scta.info/resource/\" + r.pid}>{r.pid}</Link></p>\n            <p dangerouslySetInnerHTML={{ __html: r.text}}/>\n            </div>\n          )\n\n        })\n      return results\n    }\n    else if (this.state.searchResults){\n      return (\n        <div key={this.state.searchResults.pid}>\n        <p><Link to={\"/text?resourceid=http://scta.info/resource/\" + this.state.searchResults.pid}>{this.state.searchResults.pid}</Link></p>\n        <p dangerouslySetInnerHTML={{ __html: this.state.searchResults.text}}/>\n        </div>\n      )\n    }\n    else{\n      return (\n        <div><p>No results</p></div>\n      )\n    }\n  }\n  return (\n    <div>\n    {\n      this.state.fetching ?\n      <Spinner/> :\n      displayResults()\n    }\n    </div>\n\n\n  );\n  }\n}\n\nSearch.propTypes = {\n  /**\n  * query string\n  *\n  */\n  query: PropTypes.string,\n  /**\n  * eid, shortId of expression id; search restricted to text within this expression\n  *\n  * TODO: consider changing eid from shortId to full Url id to match authorFocusId\n  */\n  eid: PropTypes.string,\n  /**\n  * authorFocusId, full url id of expression author; search restricted to texts by this author\n  *\n  */\n  authorFocusId: PropTypes.string\n}\n\nexport default Search;\n","import Axios from 'axios'\nimport {sparqlEndpoint} from './config';\nimport $ from 'jquery';\n\nexport function loadXMLDoc(url){\n  //See https://github.com/martin-honnen/martin-honnen.github.io/blob/master/xslt/arcor-archive/2016/test2016081501.html\n  return new Promise(function(resolve) {\n    var req = new XMLHttpRequest();\n    req.open(\"GET\", url);\n    if (typeof XSLTProcessor === 'undefined') {\n     try {\n       req.responseType = 'msxml-document';\n     }\n     catch (e) {\n       console.log('error', e)\n     }\n    }\n    req.onload = function() {\n     resolve(this.responseXML)\n    }\n    req.send();\n  });\n}\n\nexport function convertXMLDoc(xmlurl, xslurl){\n  //See https://github.com/martin-honnen/martin-honnen.github.io/blob/master/xslt/arcor-archive/2016/test2016081501.html\n  return new Promise(function(resolve, reject){\n    Promise.all([loadXMLDoc(xmlurl), loadXMLDoc(xslurl)]).then(function(data) {\n      const xsltProcessor = new XSLTProcessor();\n      xsltProcessor.importStylesheet(data[1]);\n      if (data[0]){\n        const resultDocument = xsltProcessor.transformToFragment(data[0], document);\n        resolve(resultDocument)\n      }\n      else{\n        const reason = new Error('xml document could not be retrieved');\n        reject(reason); // reject\n      }\n    })\n  })\n}\n\nexport function nsResolver(prefix) {\n    if(prefix === \"tei\") {\n      return 'http://www.tei-c.org/ns/1.0'\n    }\n}\n\nexport function copyToClipboard(string){\n  var dummy = document.createElement(\"textarea\");\n  document.body.appendChild(dummy);\n  dummy.value = string;\n  dummy.select();\n  document.execCommand(\"copy\");\n  document.body.removeChild(dummy);\n}\n\nexport function runQuery(query){\n  //const sparqlEndpoint = \"https://sparql-docker.scta.info/ds/query\"\n  //const sparqlEndpoint = sparqlEndpoint\n  const queryPromise = Axios.get(sparqlEndpoint, { params: { \"query\": query, \"output\": \"json\" } })\n  return queryPromise\n}\n\n//handles scroll to paragraph procedure\nexport function scrollToParagraph(hash, highlight){\n    const element = $(\"#\" + hash);\n\n    // TODO: highlighting is NOT working\n    if (highlight){\n      element.addClass(\"highlightNone\");\n      $(\".paragraphnumber\").removeClass(\"highlight2\")\n      $(\".plaoulparagraph\").removeClass(\"highlightNone\")\n      $(\".plaoulparagraph\").removeClass(\"highlight\")\n      element.children(\".paragraphnumber\").addClass(\"highlight2\")\n      element.addClass( \"highlight\");\n      setTimeout(function(){\n        element.addClass(\"highlightNone\");\n    }, 2000);\n\n    }\n  \tif (element.length > 0) {\n  \t    $('html, body')\n              .stop()\n              .animate({\n                  scrollTop: element.offset().top - 100\n              }, 1000);\n     }\n\n  }\n","//note; each query here represents an attempt an efficient single request for related information\n//each query therefore could be tranformed into a restful api\n\n\n export function getRelatedExpressions(itemExpressionUri){\n   const query = [\n     \"SELECT DISTINCT ?isRelatedTo ?label \",\n     \"WHERE { \",\n     \"{\",\n     \"<\" + itemExpressionUri + \"> ?o ?isRelatedTo .\",\n     \"?o a <http://scta.info/resource/textRelation> .\",\n     \"?o <http://www.w3.org/1999/02/22-rdf-syntax-ns#label> ?label . \",\n     \"?isRelatedTo a <http://scta.info/resource/expression> .\",\n     \"}\",\n     \"UNION\",\n     \"{\",\n     \"<\" + itemExpressionUri + \"> ?o ?p .\",\n     \"?o a <http://scta.info/resource/textRelation> .\",\n     \"?o <http://www.w3.org/1999/02/22-rdf-syntax-ns#label> ?label . \",\n     \"?p a <http://scta.info/resource/quotation> .\",\n     \"?p <http://scta.info/property/source> ?isRelatedTo .\",\n     \"}\",\n     \"}\"\n   ].join('');\n     return query\n }\n//get Related Expressions\n// export function getRelatedExpressions(itemExpressionUri){\n//   const query = [\n//     \"SELECT DISTINCT ?isRelatedTo \",\n//     \"WHERE { \",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/isRelatedTo> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/quotes> ?quote .\",\n//     \"?quote a <http://scta.info/resource/quotation> .\",\n//     \"?quote <http://scta.info/property/source> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/quotes> ?quote .\",\n//     \"?quote a <http://scta.info/resource/expression> .\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/quotes> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/quotedBy> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/abbreviates> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/abbreviatedBy> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/references> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/referencedBy> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/copies> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/isCopiedBy> ?isRelatedTo .\",\n//     \"}\",\n//     \"}\"\n//   ].join('');\n//\n//     return query\n// }\n\n// query info block, division, or item (possible also collection)\nexport function basicInfoQuery(itemExpressionUri){\n  const query = [\n    \"SELECT DISTINCT ?title ?structureType ?cmanifestation ?cmanifestationTitle ?manifestation ?manifestationTitle ?ctranscription ?manifestationCTranscription ?cdoc ?cxml ?expressionShortId ?longTitle ?topLevelExpression ?next ?previous ?inbox ?author ?authorTitle \",\n    \"WHERE { \",\n    \"<\" + itemExpressionUri + \"> <http://purl.org/dc/elements/1.1/title> ?title .\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/structureType> ?structureType .\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/hasCanonicalManifestation> ?cmanifestation .\",\n    \"?cmanifestation <http://purl.org/dc/elements/1.1/title> ?cmanifestationTitle .\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/hasManifestation> ?manifestation .\",\n    \"?manifestation <http://purl.org/dc/elements/1.1/title> ?manifestationTitle .\",\n    \"?manifestation <http://scta.info/property/hasCanonicalTranscription> ?manifestationCTranscription .\",\n    \"?cmanifestation <http://scta.info/property/hasCanonicalTranscription> ?ctranscription .\",\n    \"?ctranscription <http://scta.info/property/hasDocument> ?cdoc . \",\n    \"?ctranscription <http://scta.info/property/hasXML> ?cxml . \",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/shortId> ?expressionShortId .\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/isPartOfTopLevelExpression> ?topLevelExpression .\",\n    \"OPTIONAL {\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/longTitle> ?longTitle .\",\n    \"}\",\n    \"OPTIONAL {\",\n    \"?topLevelExpression <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n    \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n    \"}\",\n\n    \"OPTIONAL {\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/next> ?next .\",\n    \"}\",\n    \"OPTIONAL {\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/previous> ?previous .\",\n    \"}\",\n    \"<\" + itemExpressionUri + \"> <http://www.w3.org/ns/ldp#inbox> ?inbox . \",\n    \"}\",\n    \"ORDER BY ?title\"].join('');\n\n    return query\n  }\n\n  export function itemTranscriptionInfoQuery(itemTranscriptionUri){\n    const query = [\n      \"SELECT DISTINCT ?title ?manifestation ?doc ?xml ?expression ?expressionShortId ?longTitle ?topLevelExpression ?next ?previous ?inbox ?t \",\n      \"WHERE { \",\n      \"BIND(<\" + itemTranscriptionUri + \"> as ?t) . \",\n      \"?t <http://purl.org/dc/elements/1.1/title> ?title .\",\n      \"?t <http://scta.info/property/isTranscriptionOf> ?manifestation .\",\n      \"?t <http://scta.info/property/hasDocument> ?doc . \",\n      \"?t <http://scta.info/property/hasXML> ?xml . \",\n      \"?manifestation <http://scta.info/property/isManifestationOf> ?expression .\",\n      \"?expression <http://purl.org/dc/elements/1.1/title> ?expressionTitle .\",\n      \"?expression <http://scta.info/property/shortId> ?expressionShortId .\",\n      \"?expression <http://scta.info/property/longTitle> ?longTitle .\",\n      \"?expression <http://scta.info/property/isPartOfTopLevelExpression> ?topLevelExpression .\",\n      \"OPTIONAL {\",\n      \"?expression <http://scta.info/property/next> ?next .\",\n      \"}\",\n      \"OPTIONAL {\",\n      \"?expression <http://scta.info/property/previous> ?previous .\",\n      \"}\",\n      \"?expression <http://www.w3.org/ns/ldp#inbox> ?inbox . \",\n      \"}\",\n      \"ORDER BY ?expressionTitle\"].join('');\n\n      return query\n    }\n  // gets all structure items with basic item information\n  export function basicStructureAllItemsInfoQuery(topLevelExpressionUrl){\n    const query = [\n      \"SELECT DISTINCT ?item ?itemTitle ?topLevel ?itemQuestionTitle ?cm ?cmTitle ?ct ?next ?previous ?itemType ?doc \",\n      \"WHERE { \",\n      \"<\" + topLevelExpressionUrl + \"> <http://scta.info/property/hasStructureItem> ?item .\",\n      \"?item <http://scta.info/property/isPartOfTopLevelExpression> ?topLevel .\",\n      \"?item <http://purl.org/dc/elements/1.1/title> ?itemTitle .\",\n      \"?item <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?itemType . \",\n      \"OPTIONAL {\",\n      \"?item <http://scta.info/property/questionTitle> ?itemQuestionTitle .\",\n      \"}\",\n      \"OPTIONAL\",\n      \"{\",\n      \"?item <http://scta.info/property/next> ?next .\",\n      \"}\",\n      \"OPTIONAL\",\n      \"{\",\n      \"?item <http://scta.info/property/previous> ?previous .\",\n      \"}\",\n      \"?item <http://scta.info/property/hasCanonicalManifestation> ?cm .\",\n      \"?item <http://scta.info/property/totalOrderNumber> ?totalOrderNumber .\",\n      \"?cm <http://purl.org/dc/elements/1.1/title> ?cmTitle .\",\n      \"?cm <http://scta.info/property/hasCanonicalTranscription> ?ct .\",\n      \"?ct <http://scta.info/property/hasDocument> ?doc .\",\n      \"}\",\n      \"ORDER BY ?totalOrderNumber\"].join('');\n      return query\n    }\n    // gets all parts\n    export function partsInfoQuery(resourceurl){\n      const query = [\n        \"SELECT DISTINCT ?part ?partTitle ?partQuestionTitle ?partType ?partLevel \",\n        \"WHERE { \",\n        \"<\" + resourceurl + \"> <http://purl.org/dc/terms/hasPart> ?part .\",\n        \"?part <http://purl.org/dc/elements/1.1/title> ?partTitle .\",\n        \"?part <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?partType . \",\n        \"OPTIONAL {\",\n        \"?part <http://scta.info/property/questionTitle> ?partQuestionTitle .\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?part <http://scta.info/property/level> ?partLevel .\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?part <http://scta.info/property/totalOrderNumber> ?totalOrderNumber .\",\n        \"}\",\n        \"}\",\n        \"ORDER BY ?totalOrderNumber\"].join('');\n        return query\n      }\n    // gets all expressions for work Group\n    export function workGroupExpressionQuery(resourceurl){\n      const query = [\n        \"SELECT DISTINCT ?item ?itemTitle ?itemAuthor ?itemAuthorTitle ?itemType \",\n        \"WHERE { \",\n        \"<\" + resourceurl + \"> <http://scta.info/property/hasExpression> ?item .\",\n        \"?item <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?itemType . \",\n        \"?item <http://purl.org/dc/elements/1.1/title> ?itemTitle .\",\n        \"?item <http://www.loc.gov/loc.terms/relators/AUT> ?itemAuthor .\",\n        \"?itemAuthor <http://purl.org/dc/elements/1.1/title> ?itemAuthorTitle .\",\n        \"}\",\n        \"ORDER BY ?itemAuthorTitle\"].join('');\n        return query\n      }\n\n  export function getItemTranscription(resourceurl){\n    const query = [\n      \"SELECT DISTINCT ?ctranscription \",\n      \"WHERE { \",\n        \"{\",\n          \"<\" + resourceurl + \"> <http://scta.info/property/hasCanonicalManifestation> ?cmanifestation . \",\n          \"?cmanifestation <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . \",\n        \"}\",\n        \"UNION\",\n        \"{\",\n          \"<\" + resourceurl + \"> <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . \",\n        \"}\",\n      \"}\"].join('');\n      return query\n  }\n  export function getArticleTranscriptionDoc(resourceurl){\n    const query = [\n      \"SELECT DISTINCT ?doc ?articleType \",\n      \"WHERE { \",\n        \"<\" + resourceurl + \"> <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . \",\n        \"<\" + resourceurl + \"> <http://scta.info/property/articleType> ?articleType .\",\n        \"?ctranscription <http://scta.info/property/hasXML> ?doc . \",\n      \"}\"].join('');\n      return query\n  }\n  export function getItemTranscriptionFromBlockDiv(resourceurl){\n    const query = [\n      \"SELECT DISTINCT ?ctranscription ?blockDivExpression \",\n      \"WHERE { \",\n        \"OPTIONAL\",\n        \"{\",\n        \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfStructureItem> ?itemParent . \",\n        \"{\",\n          \"{\",\n            \"?itemParent <http://scta.info/property/hasCanonicalManifestation> ?cmanifestation . \",\n            \"?cmanifestation <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . \",\n          \"}\",\n          \"UNION\",\n          \"{\",\n            \"?itemParent <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . \",\n          \"}\",\n        \"}\",\n        \"}\",\n        \"OPTIONAL\",\n        \"{\",\n        \"{\",\n          \"{\",\n            \"<\" + resourceurl + \"> <http://scta.info/property/isManifestationOf> ?blockDivExpression . \",\n          \"}\",\n          \"UNION\",\n          \"{\",\n            \"<\" + resourceurl + \"> <http://scta.info/property/isTranscriptionOf> ?blockDivManifestation . \",\n            \"?blockDivManifestation <http://scta.info/property/isManifestationOf> ?blockDivExpression . \",\n          \"}\",\n        \"}\",\n        \"}\",\n      \"}\"].join('');\n      return query\n  }\n  //TODO rename to getType\n  export function getStructureType(resourceurl){\n    const query = [\n      \"SELECT DISTINCT ?type ?structureType ?level ?topLevel ?itemParent ?resourceTitle ?author \",\n      \"WHERE { \",\n      \"<\" + resourceurl + \"> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?type . \",\n      \"OPTIONAL {\",\n        \"<\" + resourceurl + \"> <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n      \"}\",\n      \"OPTIONAL {\",\n        \"<\" + resourceurl + \"> <http://purl.org/dc/elements/1.1/title> ?resourceTitle .\",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/structureType> ?structureType . \",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/level> ?level . \",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfTopLevelExpression> ?topLevel . \",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfTopLevelManifestation> ?topLevel . \",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfTopLevelTransription> ?topLevel . \",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfStructureItem> ?itemParent . \",\n      \"}\",\n      \"}\"].join('');\n      return query\n    }\n  //surface id query, gets canvas and manifestation\n  export function getSurfaceInfo(surfaceid){\n    const query = [\n      \"SELECT DISTINCT ?surfaceTitle ?isurface ?isurfaceTitle ?icodexTitle ?canvas ?imageurl ?next_surface ?previous_surface \",\n        \"{\",\n  \t\t\t\t\"<\" + surfaceid + \"> <http://purl.org/dc/elements/1.1/title> ?surfaceTitle .\",\n  \t\t\t\t\"<\" + surfaceid + \"> <http://scta.info/property/hasISurface> ?isurface .\",\n  \t\t\t\t\"OPTIONAL {\",\n  \t\t\t\t\t\"<\" + surfaceid + \"> <http://scta.info/property/next> ?next_surface .\",\n  \t\t\t\t\"}\",\n  \t\t\t\t\"OPTIONAL {\",\n  \t\t\t\t\t\"<\" + surfaceid + \"> <http://scta.info/property/previous> ?previous_surface .\",\n          \"}\",\n  \t\t\t\t\"OPTIONAL {\",\n  \t\t\t\t\t\"?isurface <http://purl.org/dc/elements/1.1/title> ?isurfaceTitle .\",\n  \t\t\t\t\t\"?isurface <http://purl.org/dc/elements/1.1/isPartOf> ?icodex .\",\n  \t\t\t\t\t\"?icodex <http://purl.org/dc/elements/1.1/title> ?icodexTitle .\",\n  \t\t\t\t\"}\",\n  \t\t\t\t\"?isurface <http://scta.info/property/hasCanvas> ?canvas .\",\n  \t\t\t\t\"OPTIONAL{\",\n  \t\t\t\t\t\"?canvas <http://iiif.io/api/presentation/2#hasImageAnnotations> ?blank .\",\n  \t\t\t\t\"}\",\n  \t\t\t\t\"OPTIONAL{\",\n  \t\t\t\t\"?canvas <http://www.w3.org/2003/12/exif/ns#height> ?c_height .\",\n          \"}\",\n  \t\t     \"?blank <http://www.w3.org/1999/02/22-rdf-syntax-ns#first> ?o .\",\n  \t\t     \"?o <http://www.w3.org/ns/oa#hasBody> ?o2 .\",\n  \t\t    \"OPTIONAL{\",\n  \t\t\t\t\t \"?o2 <http://rdfs.org/sioc/services#has_service> ?imageurl .\",\n  \t\t\t\t \"}\",\n  \t\t\t\t \"OPTIONAL{\",\n  \t\t\t\t\t \"?o2 <http://www.shared-canvas.org/ns/hasRelatedService> ?imageurl .\",\n  \t\t\t\t \"}\",\n        \"}\"].join('');\n\n      return query\n    }\n\n//surface id query, gets canvas and manifestation\nexport function getAuthorInformation(authorid){\n    const query = [\n      \"CONSTRUCT\",\n      \"{\",\n      \"?author  <http://purl.org/dc/elements/1.1/title> ?authorTitle ;\",\n      \"<http://scta.info/resource/hasTopLevelExpression> ?expression ;\",\n      \"<http://scta.info/property/authorArticle> ?authorArticle;\",\n      \"<http://scta.info/property/textArticle> ?textArticle .\",\n    \t\"?authorArticle <http://purl.org/dc/elements/1.1/title> ?authorArticleTitle . \",\n      \"?textArticle <http://purl.org/dc/elements/1.1/title> ?textArticleTitle . \",\n    \t\"?expression <http://purl.org/dc/elements/1.1/title> ?topLevelExpressionTitle .\",\n      \"}\",\n      \"WHERE \",\n      \"{\",\n      \"BIND(<\" + authorid + \"> as ?author) . \",\n      \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n      \"OPTIONAL\",\n      \"{\",\n      \"?expression <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n      \"?expression a <http://scta.info/resource/expression> .\",\n      \"?expression <http://scta.info/property/level> '1' .\",\n      \"?expression <http://purl.org/dc/elements/1.1/title> ?topLevelExpressionTitle .\",\n      \"}\",\n      \"OPTIONAL\",\n      \"{\",\n      \"?expression2 <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n      \"?textArticle <http://scta.info/property/isArticleOf> ?expression2 .\",\n      \"?textArticle <http://purl.org/dc/elements/1.1/title> ?textArticleTitle .\",\n      \"}\",\n      \"OPTIONAL\",\n      \"{\",\n      \"?authorArticle <http://scta.info/property/isArticleOf> ?author .\",\n      \"?authorArticle <http://purl.org/dc/elements/1.1/title> ?authorArticleTitle\",\n      \"}\",\n      \"}\"].join('');\n      return query\n      }\n\n  export function versionHistoryInfo(transcriptionUri){\n     \t \tconst query = [\n     \t \t\t\"SELECT ?version ?version_shortId ?order_number ?version_label ?review ?doc\",\n     \t    \"{\",\n            \"{\",\n               \"BIND(<\" + transcriptionUri + \"> as ?version) . \",\n     \t         \"?version <http://scta.info/property/shortId> ?version_shortId .\",\n               \"?version <http://scta.info/property/hasDocument> ?doc . \",\n     \t         \"?version <http://scta.info/property/versionOrderNumber> ?order_number .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/versionLabel> ?version_label .\",\n     \t\t\t\t\t \"OPTIONAL {\",\n     \t\t\t\t\t \t\"?version <http://scta.info/property/hasReview> ?review .\",\n     \t\t\t\t   \"}\",\n     \t\t\t\t \"}\",\n     \t       \"UNION\",\n            \"{\",\n     \t         \"<\" + transcriptionUri + \"> <http://scta.info/property/hasAncestor> ?version .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/shortId> ?version_shortId .\",\n               \"?version <http://scta.info/property/hasDocument> ?doc . \",\n     \t         \"?version <http://scta.info/property/versionOrderNumber> ?order_number .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/versionLabel> ?version_label .\",\n     \t\t\t\t\t \"OPTIONAL {\",\n     \t\t\t\t\t \t\"?version <http://scta.info/property/hasReview> ?review .\",\n     \t\t\t\t   \"}\",\n     \t\t\t\t \"}\",\n     \t       \"UNION\",\n     \t       \"{\",\n     \t         \"<\" + transcriptionUri + \"> <http://scta.info/property/hasDescendant> ?version .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/shortId> ?version_shortId .\",\n               \"?version <http://scta.info/property/hasDocument> ?doc . \",\n     \t         \"?version <http://scta.info/property/versionOrderNumber> ?order_number .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/versionLabel> ?version_label .\",\n     \t\t\t\t\t \"OPTIONAL {\",\n     \t\t\t\t\t \t\"?version <http://scta.info/property/hasReview> ?review .\",\n     \t\t\t\t   \"}\",\n     \t\t\t\t \"}\",\n     \t     \"}\",\n     \t     \"ORDER BY DESC(?order_number)\"].join('');\n           return query\n           }\n\n  //gets lines and zone order for\n  export function getBlockLines(manifestationBlockId){\n     const query = [\n       \"SELECT ?first ?last ?order ?surface\",\n       \"{\",\n         \"<\" + manifestationBlockId + \"> <http://scta.info/property/isOnZone> ?zone . \",\n         \"?zone <http://scta.info/property/isOnZone> ?zone2 .\",\n         \"?zone2 <http://scta.info/property/firstLine> ?first .\",\n         \"?zone2 <http://scta.info/property/lastLine> ?last .\",\n         \"?zone2 <http://scta.info/property/isPartOfSurface> ?surface .\",\n         \"?zone <http://scta.info/property/isOnZoneOrder> ?order .\",\n       \"}\"].join('');\n       return query\n     }\n\n   //gets lines and zone order for\n   export function getChildParts(resourceid){\n      const query = [\n        \"SELECT ?part ?title ?level ?order ?structureType ?questionTitle \",\n        \"{\",\n          \"<\" + resourceid + \"> <http://purl.org/dc/terms/hasPart> ?part . \",\n          \"?part <http://purl.org/dc/elements/1.1/title> ?title .\",\n          \"?part <http://scta.info/property/level> ?level .\",\n          \"?part <http://scta.info/property/structureType> ?structureType .\",\n          \"OPTIONAL\",\n          \"{\",\n          \"?part <http://scta.info/property/sectionOrderNumber> ?order .\",\n          \"}\",\n          \"OPTIONAL\",\n          \"{\",\n          \"?part <http://scta.info/property/questionTitle> ?questionTitle .\",\n          \"}\",\n        \"}\",\n        \"ORDER BY ?order\"].join('');\n        return query\n      }\n      //gets lines and zone order for\n    export function getMembersOf(resourceid){\n       const query = [\n         \"SELECT ?memberOf\",\n         \"{\",\n           \"<\" + resourceid + \"> <http://scta.info/property/isMemberOf> ?memberOf . \",\n         \"}\"].join('');\n         return query\n       }\n\n    export function getManifestationCitationInfo(transcriptionid){\n       var query = [\n       \"SELECT DISTINCT ?manifestation ?manifestationTitle ?manifestationSurface ?surfaceTitle ?codexTitle ?datasource ?eLongTitle ?author ?authorTitle ?expression \",\n       \"{\",\n       \"<\" + transcriptionid + \"> <http://scta.info/property/isTranscriptionOf> ?manifestation .\",\n       \"<\" + transcriptionid + \"> <http://scta.info/property/hasDocument> ?datasource . \",\n       \"?manifestation <http://purl.org/dc/elements/1.1/title> ?manifestationTitle .\",\n       \"?manifestation <http://scta.info/property/isManifestationOf> ?expression .\",\n       \"?expression <http://scta.info/property/isPartOfTopLevelExpression> ?topLevelExpression .\",\n       \"OPTIONAL {\",\n        \"?expression <http://scta.info/property/longTitle> ?eLongTitle\",\n      \"}\",\n       \"OPTIONAL {\",\n         \"?topLevelExpression <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n         \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n       \"}\",\n       \"OPTIONAL\",\n         \"{\",\n         \"?manifestation <http://scta.info/property/isOnSurface> ?manifestationSurface .\",\n         \"?manifestationSurface <http://purl.org/dc/elements/1.1/title> ?surfaceTitle .\",\n         \"?surface <http://scta.info/property/order> ?surface_order .\",\n         \"?codex <http://scta.info/property/hasSurface> ?manifestationSurface .\",\n         \"?codex <http://purl.org/dc/elements/1.1/title> ?codexTitle .\",\n         \"}\",\n       \"}\",\n       \"ORDER BY ?surface_order\"].join('');\n       return query\n     }\n\n    export function getCodices(){\n     const query = [\n       \"SELECT ?codex ?codex_title\",\n \t     \"{\",\n\t\t\t\t \"?codex a <http://scta.info/resource/codex> .\",\n\t\t\t\t \"?codex <http://purl.org/dc/elements/1.1/title> ?codex_title\",\n\t\t\t\t\"}\",\n\t\t\t \"ORDER BY ?codex_title\"].join('')\n       return query\n     }\n     export function getCodexInfo(codexid){\n      const query = [\n        \"SELECT DISTINCT ?codex ?expression ?codex_title ?item_expression_title ?item_expression_question_title ?surface ?surface_title ?surface_order ?manifestation ?manifestation_short_id ?status \",\n        \"{\",\n          \"BIND(<\" + codexid + \"> as ?codex) . \",\n          \"?codex <http://purl.org/dc/elements/1.1/title> ?codex_title .\",\n          \"OPTIONAL {\",\n          \"?icodex <http://scta.info/property/isCodexItemOf> ?codex .\",\n          \"?isurface <http://purl.org/dc/elements/1.1/isPartOf> ?icodex .\",\n          \"?surface <http://scta.info/property/hasISurface> ?isurface .\",\n          \"?surface <http://scta.info/property/order> ?surface_order .\",\n          \"?surface <http://purl.org/dc/elements/1.1/title> ?surface_title .\",\n          \"?manifestation <http://scta.info/property/isOnSurface> ?surface .\",\n          \"?manifestation <http://scta.info/property/structureType> <http://scta.info/resource/structureItem> .\",\n          \"?manifestation <http://scta.info/property/shortId> ?manifestation_short_id .\",\n          \"?manifestation <http://scta.info/property/isManifestationOf> ?expression .\",\n          \"?expression <http://purl.org/dc/elements/1.1/title> ?item_expression_title .\",\n          \"?expression <http://scta.info/property/status> ?status .\",\n          \"OPTIONAL {\",\n             \"?expression <http://scta.info/property/questionTitle> ?item_expression_question_title .\",\n           \"}\",\n         \"}\",\n        \"}\",\n        \"ORDER BY ?surface_order\"].join('')\n     return query\n   }\n   export function getCodexInfoFromManifest(manifestid){\n    const query = [\n      \"SELECT DISTINCT ?codex ?expression ?codex_title ?item_expression_title ?item_expression_question_title ?surface ?surface_title ?surface_order ?manifestation ?manifestation_short_id ?status \",\n      \"{\",\n        \"?icodex <http://scta.info/property/hasOfficialManifest> <\" + manifestid + \"> .\",\n        \"?codex <http://scta.info/property/hasCodexItem> ?icodex .\",\n        \"?codex <http://purl.org/dc/elements/1.1/title> ?codex_title .\",\n        \"OPTIONAL {\",\n        \"?icodex <http://scta.info/property/isCodexItemOf> ?codex .\",\n        \"?isurface <http://purl.org/dc/elements/1.1/isPartOf> ?icodex .\",\n        \"?surface <http://scta.info/property/hasISurface> ?isurface .\",\n        \"?surface <http://scta.info/property/order> ?surface_order .\",\n        \"?surface <http://purl.org/dc/elements/1.1/title> ?surface_title .\",\n        \"?manifestation <http://scta.info/property/isOnSurface> ?surface .\",\n        \"?manifestation <http://scta.info/property/structureType> <http://scta.info/resource/structureItem> .\",\n        \"?manifestation <http://scta.info/property/shortId> ?manifestation_short_id .\",\n        \"?manifestation <http://scta.info/property/isManifestationOf> ?expression .\",\n        \"?expression <http://purl.org/dc/elements/1.1/title> ?item_expression_title .\",\n        \"?expression <http://scta.info/property/status> ?status .\",\n        \"OPTIONAL {\",\n           \"?expression <http://scta.info/property/questionTitle> ?item_expression_question_title .\",\n         \"}\",\n       \"}\",\n      \"}\",\n      \"ORDER BY ?surface_order\"].join('')\n      return query\n    }\n\n     export function getCodexInfoFromSurface(surfaceid){\n      const query = [\n        \"SELECT DISTINCT ?codex ?expression ?codex_title ?item_expression_title ?item_expression_question_title ?surface ?surface_title ?surface_order ?manifestation ?manifestation_short_id ?status \",\n        \"{\",\n          \"?codex <http://scta.info/property/hasSurface> <\" + surfaceid + \"> .\",\n          \"?codex <http://purl.org/dc/elements/1.1/title> ?codex_title .\",\n          \"OPTIONAL {\",\n          \"?icodex <http://scta.info/property/isCodexItemOf> ?codex .\",\n          \"?isurface <http://purl.org/dc/elements/1.1/isPartOf> ?icodex .\",\n          \"?surface <http://scta.info/property/hasISurface> ?isurface .\",\n          \"?surface <http://scta.info/property/order> ?surface_order .\",\n          \"?surface <http://purl.org/dc/elements/1.1/title> ?surface_title .\",\n          \"?manifestation <http://scta.info/property/isOnSurface> ?surface .\",\n          \"?manifestation <http://scta.info/property/structureType> <http://scta.info/resource/structureItem> .\",\n          \"?manifestation <http://scta.info/property/shortId> ?manifestation_short_id .\",\n          \"?manifestation <http://scta.info/property/isManifestationOf> ?expression .\",\n          \"?expression <http://purl.org/dc/elements/1.1/title> ?item_expression_title .\",\n          \"?expression <http://scta.info/property/status> ?status .\",\n          \"OPTIONAL {\",\n             \"?expression <http://scta.info/property/questionTitle> ?item_expression_question_title .\",\n           \"}\",\n         \"}\",\n        \"}\",\n        \"ORDER BY ?surface_order\"].join('')\n     return query\n   }\n\n   export function getCodexInfoFromCanvas(canvasid){\n    const query = [\n      \"SELECT DISTINCT ?codex ?surfaceFocus ?expression ?codex_title ?item_expression_title ?item_expression_question_title ?surface ?surface_title ?surface_order ?manifestation ?manifestation_short_id ?status \",\n      \"{\",\n        \"?isurfaceFocus <http://scta.info/property/hasCanvas> <\" + canvasid + \"> .\",\n        \"?surfaceFocus <http://scta.info/property/hasISurface> ?isurfaceFocus .\",\n        \"?codex <http://scta.info/property/hasSurface> ?surfaceFocus .\",\n        \"?codex <http://purl.org/dc/elements/1.1/title> ?codex_title .\",\n        \"OPTIONAL {\",\n        \"?icodex <http://scta.info/property/isCodexItemOf> ?codex .\",\n        \"?isurface <http://purl.org/dc/elements/1.1/isPartOf> ?icodex .\",\n        \"?surface <http://scta.info/property/hasISurface> ?isurface .\",\n        \"?surface <http://scta.info/property/order> ?surface_order .\",\n        \"?surface <http://purl.org/dc/elements/1.1/title> ?surface_title .\",\n        \"?manifestation <http://scta.info/property/isOnSurface> ?surface .\",\n        \"?manifestation <http://scta.info/property/structureType> <http://scta.info/resource/structureItem> .\",\n        \"?manifestation <http://scta.info/property/shortId> ?manifestation_short_id .\",\n        \"?manifestation <http://scta.info/property/isManifestationOf> ?expression .\",\n        \"?expression <http://purl.org/dc/elements/1.1/title> ?item_expression_title .\",\n        \"?expression <http://scta.info/property/status> ?status .\",\n        \"OPTIONAL {\",\n           \"?expression <http://scta.info/property/questionTitle> ?item_expression_question_title .\",\n         \"}\",\n       \"}\",\n      \"}\",\n      \"ORDER BY ?surface_order\"].join('')\n      return query\n    }\n\n   export function getSearchExpressionList(filters){\n     //filters should be an ojbect\n     let authorFilter = \"\"\n     if (filters.authorId){\n       authorFilter = \"BIND(<\" + filters.authorId + \"> as ?author) . \"\n     }\n     const query = [\n       \"SELECT DISTINCT ?expressionid ?expressionTitle ?author ?authorTitle \",\n       \"{\",\n         authorFilter,\n         \"?author a <http://scta.info/resource/person> .\",\n         \"?expressionid <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n         \"?expressionid a <http://scta.info/resource/expression> .\",\n         \"?expressionid <http://scta.info/property/level> '1' .\",\n         \"?expressionid <http://purl.org/dc/elements/1.1/title> ?expressionTitle .\",\n         \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n       \"}\",\n       \"ORDER BY ?authorTitle\"].join('')\n    return query\n   }\n   export function getSearchAuthorList(filters){\n     //filters should be an ojbect\n     const query = [\n       \"SELECT DISTINCT ?author ?authorTitle \",\n       \"{\",\n          \"?author a <http://scta.info/resource/person> .\",\n          \"?expressionid <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n          \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n\n       \"}\",\n       \"ORDER BY ?authorTitle\"].join('')\n    return query\n   }\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Form from 'react-bootstrap/Form';\nimport Button from 'react-bootstrap/Button';\n\nimport {runQuery} from './utils'\nimport {getSearchExpressionList, getSearchAuthorList} from './Queries'\n\n\nclass SearchQuery extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleQueryUpdate = this.handleQueryUpdate.bind(this)\n    this.handleEidUpdate = this.handleEidUpdate.bind(this)\n    this.handleRunSearch = this.handleRunSearch.bind(this)\n    this.getAvailableExpressions = this.getAvailableExpressions.bind(this)\n    this.handleAuthorUpdate = this.handleAuthorUpdate.bind(this)\n    this.handleToggleFilterOptions = this.handleToggleFilterOptions.bind(this)\n    this.state = {\n      query: \"\",\n      eid: \"\",\n      eidFull: \"\",\n      authorFocusId: \"\",\n      availableExpressions: [],\n      availableAuthors: [],\n      showFilterOptions: false\n    }\n  }\n  handleQueryUpdate(e){\n    e.preventDefault()\n\n    this.setState({query: e.target.value})\n\n  }\n  getAvailableExpressions(filter){\n    //filter should be object\n    const searchExpressionList = runQuery(getSearchExpressionList(filter))\n    searchExpressionList.then((d) => {\n      const availableExpressions = d.data.results.bindings.map((b) => {\n        return {\n          expression: b.expressionid.value,\n          expressionTitle: b.expressionTitle.value,\n          author: b.author.value,\n          authorTitle: b.authorTitle.value,\n        }\n      })\n      this.setState(() => {\n        return{\n          availableExpressions: availableExpressions\n        }\n      })\n    })\n  }\n  getAvailableAuthors(){\n    const searchAuthorList = runQuery(getSearchAuthorList({}))\n    searchAuthorList.then((d) => {\n      const availableAuthors = d.data.results.bindings.map((b) => {\n        return {\n          author: b.author.value,\n          authorTitle: b.authorTitle.value,\n        }\n      })\n      //searchAuthorList.filter((value,index,self) => self.indexOf(value.authro === index.author))\n      this.setState(() => {\n        return{\n          availableAuthors: availableAuthors\n        }\n      })\n    })\n  }\n  handleEidUpdate(e){\n    e.preventDefault()\n    this.setState({eid: e.target.value.split(\"/resource/\")[1], eidFull: e.target.value})\n  }\n  handleAuthorUpdate(e){\n    e.preventDefault()\n    this.setState({authorFocusId: e.target.value, eid: '', eidFull: ''})\n  }\n  handleToggleFilterOptions(){\n    this.setState((prevState) => {\n      return {\n        showFilterOptions: !prevState.showFilterOptions\n      }\n    })\n  }\n  handleRunSearch(e){\n    e.preventDefault()\n    this.props.handleRunSearch(this.state.query, this.state.eid, this.state.authorFocusId)\n  }\n  componentDidUpdate(prevProps, prevState){\n    if (prevState.authorFocusId !== this.state.authorFocusId){\n      this.getAvailableExpressions({authorId: this.state.authorFocusId})\n\n    }\n  }\n  componentDidMount(){\n    this.getAvailableExpressions({})\n    this.getAvailableAuthors()\n    this.props.eid && this.setState({eid: this.props.eid, eidFull: \"http://scta.info/resource/\" + this.props.eid, authorFocusId: this.props.authorId})\n  }\n  componentWillReceiveProps(nextProps){\n    nextProps.eid && this.setState({eid: nextProps.eid})\n  }\n  render(){\n    const displayAvailableExpressions = () => {\n      if (this.state.availableExpressions.length > 0){\n        const availableExpressions = this.state.availableExpressions.map((e, i) => {\n          return <option key={e.expression + \"-\" + i} value={e.expression}>{e.authorTitle}: {e.expressionTitle}</option>\n        })\n        return availableExpressions\n      }\n      else{\n        return null\n      }\n    }\n    const displayAvailableAuthors = () => {\n      if (this.state.availableAuthors.length > 0){\n        const availableAuthors = this.state.availableAuthors.map((e, i) => {\n          return <option key={e.author + \"-\" + i} value={e.author}>{e.authorTitle}</option>\n        })\n        return availableAuthors\n      }\n      else{\n        return null\n      }\n    }\n    return (\n      <div>\n       <Form onSubmit={this.handleRunSearch}>\n       <Form.Group>\n          <Form.Label>Enter Search Text</Form.Label>\n          <Form.Control type=\"text\" id=\"query\" placeholder=\"query\" className=\"mr-sm-2\" onChange={this.handleQueryUpdate} />\n        </Form.Group>\n\n        {this.state.showFilterOptions &&\n          <div>\n          <Form.Group>\n          <Form.Label>Filter by Author</Form.Label>\n          <Form.Control as=\"select\" onChange={this.handleAuthorUpdate} value={this.state.authorFocusId}>\n            <option key=\"all-authors\" value=\"\">All</option>\n            {displayAvailableAuthors()}\n          </Form.Control>\n          </Form.Group>\n          <Form.Group>\n          <Form.Label>Filter by Title</Form.Label>\n          <Form.Control as=\"select\" onChange={this.handleEidUpdate} value={this.state.eidFull}>\n            <option key=\"all-expressions\" value=\"\">All</option>\n            {displayAvailableExpressions()}\n          </Form.Control>\n          </Form.Group>\n          </div>\n        }\n\n        {\n          //!this.props.eid && <FormControl type=\"text\" id=\"eid\" placeholder=\"eid\" className=\"mr-sm-2\" onChange={this.handleEidUpdate} />\n        }\n        <Button onClick={this.handleToggleFilterOptions}>{this.state.showFilterOptions ? \"Hide\" : \"Show\"} Filter Options</Button>\n        <br/>\n        <br/>\n        <Button type=\"submit\" variant=\"outline-success\">Search</Button>\n\n      </Form>\n\n      </div>\n    )\n  }\n}\n\nSearchQuery.propTypes = {\n  /**\n  * handleRunSearch function; function to be passed down from parent\n  * which should determine what should be done when SearchQuery parameters have been set\n  * function should take three parameters\n  * this.state.query, this.state.eid, this.state.authorFocusId\n  *\n  */\n  handleRunSearch: PropTypes.func,\n  /**\n  * eid, shortId of expression id; search restricted to text within this expression\n  *\n  * TODO: consider changing eid from shortId to full Url id to match authorFocusId\n  */\n  eid: PropTypes.string,\n  /**\n  * authorId, full url id of expression author; search restricted to texts by this author\n  *\n  * TODO: consider making \"authorId\" consistent with \"authorFocusId\" used in <Search> component\n  */\n  authorId: PropTypes.string\n}\nexport default SearchQuery;\n","import React from 'react';\nimport Search from \"./Search\"\nimport SearchQuery from \"./SearchQuery\"\nimport Container from 'react-bootstrap/Container';\n\nclass SearchWrapper extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleRunSearch = this.handleRunSearch.bind(this)\n    this.state = {\n      query: \"\",\n      eid: \"\",\n      authorFocusId: \"\"\n    }\n  }\n  handleRunSearch(query, eid, authorFocusId){\n    this.setState({query: query, eid: eid, authorFocusId: authorFocusId})\n  }\n\n  componentDidMount(){\n\n  }\n  componentWillReceiveProps(){\n\n  }\n  render(){\n    return (\n      <Container className={this.props.hidden ? \"hidden\" : \"showing\"}>\n        <h1>Search</h1>\n        <SearchQuery handleRunSearch={this.handleRunSearch} eid={this.props.topLevel ? this.props.topLevel.split(\"/resource/\")[1] : null} authorId={this.props.authorId}/>\n        {this.state.query && <Search query={this.state.query} eid={this.state.eid} authorFocusId={this.state.authorFocusId}/>}\n      </Container>\n    )\n  }\n}\n\nexport default SearchWrapper;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nfunction Image(props) {\n  let newCoords = \"\"\n  if (props.coords){\n    const coordsSplitArray = props.coords.split(\",\")\n    //const x = parseInt(coordsSplitArray[0]) - 20\n    const x = parseInt(coordsSplitArray[0])\n    const y = coordsSplitArray[1]\n    //const w = parseInt(coordsSplitArray[2]) + 40\n    const w = parseInt(coordsSplitArray[2])\n    const h = coordsSplitArray[3]\n    newCoords = x + \",\" + y + \",\" + w + \",\" + h\n  }\n\n  const imageLink = props.imageUrl + \"/\" + newCoords + \"/\" + props.displayWidth + \",/0/default.jpg\"\n  return (\n    <img alt=\"manuscript\" src={imageLink}/>\n  );\n}\n\nImage.propTypes = {\n  /**\n  * the Url for the image resource\n  **/\n  imageUrl: PropTypes.string.isRequired,\n  /**\n  * width of the image to be displayed\n  *\n  * TODO: might be better to make this a number/integer and not required;\n  * when not preset perhaps it should just default to the widths listed in the coords\n  **/\n  displayWidth: PropTypes.string.isRequired,\n  /**\n  * string in the form of \"x,y,w,h\"\n  *\n  **/\n  coords: PropTypes.string.isRequired\n}\nexport default Image;\n","import React from 'react';\n\nfunction LineText(props) {\n  return (\n    <div className=\"text\" style={{\"whiteSpace\": \"nowrap\"}}>\n     <span dangerouslySetInnerHTML={{__html: props.text}} />\n    </div>\n  );\n}\n\nexport default LineText;\n","// Note this component is a near duplicate of Image Text Wrapper in Paleographinator\n// TODO: This shoud be the target for a refactored independent React Component\n\nimport React, { Component } from 'react';\nimport Image from './Image';\nimport LineText from './LineText';\n\nclass ImageTextWrapper extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      searchText: \"\"\n    }\n  }\n  render() {\n    // const getClass = () => {\n    //   if (this.props.targetLabel === this.props.label){\n    //     return \"ImageTextWrapper target\"\n    //   }\n    //   else {\n    //     return \"ImageTextWrapper\"\n    //   }\n    // }\n    return (\n      <div className={this.props.targetLabel === this.props.label ? \"ImageTextWrapper target\" : \"ImageTextWrapper\"}>\n        <div className=\"labelImageWrapper\">\n\n        <Image\n          imageUrl={this.props.imageUrl}\n          canvas={this.props.canvas}\n          coords={this.props.coords}\n          canvasShort={this.props.canvasShort}\n          displayWidth={this.props.displayWidth}\n          />\n        </div>\n        <LineText text={this.props.text}/>\n      </div>\n    );\n  }\n}\n\nexport default ImageTextWrapper;\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport Axios from 'axios'\nimport Button from 'react-bootstrap/Button';\n\nimport ImageTextWrapper from './ImageTextWrapper';\n\nimport {runQuery} from './utils'\nimport {getSurfaceInfo} from './Queries'\n\n\n\nclass Surface2 extends React.Component {\n  constructor(props){\n    super(props)\n    this.mount = false\n    this.handleNext = this.handleNext.bind(this)\n    this.handlePrevious = this.handlePrevious.bind(this)\n    this.handleToggleTextLines = this.handleToggleTextLines.bind(this)\n    this.handleToggleAllLines = this.handleToggleAllLines.bind(this)\n    this.state = {\n      currentSurfaceId: \"\",\n      manifest: \"\",\n      canvas: \"\",\n      region: \"full\",\n      width: \"1000\",\n      next: \"\",\n      previous: \"\",\n      imageurl: \"\",\n      annotationsDisplay: true,\n      showAllLines: false\n    }\n\n  }\n  handleNext(){\n    //this.retrieveSurfaceInfo(this.state.next)\n    this.props.handleSurfaceFocusChange(this.state.next)\n  }\n  handlePrevious(){\n    //this.retrieveSurfaceInfo(this.state.previous)\n    this.props.handleSurfaceFocusChange(this.state.previous)\n\n  }\n  handleToggleTextLines(){\n    //this.retrieveSurfaceInfo(this.state.previous)\n    this.setState((prevState) => {\n      return {annotationsDisplay: !prevState.annotationsDisplay}\n    })\n  }\n  handleToggleAllLines(){\n    this.setState((prevState) => {\n      return {showAllLines: !prevState.showAllLines}\n    })\n  }\n  retrieveSurfaceInfo(surfaceid){\n    // manifest id should be retrieved from query\n    // this is a temporary measure until db is corrected and query is posible\n\n    //const manifest = \"http://scta.info/iiif/\" + this.props.topLevel.split(\"/resource/\")[1] + \"/\" + surfaceid.split(\"/resource/\")[1].split(\"/\")[0] + \"/manifest\";\n    const manifest = \"\";\n    const surfaceInfo = runQuery(getSurfaceInfo(surfaceid))\n    surfaceInfo.then((d) => {\n      const b = d.data.results.bindings[0]\n      // only preceed if sparql query returns results\n      if (b){\n        //second nested async call for annotation list\n        const alUrl = \"https://exist.scta.info/exist/apps/scta-app/folio-annotaiton-list-from-simpleXmlCoordinates.xq?surfaceid=\" + surfaceid.split(\"/resource/\")[1]\n        Axios.get(alUrl).then((d2) => {\n          if (this.mount){\n              this.setState({\n                currentSurfaceId: surfaceid,\n                surfaceTitle: b.surfaceTitle.value,\n                manifest: manifest,\n                canvas: b.canvas.value,\n                imageurl: b.imageurl.value,\n                next: b.next_surface ? b.next_surface.value : \"\",\n                previous: b.previous_surface ? b.previous_surface.value : \"\",\n                annotations: d2.data ? d2.data.resources : \"\"\n            })\n          }\n        }).catch((error) => {\n          console.log(\"failed retrieving annotationlist: \", error)\n          if (this.mount){\n            this.setState({\n            currentSurfaceId: surfaceid,\n            surfaceTitle: b.surfaceTitle.value,\n            manifest: manifest,\n            canvas: b.canvas.value,\n            imageurl: b.imageurl.value,\n            next: b.next_surface ? b.next_surface.value : \"\",\n            previous: b.previous_surface ? b.previous_surface.value : \"\",\n            annotations: \"\"\n          })\n        }\n      })\n    }\n  })\n}\ncomponentDidMount(){\n  this.mount = true\n    if (this.props.surfaceid){\n      this.retrieveSurfaceInfo(this.props.surfaceid)\n    }\n    this.setState({annotationsDisplay: this.props.annotationsDisplay})\n  }\n  componentWillReceiveProps(nextProps){\n    if (nextProps.surfaceid !== this.props.surfaceid){\n    this.retrieveSurfaceInfo(nextProps.surfaceid)\n    }\n  }\n  componentWillUnmount(){\n    this.mount = false\n  }\n  render() {\n    const displayImages = () => {\n      if (this.state.annotations && this.state.annotationsDisplay){\n        const imageTextWrappers = this.state.annotations.map((h, i) => {\n          const text = h.resource.chars;\n          const canvas = h.on.split(\"#xywh=\")[0];\n          const canvasShort = canvas.split(\"/\")[canvas.split(\"/\").length - 1];\n          const coords = h.on.split(\"#xywh=\")[1];\n          const imageUrl = h.imageUrl\n          const label = h.label\n          if (this.state.showAllLines || (parseInt(this.props.lineFocusId.split(\"/\")[this.props.lineFocusId.split(\"/\").length - 1]) === (i + 1) ) || !this.props.lineFocusId){\n          return (\n            <ImageTextWrapper key={i}\n              imageUrl={imageUrl}\n              canvas={canvas}\n              coords={coords}\n              canvasShort={canvasShort}\n              text={text}\n              label={label}\n              targetLabel={this.props.targetLabel}\n              surfaceButton={false}\n              displayWidth={this.props.width ? this.props.width : this.state.width}\n              />\n            )\n          }\n          else{\n            return null\n          }\n\n        })\n        return imageTextWrappers\n      }\n      else{\n        const width = this.props.width ? this.props.width : this.state.width\n        return <img alt=\"manuscript\" src={this.state.imageurl + \"/\" + this.state.region + \"/\" + width + \",/0/default.jpg\"}/>\n      }\n    }\n    return (\n      <Container className={this.props.hidden ? \"hidden\" : \"showing\"}>\n      {this.state.currentSurfaceId ?\n        <div>\n          <div className=\"surface-navigation\">\n            <p>{this.state.surfaceTitle}</p>\n            {this.props.handleSurfaceFocusChange &&\n              <div>\n              {this.state.previous && <Button size=\"sm\" onClick={this.handlePrevious}>Previous</Button>}\n              {this.state.next && <Button size=\"sm\" onClick={this.handleNext}>Next</Button>}\n              </div>\n            }\n            <div>\n            {this.props.lineFocusId && <Button size=\"sm\" onClick={this.handleToggleAllLines}>Show All Lines</Button>}\n            {this.state.annotations && <Button size=\"sm\" onClick={this.handleToggleTextLines}>Toggle Text Lines</Button>}\n            </div>\n          </div>\n          {displayImages()}\n        </div> : <p>No surface selected</p>}\n      </Container>\n\n    );\n  }\n\n}\nSurface2.defaultProps = {\n  annotationsDisplay: true\n};\nexport default Surface2;\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport PropTypes from 'prop-types';\nimport Axios from 'axios'\n\nimport ImageTextWrapper from './ImageTextWrapper';\n\nimport {runQuery} from './utils'\nimport {getSurfaceInfo, getBlockLines} from './Queries'\n\nclass Surface3 extends React.Component {\n  constructor(props){\n    super(props)\n    this.mounted = \"\"\n    this.handleNext = this.handleNext.bind(this)\n    this.handlePrevious = this.handlePrevious.bind(this)\n    this.state = {\n      region: \"full\",\n      surfaces: [\n      ]\n    }\n\n  }\n  handleNext(){\n    //this.retrieveSurfaceInfo(this.state.next)\n    this.props.handleSurfaceFocusChange(this.state.next)\n  }\n  handlePrevious(){\n    //this.retrieveSurfaceInfo(this.state.previous)\n    this.props.handleSurfaceFocusChange(this.state.previous)\n\n  }\n  retrieveSurfaceInfo(manifestationid){\n    // manifest id should be retrieved from query\n    // this is a temporary measure until db is corrected and query is posible\n    const blockLineInfo = runQuery(getBlockLines(manifestationid))\n    blockLineInfo.then((d1) => {\n      d1.data.results.bindings.forEach((z) => {\n        const surfaceid = z.surface.value\n        const firstLine = z.first.value\n        const lastLine = z.last.value\n        const order = z.order.value\n        //const manifest = \"http://scta.info/iiif/\" + this.props.topLevel.split(\"/resource/\")[1] + \"/\" + surfaceid.split(\"/resource/\")[1].split(\"/\")[0] + \"/\" + \"manifest\";\n        const surfaceInfo = runQuery(getSurfaceInfo(surfaceid))\n        surfaceInfo.then((d) => {\n          const b = d.data.results.bindings[0]\n          // only preceed if sparql query returns results\n          if (b){\n            //second nested async call for annotation list\n            const alUrl = \"https://exist.scta.info/exist/apps/scta-app/folio-annotaiton-list-from-simpleXmlCoordinates.xq?surfaceid=\" + surfaceid.split(\"/resource/\")[1]\n            Axios.get(alUrl).then((d2) => {\n              //const resources = d2.data.resources\n              if (this.mounted){\n                this.setState((prevState) => {\n                  const newSurface = {\n                    currentSurfaceId: surfaceid,\n                    surfaceTitle: b.surfaceTitle ? b.surfaceTitle.value : \"\",\n                    //manifest: manifest,\n                    canvas: b.canvas.value,\n                    imageurl: b.imageurl.value,\n                    next: b.next_surface ? b.next_surface.value : \"\",\n                    previous: b.previous_surface ? b.previous_surface.value : \"\",\n                    annotations: d2.data ? d2.data.resources : \"\",\n                    surfaceid: surfaceid,\n                    firstLine: firstLine,\n                    lastLine: lastLine,\n                    order: order\n\n                  }\n                return {\n                  surfaces: [\n                    ...prevState.surfaces,\n                    newSurface\n                    ]\n                  }\n                })\n              }\n            }).catch((error) => {\n              console.log(\"failed retrieving annotationlist: \", error)\n              if (this.mounted){\n                this.setState((prevState) => {\n                  const newSurface = {\n                    currentSurfaceId: surfaceid,\n                    surfaceTitle: b.surfaceTitle.value,\n                    //manifest: manifest,\n                    canvas: b.canvas.value,\n                    imageurl: b.imageurl.value,\n                    next: b.next_surface ? b.next_surface.value : \"\",\n                    previous: b.previous_surface ? b.previous_surface.value : \"\",\n                    annotations: \"\",\n                    surfaceid: surfaceid,\n                    firstLine: firstLine,\n                    lastLine: lastLine,\n                    order: order\n\n                  }\n                return {\n                  surfaces: [\n                    ...prevState.surfaces,\n                    newSurface\n                  ]\n                }\n              })\n            }\n          })\n        }\n      })\n    })\n  })\n}\ncomponentDidMount(){\n  this.mounted = true\n    if (this.props.manifestationid){\n      this.setState((prevState) => {\n        return {\n          surfaces: []\n        }\n      },\n      this.retrieveSurfaceInfo(this.props.manifestationid)\n    )\n    }\n  }\n  componentWillReceiveProps(nextProps){\n    if (nextProps.manifestationid !== this.props.manifestationid){\n      this.setState((prevState) => {\n        return {\n          surfaces: []\n        }\n\n      },\n    this.retrieveSurfaceInfo(nextProps.manifestationid))\n    }\n  }\n  componentWillUnmount(){\n    this.mounted = false\n  }\n  render() {\n    const displayAllImages = () => {\n      const sortedSurfaces = this.state.surfaces.sort((a, b) => {\n        if (a.order > b.order) return 1;\n        if (b.order > a.order) return -1;\n        return 0;\n      })\n      const surfacesDisplay = sortedSurfaces.map((surface) => {\n        return displayImages(surface)\n      })\n      return surfacesDisplay\n    }\n    const displayImages = (surface) => {\n      // handle line display\n      if (surface.annotations && this.props.annotationsDisplay === \"lines\"){\n        const imageTextWrappers = surface.annotations.map((h, i) => {\n\n          if (i + 1 >= surface.firstLine && i < surface.lastLine){\n            const text = h.resource.chars;\n            const canvas = h.on.split(\"#xywh=\")[0];\n            const canvasShort = canvas.split(\"/\")[canvas.split(\"/\").length - 1];\n            const coords = h.on.split(\"#xywh=\")[1];\n            const imageUrl = h.imageUrl\n            const label = h.label\n            return (\n              <ImageTextWrapper key={i}\n                imageUrl={imageUrl}\n                canvas={canvas}\n                coords={coords}\n                canvasShort={canvasShort}\n                text={text}\n                label={label}\n                targetLabel={this.props.targetLabel}\n                surfaceButton={false}\n                displayWidth={this.props.width}\n                />\n              )\n            }\n            else{\n              return null\n            }\n\n        })\n        return imageTextWrappers\n      }\n      // handle paragraph display\n      else if (surface.annotations && this.props.annotationsDisplay === \"paragraph\"){\n        const h = surface.annotations[surface.firstLine - 1]\n        const fl = surface.annotations[surface.firstLine - 1]\n        const flcanvas = fl ? fl.on.split(\"#xywh=\")[0] : \"\"\n        const flcanvasShort = flcanvas.split(\"/\")[flcanvas.split(\"/\").length - 1];\n        const flcoords = fl ? fl.on.split(\"#xywh=\")[1] : \"\"\n        const y = flcoords.split(\",\")[1]\n        const ll = surface.annotations[surface.lastLine - 1]\n        //const llcanvas = ll ? ll.on.split(\"#xywh=\")[0] : \"\"\n        //const llcanvasShort = llcanvas.split(\"/\")[llcanvas.split(\"/\").length - 1];\n        const llcoords = ll ? ll.on.split(\"#xywh=\")[1] : \"\"\n        const lly = llcoords.split(\",\")[1]\n        const llh = llcoords.split(\",\")[3]\n        const llbottom = (parseInt(lly) + parseInt(llh)) - parseInt(y)\n        const coords = (parseInt(flcoords.split(\",\")[0] - 10)) + \",\" + (parseInt(y)) + \",\" + (parseInt(flcoords.split(\",\")[2]) + 10) + \",\" + (parseInt(llbottom) + 50)\n        const text = \"\"\n        const imageUrl = h ? h.imageUrl : \"\"\n        // check to see if an Image Url has been found.\n        // if not show \"error message\"\n        if (imageUrl){\n\n          return (\n            <ImageTextWrapper\n              key={surface.currentSurfaceId + \"-\" + surface.order}\n              imageUrl={imageUrl}\n              canvas={flcanvas}\n              coords={coords}\n              canvasShort={flcanvasShort}\n              text={text}\n              label={\"\"}\n              targetLabel={\"\"}\n              surfaceButton={false}\n              displayWidth={this.props.width}\n              />\n            )\n          }\n          else {\n            return (<p key={surface.currentSurfaceId + \"-\" + surface.order}>Sorry, this image is not yet ready</p>)\n          }\n        }\n      else{\n        return <img key={surface.currentSurfaceId + \"-\" + surface.order} alt=\"manuscript\" src={surface.imageurl + \"/full/\" + this.props.width + \",/0/default.jpg\"}/>\n      }\n    }\n    return (\n      <Container className={this.props.hidden ? \"hidden\" : \"showing\"}>\n      {displayAllImages()}\n      </Container>\n\n    );\n  }\n\n}\nSurface3.defaultProps = {\n  width: \"500\"\n};\n\nSurface3.propTypes = {\n  /**\n  * a string indicating desired width in pixels for image display\n  *\n  * TODO: it might be desireable to change propType to an integer. I'm not sure.\n  */\n  width: PropTypes.string,\n  /**\n  * manifestation id\n  */\n  manifestationid: PropTypes.string,\n  /**\n  * indicates what kind of display is desired, \"lines, paragraph, surface/null\"\n  */\n  annotationsDisplay: PropTypes.string\n}\n\nexport default Surface3;\n","import React from 'react';\nimport Surface3 from './Surface3';\nimport PropTypes from 'prop-types';\nimport Form from 'react-bootstrap/Form';\n\nimport { FaList, FaFile, FaParagraph} from 'react-icons/fa';\n\n//TODO: surface 3 needs to run in a wrapper which allows the user to choose between manifestations.\n//TODO: rdf dbase needs to include first line numbers for paragraphs that start in the middle of al line.\n\nclass Surface3Wrapper extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleChangeManifestation = this.handleChangeManifestation.bind(this)\n    this.handleToggleTextLinesView = this.handleToggleTextLinesView.bind(this)\n    this.state = {\n      focusedManifestation: \"\",\n      annotationsDisplay: \"lines\"\n    }\n  }\n  handleToggleTextLinesView(view){\n    //optional prop to allow parent container to reset default view prop\n    if (this.props.handleToggleTextLinesView){\n      this.props.handleToggleTextLinesView(view)\n    }\n    else{\n      this.setState((prevState) => {\n        return {annotationsDisplay: view}\n      })\n    }\n  }\n  handleChangeManifestation(e){\n    e.preventDefault()\n    //optional prop to allow parent container to reset default view prop\n    if (this.props.handleChangeManifestation){\n      this.props.handleChangeManifestation(e.target.value)\n    }\n    else{\n      this.setState({focusedManifestation: e.target.value})\n    }\n  }\n  componentDidMount(){\n    if (this.props.manifestations){\n      this.setState((prevState) => {\n        return {\n          focusedManifestation: this.props.focusedManifestation,\n          annotationsDisplay: this.props.annotationsDisplay,\n        }\n      })\n    }\n  }\n  componentWillReceiveProps(nextProps){\n    if (nextProps.focusedManifestation !== this.props.focusedManifestation){\n      this.setState((prevState) => {\n        return {\n          focusedManifestation: nextProps.focusedManifestation,\n        }\n      })\n    }\n    if (nextProps.annotationsDisplay !== this.props.annotationsDisplay){\n      this.setState((prevState) => {\n        return {\n          annotationsDisplay: nextProps.annotationsDisplay,\n        }\n      })\n    }\n  }\n  render() {\n    const displayManifestationsList = () => {\n      const list = this.props.manifestations.map((m) => {\n        return <option key={\"title-\" + m.manifestation} value={m.manifestation}>{m.manifestationTitle}</option>\n      })\n      return list\n    }\n    const displayManifestation = () => {\n      const manifestation = this.props.manifestations.map((m) => {\n        if (m.manifestation === this.state.focusedManifestation){\n          return <Surface3 key={\"surface-\" + m.manifestation} manifestationid={m.manifestation} annotationsDisplay={this.state.annotationsDisplay} width={this.props.width}/>\n        }\n        else{\n          return null\n        }\n      })\n      return manifestation\n\n    }\n\n    return (\n      <div className={this.props.hidden ? \"hidden\" : \"showing\"}>\n        <div className=\"manifestationsList\">\n          <Form.Control as=\"select\" onChange={this.handleChangeManifestation} value={this.state.focusedManifestation}>\n            {displayManifestationsList()}\n          </Form.Control>\n        </div>\n        <div className=\"surfaceWrapper\">\n          {this.state.focusedManifestation &&\n            <div className=\"image-display-choice\">\n              <p><span title=\"Text Line View\" onClick={() => {this.handleToggleTextLinesView(\"lines\")}}><FaList/></span></p>\n              <p><span title=\"Paragraph View\" onClick={() => {this.handleToggleTextLinesView(\"paragraph\")}}><FaParagraph/></span></p>\n              <p><span title=\"Full Surface View\" onClick={() => {this.handleToggleTextLinesView(\"surface\")}}><FaFile/></span></p>\n            </div>\n          }\n          <div className=\"imagesDisplay\">\n            {displayManifestation()}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nSurface3Wrapper.defaultProps = {\n  manifestations: [],\n  hidden: false,\n  focusedManifestation: \"\",\n  annotationsDisplay: \"paragraph\",\n  width: \"500\"\n};\n\nSurface3Wrapper.propTypes = {\n  /**\n  * an array of manifestation ids\n  */\n  manifestations: PropTypes.array,\n  /**\n  * boolean indicating whether or not compoment should be mounted by still hidden\n  */\n  hidden: PropTypes.bool,\n  /**\n  * indicates on which manifestation component to default focus.\n  * manifestation value MUST be included in manifestations array\n  */\n  focusedManifestation: PropTypes.string,\n  /**\n  * indicates what kind of display is desired, \"lines, paragraph, surface/null\"\n  */\n\n  annotationsDisplay: PropTypes.string,\n  /**\n  * optional prop to allow parent container to reset default view prop\n  */\n  handleToggleTextLinesView: PropTypes.func,\n  /**\n  * desired image width\n  */\n  width: PropTypes.string\n}\n\nexport default Surface3Wrapper;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Axios from 'axios'\nimport { Light as SyntaxHighlighter } from 'react-syntax-highlighter';\n//import xml from 'react-syntax-highlighter/dist/esm/languages/hljs/xml';\nimport { docco } from 'react-syntax-highlighter/dist/esm/styles/hljs';\n\n/**\n* XML view show component\n**/\nclass XmlView extends React.Component {\n\n  constructor(props){\n    super(props)\n    this.mount = false\n    this.retrieveXML = this.retrieveXML.bind(this)\n    this.state = {\n      xmlstring: \"\"\n    }\n  }\n  retrieveXML(tresourceid){\n    const xmlurl = \"http://exist.scta.info/exist/apps/scta-app/document/\" + tresourceid.split(\"/resource/\")[1]\n    Axios.get(xmlurl).then((d) => {\n      if (this.mount){\n        this.setState({xmlstring: d.data})\n      }\n    })\n\n  }\n  componentDidMount(){\n    this.mount = true\n    this.retrieveXML(this.props.tresourceid)\n\n  }\n  componentWillReceiveProps(nextProps){\n    if (nextProps.tresourceid !== this.props.tresourceid){\n      this.retrieveXML(nextProps.tresourceid)\n    }\n  }\n  componentWillUnmount(){\n    this.mount = false\n  }\n\n  render(){\n    return (\n      <div className={this.props.hidden ? \"hidden\" : \"showing\"}>\n      <SyntaxHighlighter language=\"xml\" style={docco} showLineNumbers>\n        {this.state.xmlstring}\n      </SyntaxHighlighter>\n      </div>\n    )\n  }\n}\n\nXmlView.propTypes = {\n  /**\n  * transcription resource id of transcription for desired xml view\n  *\n  * TODO: Component is currently splitting the id and constructing the xml based\n  * on a prior knowledge of where xml is; this really should be retrieved from the resource id\n  * but the xml look up should happen outside of the XmlView Component in order to keep this component simple\n  * and making only request directly to the xml file\n  */\n  tresourceid: PropTypes.string.isRequired,\n  /**\n  * hidden designates whether the component should be hidden after mounting\n  */\n  hidden: PropTypes.bool,\n}\nexport default XmlView;\n","import React from 'react';\nimport Nav from 'react-bootstrap/Nav';\n\nimport {FaSearch, FaGripVertical, FaCode, FaInfo, FaRegImage, FaComments, FaRegWindowRestore, FaRegWindowMaximize, FaRegWindowMinimize, FaRegWindowClose, FaClone, FaAlignLeft} from 'react-icons/fa';\n// reimport these if you want to use the chnage window location functions: FaAngleDoubleDown, FaAngleDoubleLeft,\n\nfunction WindowNavBar(props) {\n  return (\n  <Nav variant=\"tabs\">\n  {\n    //<Navbar.Brand href=\"/\">Focus: {props.focus}</Navbar.Brand>\n  }\n  {\n    //props.focusSet && <Nav.Item>\n    //<Nav.Link title=\"Basic Resource Information\" onClick={() => {props.handleTabChange(\"info\", props.windowId)}}><FaInfo/></Nav.Link>\n    //</Nav.Item>\n  }\n  {props.focusSet &&<Nav.Item>\n    <Nav.Link active={props.windowLoad === \"citation\"} title=\"Text Citation\" onClick={() => {props.handleTabChange(\"citation\", props.windowId)}}><FaInfo/></Nav.Link>\n  </Nav.Item>}\n  {props.focusSet && <Nav.Item>\n    <Nav.Link active={props.windowLoad === \"surface3\"} title=\"Images\" onClick={() => {props.handleTabChange(\"surface3\", props.windowId)}}><FaRegImage/></Nav.Link>\n  </Nav.Item>}\n  <Nav.Item>\n    <Nav.Link active={props.windowLoad === \"xml\"} title=\"Text XML Source\" onClick={() => {props.handleTabChange(\"xml\", props.windowId)}}><FaCode/></Nav.Link>\n  </Nav.Item>\n  {props.focusSet && <Nav.Item>\n    <Nav.Link active={props.windowLoad === \"textCompare\"} title=\"Text Comparisons\" onClick={() => {props.handleTabChange(\"textCompare\", props.windowId)}}><FaGripVertical/></Nav.Link>\n  </Nav.Item>}\n  {props.focusSet &&<Nav.Item>\n    <Nav.Link active={props.windowLoad === \"comments\"} title=\"Comments\" onClick={() => {props.handleTabChange(\"comments\", props.windowId)}}><FaComments/></Nav.Link>\n  </Nav.Item>}\n\n  <Nav.Item>\n    <Nav.Link active={props.windowLoad === \"textOutlineWrapper\"} title=\"Text Outline\" onClick={() => {props.handleTabChange(\"textOutlineWrapper\", props.windowId)}}><FaAlignLeft/></Nav.Link>\n  </Nav.Item>\n  <Nav.Item>\n    <Nav.Link active={props.windowLoad === \"search\"} title=\"Text Search\" onClick={() => {props.handleTabChange(\"search\", props.windowId)}}><FaSearch/></Nav.Link>\n  </Nav.Item>\n\n  {props.openWidthHeight !== \"minimum\" &&\n  <Nav.Item>\n    <Nav.Link title=\"Minimize Window\" onClick={() => {props.handleMinimize(props.windowId)}}><FaRegWindowMinimize/></Nav.Link>\n  </Nav.Item>}\n  {props.openWidthHeight !== \"middle\" &&\n  <Nav.Item>\n    <Nav.Link title=\"Half Size Window\" onClick={() => {props.handleMiddlize(props.windowId)}}><FaRegWindowRestore/></Nav.Link>\n  </Nav.Item>\n  }\n  {props.openWidthHeight !== \"maximum\" &&\n  <Nav.Item>\n    <Nav.Link title=\"Maximize Window\" onClick={() => {props.handleMaximize(props.windowId)}}><FaRegWindowMaximize/></Nav.Link>\n  </Nav.Item>\n  }\n  <Nav.Item>\n    <Nav.Link title=\"Close Window\" onClick={() => {props.handleClose(props.windowId)}}><FaRegWindowClose/></Nav.Link>\n  </Nav.Item>\n  {/* commented to prevent window moving; this insures window 1 is always side window and window 2 is bottom window\n    uncomment if this behavior is desired\n    <Nav.Item>\n    <Nav.Link title=\"Move Window\" onClick={() => {props.handleSwitchWindow(props.windowId, props.windowType)}}>{props.windowType === \"sideWindow\" ? <FaAngleDoubleDown/> : <FaAngleDoubleLeft/>}</Nav.Link>\n  </Nav.Item>\n  */\n  }\n  <Nav.Item>\n    {!props.altWindowState && <Nav.Link title=\"Clone Window\" onClick={() => {props.handleDuplicateWindow(props.windowId, props.windowType)}}>{<FaClone/>}</Nav.Link>}\n  </Nav.Item>\n\n\n</Nav>\n\n  );\n}\n\nexport default WindowNavBar;\n","import React from 'react';\n\nimport { FaAngleLeft, FaAngleRight} from 'react-icons/fa';\nimport Nav from 'react-bootstrap/Nav';\n\nfunction NextPrevBar(props) {\n  const displayNextPrevBar = () => {\n    if (props.info){\n      return (\n        <Nav variant=\"tabs\">\n        <Nav.Link onClick={() => {props.handleBlockFocusChange(props.info.resourceid)}}>{props.info.title}</Nav.Link>\n        <Nav.Item>\n          {(props.info.previous && props.info.previous !== \"http://scta.info/resource/\")  && <Nav.Link onClick={() => {props.handleBlockFocusChange(props.info.previous)}}><FaAngleLeft/></Nav.Link>}\n        </Nav.Item>\n        <Nav.Item>\n          {(props.info.next && props.info.next !== \"http://scta.info/resource/\") && <Nav.Link onClick={() => {props.handleBlockFocusChange(props.info.next)}}><FaAngleRight/></Nav.Link>}\n        </Nav.Item>\n\n        </Nav>\n      )\n    }\n    else{\n      return null\n    }\n  }\n  return (\n    displayNextPrevBar()\n  );\n}\n\nexport default NextPrevBar;\n","import React from 'react';\nimport Diff from 'diff-match-patch'\nimport Axios from 'axios'\nimport Spinner from './Spinner';\nimport {Link} from 'react-router-dom';\n\nimport { FaEyeSlash, FaEye, FaStar } from 'react-icons/fa';\n\nclass TextCompareItem extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleToggleShow = this.handleToggleShow.bind(this)\n    this.mounted = \"\"\n    this.state = {\n      compareText: \"\",\n      rawText: \"\",\n      show: true\n    }\n  }\n  handleToggleShow(){\n    this.setState((prevState) => {\n      return{\n        show: !prevState.show\n      }\n    })\n  }\n  createCompare(base, transcription){\n\n    Axios.get(\"http://exist.scta.info/exist/apps/scta-app/csv-pct.xq?resourceid=\" + transcription)\n          .then((text) => {\n\n            const dmp = new Diff.diff_match_patch();\n\n            const diff = dmp.diff_main(base, text.data);\n            // Result: [(-1, \"Hell\"), (1, \"G\"), (0, \"o\"), (1, \"odbye\"), (0, \" World.\")]\n            dmp.diff_cleanupSemantic(diff);\n            const ds = dmp.diff_prettyHtml(diff);\n            if (this.mounted === true && base){\n              this.setState({compareText: ds, rawText: text.data})\n            }\n            else if(this.mounted){\n              this.setState({rawText: text.data})\n            }\n\n          })\n        }\n\n  componentDidMount(){\n    this.mounted = true;\n    this.setState({rawText: \"\", compareText: \"\"})\n    this.createCompare(this.props.base, this.props.compareTranscription)\n  }\n  componentWillReceiveProps(newProps){\n    // conditional try to restrict new async calls to only when props.info changes\n    if (newProps.base !== this.props.base || newProps.compareTranscription !== this.props.compareTranscription){\n      this.setState({rawText: \"\", compareText: \"\"})\n      this.createCompare(newProps.base, newProps.compareTranscription)\n    }\n  }\n  componentWillUnmount(){\n      this.mounted = false;\n    }\n\n\n  render(){\n    const displayComparison = () => {\n      if (this.props.base && this.state.compareText){\n        return (\n          <div>\n            <span><Link to={\"/text?resourceid=\" + this.props.compareTranscription}>{this.props.compareTranscription}</Link></span>\n            <span onClick={() => this.handleToggleShow()}>{this.state.show ? <FaEyeSlash/> : <FaEye/>}</span>\n            <span onClick={() => this.props.handleChangeBase(this.state.rawText)}><FaStar/></span>\n            <div className={this.state.show ? \"unhidden\" : \"hidden\"}>\n              <div ref=\"text\" dangerouslySetInnerHTML={{ __html: this.state.compareText}}></div>\n            </div>\n          </div>\n        )\n      }\n      if (this.state.rawText){\n        return (\n          <div>\n            <span><Link to={\"/text?resourceid=\" + this.props.compareTranscription}>{this.props.compareTranscription}</Link></span>\n            <span onClick={() => this.handleToggleShow()}>{this.state.show ? <FaEyeSlash/> : <FaEye/>}</span>\n            <span onClick={() => this.props.handleChangeBase(this.state.rawText)}><FaStar/></span>\n            <div className={this.state.show ? \"unhidden\" : \"hidden\"}>\n              <div ref=\"text\" dangerouslySetInnerHTML={{ __html: this.state.rawText}}></div>\n            </div>\n          </div>\n        )\n      }\n      else{\n        return <Spinner/>\n      }\n    }\n\n    return (\n      displayComparison()\n    );\n  }\n}\n\nexport default TextCompareItem;\n","import React from 'react';\nimport {Link} from 'react-router-dom';\nimport { FaEyeSlash, FaEye } from 'react-icons/fa';\nimport {runQuery} from './utils'\nimport {basicInfoQuery} from './Queries'\n\nimport TextCompareItem from './TextCompareItem'\n\n\n\nclass TextCompare extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleToggleShowAll = this.handleToggleShowAll.bind(this)\n    this.mounted = \"\"\n    this.state = {\n      info: \"\",\n      show: false,\n      baseText: \"\"\n    }\n\n  }\n\n  handleToggleShowAll(){\n    this.setState((prevState) => {\n      return{\n        show: !prevState.show\n      }\n    })\n  }\n\n  // TODO dupblicate of function in Text Component\n  // needs refactoring\n  arrangeTextInfo(info, resourceid){\n      info.then((d) => {\n        const bindings = d.data.results.bindings[0]\n        const manifestations = d.data.results.bindings.map((b) => {\n          return {\n            manifestation: b.manifestation.value,\n            manifestationTitle: b.manifestationTitle.value,\n            transcription: b.manifestationCTranscription.value\n          }\n        })\n        if (this.mounted === true && bindings){\n          this.setState({\n            info: {\n              resourceid: resourceid,\n              title: bindings.title.value,\n              structureType: bindings.structureType.value,\n              inbox: bindings.inbox.value,\n              next: bindings.next ? bindings.next.value : \"\",\n              previous: bindings.previous ? bindings.previous.value : \"\",\n              cdoc: bindings.cdoc.value,\n              cxml: bindings.cxml.value,\n              topLevel: bindings.topLevelExpression.value,\n              cmanifestation: bindings.cmanifestation.value,\n              ctranscription: bindings.ctranscription.value,\n              manifestations: manifestations\n            }\n          });\n        }\n      });\n    }\n  getTextInfo(id){\n    const info = runQuery(basicInfoQuery(id))\n    this.arrangeTextInfo(info, id)\n  }\n\n  componentDidMount(){\n    this.mounted = true;\n    this.setState({show: this.props.show, baseText: this.props.baseText})\n\n    if (this.props.isMainText){\n\n      this.setState({info: this.props.info})\n    }\n    else{\n      this.getTextInfo(this.props.expressionid)\n    }\n  }\n\n\n  componentWillReceiveProps(nextProps){\n    // conditional try to restrict new async calls to only when props.info changes\n    if (this.props.info.resourceid !== nextProps.info.resourceid){\n      this.setState({baseText: nextProps.baseText})\n\n      if (nextProps.isMainText){\n        this.setState({info: nextProps.info})\n      }\n      else{\n        this.getTextInfo(nextProps.expressionid)\n\n      }\n    }\n  }\n    componentWillUnmount(){\n      this.mounted = false;\n  }\n\n  render(){\n    const displayComparisons = () => {\n      if (this.state.info.manifestations){\n        const texts = this.state.info.manifestations.map((m) => {\n          return (\n            <TextCompareItem\n            key={m.transcription}\n            base={this.props.baseText}\n            compareTranscription={m.transcription}\n            handleChangeBase={this.props.handleChangeBase}\n            show={this.state.show}\n            />\n          )\n        })\n        return texts\n      }\n    }\n\n  return (\n    <div>\n      {\n        // the link to reroute is not quite working, because the base Text is not resetting, focusBlockChange might be better; but item structure will also need to be changed.\n      }\n      <p><span>{this.props.relationLabel}</span> <Link to={\"/text?resourceid=\" + this.state.info.resourceid}>{this.state.info.resourceid}</Link>\n      <span onClick={() => this.handleToggleShowAll()}>{this.state.show ? <FaEyeSlash/> : <FaEye/>}</span></p>\n      <div className={this.state.show ? \"unhidden\" : \"hidden\"}>\n      {displayComparisons()}\n      </div>\n    </div>\n\n  );\n  }\n}\n\nexport default TextCompare;\n","import React from 'react';\nimport Axios from 'axios'\nimport Container from 'react-bootstrap/Container';\nimport TextCompare from './TextCompare'\n\n\nclass TextCompareWrapper extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleCompare = this.handleToggleCompare.bind(this)\n    this.handleChangeBase = this.handleChangeBase.bind(this)\n    this.getText = this.getText.bind(this)\n    this.mounted = \"\"\n    this.state = {\n      expressions: {},\n      baseText: \"\"\n    }\n\n  }\n  handleChangeBase(rawText){\n    this.setState({baseText: rawText})\n  }\n  handleToggleCompare(expressionid){\n    this.setState((prevState) => {\n      const newExpressions = {...prevState.expressions}\n      newExpressions[expressionid].show = !newExpressions[expressionid].show\n      return {\n        expressions: newExpressions\n      }\n    })\n  }\n  getText(ctranscription){\n    const _this = this;\n    Axios.get(\"http://exist.scta.info/exist/apps/scta-app/csv-pct.xq?resourceid=\" + ctranscription)\n      .then((text) => {\n        _this.setState({baseText: text.data})\n      })\n    }\n\n  componentDidMount(){\n    // prevents check when prop.info is not set\n    if (this.props.info){\n      // prevents check when prop.info.relatedExpressions is not set\n      if (this.props.info.relatedExpressions){\n        this.getText(this.props.info.ctranscription)\n        const expressions = {}\n        expressions[this.props.info.resourceid] = {id: this.props.info.resourceid, show: true}\n\n        this.props.info.relatedExpressions.forEach((r) => {\n          expressions[r.resourceid] = {id: r.resourceid, relationLabel: r.relationLabel, show: false}\n        })\n        this.setState({expressions: expressions})\n      }\n    }\n  }\n  componentWillReceiveProps(nextProps){\n    // only fire reload if \"info resource\" has changed\"\n    if (this.props.info.resourceid !== nextProps.info.resourceid){\n\n    // this conditional is needed, because props are waiting on multiple async calls.\n    // when an async call finishes it will up; and the related Expression query last,\n    // it will use the old ctranscription prop overriding the the update from the prop update from the other async call\n    if (this.props.info.relatedExpressions){\n      // this conditional may no longer be necessary based on first conditional check\n      if (this.props.info.ctranscription !== nextProps.info.ctranscription){\n        this.getText(nextProps.info.ctranscription)\n      }\n      const expressions = {}\n      expressions[nextProps.info.resourceid] = {id: nextProps.info.resourceid, show: true}\n      nextProps.info.relatedExpressions.forEach((r) => {\n        expressions[r.resourceid] = {id: r.resourceid, relationLabel: r.relationLabel, show: false}\n      })\n      this.setState({expressions: expressions})\n    }\n  }\n  }\n  render(){\n    const displayExpressions = () => {\n      const exObject = this.state.expressions\n      const expressions = Object.keys(exObject).map((key) => {\n        const isMainText = this.props.info.resourceid === exObject[key].id ? true : false\n        return (\n          <div key={this.state.expressions[key].id}>\n            {<TextCompare\n              info={this.props.info}\n              expressionid={exObject[key].id}\n              relationLabel={exObject[key].relationLabel}\n              isMainText={isMainText}\n              handleChangeBase={this.handleChangeBase}\n              baseText={this.state.baseText}\n              show={exObject[key].show}\n              />}\n          </div>\n        )\n      })\n      return expressions\n    }\n\n  return (\n    <Container className={this.props.hidden ? \"hidden\" : \"showing\"}>\n    <h4>Text Comparisons</h4>\n    {displayExpressions()}\n    <hr/>\n    <div>\n      <p>Other Comparison/Connection Visualizations</p>\n      <p><a target=\"_blank\" rel=\"noopener noreferrer\" href={\"http://lombardpress.org/collation-vizualizer/index.html?id=\" + this.props.info.resourceid}>Collation Overlay</a></p>\n      <p><a target=\"_blank\" rel=\"noopener noreferrer\" href={\"https://scta.github.io/networks-explorer/?resourceid=\" + this.props.info.resourceid}>View Reference Connections</a></p>\n      <p><a target=\"_blank\" rel=\"noopener noreferrer\" href={\"https://scta.github.io/networks-explorer/topicconnections.html?resourceid=\" + this.props.info.resourceid}>View Topic Connections</a></p>\n    </div>\n    </Container>\n\n  );\n  }\n}\n\nexport default TextCompareWrapper;\n","import React from 'react';\n\nfunction CommentItem(props) {\n  return (\n    <div className=\"comment\">\n     {\n       props.n.motivation === \"discussing\"\n       ? <p>{props.n.body.value} at: <a href={props.n.body.id} target=\"_blank\" rel=\"noopener noreferrer\">{props.n.body.id}</a></p>\n       : <p>{props.n && props.n.body.value}</p>\n     }\n    </div>\n  );\n}\n\nexport default CommentItem;\n","import React from 'react';\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\n\nclass CommentCreate extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleCommentUpdate = this.handleCommentUpdate.bind(this)\n    this.handleSubmitComment = this.handleSubmitComment.bind(this)\n    this.state = {\n      comment: \"\"\n    }\n  }\n  handleCommentUpdate(e){\n    e.preventDefault()\n    this.setState({comment: e.target.value})\n\n  }\n  handleSubmitComment(e){\n    e.preventDefault()\n    this.props.handleSumbitComment(this.state.comment)\n  }\n  render(){\n    return (\n      <div className=\"comment\">\n        <Form onSubmit={this.handleSubmitComment}>\n         <FormControl type=\"text\" id=\"comment\" placeholder=\"comment\" className=\"mr-sm-2\" onChange={this.handleCommentUpdate} />\n         <hr/>\n         <Button type=\"submit\" block>Submit</Button>\n       </Form>\n      </div>\n    );\n  }\n}\n\nexport default CommentCreate;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Axios from 'axios';\nimport uuidv4 from 'uuid/v4';\n\nimport Container from 'react-bootstrap/Container';\n\nimport CommentItem from \"./CommentItem\"\nimport CommentCreate from \"./CommentCreate\"\n\nclass Comments extends React.Component {\n  constructor(props){\n  super(props)\n  this.handleSumbitComment = this.handleSumbitComment.bind(this)\n  this.state = {\n    notifications: [],\n    inbox: \"\",\n    resourceid: \"\"\n  }\n}\nhandleSumbitComment(comment){\n  const _this = this;\n\n  const randomid = uuidv4();\n  const annotat = {\n    \"@context\": \"http://www.w3.org/ns/anno.jsonld\",\n    \"id\": \"http://inbox.scta.info/notifications/\" + randomid,\n    \"type\": \"Annotation\",\n    \"motivation\": \"commenting\",\n    \"body\": {\n      \"type\": \"TextualBody\",\n      \"value\": comment\n    },\n    \"target\": this.state.resourceid\n  }\n  Axios({\n    method: 'post',\n    url: this.state.inbox,\n    data: annotat,\n    config: { headers: {'Content-Type': 'application/json+ld' }}\n    })\n    .then(function (response) {\n      _this.setState((prevState) => {\n        return {notifications: [annotat, ...prevState.notifications, ]}\n      });\n    })\n    .catch(function (response) {\n        //handle error\n        console.log(response);\n    });\n\n\n  }\n  retrieveComments(inbox){\n    // using callback here to make sure state is set before making second a sync call.\n    // TODO: consider using this in other components to prevent out of sync behavior\n    // especially is TextCompareComponents\n    this.setState({notifications: []}, function() {\n      Axios.get(inbox).then((d) => {\n        d.data[\"ldp:contains\"].forEach((n) => {\n          //TODO annoying that each comment has to be requestd.\n          // if inbox main list included full comment, only one request would be needed\n          Axios.get(n[\"@id\"]).then((d2) => {\n            this.setState((prevState) => {\n              return {notifications: [...prevState.notifications, d2.data]}\n            });\n          });\n        })\n      }).catch((e) => {\n        console.log(e)\n      })\n    })\n  }\n  componentDidMount(){\n    // conditional prevents against needless attempt to retreive comments with info is not present\n    if (this.props.resourceid){\n      this.setState({inbox: this.props.inbox, resourceid: this.props.resourceid})\n      this.retrieveComments(this.props.inbox)\n    }\n  }\n  componentWillReceiveProps(newProps){\n    // conditional prevents against needlessly rerequesting information when \"info\" is the same\n    if (newProps.resourceid !== this.props.resourceid){\n      this.setState({inbox: newProps.inbox, resourceid: newProps.resourceid})\n      this.retrieveComments(newProps.inbox)\n    }\n  }\n  render(){\n    const displayComments = () => {\n      const comments = this.state.notifications.map((n, i) => {\n        if (n.motivation === \"commenting\"){\n          return (\n            <CommentItem key={\"commenting-\" + i} n={n}/>\n          )\n        }\n        else{\n          return null\n        }\n      })\n      return comments\n    }\n    const displayDiscussions = () => {\n      const comments = this.state.notifications.map((n, i) => {\n        if (n.motivation === \"discussing\"){\n          return (\n            <CommentItem key={\"discussion-\" + i} n={n}/>\n          )\n        }\n        else{\n          return null\n        }\n      })\n      return comments\n    }\n    return (\n      <Container className={this.props.hidden ? \"hidden\" : \"showing\"}>\n        <h1>Comments</h1>\n        <CommentCreate handleSumbitComment={this.handleSumbitComment}/>\n        <hr/>\n        <div>\n          <h4>Previous Comments</h4>\n          {displayComments()}\n        </div>\n        <hr/>\n        <div>\n          <h4>Web Discussions/Quotations</h4>\n          {displayDiscussions()}\n        </div>\n      </Container>\n    );\n\n  }\n}\n\nComments.propTypes = {\n  /**\n  * resource id; comments will be assigned to this resourceid\n  */\n  resourceid: PropTypes.string.isRequired,\n  /**\n  * inbox;\n  * IDEA: inbox url is currently required; but it is retrievable\n  * just from the resource. Thus it would be good to be able to supply it if already known\n  * but if it is not supplied the component should be able to look it up.\n  */\n  inbox: PropTypes.string.isRequired,\n  /**\n  * hidden designates whether the component should be hidden after mounting\n  */\n  hidden: PropTypes.bool\n}\n\nexport default Comments;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Container from 'react-bootstrap/Container';\nimport Spinner from './Spinner';\nimport { FaClipboard} from 'react-icons/fa';\nimport {runQuery, copyToClipboard} from './utils'\nimport {getManifestationCitationInfo} from './Queries'\n\n/**\n* citation component\n*\n* TODO: it would be better to separate the citation display, manifestation picker, citation explation\n* into three differen compoments wrapped in a citation Wrapper.\n* This way the citation display could be truly independent\n*/\nclass Citation extends React.Component{\n  constructor(props){\n    super(props)\n    this.state = {\n      eurl: \"\",\n      etitle: \"\",\n      murl: \"\",\n      mtitle: \"\",\n      turl: \"\",\n\n      fetching: false\n    }\n  }\n\n\n\n  retrieveCitation(tresourceid){\n    if (tresourceid){\n      this.setState({fetching: true})\n      const manifestationCitationInfo = runQuery(getManifestationCitationInfo(tresourceid))\n      manifestationCitationInfo.then((data) => {\n        const allBindings = data.data.results.bindings\n        console.log(allBindings)\n        if (allBindings.length > 0){\n          const bindings = allBindings[0]\n          const expressionid = bindings.expression ? bindings.expression.value : \"\"\n          const manifestationid = bindings.manifestation ? bindings.manifestation.value : \"\"\n          const eLongTitle = bindings.eLongTitle ? bindings.eLongTitle.value : \"\"\n          const authorTitle = bindings.authorTitle ? bindings.authorTitle.value : \"\"\n          const author = bindings.authorTitle ? bindings.author.value : \"\"\n          const datasource = bindings.datasource ? bindings.datasource.value : \"\"\n          const title = bindings.codexTitle ? bindings.codexTitle.value : \"\"\n          const start = bindings.surfaceTitle ? bindings.surfaceTitle.value : \"\"\n          const end = allBindings[allBindings.length - 1].surfaceTitle ? allBindings[allBindings.length - 1].surfaceTitle.value : \"\"\n\n          this.setState(\n            {\n              author: author,\n              authorTitle: authorTitle,\n              eurl: expressionid,\n              etitle: eLongTitle,\n              murl: manifestationid,\n              mtitle: start !== end ? title + \", \" + start + \"-\" + end : title + \", \" + start,\n              turl: tresourceid,\n              datasource: datasource,\n              fetching: false\n            }\n          )\n        }\n      })\n    }\n  }\n  componentDidMount(){\n    this.retrieveCitation(this.props.tresourceid)\n\n  }\n  componentWillReceiveProps(newProps){\n    if (newProps.tresourceid !== this.props.tresourceid){\n      this.retrieveCitation(newProps.tresourceid)\n    }\n  }\n  render(){\n\n    const fullCitationString = this.state.authorTitle + \", \" + this.state.etitle + \"(\" + this.state.mtitle + \") Data source: \" + this.state.datasource + \".\"\n    return (\n      <Container>\n      <h4>Citation</h4>\n      {this.state.fetching ?\n        <Spinner/> :\n      <div>\n        <p className=\"etitle\">{this.state.authorTitle}, {this.state.etitle} (<a href={this.state.eurl} target=\"_blank\" rel=\"noopener noreferrer\">{this.state.eurl}</a> <span className=\"lbp-span-link\" title=\"Copy Citation to Clipboard\" onClick={(e) => {e.preventDefault(); copyToClipboard(this.state.eurl)}}><FaClipboard /></span>)</p>\n\n        <p className=\"mtitle\">({this.state.mtitle} (<a href={this.state.murl} target=\"_blank\" rel=\"noopener noreferrer\">{this.state.murl}</a> <span className=\"lbp-span-link\" title=\"Copy Citation to Clipboard\" onClick={(e) => {e.preventDefault(); copyToClipboard(this.state.murl)}}><FaClipboard /></span>))</p>\n\n        <p className=\"ttitle\">(Transcription Resource: <a href={this.state.turl} target=\"_blank\" rel=\"noopener noreferrer\">{this.state.turl}</a> <span className=\"lbp-span-link\" title=\"Copy Citation to Clipboard\" onClick={(e) => {e.preventDefault(); copyToClipboard(this.state.turl)}}><FaClipboard /></span>;\n        (Data source:<a href={this.state.datasource} target=\"_blank\" rel=\"noopener noreferrer\"> {this.state.datasource}</a> <span className=\"lbp-span-link\" title=\"Copy Citation to Clipboard\" onClick={(e) => {e.preventDefault(); copyToClipboard(this.state.datasource)}}><FaClipboard /></span>)</p>\n        <p className=\"lbp-span-link\" title=\"Copy Citation to Clipboard\" onClick={(e) => {e.preventDefault(); copyToClipboard(fullCitationString)}}><FaClipboard /> Copy Full Citation to Clipboard</p>\n      </div>\n      }\n      </Container>\n    );\n  }\n}\n\nCitation.propTypes = {\n  /**\n  * transcription resource id of focused passage,\n  * transcription id is required, because a specific text passage is being complicated\n  *\n  * TODO: perhaps it would be good to allow the expression or manifestation id to be given\n  * but the citation component would need to know what kind of resource this and would\n  * need to produce a different query in each case\n  */\n  tresourceid: PropTypes.string.isRequired,\n\n}\n\nexport default Citation;\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport {FaChevronDown, FaChevronUp} from 'react-icons/fa';\n\nclass CitationExplanation extends React.Component {\n  constructor(props){\n    super(props)\n    this.toggleCitationExplanation = this.toggleCitationExplanation.bind(this)\n    this.state = {\n      showCitationExplanation: false,\n    }\n  }\n  toggleCitationExplanation(){\n    this.setState((prevState) => {\n      return {showCitationExplanation: !prevState.showCitationExplanation}\n    })\n  }\n  render(){\n    return (\n      <Container className=\"CitationExplanation\">\n      <p onClick={this.toggleCitationExplanation}>{this.state.showCitationExplanation ? <span><FaChevronDown/>Hide Explanation of Citation Practices</span> : <span><FaChevronUp/>View Explanation of Citation Practices</span>} </p>\n      {this.state.showCitationExplanation &&\n        <div>\n          <p>The citation of a text that has survived through a historical succession of manifestations is a complicated endeavor.\n          Today, when transcriptions of these manifestations\n          can be published as data, separate from any presentation,\n          and thereby can be presented in a variety of ways,\n          a full citation inevitably becomes even more complex.\n          In order to identify the content hierarchy of the text,\n          the specifical material or born digital manifestation of that text,\n          and the data sources used to represent and display that manifestation,\n          specificity and precision are needed.</p>\n\n          <p>Full citations therefore identify three aspects of the text currently being viewed.</p>\n\n          <p className=\"etitle\">First (blue) it identifies the idea of the paragraph in question situated within the conceptual hierarchy of the text.</p>\n\n          <p className=\"mtitle\">Second (red) it identifies the manifestation of the text in a historical or born digital edition.</p>\n\n          <p className=\"ttitle\">Third (purple) it identifies the transcription and transcription data source used to power the current text presentation.</p>\n        </div>}\n      </Container>\n\n    );\n  }\n}\n\nexport default CitationExplanation;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Container from 'react-bootstrap/Container';\nimport {FaChevronDown, FaChevronUp} from 'react-icons/fa';\n\nclass ManifestationList extends React.Component {\n  constructor(props){\n    super(props)\n    this.toggleAlternativeManifestations = this.toggleAlternativeManifestations.bind(this)\n    this.state = {\n      showAlternativeManifestations: true\n    }\n  }\n  toggleAlternativeManifestations(){\n    this.setState((prevState) => {\n      return {showAlternativeManifestations: !prevState.showAlternativeManifestations}\n    })\n  }\n  render(){\n    const displayManifestations = () => {\n      if (this.props.manifestations){\n        const manifestations = this.props.manifestations.map((i) => {\n          return <p key={i.manifestation}>{i.manifestationTitle} : <span className=\"lbp-span-link\" onClick={() => {this.props.handleFocusChange(i.manifestation)}}>{i.manifestation}</span></p>\n        })\n        return manifestations\n      }\n    }\n    return (\n      <Container className=\"ManifestationList\">\n      {this.props.optionalDisplay ?\n        <h4 onClick={this.toggleAlternativeManifestations}>{this.state.showAlternativeManifestations ? <span><FaChevronDown/>Hide Alternative Manifestations</span> : <span><FaChevronUp/>View Alternative Manifestations</span>} </h4>\n        :\n        <h4>Alternative Manifestations</h4>\n      }\n\n        {this.state.showAlternativeManifestations && displayManifestations()}\n      </Container>\n    );\n  }\n}\nManifestationList.propTypes = {\n/**\n  * manifestations provides list of other mnaifestations for focused expression\n\n  * TODO: it seems desireable not to require a manifestations property so that\n  * one can simply provide the transcription resource id, but if the propery is not\n  * the component could look it up itself. But information could also be supplied a prop\n  * in the case the parent component already has the information. In this case,\n  * a second look up by the component would be needless\n  */\n  manifestations: PropTypes.array,\n  /**\n  * function to handle response when new manifestaiton is picked.\n  *\n  */\n  handleFocusChange: PropTypes.func,\n  /**\n  * boolean; if true; turns manifestation header into trigger to hide and display manifestation list\n  */\n  optionalDisplay: PropTypes.bool\n}\nexport default ManifestationList;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Container from 'react-bootstrap/Container';\nimport Citation from './Citation'\nimport CitationExplanation from './CitationExplanation'\nimport ManifestationList from './ManifestationList'\n\nfunction CitationWrapper(props) {\n  return (\n    <Container className={props.hidden ? \"CitationWrapper hidden\" : \"CitationWrapper showing\"}>\n      <Citation tresourceid={props.tresourceid}/>\n      <CitationExplanation/>\n      <hr/>\n      <ManifestationList manifestations={props.manifestations} handleFocusChange={props.handleFocusChange}/>\n    </Container>\n  );\n}\n\nCitation.propTypes = {\n  /**\n  * transcription resource id of focused passage,\n  * transcription id is required to be passed down to Citaiton Component\n  */\n  tresourceid: PropTypes.string.isRequired,\n  /**\n  * manifestations provides list of other mnaifestations for focused expression\n\n  * TODO: it seems desireable not to require a manifestations property so that\n  * one can simply provide the transcription resource id, but if the propery is not\n  * the component could look it up itself. But information could also be supplied a prop\n  * in the case the parent component already has the information. In this case,\n  * a second look up by the component would be needless\n  */\n  manifestations: PropTypes.array,\n  /**\n  * hidden designates whether the component should be hidden after mounting\n  */\n  hidden: PropTypes.bool,\n  /**\n  * function to handle response when new manifestaiton is picked.\n  * should be passed down to ManifestationList component\n  */\n  handleFocusChange: PropTypes.func\n}\nexport default CitationWrapper;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {FaExternalLinkAlt, FaChevronDown, FaChevronUp} from 'react-icons/fa';\nimport {Link} from 'react-router-dom';\n\nimport {runQuery} from './utils'\nimport {getChildParts} from './Queries'\n\n/**\n* creates a text outline section\n*/\nclass TextOutline extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleToggleChildren = this.handleToggleChildren.bind(this)\n    this.state = {\n      parts: [],\n      showChildren: false\n    }\n\n  }\n  /**\n    @public\n    * toggles state.showChildren indicating whether or not section children should be mounted\n  */\n  handleToggleChildren(e){\n    e.preventDefault();\n    this.setState((prevState) => {\n      return {showChildren: !prevState.showChildren}\n    })\n  }\n  retrieveParts(resourceid){\n    const partsInfo = runQuery(getChildParts(resourceid))\n    partsInfo.then((data) => {\n      // async seems to be working pretty well and efficiently.\n      // if a section has many parts, it will be fired several times.\n      // if it has a 100 parts, it will fire 100 times.\n      // But 100 doesn't seem to causing serious performance issues.\n      //console.log(\"async test; fired\")\n      const newData = data.data.results.bindings.map((d) => {\n        return {\n          part: d.part.value,\n          title: d.title.value,\n          level: d.level.value,\n          structureType: d.structureType.value,\n          questionTitle: d.questionTitle ? d.questionTitle.value : \"\"\n        }\n      })\n      this.setState({parts: newData})\n    })\n  }\n  componentDidMount(){\n    //this.setState({showChildren: this.props.showChildren})\n    this.retrieveParts(this.props.resourceid)\n\n    if (this.props.membersOf){\n      if (this.props.membersOf.includes(this.props.resourceid)) {\n        this.setState({showChildren: true})\n\n      }\n    }\n\n  }\n  componentWillReceiveProps(newProps){\n    if (newProps.resourceid !== this.props.resourceid){\n      this.retrieveParts(this.props.resourceid)\n    }\n    if (newProps.resourceid !== this.props.resourceid || newProps.membersOf !== this.props.membersOf){\n      if (newProps.membersOf){\n        if (newProps.membersOf.includes(newProps.resourceid)) {\n          this.setState({showChildren: true})\n        }\n        // else{\n        //   this.setState({showChildren: false})\n        // }\n      }\n    }\n\n  }\n  render(){\n    const displayChildren = () => {\n      const parts = this.state.parts.map((p) => {\n        let bold = \"\"\n        if (this.props.membersOf){\n          if (this.props.membersOf.includes(p.part) || p.part === this.props.focusResourceid) {\n            bold = \"bold\"\n            //showChildren = true;\n          }\n        }\n        return <TextOutline\n        bold={bold}\n        key={p.part}\n        focusResourceid={this.props.focusResourceid}\n        showChildren={this.state.showChildren}\n        resourceid={p.part}\n        title={p.title}\n        level={p.level}\n        structureType={p.structureType}\n        membersOf={this.props.membersOf}\n        questionTitle={p.questionTitle}\n        mtFocus={this.props.mtFocus}\n        collectionLink={p.structureType === \"http://scta.info/resource/structureCollection\" ? this.props.collectionLink : true}/>\n      })\n      return parts\n    }\n    const indent = this.props.level * 5\n    return (\n      <div id=\"outline\" style={{\"paddingLeft\": indent + \"px\"}}>\n        <p className={this.props.bold}>\n        {this.props.title}\n        {this.props.questionTitle && <span>: {this.props.questionTitle}</span>}\n        {(this.state.parts.length > 0 && !this.state.showChildren) && <span className=\"outlineArrow\" onClick={this.handleToggleChildren}><FaChevronDown/></span>}\n        {(this.state.parts.length > 0 && this.state.showChildren) && <span className=\"outlineArrow\" onClick={this.handleToggleChildren}><FaChevronUp/></span>}\n        {this.props.collectionLink && <Link to={\"/text?resourceid=\" + this.props.resourceid + this.props.mtFocus} ><FaExternalLinkAlt/></Link>}\n        </p>\n        {this.state.showChildren && displayChildren()}\n      </div>\n    );\n  }\n}\n\nTextOutline.propTypes = {\n  /**\n  * resource id of focused passage, e.g. paragraph or div structure\n  */\n  focusedResourceid: PropTypes.string,\n  /**\n  * resource id of current section\n  */\n  resourceid: PropTypes.string,\n  /**\n  * title of current section\n  */\n  title: PropTypes.string,\n  /**\n  * hide entire outline\n  */\n  hidden: PropTypes.bool,\n  /**\n  * manifestation and transcription slug\n  * used to create links in outline to specific manifestation\n  * or transcription\n\n  */\n  mtFocus: PropTypes.string,\n  /**\n  * indicates if section heading should be bold with string \"bold\", indicating that focusedResourceId falls within this section\n\n  * TODO: \"bold\" value would be better as boolean, true false\n  */\n  bold: PropTypes.string,\n  /**\n  * indicates whether children should be shown\n  */\n  showChildren: PropTypes.bool,\n  /**\n  * indicates whether level of section with number as string\n\n  * TODO: would be better if level propType was number.\n  */\n  level: PropTypes.string,\n  /**\n  * indicates structureType of current section (e.g. collection, item, division, block)\n  */\n  structureType: PropTypes.string,\n  /**\n  * an array of ids, that focused section is a member of\n  */\n  membersOf: PropTypes.array,\n  /**\n  * question title associated with section\n  */\n  questionTitle: PropTypes.string,\n  /**\n  * indications whether a link at the collection level should be set or not\n  */\n  collectionLink: PropTypes.bool\n}\n\nexport default TextOutline;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport TextOutline from './TextOutline'\n\nimport {runQuery} from './utils'\nimport {getMembersOf} from './Queries'\n\n/**\n* creates a text outline starting from top level expression\n\n*/\nclass TextOutlineWrapper extends React.Component {\n  constructor(props){\n    super(props)\n    this.state = {\n      membersOf: [],\n    }\n  }\n  retrieveMembersOf(resourceid){\n    const membersOfInfo = runQuery(getMembersOf(resourceid))\n    membersOfInfo.then((data) => {\n      const newData = data.data.results.bindings.map((d) => {\n        return d.memberOf.value\n      })\n      this.setState({membersOf: newData})\n    })\n  }\n  componentDidMount(){\n    this.retrieveMembersOf(this.props.focusResourceid)\n  }\n  componentWillReceiveProps(newProps){\n    if (newProps.focusResourceid !== this.props.focusResourceid){\n      this.retrieveMembersOf(newProps.focusResourceid)\n    }\n  }\n  render(){\n    return (\n      <div className={this.props.hidden ? \"hidden\" : \"showing\"}>\n      <TextOutline key={this.props.resourceid}\n      showChildren={true}\n      focusResourceid={this.props.focusResourceid}\n      resourceid={this.props.resourceid}\n      title={this.props.title}\n      level={\"1\"}\n      structureType={\"http://scta.info/resource/structureCollection\"}\n      membersOf={this.state.membersOf}\n      mtFocus={this.props.mtFocus}\n      collectionLink={this.props.collectionLink}/>\n      </div>\n    );\n  }\n}\n\nTextOutlineWrapper.propTypes = {\n  /**\n  * resource id of focused passage, e.g. paragraph or div structure\n  */\n  focusedResourceid: PropTypes.string,\n  /**\n  * resource id of current section\n  */\n  resourceid: PropTypes.string,\n  /**\n  * title of current section\n  */\n  title: PropTypes.string,\n  /**\n  * hide entire outline\n  */\n  hidden: PropTypes.bool,\n  /**\n  * manifestation and transcription slug\n  * used to create links in outline to specific manifestation\n  * or transcription\n  */\n  mtFoucs: PropTypes.string,\n  /**\n  * indications whether a link at the collection level should be set or not\n  */\n  collectionLink: PropTypes.bool\n}\nexport default TextOutlineWrapper;\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport TextPreview from '@bit/jeffreycwitt.lbp.text-preview'\nimport {runQuery} from './utils'\nimport {getCanonicalTranscription} from '../queries/TextPreviewWrapperQueries'\n\nclass TextPreviewWrapper extends React.Component {\n  constructor(props){\n    super(props)\n    this.mounted = false\n    this.state = {\n      tresourceid: \"\"\n    }\n  }\n  getTranscriptionId(textPreviewResourceId){\n    const info = runQuery(getCanonicalTranscription(textPreviewResourceId))\n\n    info.then((d) => {\n      if (this.mounted){\n        this.setState({tresourceid: d.data.results.bindings[0].ctranscription.value})\n      }\n    })\n    .catch((e) => {\n      this.setState({tresourceid: \"\"})\n      //console.log(\"transcription id could not be found\", e)\n      // uncomment if you want to automatically redirect\n        //this.props.handleFocusChange(textPreviewResourceId)\n    })\n\n\n  }\n  componentDidMount(){\n    this.mounted = true\n    this.getTranscriptionId(this.props.textPreviewResourceId)\n  }\n  componentWillReceiveProps(newProps){\n    this.getTranscriptionId(newProps.textPreviewResourceId)\n  }\n  componentWillUnmount()\n  {\n    this.mounted = false\n  }\n  render(){\n    return (\n      <Container className={this.props.hidden ? \"hidden\" : \"showing\"}>\n      <p>Go to: <span className=\"lbp-span-link\" onClick={() => this.props.handleFocusChange(this.state.tresourceid)}>{this.state.tresourceid}</span></p>\n      {\n       this.state.tresourceid && <TextPreview tresourceid={this.state.tresourceid}/>\n      }\n      </Container>\n    );\n  }\n}\n\nexport default TextPreviewWrapper;\n"," export function getCanonicalTranscription(expressionId){\n   const query = [\n     \"SELECT DISTINCT ?ctranscription \",\n     \"WHERE { \",\n       \"<\" + expressionId + \"> <http://scta.info/property/hasCanonicalManifestation> ?manifestation .\",\n       \"?manifestation <http://scta.info/property/hasCanonicalTranscription> ?ctranscription .\",\n     \"}\"\n    ].join('');\n  return query\n }\n","import React from 'react';\nimport Surface2 from \"./Surface2\"\nimport Surface3Wrapper from \"./Surface3Wrapper\"\nimport XmlView from \"./XmlView\"\n//import Info from \"./Info\"\nimport WindowNavBar from \"./WindowNavBar\"\nimport NextPrevBar from \"./NextPrevBar\"\nimport TextCompareWrapper from \"./TextCompareWrapper\"\nimport SearchWrapper from \"./SearchWrapper\"\nimport Comments from \"./Comments\"\nimport CitationWrapper from \"./CitationWrapper\"\nimport TextOutlineWrapper from \"./TextOutlineWrapper\"\nimport TextPreviewWrapper from \"./TextPreviewWrapper\"\n\n\n\n\nclass Window extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleToggleTextLinesView = this.handleToggleTextLinesView.bind(this)\n    this.handleChangeManifestation = this.handleChangeManifestation.bind(this)\n    this.state = {\n      windowLoad: \"\",\n      mountStatus: {\n        textCompare: false,\n        surface3: false,\n        comments: false,\n        xml: false,\n        search:  false,\n        textOutline: false,\n        citation: false\n      }\n\n    }\n  }\n  // used to control default iamge view prop for surface3 component\n  handleToggleTextLinesView(view){\n    this.props.handleToggleTextLinesView(this.props.windowId, view)\n  }\n  // used to control default manifestation prop for surface3 component\n  handleChangeManifestation(manifestation){\n    // to do getting manifestation slug, to apply as default view\n    // TODO: it is precarious to get info like this by deconstructing identifier\n    // it would better if this information were being passed from original db look up\n    const manifestationSlug = manifestation.split(\"/resource/\")[1].split(\"/\")[1]\n    this.props.handleChangeManifestation(this.props.windowId, manifestationSlug)\n  }\n  componentDidMount(){\n    this.setState(\n      {windowLoad: this.props.windowLoad}\n    )\n\n\n  }\n  componentWillReceiveProps(newProps){\n    //when receiving props we check first to see if a new resource id is present,\n    // if so, mounting status for all window child components is set back to false\n    let newMountStatus = {}\n    if (newProps.info.resourceid !== this.props.info.resourceid){\n      newMountStatus = {\n        textCompare: false,\n        surface3: false,\n        comments: false,\n        xml: false,\n        search:  false,\n        textOutline: false,\n        citation: false\n      }\n      // then, the mount status of the opening window load is changed to true\n      newMountStatus[newProps.windowLoad] = true\n    }\n    // if the resource id has not chnaged, but only the windowLoad\n    // we change the window mount status to true, to prevent mounting as long as the resource id has not changed\n    else if (newProps.windowLoad !== this.props.windowLoad){\n      const tempNewMount = this.state.mountStatus\n      tempNewMount[newProps.windowLoad] = true\n      newMountStatus = tempNewMount\n    }\n    else{\n      newMountStatus = this.state.mountStatus\n    }\n\n    this.setState(\n      {windowLoad: newProps.windowLoad,\n      mountStatus: newMountStatus}\n    )\n  }\n\n\n  render(){\n    const displayChild = () => {\n      return(\n        <div>\n\n          {// components that are only avialable if blockDiv focus and this.props.info is set\n            this.props.info &&\n          <div>\n          {\n            // NOTE: performance seems a lot better when these mount only when clicked on\n            // some downside as it was nice to have them pre-loaded\n            // and the state doesn't remain when leaving tab and returning back to tab.\n            // for this reason search is always loaded, so that search results remain when moving between tabs.\n            // a compromise approach could be made for similar resources, where some components are dismounted and some are hiddden\n          }\n            {(this.state.windowLoad === \"textCompare\" || this.state.mountStatus.textCompare) && <TextCompareWrapper info={this.props.info} relatedExpressions={this.props.relatedExpressions} hidden={this.state.windowLoad !== \"textCompare\"}/>}\n            {\n              //this.state.windowLoad === \"info\" &&  <Info info={this.props.info} relatedExpressions={this.props.relatedExpressions} topLevel={this.props.topLevel} hidden={this.state.windowLoad !== \"info\"}/>\n            }\n            {\n              //always load search to keep search results present even when navigating two diffferent tabs\n              // uncomment to prevent auto mounting this.state.windowLoad === \"citation\" &&\n            }\n            {(this.state.windowLoad === \"citation\" || this.state.mountStatus.citation) && <CitationWrapper tresourceid={this.props.info.resourceid + this.props.mtFocus} manifestations={this.props.info.manifestations} handleFocusChange={this.props.handleFocusChange} hidden={this.state.windowLoad !== \"citation\"}/>}\n            {this.state.windowLoad === \"surface2\" &&  <Surface2 surfaceid={this.props.surfaceid} lineFocusId={this.props.lineFocusId} topLevel={this.props.topLevel} handleSurfaceFocusChange={this.props.handleSurfaceFocusChange} hidden={this.state.windowLoad !== \"surface2\"}/>}\n            {(this.state.windowLoad === \"surface3\" || this.state.mountStatus.surface3) &&  <Surface3Wrapper\n            manifestations={this.props.info.manifestations}\n            focusedManifestation={this.props.defaultManifestationSlug ? this.props.resourceid + \"/\" + this.props.defaultManifestationSlug : this.props.resourceid + \"/\" + this.props.mtFocus.split(\"/\")[1]}\n            annotationsDisplay={this.props.annotationsDisplay}\n            handleToggleTextLinesView={this.handleToggleTextLinesView}\n            handleChangeManifestation={this.handleChangeManifestation}\n            width={this.props.windowType === 'bottomWindow' ? \"1000\" : \"500\"}\n            hidden={this.state.windowLoad !== \"surface3\"}/>}\n            {(this.state.windowLoad === \"comments\" || this.state.mountStatus.comments) &&  <Comments resourceid={this.props.info.resourceid} inbox={this.props.info.inbox} hidden={this.state.windowLoad !== \"comments\"}/>}\n          </div>\n          }\n          {\n            //TODO: use of info, topLevel, itemFocus, focusResearceid, resourceid, needs to be better organized and clarified\n          }\n          {(this.state.windowLoad === \"xml\" || this.state.mountStatus.xmls) &&  <XmlView tresourceid={this.props.info ? this.props.info.resourceid + this.props.mtFocus : this.props.itemFocus.expression + this.props.mtFocus} hidden={this.state.windowLoad !== \"xml\"}/>}\n          {\n            //always load outline since it reduces number of calls, as most info is the same for all paragraphs\n          }\n          <TextOutlineWrapper focusResourceid={this.props.info ? this.props.info.resourceid : this.props.itemFocus.expression} resourceid={this.props.topLevel} title={this.props.topLevel} hidden={this.state.windowLoad !== \"textOutlineWrapper\"} mtFocus={this.props.mtFocus}/>\n          {\n            //always load search to keep search results present even when navigating two diffferent tabs\n          }\n          <SearchWrapper hidden={this.state.windowLoad !== \"search\"} topLevel={this.props.topLevel} authorId={this.props.info.author}/>\n          {\n            //<Surface surfaceid={this.props.surfaceid} topLevel={this.props.topLevel}/>\n          }\n          {\n            // text preview wrapper -- loads a text preview from expression resource id\n            this.state.windowLoad === \"textPreview\" &&  <TextPreviewWrapper textPreviewResourceId={this.props.textPreviewResourceId} handleFocusChange={this.props.handleFocusChange} hidden={this.state.windowLoad !== \"textPreview\"}/>\n          }\n        </div>\n      )\n\n    }\n\n  return (\n    <div className={this.props.windowType + \" \" + this.props.windowType + this.props.openWidthHeight}>\n      <WindowNavBar handleTabChange={this.props.handleTabChange}\n      handleClose={this.props.handleClose}\n      handleMinimize={this.props.handleMinimize}\n      handleMaximize={this.props.handleMaximize}\n      handleMiddlize={this.props.handleMiddlize}\n      windowType={this.props.windowType}\n      openWidthHeight={this.props.openWidthHeight}\n      windowId={this.props.windowId}\n      windowLoad={this.props.windowLoad}\n      focus={this.props.resourceid}\n      handleSwitchWindow={this.props.handleSwitchWindow}\n      handleDuplicateWindow={this.props.handleDuplicateWindow}\n      altWindowState={this.props.altWindowState}\n      focusSet={!!this.props.info}\n      />\n      <NextPrevBar info={this.props.info} handleBlockFocusChange={this.props.handleBlockFocusChange}/>\n\n      {displayChild()}\n\n    </div>\n    );\n  }\n}\n\nexport default Window;\n","import React from 'react';\nimport {NavLink} from 'react-router-dom';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\n\n\nclass TextNavBar extends React.Component {\n  constructor(props){\n    super(props)\n    this.state = {\n      next: \"\",\n      previous: \"\"\n    }\n  }\n  componentWillReceiveProps(nextProps){\n    this.setState({next: nextProps.next, previous: nextProps.previous})\n  }\n  render(){\n    return (\n      <Navbar bg=\"light\" variant=\"light\" expand=\"lg\" fixed=\"bottom\">\n        <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n        <Navbar.Collapse id=\"basic-navbar-nav\">\n        <Nav>\n          {this.props.previous && <NavLink className=\"nav-link\" to={\"/text?resourceid=\" + this.props.previous}>Previous</NavLink>}\n          {this.props.next && <NavLink className=\"nav-link\" to={\"/text?resourceid=\" + this.props.next}>Next</NavLink>}\n          {this.props.topLevel && <NavLink className=\"nav-link\" to={\"/text?resourceid=\" + this.props.topLevel}>Text Home</NavLink>}\n        </Nav>\n        </Navbar.Collapse>\n      </Navbar>\n\n    );\n  }\n}\n\nexport default TextNavBar;\n","import React from 'react';\n\nimport $ from 'jquery';\n\nimport {convertXMLDoc, scrollToParagraph} from './utils'\n\nclass Text extends React.Component {\n  constructor(props){\n    super(props)\n    this.retrieveText = this.retrieveText.bind(this)\n\n\n  }\n  retrieveText(doc, topLevel, scrollTo){\n    const _this = this;\n    if (doc){\n      //construct file url request ot exist db to get a cors enabled copy of the text (github does not serve files with cors enabled)\n      const doc = this.props.doc;\n      const topLevel = this.props.topLevel;\n      const docFragment = doc.split(\"/master/\")[1]\n      const topLevelFragment = topLevel.split(\"/resource/\")[1]\n\n      let xmlurl = \"\"\n      if (doc.includes(\"ipfs\")){\n        xmlurl = doc\n      }\n      else{\n        xmlurl = \"http://exist.scta.info/exist/apps/scta-app/text/\" + topLevelFragment + \"/\" + docFragment;\n      }\n      const xslurl = \"/xslt/main_view.xsl\"\n\n      //conversion done in promise in utils.js file\n      const resultDocument = convertXMLDoc(xmlurl, xslurl)\n      resultDocument.then((data) => {\n        //appendage to file\n        //and event binding\n        //happens inside promise call back\n        document.getElementById(\"text\").innerHTML = \"\";\n        document.getElementById(\"text\").appendChild(data);\n\n        $('.paragraphnumber').click(function(e) {\n           e.preventDefault();\n           const id = $(this).parent(\"p\").attr('id')\n           _this.props.setFocus(id)\n           _this.props.openWindow(\"window1\")\n         });\n         if (scrollTo){\n          scrollToParagraph(scrollTo, true)\n        }\n\n        $('.js-show-folio-image').click(function(e) {\n          e.preventDefault();\n          const surfaceid = $(this).attr('data-surfaceid');\n          const paragraphid = $(this).closest('.plaoulparagraph').attr(\"id\");\n\n          _this.props.setFocus(paragraphid)\n          _this.props.handleSurfaceFocusChange(\"http://scta.info/resource/\" + surfaceid)\n          _this.props.openWindow(\"window2\", \"surface2\")\n        });\n\n        $('.lbp-line-number').click(function(e) {\n          e.preventDefault();\n          const surfaceid = $(this).attr('data-surfaceid');\n          const ln = $(this).attr('data-ln');\n          const paragraphid = $(this).closest('.plaoulparagraph').attr(\"id\");\n\n          _this.props.setFocus(paragraphid)\n          _this.props.handleSurfaceFocusChange(\"http://scta.info/resource/\" + surfaceid)\n          _this.props.handleLineFocusChange(\"http://scta.info/resource/\" + surfaceid + \"/\" + ln)\n          _this.props.openWindow(\"window2\", \"surface2\")\n        });\n\n        $('.appnote, .footnote').click(function(e) {\n          e.preventDefault();\n\n        });\n        $('.appnote, .footnote').parent().click(function(e) {\n             e.preventDefault();\n             const link = $(this).children('.appnote, .footnote')\n             const target = $(link).attr('href')\n             const text = $(target).html()\n             const targetText = $(this).children(\".note-display\").attr('data-target-id')\n             /// toggles highlight for select text segemnts\n             if (targetText){\n               $(\"#\" + targetText).toggleClass(\"highlight\")\n               $(\"span[data-corresp=\" + targetText + \"]\").toggleClass(\"highlight\")\n             }\n\n             //adds footnote text to noteDisplay Div and toggles hidden class\n             const noteDisplay = $(this).children(\".note-display\")\n             noteDisplay.toggleClass(\"hidden\")\n             noteDisplay.html(text)\n           });\n           $(document).on(\"click\", '.js-show-reference-paragraph', function(e){\n            e.preventDefault();\n            const target = $(this).attr('data-url')\n            const targetParagraph = $(this).attr('data-target-paragraph')\n            //setting paragraph focus for paragraph containing target footnote\n            _this.props.setFocus(targetParagraph)\n            // set the desired text preview focus to the target of the reference\n            _this.props.handleTextPreviewFocusChange(target)\n            //opening bottomw window 2 to textPreview\n            _this.props.openWindow(\"window2\", \"textPreview\")\n          })\n        })\n        .catch((e) => {\n          console.log(\"something went wrong\", e)\n          document.getElementById(\"text\").innerHTML = \"\";\n          document.getElementById(\"text\").innerHTML = \"<p>Apologies, the document is not able to be loaded at this time</p>\";\n        })\n      }\n  }\n\n  componentDidUpdate(prevProps, prevState){\n\n    //check to see if doc has changed\n    if (prevProps.doc !== this.props.doc){\n      this.retrieveText(this.props.doc, this.props.topLevel, this.props.scrollTo)\n    }\n    // if doc has already been appended, still scroll to target block\n    else{\n      if (this.props.scrollTo !== prevProps.scrollTo){\n        scrollToParagraph(this.props.scrollTo, true)\n      }\n    }\n\n\n    //this.retrieveText(this.props.doc, this.props.topLevel, this.props.scrollTo)\n  }\n\n  componentDidMount(){\n    this.retrieveText(this.props.doc, this.props.topLevel, this.props.scrollTo)\n  }\n  componentWillReceiveProps(newProps){\n\n  }\n  render(){\n\n    return (\n      <div>\n        <div id=\"text\"></div>\n      </div>\n    );\n  }\n}\n\nexport default Text;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Axios from 'axios'\nimport Alert from 'react-bootstrap/Alert';\n\nimport {runQuery} from './utils'\nimport {versionHistoryInfo} from './Queries'\n\nclass VersionChain extends React.Component {\n  constructor(props){\n    super(props)\n    this.getVersionHistory = this.getVersionHistory.bind(this)\n    this.handleToggleShowVersions = this.handleToggleShowVersions.bind(this)\n    this.state = {\n      versions: [],\n      currentVersion: \"\",\n      showVersions: false\n    }\n  }\n  handleToggleShowVersions(){\n    this.setState((prevState) => {\n      return {showVersions: !prevState.showVersions}\n    })\n  }\n  getVersionHistory(transcriptionid){\n      const versionChainInfo = runQuery(versionHistoryInfo(transcriptionid))\n      versionChainInfo.then((d) => {\n        const b = d.data.results.bindings\n        b.forEach((b, i) => {\n          var reviewUrl = \"https://dll-review-registry.scta.info/api/v1/reviews/?url=\" + b.doc.value + \"?society=MAA\"\n          Axios(reviewUrl).then((d2) => {\n            const data = d2.data\n            var reviewObject = {}\n            if (data.length > 0){\n              reviewObject = {\n                img_url: data[0][\"badge-url\"],\n                reviewid: data[0][\"id\"],\n                ipfsHash: data[0][\"ipfs-hash\"],\n                html_link: \"https://dll-review-registry.scta.info/reviews/\" + data[0][\"id\"] + \".html\",\n                rubric_link: data[0][\"badge-rubric\"],\n                summary: data[0][\"review-summary\"]\n              }\n            }\n            this.setState((prevState) => {\n              const newVersion = {\n                versionTranscription: b.version ? b.version.value : \"\",\n                versionLabel: b.version_label ? b.version_label.value : \"\",\n                versionOrderNumber: b.order_number ? b.order_number.value : \"\",\n                versionReview: b.review ? b.review.value : \"\",\n                versionDoc: b.doc ? b.doc.value : \"\",\n                versionReviewInfo: reviewObject,\n              }\n              return {\n                versions: [...prevState.versions, newVersion],\n                currentVersion: transcriptionid\n              }\n            })\n          })\n        })\n      })\n    }\n  componentDidMount(){\n    //prevents call when itemInfo prop is not present\n    if (this.props.transcriptionid){\n      this.getVersionHistory(this.props.transcriptionid)\n    }\n  }\n  componentWillReceiveProps(newProps){\n      if (newProps.transcriptionid !== this.props.transcriptionid){\n        this.setState({versions: []}, () => {\n          this.getVersionHistory(newProps.transcriptionid)\n        })\n      }\n\n\n  }\n  render(){\n    const displayVersions = () => {\n      const versions = this.state.versions.map((v) => {\n        const currentlyViewing = v.versionTranscription === this.state.currentVersion ? \"currentlyViewing\" : \"\"\n        return (<p key={v.versionTranscription} className={currentlyViewing}>\n          {currentlyViewing ? <span>{v.versionLabel} (Currently Viewing)</span> : <span className=\"lbp-span-link\" onClick={()=>{this.props.handleFocusChange(v.versionTranscription)}}>{v.versionLabel}</span>}\n          {v.versionReviewInfo.html_link && <span> Peer Reviewed: <a href={v.versionReviewInfo.html_link}><img alt=\"review\" src={v.versionReviewInfo.img_url}/></a> </span>}\n          <span className=\"small\"> Data Source: <a href={v.versionDoc}>{v.versionDoc}</a> </span>\n          </p>)\n      })\n      return versions\n    }\n    const displayAlert = () => {\n      if (this.state.versions){\n        if (this.state.versions.length > 1){\n          return (\n            <Alert variant=\"info\">\n              <p onClick={this.handleToggleShowVersions}>This Text Has Multiple Indexed Versions</p>\n              {this.state.showVersions && displayVersions()}\n            </Alert>\n          )\n        }\n        else if (this.state.versions.length === 1){\n          const version = this.state.versions[0]\n          return (<Alert variant=\"info\">\n            <span>Version: {version.versionLabel} | Data Source: <a href={version.versionDoc}>{version.versionDoc}</a> </span>\n          </Alert>\n          )\n        }\n        else{\n          return null\n        }\n      }\n      else {\n        return null\n      }\n    }\n    return (\n      displayAlert()\n    );\n  }\n}\nVersionChain.propTypes = {\n  /**\n  * transcription resource id of focused passage,\n  * transcription id is required, because a specific text passage is being complicated\n  */\n  transcriptionid: PropTypes.string.isRequired,\n  /**\n  * handleFocusChange; a function carrying desired behavior\n  * when you user selects non-current version\n  */\n  handleFocusChange: PropTypes.func.isRequired\n}\n\nexport default VersionChain;\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\n\n\nimport Window from \"./Window\"\nimport TextNavBar from \"./TextNavBar\"\nimport Text from \"./Text\"\nimport VersionChain from \"./VersionChain\"\nimport {runQuery, scrollToParagraph} from './utils'\n\nimport {getRelatedExpressions, basicInfoQuery, itemTranscriptionInfoQuery} from './Queries'\n\n\nclass TextWrapper extends React.Component {\n  constructor(props){\n    super(props)\n    this.mount = false\n    this.openWindow = this.openWindow.bind(this)\n    this.setFocus = this.setFocus.bind(this)\n    this.setFocus2 = this.setFocus2.bind(this)\n    this.handleTabChange = this.handleTabChange.bind(this)\n    this.handleClose = this.handleClose.bind(this)\n    this.handleMinimize = this.handleMinimize.bind(this)\n    this.handleMaximize = this.handleMaximize.bind(this)\n    this.handleMiddlize = this.handleMiddlize.bind(this)\n    this.handleSwitchWindow = this.handleSwitchWindow.bind(this)\n    this.handleDuplicateWindow = this.handleDuplicateWindow.bind(this)\n    this.handleSurfaceFocusChange = this.handleSurfaceFocusChange.bind(this)\n    this.handleLineFocusChange = this.handleLineFocusChange.bind(this)\n    this.handleToggleTextLinesView = this.handleToggleTextLinesView.bind(this)\n    this.handleChangeManifestation = this.handleChangeManifestation.bind(this)\n    this.handleTextPreviewFocusChange = this.handleTextPreviewFocusChange.bind(this)\n    this.state = {\n      doc: \"\",\n      focus: \"\",\n      //focusRelatedExpressions: \"\",\n      mtFocus: \"\",\n      itemFocus: \"\",\n      surfaceid: \"\",\n      lineFocusId: \"\",\n      textPreviewResourceId: \"\",\n      windows: {\n        window1: {\n          windowId: \"window1\",\n          open: false,\n          windowLoad: \"citation\",\n          position: \"sideWindow\",\n          openWidthHeight: \"middle\",\n          annotationsDisplay: \"paragraph\",\n          defaultManifestationSlug: \"\"\n        },\n        window2: {\n          windowId: \"window2\",\n          open: false,\n          windowLoad: \"citation\",\n          position: \"bottomWindow\",\n          openWidthHeight: \"middle\",\n          annotationsDisplay: \"paragraph\",\n          defaultManifestationSlug: \"\"\n        }\n      }\n    }\n  }\n  handleToggleTextLinesView(windowId, value){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].annotationsDisplay = value\n      return {windows: windows}\n    })\n  }\n  handleChangeManifestation(windowId, manifestationSlug){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].defaultManifestationSlug = manifestationSlug\n      return {windows: windows}\n    })\n  }\n\n  openWindow(id, windowLoad){\n    if (!this.state.windows[id].open || this.state.windows[id].windowLoad !== windowLoad){\n      this.setState((prevState) => {\n        const windows = prevState.windows\n        windows[id].open = true\n        if (windowLoad){\n          windows[id].windowLoad = windowLoad\n        }\n        return {\n          windows: windows,\n        }\n      })\n    }\n  }\n  handleClose(windowId){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].open = false\n      return {windows: windows}\n\n    })\n    //scroll is supposed to re-align text scroll to focused paragraph after side bar close.\n    //but it is not quite working\n    scrollToParagraph(this.state.blockFocus, true)\n\n  }\n  handleMinimize(windowId){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].openWidthHeight = \"minimum\"\n      return {windows: windows}\n\n    })\n  }\n  handleMaximize(windowId){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].openWidthHeight = \"maximum\"\n      return {windows: windows}\n\n    })\n  }\n  handleMiddlize(windowId){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].openWidthHeight = \"middle\"\n      return {windows: windows}\n\n    })\n  }\n  handleSwitchWindow(windowId, windowType){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      if (windows[windowId].position === \"sideWindow\"){\n        windows[windowId].position = \"bottomWindow\"\n        // these conditionals control whether an already existing window will be closed when the other is moved\n        // while commented they allow window1 and window2 to stack on top of each other\n\n        // if (windowId === \"window1\"){\n        //   windows[\"window2\"].open = false\n        // }\n        // else if ((windowId === \"window2\")){\n        //   windows[\"window1\"].open = false\n        // }\n      }\n      else if (windows[windowId].position === \"bottomWindow\"){\n        windows[windowId].position = \"sideWindow\"\n        // these conditionals control whether an already existing window will be closed when the other is moved\n        // while commented they allow window1 and window2 to stack on top of each other\n\n        // if (windowId === \"window1\"){\n        //   windows[\"window2\"].open = false\n        // }\n        // else if ((windowId === \"window2\")){\n        //   windows[\"window1\"].open = false\n        // }\n      }\n      return {windows: windows}\n\n    })\n  }\n  handleDuplicateWindow(windowId, windowType){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      const altWindowId = windowId === \"window1\" ? \"window2\" : \"window1\"\n      if (windows[windowId].position === \"sideWindow\"){\n        windows[altWindowId].position = \"bottomWindow\"\n        windows[altWindowId].open = true\n      }\n      else if (windows[windowId].position === \"bottomWindow\"){\n        windows[altWindowId].position = \"sideWindow\"\n        windows[altWindowId].open = true\n      }\n      return {windows: windows}\n    })\n  }\n  handleTabChange(windowLoad, windowId){\n\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].windowLoad = windowLoad\n      return {windows: windows}\n\n    })\n\n  }\n\n  handleSurfaceFocusChange(surfaceid){\n    this.setState({surfaceid: surfaceid})\n  }\n  handleLineFocusChange(lineFocusId){\n    this.setState({lineFocusId: lineFocusId})\n  }\n  handleTextPreviewFocusChange(textPreviewResourceId){\n    this.setState({textPreviewResourceId: textPreviewResourceId})\n  }\n  //TODO\n  //These two function should be refactored into one\n  setFocus(id){\n    const fullid = id.includes(\"http\") ? id + this.state.mtFocus : \"http://scta.info/resource/\" + id + this.state.mtFocus\n    this.props.handleUpdateUrlResource(fullid)\n  }\n  setFocus2(newid){\n    this.props.handleUpdateUrlResource(newid)\n  }\n  //END TODO\n\n\n  retrieveFocusInfo(id){\n    const fullid = id.includes(\"http\") ? id : \"http://scta.info/resource/\" + id\n    // get info\n    const info = runQuery(basicInfoQuery(fullid))\n    //arrange info and set it to state\n\n    this.arrangeFocusInfo(info, fullid)\n    // get related expressions info\n    // removed these second calls and embed the query in arrange focus info to keep information in sync.\n    // TODO remove below three lines\n    //const relatedExpressions = runQuery(getRelatedExpressions(fullid))\n    //arrange info and set it to state\n    //this.arrangeFocusRelatedInfo(relatedExpressions)\n\n    //scrollToParagraph(shortid, true)\n\n  }\n\n  arrangeFocusInfo(info, resourceid){\n      info.then((d) => {\n        const bindings = d.data.results.bindings[0]\n        const manifestations = d.data.results.bindings.map((b) => {\n          return {\n            manifestation: b.manifestation.value,\n            manifestationTitle: b.manifestationTitle.value,\n            transcription: b.manifestationCTranscription.value\n          }\n        })\n        // TODO the need for this 2nd query and async call might\n        // be able to be removed using a construct query\n        // see example pattern in articles collection\n        const relatedExpressions = runQuery(getRelatedExpressions(resourceid))\n        relatedExpressions.then((d) => {\n          const bindings2 = d.data.results.bindings\n          const relatedExpressions = bindings2.map((r) => {\n              return {\n                resourceid: r.isRelatedTo.value,\n                relationLabel: r.label.value\n              }\n            });\n\n          if (this.mount){\n            this.setState({\n              focus: {\n                resourceid: resourceid,\n                title: bindings.title.value,\n                longTitle: bindings.longTitle ? bindings.longTitle.value : \"\",\n                author: bindings.author ? bindings.author.value : \"\",\n                authorTitle: bindings.authorTitle ? bindings.authorTitle.value : \"\",\n                structureType: bindings.structureType.value,\n                inbox: bindings.inbox.value,\n                next: bindings.next ? bindings.next.value : \"\",\n                previous: bindings.previous ? bindings.previous.value : \"\",\n                cdoc: bindings.cdoc.value,\n                cxml: bindings.cxml.value,\n                topLevel: bindings.topLevelExpression.value,\n                cmanifestation: bindings.cmanifestation.value,\n                ctranscription: bindings.ctranscription.value,\n                manifestations: manifestations,\n                relatedExpressions: relatedExpressions\n              }\n            });\n          }\n        })\n      });\n    }\n  // embeded this within arrang focus info, so that information remains in sync\n  // TODO remove this\n    // arrangeFocusRelatedInfo(relatedInfo){\n    //     relatedInfo.then((d) => {\n    //       console.log(\"new data\", d)\n    //       const bindings = d.data.results.bindings\n    //       const relatedExpressions = bindings.map((r) => {\n    //           return {\n    //             resourceid: r.isRelatedTo.value,\n    //             relationLabel: r.label.value\n    //           }\n    //         });\n    //     if (this.mount){\n    //       this.setState({\n    //         focusRelatedExpressions: relatedExpressions\n    //       });\n    //       }\n    //     });\n    //   }\n    setItemFocus(id){\n      const fullid = id.includes(\"http\") ? id : \"http://scta.info/resource/\" + id\n      // get info\n      const info = runQuery(itemTranscriptionInfoQuery(fullid))\n      this.arrangeItemFocusInfo(info)\n    }\n    arrangeItemFocusInfo(itemFocusInfo){\n        itemFocusInfo.then((d) => {\n          const bindings = d.data.results.bindings[0]\n          if (this.mount){\n            this.setState({\n              itemFocus: {\n                title: bindings.title.value,\n                manifestation: bindings.manifestation.value,\n                expression: bindings.expression.value,\n                doc: bindings.doc.value,\n                xml: bindings.xml.value,\n                next: bindings.next ? bindings.next.value : \"\",\n                previous: bindings.previous ? bindings.previous.value : \"\",\n                inbox: bindings.inbox.value,\n                topLevel: bindings.topLevelExpression.value,\n                transcriptionid: bindings.t.value\n              }\n            });\n          }\n        });\n      }\n\n  componentDidMount(){\n    this.mount = true\n\n    this.setItemFocus(this.props.transcriptionid)\n\n    const mFocus = this.props.transcriptionid.split(\"/resource/\")[1].split(\"/\")[1]\n    const tFocus = this.props.transcriptionid.split(\"/resource/\")[1].split(\"/\")[2]\n    this.setState({mtFocus: \"/\" + mFocus + \"/\" + tFocus})\n\n    if (this.props.blockDivFocus){\n      this.retrieveFocusInfo(this.props.blockDivFocus)\n    }\n  }\n  componentWillReceiveProps(newProps){\n    //Keep testing, but it seems like this look up only needs to fire, when the transcription id prop changes\n    // not when other props changes.\n    if (newProps.transcriptionid !== this.props.transcriptionid){\n      this.setItemFocus(newProps.transcriptionid)\n      const mFocus = newProps.transcriptionid.split(\"/resource/\")[1].split(\"/\")[1]\n      const tFocus = newProps.transcriptionid.split(\"/resource/\")[1].split(\"/\")[2]\n      //clear or set parts of state when new transcription file is loaded\n      this.setState((prevState) => {\n        const windows = prevState.windows\n        windows[\"window1\"].defaultManifestationSlug = \"\"\n        windows[\"window2\"].defaultManifestationSlug = \"\"\n        return {\n          mtFocus: \"/\" + mFocus + \"/\" + tFocus,\n          windows: windows\n        }\n      })\n    }\n\n\n\n    if (!newProps.blockDivFocus){\n      this.setState({focus: \"\"});\n    }\n    else if (newProps.blockDivFocus !== this.props.blockDivFocus){\n      this.retrieveFocusInfo(newProps.blockDivFocus)\n    }\n  }\n  componentWillUnmount(){\n    this.mount = false\n  }\n  render(){\n    const displayWindows = () => {\n      const windows = Object.keys(this.state.windows).map((key) => {\n        if (this.state.windows[key].open){\n          return (<Window\n              key={key}\n              handleClose={this.handleClose}\n              handleMinimize={this.handleMinimize}\n              handleMaximize={this.handleMaximize}\n              handleMiddlize={this.handleMiddlize}\n              handleTabChange={this.handleTabChange}\n              handleBlockFocusChange={this.setFocus}\n              handleFocusChange={this.setFocus2}\n              handleSurfaceFocusChange={this.handleSurfaceFocusChange}\n              handleSwitchWindow={this.handleSwitchWindow}\n              handleDuplicateWindow={this.handleDuplicateWindow}\n              resourceid={this.state.focus ? this.state.focus.resourceid : this.props.resourceid}\n              windowType={this.state.windows[key].position}\n              windowId={this.state.windows[key].windowId}\n              windowLoad={this.state.windows[key].windowLoad}\n              openWidthHeight={this.state.windows[key].openWidthHeight}\n              surfaceid={this.state.surfaceid}\n              lineFocusId={this.state.lineFocusId}\n              info={this.state.focus}\n              itemFocus={this.state.itemFocus}\n              topLevel={this.state.itemFocus.topLevel}\n              altWindowState={this.state.windows[key].windowId === \"window1\" ? this.state.windows[\"window2\"].open : this.state.windows[\"window1\"].open}\n              mtFocus={this.state.mtFocus}\n              handleToggleTextLinesView={this.handleToggleTextLinesView}\n              annotationsDisplay={this.state.windows[key].annotationsDisplay}\n              handleChangeManifestation={this.handleChangeManifestation}\n              defaultManifestationSlug={this.state.windows[key].defaultManifestationSlug}\n              textPreviewResourceId={this.state.textPreviewResourceId}\n              />\n            )\n          }\n          else{\n            return null\n          }\n        })\n        return windows\n      }\n    const textClass = () => {\n      let aSideWindowOpen = false;\n      if (this.state.windows.window1.open && this.state.windows.window1.position === \"sideWindow\" && this.state.windows.window1.openWidthHeight === \"middle\"){\n        aSideWindowOpen = true\n      }\n      else if (this.state.windows.window2.open && this.state.windows.window2.position === \"sideWindow\"){\n        aSideWindowOpen = true\n      }\n      return aSideWindowOpen\n    }\n\n    return (\n      <div>\n        {this.state.itemFocus &&\n          <VersionChain transcriptionid={this.state.itemFocus.transcriptionid} handleFocusChange={this.setFocus2}/>\n        }\n        <Container className={textClass() ? \"lbp-text skinnyText\" : \"lbp-text fullText\"}>\n          {this.state.itemFocus &&\n          <Text\n            doc={this.state.itemFocus.doc}\n            topLevel={this.state.itemFocus.topLevel}\n            setFocus={this.setFocus}\n            handleSurfaceFocusChange={this.handleSurfaceFocusChange}\n            handleLineFocusChange={this.handleLineFocusChange}\n            openWindow={this.openWindow}\n            // NOTE: using props instead of state; seems better, but needs full documentation\n            // NOTE: itemid is shortid of item: TODO: needs documentation; or better, refactoring!\n            scrollTo={this.props.blockDivFocus ? this.props.blockDivFocus.split(\"/resource/\")[1] : this.props.itemid}\n            handleTextPreviewFocusChange={this.handleTextPreviewFocusChange}\n            />\n          }\n        </Container>\n        <TextNavBar\n          next={this.state.itemFocus && this.state.itemFocus.next}\n          previous={this.state.itemFocus && this.state.itemFocus.previous}\n          topLevel={this.state.itemFocus && this.state.itemFocus.topLevel}\n          handleClose={this.handleClose}\n        />\n        <div>\n        {\n        // <TextNavBar\n        // next={this.state.items[this.state.itemFocus] && this.state.items[this.state.itemFocus].next}\n        // previous={this.state.items[this.state.itemFocus] && this.state.items[this.state.itemFocus].previous}\n        // topLevel={this.state.items[this.state.itemFocus] && this.state.items[this.state.itemFocus].topLevel}\n        // handleClose={this.handleClose}\n        // />\n        }\n        {displayWindows()}\n        </div>\n      </div>\n    );\n  }\n}\nexport default TextWrapper;\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\n\nimport '../styles/timelinelist.scss';\nimport $ from 'jquery';\n\nimport {convertXMLDoc, scrollToParagraph} from './utils'\n\n///TODO: Not this is very similar to the Text component\n//it would be nice if this could be refactored to be a more generic component that could handle both\n//however, the edition text will\n\n//TODO: article componet needs to retrieve and article type and then pick a different style sheet for different types.\n\nclass TextArticle extends React.Component {\n  constructor(props){\n    super(props)\n    this.retrieveText = this.retrieveText.bind(this)\n\n\n  }\n  retrieveText(doc, scrollTo, articleType){\n    const _this = this;\n    if (doc){\n      //construct file url request ot exist db to get a cors enabled copy of the text (github does not serve files with cors enabled)\n      const doc = this.props.doc;\n      const docFragment = doc.split(\"/master/\")[1].split(\"/\")[1]\n\n\n      let xmlurl = \"\"\n      if (doc.includes(\"ipfs\") || (doc.includes(\"zotero\"))){\n         xmlurl = doc\n       }\n       else{\n         xmlurl = \"http://exist.scta.info/exist/apps/scta-app/text/scta-articles/\" + docFragment\n       }\n      let xslurl = \"\"\n      if (articleType === \"http://scta.info/resource/timeline\"){\n         xslurl = \"/xslt/articles/timeline.xsl\"\n      }\n      else if (articleType === \"http://scta.info/resource/bibliography\"){\n        xslurl = \"/xslt/articles/bibliography.xsl\"\n      }\n      else if (articleType === \"http://scta.info/resource/biography\"){\n        xslurl = \"/xslt/articles/biography.xsl\"\n      }\n      else{\n        xslurl = \"/xslt/articles/standard.xsl\"\n      }\n\n      //conversion done in promise in utils.js file\n      const resultDocument = convertXMLDoc(xmlurl, xslurl)\n      resultDocument.then((data) => {\n        //appendage to file\n        //and event binding\n        //happens inside promise call back\n        document.getElementById(\"text\").innerHTML = \"\";\n        document.getElementById(\"text\").appendChild(data);\n\n        // $('.paragraphnumber').click(function(e) {\n        //    e.preventDefault();\n        //    const id = $(this).parent(\"p\").attr('id')\n        //    _this.props.setFocus(id)\n        //    _this.props.openWindow(\"window1\")\n        //  });\n        //  if (scrollTo){\n        //   scrollToParagraph(scrollTo, true)\n        // }\n        //\n        // $('.js-show-folio-image').click(function(e) {\n        //   e.preventDefault();\n        //   const surfaceid = $(this).attr('data-surfaceid');\n        //   const paragraphid = $(this).closest('.plaoulparagraph').attr(\"id\");\n        //\n        //   _this.props.setFocus(paragraphid)\n        //   _this.props.handleSurfaceFocusChange(\"http://scta.info/resource/\" + surfaceid)\n        //   _this.props.openWindow(\"window2\", \"surface2\")\n        // });\n        //\n        // $('.lbp-line-number').click(function(e) {\n        //   e.preventDefault();\n        //   const surfaceid = $(this).attr('data-surfaceid');\n        //   const ln = $(this).attr('data-ln');\n        //   const paragraphid = $(this).closest('.plaoulparagraph').attr(\"id\");\n        //\n        //   _this.props.setFocus(paragraphid)\n        //   _this.props.handleSurfaceFocusChange(\"http://scta.info/resource/\" + surfaceid)\n        //   _this.props.handleLineFocusChange(\"http://scta.info/resource/\" + surfaceid + \"/\" + ln)\n        //   _this.props.openWindow(\"window2\", \"surface2\")\n        // });\n\n        $('.appnote, .footnote').click(function(e) {\n          e.preventDefault();\n\n        });\n        $('.appnote, .footnote').parent().click(function(e) {\n             e.preventDefault();\n             const link = $(this).children('.appnote, .footnote')\n             const target = $(link).attr('href')\n             const text = $(target).html()\n             const targetText = $(this).children(\".note-display\").attr('data-target-id')\n             /// toggles highlight for select text segemnts\n             if (targetText){\n               $(\"#\" + targetText).toggleClass(\"highlight\")\n               $(\"span[data-corresp=\" + targetText + \"]\").toggleClass(\"highlight\")\n             }\n\n             //adds footnote text to noteDisplay Div and toggles hidden class\n             const noteDisplay = $(this).children(\".note-display\")\n             noteDisplay.toggleClass(\"hidden\")\n             noteDisplay.html(text)\n           });\n           $(document).on(\"click\", '.js-show-reference-paragraph', function(e){\n            e.preventDefault();\n            const target = $(this).attr('data-url')\n            const targetParagraph = $(this).attr('data-target-paragraph')\n            //setting paragraph focus for paragraph containing target footnote\n            _this.props.setFocus(targetParagraph)\n            // set the desired text preview focus to the target of the reference\n            _this.props.handleTextPreviewFocusChange(target)\n            //opening bottomw window 2 to textPreview\n            _this.props.openWindow(\"window2\", \"textPreview\")\n          })\n        })\n        .catch((e) => {\n          console.log(\"something went wrong\", e)\n          document.getElementById(\"text\").innerHTML = \"\";\n          document.getElementById(\"text\").innerHTML = \"<p>Apologies, the document is not able to be loaded at this time</p>\";\n        })\n      }\n  }\n\n  componentDidUpdate(prevProps, prevState){\n\n    //check to see if doc has changed\n    if (prevProps.doc !== this.props.doc){\n      this.retrieveText(this.props.doc, this.props.scrollTo, this.props.articleType)\n    }\n    // if doc has already been appended, still scroll to target block\n    else{\n      if (this.props.scrollTo !== prevProps.scrollTo){\n        scrollToParagraph(this.props.scrollTo, true)\n      }\n    }\n\n\n    //this.retrieveText(this.props.doc, this.props.topLevel, this.props.scrollTo)\n  }\n\n  componentDidMount(){\n    this.retrieveText(this.props.doc, this.props.scrollTo, this.props.articleType)\n  }\n  componentWillReceiveProps(newProps){\n\n  }\n  render(){\n\n    return (\n      <Container>\n        <div id=\"text\"></div>\n      </Container>\n    );\n  }\n}\n\nexport default TextArticle;\n","import React from 'react';\nimport {Link} from 'react-router-dom';\nfunction Item(props) {\n  const displayItem = () => {\n    // conditions prevents attempt to render when props.item is not present\n    if (props.item){\n      return (\n        <tr>\n          {props.item.author && <td><Link to={\"/text?resourceid=\" + props.item.author}>{props.item.authorTitle}</Link></td>}\n          <td><Link to={\"/text?resourceid=\" + props.item.id}>{props.item.title}</Link></td>\n          {props.item.questionTitle ? <td><Link to={\"/text?resourceid=\" + props.item.id}>{props.item.questionTitle}</Link></td> : <td/>}\n        </tr>\n      )\n    }\n    else{\n      return null\n    }\n  }\n  return (\n    displayItem()\n  );\n}\n\nexport default Item;\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\n\nimport FormControl from 'react-bootstrap/FormControl';\nimport Table from 'react-bootstrap/Table';\n\nimport {runQuery} from './utils'\nimport {basicStructureAllItemsInfoQuery, partsInfoQuery,workGroupExpressionQuery} from './Queries'\n\nimport Item from \"./Item\"\n\n//import Lbp from \"lbp.js/lib\"\n\n\nclass Collection extends React.Component {\n  constructor(props){\n    super(props)\n    this.retrieveCollectionInfo = this.retrieveCollectionInfo.bind(this)\n    this.makeRequests = this.makeRequests.bind(this)\n    this.handleFilter = this.handleFilter.bind(this)\n    this.filter = React.createRef();\n    this.mount = false\n    this.state = {\n      items: {},\n      parts: {},\n      filter: \"\"\n    }\n\n  }\n  handleFilter(e){\n    const item = e.target.value\n    this.setState({filter: item})\n\n  }\n  arrangeParts(partsPromise){\n    const _this = this\n    partsPromise.then((d) => {\n        const bindings = d.data.results.bindings\n        let partsObject = {}\n        bindings.forEach((b) => {\n          const pId = b.part.value\n          partsObject[pId] = {\n            id: b.part.value,\n            title: b.partTitle.value,\n            type: b.partType.value,\n            questionTitle: b.partQuestionTitle ? b.partQuestionTitle.value : null,\n            level: b.partLevel ? b.partLevel.value : \"unknown\",\n        }\n      });\n      if (this.mount){\n        _this.setState(\n          {\n            parts: partsObject\n          }\n        )\n      }\n    });\n  }\n  arrangeItems(itemsPromise){\n    const _this = this\n    itemsPromise.then((d) => {\n      const bindings = d.data.results.bindings\n      let itemsObject = {}\n      bindings.forEach((b) => {\n        const itemId = b.item.value\n        itemsObject[itemId] = {\n          title: b.itemTitle.value,\n          id: b.item.value,\n          type: b.itemType.value,\n          questionTitle: b.itemQuestionTitle ? b.itemQuestionTitle.value : null,\n          author: b.itemAuthor ? b.itemAuthor.value : null,\n          authorTitle: b.itemAuthorTitle ? b.itemAuthorTitle.value : null,\n          next: b.next ? b.next.value : null,\n          previous: b.previous ? b.previous.value : null,\n          cm: b.cm ? b.cm.value : null,\n          cmTitle: b.cmTitle ? b.cmTitle.value : null,\n          ct: b.ct ? b.ct.value : null,\n          topLevel: b.topLevel ? b.topLevel.value : null,\n          doc: b.doc ? b.doc.value : null\n        }\n      });\n      if (this.mount){\n        _this.setState(\n          {\n            items: itemsObject\n          }\n        )\n      }\n    })\n    .catch((err) => {\n      console.log(err)\n    })\n  }\n\n  retrieveWorkGroupInfo(resourceid){\n    const expressionsInfo = runQuery(workGroupExpressionQuery(resourceid))\n    const partsInfo = runQuery(partsInfoQuery(resourceid))\n    this.arrangeParts(partsInfo)\n    this.arrangeItems(expressionsInfo)\n  }\n  retrieveCollectionInfo(resourceid, structureType, topLevel){\n    const collectionInfo = runQuery(basicStructureAllItemsInfoQuery(topLevel))\n    const partsInfo = runQuery(partsInfoQuery(resourceid))\n\n    //add parts to state\n    this.arrangeParts(partsInfo)\n    /// add items to state\n    this.arrangeItems(collectionInfo)\n  }\n  makeRequests(newResourceId, structureType, topLevel, type){\n\n    //\n    //   // get all expressions for this workGroup\n      if (type === \"http://scta.info/resource/workGroup\"){\n          this.retrieveWorkGroupInfo(newResourceId, structureType, topLevel)\n          //this.setState({itemFocus: \"\"})\n      }\n      // get all items for this collection\n      else if (structureType === \"http://scta.info/resource/structureCollection\"){\n          this.retrieveCollectionInfo(newResourceId, structureType, topLevel)\n          //this.setState({itemFocus: \"\"})\n      }\n\n  }\n  componentDidUpdate(prevProps, prevState){\n\n  }\n  componentDidMount(){\n    this.mount = true\n    this.setState({resourceid: this.props.resourceid})\n    this.makeRequests(this.props.resourceid, this.props.structureType, this.props.topLevel, this.props.type)\n\n  }\n\n  componentWillReceiveProps(nextProps) {\n\n    // conditional prevents new information requestion if resource id has not changed\n    if (nextProps.resourceid !== this.props.resourceid){\n      this.setState({resourceid: nextProps.resourceid, filter: \"\"})\n      // this conditional resets form value if ref is present\n      if (this.filter){\n        this.filter.current.value = \"\"\n      }\n      this.makeRequests(nextProps.resourceid, nextProps.structureType, nextProps.topLevel, nextProps.type)\n    }\n  }\n  componentWillUnmount(){\n    this.mount = false\n  }\n  render(){\n    //const resourceid = Qs.parse(this.props.location.search, { ignoreQueryPrefix: true }).resourceid;\n\n    const displayQuestions = () => {\n      const questions = []\n      Object.keys(this.state.items).forEach((key) => {\n        const filterCheck = this.state.items[key].title + \" \" + this.state.items[key].authorTitle + \" \" + this.state.items[key].questionTitle\n        if (filterCheck.toLowerCase().includes(this.state.filter.toLowerCase())){\n        questions.push(\n          <Item key={key} item={this.state.items[key]}/>\n        )}\n      });\n      return (\n        <Container>\n\n        <h1>Available Texts</h1>\n        <br/>\n        <Table striped bordered hover size=\"sm\">\n        <tbody>\n        {questions}\n        </tbody>\n        </Table>\n        </Container>\n      )\n    }\n    const displayParts = () => {\n        const questions = []\n        Object.keys(this.state.parts).forEach((key) => {\n          //check against filter\n            if (this.state.parts[key].title.toLowerCase().includes(this.state.filter.toLowerCase())){\n            questions.push(\n              <Item key={key} item={this.state.parts[key]}/>\n              )\n            }\n\n        });\n        //check against top level expression as parts; if parts are top level expression; don't display parts\n        const testPart = this.state.parts[Object.keys(this.state.parts)[0]]\n        if (testPart){\n          if (!(testPart.type === \"http://scta.info/resource/expression\" && testPart.level === \"1\")){\n            return (\n              <Container>\n              <h1>Available Text Collections</h1>\n              <br/>\n              <Table striped bordered hover size=\"sm\">\n              <tbody>\n              {questions}\n              </tbody>\n              </Table>\n              </Container>\n            )\n          }\n        }\n      }\n\n    return (\n      <Container className=\"collectionBody\">\n      {}\n      <Container className=\"collectionFilter\">\n        <FormControl ref={this.filter} id=\"filter\" placeholder=\"type to filter by title\" onChange={this.handleFilter}/>\n      </Container>\n      {displayParts()}\n      {displayQuestions()}\n      </Container>\n    );\n  }\n}\n\nexport default Collection;\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport Table from 'react-bootstrap/Table';\nimport {runQuery} from './utils'\nimport {getAuthorInformation} from './Queries'\nimport Item from \"./Item\"\n\n//import Lbp from \"lbp.js/lib\"\n\n\nclass AuthorCollection extends React.Component {\n  constructor(props){\n    super(props)\n\n    this.retrieveAuthorCollectionInfo = this.retrieveAuthorCollectionInfo.bind(this)\n    this.handleItemFilter = this.handleItemFilter.bind(this)\n    this.itemFilter = React.createRef();\n\n    this.mount = false\n    this.state = {\n      authorTitle: \"\",\n      authorArticles: [],\n      textArticles: [],\n      expressions: [],\n      itemFilter: \"\",\n    }\n\n  }\n  handleItemFilter(e){\n    const item = e.target.value\n    this.setState({itemFilter: item})\n\n  }\n  arrangeItems(itemsPromise, resourceid){\n    itemsPromise.then((d) => {\n      const author = d.data[\"@graph\"].filter((i) => i[\"@id\"] === resourceid)[0]\n      //const authorExpressions = d.data[\"@graph\"].filter((i) => {i[\"@id\"] === author.hasTopLevelExpression})\n      const authorTitle = author[\"http://purl.org/dc/elements/1.1/title\"]\n      let authorArticles = null\n      if(Array.isArray(author.authorArticle)){\n        authorArticles =  author.authorArticle.map((a) => {\n          return {\n            id: a,\n            title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === a)[0][\"http://purl.org/dc/elements/1.1/title\"]\n          }\n        })\n      }\n      else if (author.authorArticle){\n        authorArticles = [{id: author.authorArticle, title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === author.authorArticle)[0][\"http://purl.org/dc/elements/1.1/title\"]}]\n      }\n      let textArticles = null\n      if(Array.isArray(author.textArticle)){\n          textArticles =  author.textArticle.map((a) => {\n          return {\n            id: a,\n            title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === a)[0][\"http://purl.org/dc/elements/1.1/title\"]\n          }\n        })\n      }\n      else if (author.textArticle){\n        textArticles = [{id: author.textArticle, title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === author.textArticle)[0][\"http://purl.org/dc/elements/1.1/title\"]}]\n      }\n\n      let expressions = null\n      if(Array.isArray(author.hasTopLevelExpression)){\n        expressions =  author.hasTopLevelExpression.map((a) => {\n          return {\n            id: a,\n            title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === a)[0][\"http://purl.org/dc/elements/1.1/title\"]\n          }\n        })\n      }\n      else if (author.hasTopLevelExpression){\n        expressions = [{id: author.hasTopLevelExpression, title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === author.hasTopLevelExpression)[0][\"http://purl.org/dc/elements/1.1/title\"]}]\n      }\n      if (this.mount){\n        this.setState({authorArticles: authorArticles, textArticles: textArticles, expressions: expressions, authorTitle: authorTitle })\n      }\n    })\n    .catch((err) => {\n      console.log(err)\n    })\n  }\n  retrieveAuthorCollectionInfo(resourceid){\n    const authorCollectionInfo = runQuery(getAuthorInformation(resourceid))\n    /// add items to state\n    this.arrangeItems(authorCollectionInfo, resourceid)\n  }\n  componentDidUpdate(prevProps, prevState){\n\n  }\n  componentDidMount(){\n    this.mount = true\n    this.retrieveAuthorCollectionInfo(this.props.resourceid)\n\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.refs.itemFilter ? this.refs.itemFilter.value = \"\" :\n    this.retrieveAuthorCollectionInfo(nextProps.resourceid)\n  }\n  componentWillUnmount(){\n    this.mount = false\n  }\n  render(){\n    //const resourceid = Qs.parse(this.props.location.search, { ignoreQueryPrefix: true }).resourceid;\n\n    const displayItems = (list) => {\n      const items = list.map((i) => {\n        return (\n\n          <Item key={i.id} item={i}/>\n\n        )\n      });\n      return items\n    }\n\n\n\n\n\n\n    return (\n      <div className=\"collectionBody\">\n      <h1>{this.state.authorTitle}</h1>\n      <br/>\n      {this.state.expressions &&\n        <Container>\n        <h1>Expressions</h1>\n        <br/>\n        <Table striped bordered hover size=\"sm\">\n        <tbody>\n        {displayItems(this.state.expressions)}\n        </tbody>\n        </Table>\n        </Container>\n      }\n      {this.state.authorArticles &&\n        <Container>\n        <h1>Author Related Articles</h1>\n        <br/>\n        <Table striped bordered hover size=\"sm\">\n        <tbody>\n        {displayItems(this.state.authorArticles)}\n        </tbody>\n        </Table>\n        </Container>\n      }\n      {this.state.textArticles &&\n        <Container>\n        <h1>Text Related Articles</h1>\n        <br/>\n        <Table striped bordered hover size=\"sm\">\n        <tbody>\n        {displayItems(this.state.textArticles)}\n        </tbody>\n        </Table>\n        </Container>\n      }\n      </div>\n    );\n  }\n}\n\nexport default AuthorCollection;\n","import React from 'react';\nimport Button from 'react-bootstrap/Button';\nimport {Link} from 'react-router-dom';\nimport {FaExternalLinkAlt,} from 'react-icons/fa';\nimport Comments from './Comments'\n\nimport {runQuery} from './utils'\nimport {getSurfaceInfo} from '../queries/SurfaceInfoQuery'\n\nclass SurfaceInfo extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleToggleRelatedDiscussion = this.handleToggleRelatedDiscussion.bind(this)\n    this.handleSurface3Manifestations = this.handleSurface3Manifestations.bind(this)\n    this.handleToggleShowQuery = this.handleToggleShowQuery.bind(this)\n    this.state = {\n      expressions: [],\n      surfaceMap: {},\n      showTextRegion: false,\n      showQuery: false,\n      query: \"\"\n    }\n  }\n  handleToggleShowQuery(){\n    this.setState((prevState) => {\n      return {\n        showQuery: !prevState.showQuery\n      }\n    })\n  }\n  handleSurface3Manifestations(manifestations, eid){\n    let newManifestations = \"\"\n    if (typeof manifestations === \"object\"){\n      newManifestations = manifestations.map((m) =>{\n        return {\n          manifestation: m,\n          manifestationTitle: m.split(\"/resource/\")[1],\n          transcription: \"\"\n        }\n      })\n    }\n    // sometimes there is only manifestation not in an array\n    else if (manifestations){\n      newManifestations = [{\n        manifestation: manifestations,\n        manifestationTitle: manifestations.split(\"/resource/\")[1],\n        transcription: \"\"\n      }]\n    }\n    this.setState((prevState) => {\n      return {\n        showTextRegion: eid\n      }\n    })\n    this.props.handleSurface3Manifestations(newManifestations)\n  }\n  handleToggleRelatedDiscussion(eid){\n    this.setState((prevState) => {\n      const target = prevState.expressions.find((e) => e[\"@id\"] === eid )\n      target.showComments = !target.showComments\n      const newExpressions = [...prevState.expressions]\n      return {\n        expressions: newExpressions\n      }\n    })\n\n  }\n  handleToggleRelatedSurfaces(eid){\n    this.setState((prevState) => {\n      const target = prevState.expressions.find((e) => e[\"@id\"] === eid )\n      target.showRelatedSurfaces = !target.showRelatedSurfaces\n      const newExpressions = [...prevState.expressions]\n      return {\n        expressions: newExpressions\n      }\n    })\n\n  }\n  retrieveSurfaceInfo(surfaceid){\n    const query = getSurfaceInfo(surfaceid)\n    const surfaceInfo = runQuery(query)\n    surfaceInfo.then((d) => {\n      if (d.data[\"@graph\"]){\n        const data = d.data[\"@graph\"]\n        const expressions = data.filter((e) => {\n          if (e.hasManifestation){\n            return {\n              expressionid: e[\"@id\"],\n              manifestations: e.hasManifestation,\n              showComments: false,\n              showRelatedSurfaces: false,\n            }\n          }\n          else{\n            return null\n          }\n        })\n        let surfaceMap = {}\n        data.forEach((e) => {\n          if (e.isOnSurface){\n            surfaceMap[e[\"@id\"]] = e.isOnSurface\n          }\n        })\n        this.setState({\n          expressions: expressions,\n          surfaceMap: surfaceMap,\n          query: query\n        })\n      }\n    })\n  }\n\n  componentDidMount(){\n    this.retrieveSurfaceInfo(this.props.surfaceid)\n  }\n  componentWillReceiveProps(newProps){\n    if (newProps.surfaceid !== this.props.surfaceid){\n      this.retrieveSurfaceInfo(newProps.surfaceid)\n    }\n  }\n  render(){\n    const displayExpressions = () => {\n      if (this.state.expressions.length > 0){\n        const expressions = this.state.expressions.map((e) => {\n          let manifestations = \"\"\n          // sometimes there are several manifestations\n          if (typeof(e.hasManifestation) === \"object\"){\n            manifestations = e.hasManifestation.map((m) => {\n              return (\n                  <div key={m}>\n                  <span>{m} <Link to={\"/text?resourceid=\" + m}><FaExternalLinkAlt/></Link></span>\n                  <br/>\n                  <span style={{\"textIndent\": \"10px\"}}>...Appearing on Surface {this.state.surfaceMap[m]} <Link to={\"/text?resourceid=\" + this.state.surfaceMap[m]}><FaExternalLinkAlt/></Link></span>\n                  <br/>\n                  <br/>\n                  </div>\n                )\n              })\n            }\n            // sometimes there is only manifestation\n            else if (e.hasManifestation){\n              manifestations = (\n                  <div key={e.hasManifestation}>\n                  <span>{e.hasManifestation} <Link to={\"/text?resourceid=\" + e.hasManifestation}><FaExternalLinkAlt/></Link></span>\n                  <br/>\n                  <span style={{\"textIndent\": \"10px\"}}>...Appearing on Surface {this.state.surfaceMap[e.hasManifestation]} <Link to={\"/text?resourceid=\" + this.state.surfaceMap[e.hasManifestation]}><FaExternalLinkAlt/></Link></span>\n                  <br/>\n                  <br/>\n                  </div>\n                )\n              }\n              else{\n                manifestations = []\n              }\n          return (\n            <div key={e[\"@id\"]}>\n            <hr/>\n            <p>{e[\"@id\"]} <Link to={\"/text?resourceid=\" + e[\"@id\"]}><FaExternalLinkAlt/></Link></p>\n            {e.showRelatedSurfaces ?\n              <div>\n\n              <Button variant=\"outline-primary\" size=\"sm\" block onClick={() => {this.handleToggleRelatedSurfaces(e[\"@id\"])}}>Hide Related Codices</Button>\n              <br/>\n              {this.state.showTextRegion !== e[\"@id\"] ?\n                <Button variant=\"outline-primary\" size=\"sm\" block onClick={() => this.handleSurface3Manifestations(e.hasManifestation, e[\"@id\"])}>View Focused Text Region</Button>\n                :\n                <Button variant=\"outline-primary\" size=\"sm\" block onClick={() => this.handleSurface3Manifestations(\"\", \"\")}>Hide Focused Text Region</Button>\n              }\n              <br/>\n              {manifestations}\n              </div> :\n              <div>\n                <Button variant=\"outline-primary\" size=\"sm\" block onClick={() => {this.handleToggleRelatedSurfaces(e[\"@id\"])}}>Show Related Codices</Button>\n                <br/>\n              </div>\n            }\n            {e.showComments ?\n              <div>\n              <Button variant=\"outline-primary\" size=\"sm\" block onClick={() => {this.handleToggleRelatedDiscussion(e[\"@id\"])}}>Hide Related Discussions</Button>\n              <br/>\n              <Comments resourceid={e[\"@id\"]} inbox={\"http://inbox.scta.info/notifications?resourceid=\" + e[\"@id\"]}/>\n              </div> :\n              <div>\n                <Button variant=\"outline-primary\" size=\"sm\" block onClick={() => {this.handleToggleRelatedDiscussion(e[\"@id\"])}}>Show Related Discussions</Button>\n                <br/>\n              </div>\n            }\n            </div>\n          )\n        })\n        return expressions\n      }\n      else{\n        return null\n      }\n    }\n\n    return (\n      <div className=\"SurfaceInfo\">\n      <h1>Page Info</h1>\n        <div style={{\"fontSize\": \"16px\"}}>\n        <h1>Text objects on this page <Button size=\"sm\" clasName=\"lbp-span-link\" onClick={this.handleToggleShowQuery}>{this.state.showQuery ? \"Hide Proof\" : \"Prove It!\"}</Button></h1>\n        {this.state.showQuery && <p>{this.state.query}</p>}\n        {displayExpressions()}\n        </div>\n\n      </div>\n    );\n  }\n}\n\nexport default SurfaceInfo;\n","//note; each query here represents an attempt an efficient single request for related information\n//each query therefore could be tranformed into a restful api\n\n\n export function getSurfaceInfo(surfaceid){\n   const query = [\n     \"CONSTRUCT\",\n     \"{\",\n     \"?expression <http://scta.info/property/hasManifestation> ?manifestation2 .\",\n     \"?manifestation2 <http://scta.info/property/isOnSurface> ?surface2 .\",\n     \"}\",\n     \"WHERE\",\n     \"{\",\n     \"?manifestation <http://scta.info/property/isOnSurface> <\" + surfaceid + \"> .\",\n     \"?manifestation <http://scta.info/property/structureType> <http://scta.info/resource/structureBlock> .\",\n     \"?manifestation <http://scta.info/property/isManifestationOf> ?expression .\",\n     \"?expression <http://scta.info/property/hasManifestation> ?manifestation2 .\",\n     \"?manifestation2 <http://scta.info/property/isOnSurface> ?surface2 .\",\n     \"?codex <http://scta.info/property/hasSurface> ?surface2 .\",\n     \"}\"\n   ].join('');\n   return query\n }\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport Surface2 from './Surface2'\nimport Surface3Wrapper from './Surface3Wrapper'\nimport SurfaceInfo from './SurfaceInfo'\nimport {Link} from 'react-router-dom';\n\nimport {runQuery} from './utils'\nimport {getCodexInfo, getCodexInfoFromSurface, getCodexInfoFromCanvas, getCodexInfoFromManifest} from './Queries'\n\nclass Codex extends React.Component {\n  constructor(props){\n    super(props)\n    this.retrieveCodexInfo = this.retrieveCodexInfo.bind(this)\n    this.handleSurfaceFocusChange = this.handleSurfaceFocusChange.bind(this)\n    this.handleToggleShowContents = this.handleToggleShowContents.bind(this)\n    this.handleSurface3Manifestations = this.handleSurface3Manifestations.bind(this)\n    this.state = {\n      items: {},\n      title: \"\",\n      focusedSurface: \"\",\n      relatedCodices: [],\n      showContents: true,\n      surface3Manifestations: [],\n      surface3FocusedManifestation: \"\"\n    }\n  }\n  handleToggleShowContents(){\n    this.setState((prevState) => {\n      return{\n        showContents: !prevState.showContents\n      }\n    })\n  }\n  handleSurface3Manifestations(manifestations){\n    // construct target manifestation from codex slug in focused surface\n    // then use slug to find matching manifestation in manifestation list\n    // TODO: not ideal to be constructing the manifestation id\n    // TODO: it would better to begetting this directly from a lookup request\n    const split1 = this.state.focusedSurface.split(\"/resource/\")[1]\n    const codexSlug = split1.split(\"/\")[0]\n    const surface3FocusedManifestation = manifestations ? manifestations.filter((m) => m.manifestation.includes(codexSlug))[0].manifestation : \"\"\n\n    this.setState({\n        surface3Manifestations: manifestations,\n        surface3FocusedManifestation: surface3FocusedManifestation\n      })\n  }\n  handleSurfaceFocusChange(surfaceid){\n    this.setState({focusedSurface: surfaceid})\n  }\n  retrieveCodexInfo(id, type){\n    let codexInfo = undefined\n    if (type === \"surface\"){\n      codexInfo = runQuery(getCodexInfoFromSurface(id))\n    }\n    else if (type === \"canvas\"){\n      codexInfo = runQuery(getCodexInfoFromCanvas(id))\n    }\n    else if (type === \"manifest\"){\n      codexInfo = runQuery(getCodexInfoFromManifest(id))\n    }\n    else{\n      codexInfo = runQuery(getCodexInfo(id))\n    }\n    codexInfo.then((d) => {\n      const data = d.data.results.bindings\n      if (data.length > 0 && data[0].surface){\n        const expressionIdMap = data.map((d) => {\n          return d.expression ? d.expression.value : \"\"\n        })\n        var unique = expressionIdMap.filter((v, i, a) => a.indexOf(v) === i);\n        let expressionList = {}\n        unique.forEach((e) => {\n           expressionList[e] = []\n        })\n        data.forEach((d) => {\n            const info = {\n              expression: d.expression.value,\n              expressionTitle: d.item_expression_title.value,\n              manifestation: d.manifestation.value,\n              surface: d.surface.value,\n              surfaceTitle: d.surface_title.value,\n              questionTitle: d.item_expression_question_title ? d.item_expression_question_title.value : ''\n            }\n          expressionList[d.expression.value].push(info)\n        })\n        let focusedSurface = \"\"\n        if (type === \"surface\"){\n           focusedSurface = id\n         }\n         else if (type === \"canvas\"){\n           focusedSurface = data[0].surfaceFocus.value\n         }\n         else{\n           focusedSurface = data[0].surface.value\n         }\n        this.setState({items: expressionList, focusedSurface: focusedSurface})\n\n      }\n    })\n  }\n  componentDidMount(){\n    if (this.props.surfaceid){\n      this.retrieveCodexInfo(this.props.surfaceid, \"surface\")\n    }\n    else if (this.props.canvasid){\n      this.retrieveCodexInfo(this.props.canvasid, \"canvas\")\n    }\n    else if (this.props.manifestid){\n      this.retrieveCodexInfo(this.props.manifestid, \"manifest\")\n    }\n    else{\n      this.retrieveCodexInfo(this.props.codexid, \"codex\")\n    }\n  }\n  componentWillReceiveProps(newProps){\n    if (newProps.surfaceid && newProps.surfaceid !== this.props.surfaceid){\n      this.retrieveCodexInfo(newProps.surfaceid, \"surface\")\n    }\n    else if (newProps.canvasid && newProps.canvasid !== this.props.canvasid){\n      this.retrieveCodexInfo(newProps.canvasid, \"canvas\")\n    }\n    else if (newProps.manifestid && newProps.manifestid !== this.props.manifestid){\n      this.retrieveCodexInfo(newProps.manifest, \"manifest\")\n    }\n    else if (newProps.codexid !== this.props.codexid){\n      this.retrieveCodexInfo(newProps.codexid, \"codex\")\n    }\n  }\n\n  render(){\n    const displayItems = () => {\n      const items = Object.keys(this.state.items).map((key) => {\n        return (\n          <p key={this.state.items[key][0].expression}>\n          <span>\n              <span className=\"codexLink\" onClick={() => {this.handleSurfaceFocusChange(this.state.items[key][0].surface)}}>\n                {this.state.items[key][0].surfaceTitle}</span>{\" - \"}\n              <span className=\"codexLink\" onClick={() => {this.handleSurfaceFocusChange(this.state.items[key][this.state.items[key].length - 1].surface)}}>\n                {this.state.items[key][this.state.items[key].length - 1].surfaceTitle}\n              </span>\n            </span>{\": \"}\n            <Link to={\"/text?resourceid=\" + this.state.items[key][0].manifestation}>{this.state.items[key][0].expressionTitle}</Link>{\": \"}\n            {this.state.items[key][0].questionTitle && this.state.items[key][0].questionTitle}\n          </p>\n\n        )\n      })\n      return items\n    }\n    const displayImages = () => {\n      if (this.state.surface3Manifestations.length > 0){\n        return <Surface3Wrapper manifestations={this.state.surface3Manifestations} focusedManifestation={this.state.surface3FocusedManifestation} annotationsDisplay=\"paragraph\" width=\"500\" hidden={false}/>\n      }\n      else if (this.state.focusedSurface){\n        return <Surface2 surfaceid={this.state.focusedSurface} lineFocusId=\"\" topLevel={this.props.topLevel} handleSurfaceFocusChange={this.handleSurfaceFocusChange} width={\"500\"} annotationsDisplay={false} hidden={false}/>\n      }\n      else{\n        return null\n      }\n\n    }\n    return (\n      <Container fluid={true} className=\"Codex\">\n      <h1>{this.props.codexid}</h1>\n      <div className=\"codexWrapper\">\n        <div className=\"codexContentsWrapper\">\n          <div className=\"codexContents\">\n          {\n            // uncomment if show hide contents toggle is desired\n            //<h2 onClick={this.handleToggleShowContents}>{this.state.showContents ? \"Hide Contents\" : \"View Contents\"}</h2>\n          }\n          <h2>Codex Contents</h2>\n          {this.state.showContents && this.state.items && displayItems()}\n          </div>\n        </div>\n        <div className=\"codexImage\">\n          <h1>Codex Pages</h1>\n          {displayImages()}\n         </div>\n         <div className=\"surfaceInfo\">\n         {this.state.focusedSurface &&\n          <SurfaceInfo surfaceid={this.state.focusedSurface} handleSurface3Manifestations={this.handleSurface3Manifestations}/>\n         }\n        </div>\n      </div>\n\n      </Container>\n    );\n  }\n}\n\nexport default Codex;\n","import React from 'react';\nimport Qs from \"query-string\"\nimport TextWrapper from \"./TextWrapper\"\nimport TextArticle from \"./TextArticle\"\nimport Collection from \"./Collection\"\nimport AuthorCollection from \"./AuthorCollection\"\nimport Codex from \"./Codex\"\nimport TextOutlineWrapper from \"./TextOutlineWrapper\"\nimport Container from 'react-bootstrap/Container';\n\nimport {runQuery} from './utils'\nimport {getArticleTranscriptionDoc, getItemTranscription, getItemTranscriptionFromBlockDiv, getStructureType} from './Queries'\n\nclass TextSwitch extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleUpdateUrlResource = this.handleUpdateUrlResource.bind(this)\n    this.state = {\n      displayType: \"\",\n      resourceid: \"\",\n      itemTranscriptionId: \"\",\n      blockDivFocus: \"\",\n      resourceTitle: \"\",\n      author: \"\"\n    }\n  }\n  handleUpdateUrlResource(fullid){\n    this.props.history.push({search: '?resourceid=' + fullid})\n  }\n  getInfo(resourceid){\n    const structureTypePromise = runQuery(getStructureType(resourceid))\n    structureTypePromise.then((t) => {\n      // reduce results to bindings variable\n      const bindings = t.data.results.bindings.length > 0 ? t.data.results.bindings[0] : \"\"\n      // get specific results from bindings data\n      const type = bindings.type ? bindings.type.value : null\n      const structureType = bindings.structureType ? bindings.structureType.value : null\n      //const level = bindings.level ? bindings.level.value : null\n      const topLevel = bindings.topLevel ? bindings.topLevel.value : resourceid\n      const itemParent = bindings.itemParent ? bindings.itemParent.value : null\n      const resourceTitle = bindings.resourceTitle ? bindings.resourceTitle.value : \"\"\n      const author = bindings.author ? bindings.author.value : \"\"\n\n      //const itemTranscriptionId = t.data.results.bindings[0].ctranscription ? t.data.results.bindings[0].ctranscription.value : null\n      if (type === \"http://scta.info/resource/person\"){\n          this.setState({displayType: \"person\", resourceid: resourceid, structureType: \"\", topLevel: \"\", type: type, resourceTitle: resourceTitle})\n      }\n      else if (type === \"http://scta.info/resource/article\"){\n        const structureTypePromise = runQuery(getArticleTranscriptionDoc(resourceid))\n        structureTypePromise.then((t) => {\n          this.setState(\n            {displayType: \"article\",\n            articleDoc: t.data.results.bindings[0] ? t.data.results.bindings[0].doc.value : \"\", // conditional checks in case the query comes up empty; if empty it sets transcription id to \"\"\n            articleType: t.data.results.bindings[0] ? t.data.results.bindings[0].articleType.value : \"\", // conditional checks in case the query comes up empty; if empty it sets transcription id to \"\"\n            resourceid: resourceid,\n            structureType: \"\", topLevel: \"\",\n            type: type,\n            resourceTitle: resourceTitle}\n          )\n        })\n\n      }\n      else if (type === \"http://scta.info/resource/codex\"){\n          this.setState({displayType: \"codex\", resourceid: resourceid, structureType: \"\", topLevel: \"\", type: type, resourceTitle: resourceTitle})\n      }\n      else if (type === \"http://scta.info/resource/surface\"){\n          this.setState({displayType: \"surface\", resourceid: resourceid, structureType: \"\", topLevel: \"\", type: type, resourceTitle: resourceTitle})\n      }\n      else if (type === \"http://iiif.io/api/presentation/2#Manifest\"){\n          this.setState({displayType: \"manifest\", resourceid: resourceid, structureType: \"\", topLevel: \"\", type: type, resourceTitle: resourceTitle})\n      }\n      else if (type === \"http://iiif.io/api/presentation/2#Canvas\"){\n          this.setState({displayType: \"canvas\", resourceid: resourceid, structureType: \"\", topLevel: \"\", type: type, resourceTitle: resourceTitle})\n      }\n      else if (type === \"http://scta.info/resource/workGroup\"){\n          this.setState({displayType: \"workGroup\", resourceid: resourceid, structureType: structureType, topLevel: topLevel, type: type, resourceTitle: resourceTitle})\n      }\n      else if (structureType === \"http://scta.info/resource/structureCollection\"){\n          this.setState({displayType: \"collection\", resourceid: resourceid, structureType: structureType, topLevel: topLevel, type: type, resourceTitle: resourceTitle, author: author})\n      }\n      else if (structureType === \"http://scta.info/resource/structureItem\" ){\n        if (type === \"http://scta.info/resource/transcription\"){\n          this.setState({itemTranscriptionId: resourceid, displayType: \"item\", blockDivFocus: \"\", resourceTitle: resourceTitle})\n        }\n        else {\n          const structureTypePromise = runQuery(getItemTranscription(resourceid))\n          structureTypePromise.then((t) => {\n            this.setState(\n              {\n                itemTranscriptionId: t.data.results.bindings[0] ? t.data.results.bindings[0].ctranscription.value : \"\", // conditional checks in case the query comes up empty; if empty it sets transcription id to \"\"\n                displayType: \"item\",\n                blockDivFocus: \"\",\n                resourceTitle: resourceTitle})\n              });\n            }\n          }\n      else if (structureType === \"http://scta.info/resource/structureBlock\" || structureType === \"http://scta.info/resource/structureDivision\" ){\n        const structureTypePromise = runQuery(getItemTranscriptionFromBlockDiv(resourceid))\n        structureTypePromise.then((t) => {\n          if (type === \"http://scta.info/resource/transcription\"){\n            this.setState({itemTranscriptionId: itemParent, blockDivFocus: t.data.results.bindings[0].blockDivExpression.value, displayType: \"item\", resourceTitle: resourceTitle})\n          }\n          else if (type === \"http://scta.info/resource/expression\"){\n            if (t.data.results.bindings[0].ctranscription){\n              this.setState({itemTranscriptionId: t.data.results.bindings[0].ctranscription.value, blockDivFocus: resourceid, displayType: \"item\", resourceTitle: resourceTitle})\n            }\n            else{\n              this.setState({displayType: \"notFound\"})\n            }\n          }\n          else {\n            this.setState({itemTranscriptionId: t.data.results.bindings[0].ctranscription.value, blockDivFocus: t.data.results.bindings[0].blockDivExpression.value, displayType: \"item\", resourceTitle: resourceTitle})\n          }\n        });\n      }\n      else{\n        this.setState({displayType: \"notFound\"})\n      }\n    });\n  }\n\n  componentDidMount(){\n    const newResourceId = Qs.parse(this.props.location.search, { ignoreQueryPrefix: true }).resourceid\n    this.getInfo(newResourceId)\n  }\n  componentWillReceiveProps(nextProps) {\n    const newResourceId = Qs.parse(nextProps.location.search, { ignoreQueryPrefix: true }).resourceid\n    this.getInfo(newResourceId)\n  }\n\n\n\n  render(){\n    const display = () => {\n      if (this.state.displayType === \"person\"){\n        return (<AuthorCollection resourceid={this.state.resourceid}/>)\n\n      }\n      if (this.state.displayType === \"article\"){\n        return (<TextArticle doc={this.state.articleDoc} articleType={this.state.articleType}/>)\n\n      }\n      else if (this.state.displayType === \"workGroup\"){\n        return (\n          <Collection resourceid={this.state.resourceid} structureType={this.state.structureType} topLevel={this.state.topLevel} type={this.state.type}/>\n        )\n      }\n      else if (this.state.displayType === \"collection\"){\n        return (\n          <Container className=\"textOutlineContainer\">\n            <TextOutlineWrapper\n              focusResourceid={this.state.resourceid}\n              resourceid={this.state.resourceid}\n              title={this.state.resourceTitle}\n              hidden={false}\n              mtFocus={\"\"}\n              collectionLink={true}/>\n          </Container>\n        )\n\n\n      }\n      else if (this.state.displayType === \"item\"){\n        // check to see if a transcription for this text has been found\n        if (this.state.itemTranscriptionId){\n          //TODO: item id is shortItemId pull from transcription id.\n          // it would be better to be getting this from query rather than string deconstruction\n          return (\n            <TextWrapper itemid={this.state.itemTranscriptionId.split(\"/resource/\")[1].split(\"/\")[0]}\n            transcriptionid={this.state.itemTranscriptionId}\n            blockDivFocus={this.state.blockDivFocus}\n            handleUpdateUrlResource={this.handleUpdateUrlResource}/>\n          )\n        }\n        // if no transcription resource id, exists return message\n        else{\n          return (<p>Apologies, no transcriptions of this text are currently available.</p>)\n\n\n        }\n      }\n      else if (this.state.displayType === \"codex\"){\n        return (<Codex codexid={this.state.resourceid}/>)\n      }\n      else if (this.state.displayType === \"surface\"){\n        return (<Codex surfaceid={this.state.resourceid}/>)\n      }\n      else if (this.state.displayType === \"canvas\"){\n        return (<Codex canvasid={this.state.resourceid}/>)\n      }\n      else if (this.state.displayType === \"manifest\"){\n        return (<Codex manifestid={this.state.resourceid}/>)\n      }\n      else if (this.state.displayType === \"notFound\"){\n        return (<p>Apologies, this resource could not be found</p>)\n      }\n      else{\n        return null\n      }\n    }\n  return (\n    display()\n    );\n  }\n\n}\n\nexport default TextSwitch;\n","import React from 'react';\n\nfunction About() {\n  return (\n    <div className=\"About\">\n    <h1>About</h1>\n\n    </div>\n  );\n}\n\nexport default About;\n","import React from 'react';\nimport {Link} from 'react-router-dom';\n\nfunction CodexListItem(props) {\n  return (\n    <p><Link to={\"/text?resourceid=\" + props.codexid}>{props.title}</Link></p>\n  );\n}\n\nexport default CodexListItem;\n","import React from 'react';\n\nimport Container from 'react-bootstrap/Container';\n\nimport CodexListItem from './CodexListItem'\nimport {runQuery} from './utils'\nimport {getCodices} from './Queries'\n\nclass Codices extends React.Component {\n  constructor(props){\n    super(props)\n    this.state = {\n      codices: []\n    }\n  }\n  retrieveCodices(){\n    const codicesInfo = runQuery(getCodices())\n    codicesInfo.then((d) => {\n      const codices = this.arrangeCodexInfo(d.data.results.bindings)\n      this.setState({codices: codices})\n    })\n\n  }\n  arrangeCodexInfo(data){\n    const codices = data.map((d) => {\n      return {\n        codexid: d.codex ? d.codex.value : \"\",\n        title: d.codex_title ? d.codex_title.value : \"\"\n      }\n    })\n    return codices\n  }\n  componentDidMount(){\n    this.retrieveCodices()\n  }\n  render(){\n    const displayCodices = () => {\n      const codices = this.state.codices.map((d) => {\n        return <CodexListItem key={d.id} codexid={d.codexid} title={d.title}/>\n      })\n      return codices\n    }\n  return (\n    <Container className=\"Codices\">\n    <h1>Codices</h1>\n    {displayCodices()}\n    </Container>\n  );\n}\n}\n\nexport default Codices;\n","import React from 'react';\nimport {NavLink} from 'react-router-dom';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\nimport {resourceEndpoint} from './config';\n\nfunction NavBar() {\n  return (\n    <Navbar bg=\"dark\" variant=\"light\" expand=\"lg\" fixed=\"top\">\n      <Nav>\n        <NavLink className=\"nav-link\" to=\"/\">SCTA Reading Room</NavLink>\n      </Nav>\n      <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n      <Navbar.Collapse id=\"basic-navbar-nav\">\n      <Nav>\n\n\n\n        <NavLink className=\"nav-link\" to={\"/text?resourceid=\" + resourceEndpoint}>Text</NavLink>\n        {// example drop down\n          // <NavDropdown title=\"Dropdown\" id=\"basic-nav-dropdown\">\n        //   <NavDropdown.Item href=\"#action/3.1\">Action</NavDropdown.Item>\n        //   <NavDropdown.Item href=\"#action/3.2\">Another action</NavDropdown.Item>\n        //   <NavDropdown.Item href=\"#action/3.3\">Something</NavDropdown.Item>\n        //   <NavDropdown.Divider />\n        //   <NavDropdown.Item href=\"#action/3.4\">Separated link</NavDropdown.Item>\n        // </NavDropdown>\n      }\n      <NavLink className=\"nav-link\" to=\"/search\">Search</NavLink>\n      </Nav>\n\n      <Nav>\n        <NavLink className=\"nav-link\" to=\"/about\">About</NavLink>\n        <NavLink className=\"nav-link\" to=\"/donate\">Donate</NavLink>\n      </Nav>\n      </Navbar.Collapse>\n    </Navbar>\n\n  );\n}\n\nexport default NavBar;\n","import React from 'react';\n\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\n\n\n\n\n\nfunction Footer() {\n  return (\n\n    <Navbar bg=\"light\" variant=\"light\" expand=\"lg\" fixed=\"bottom\" style={{\"zIndex\": \"0\"}}>\n    <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n    <Navbar.Collapse id=\"basic-navbar-nav\">\n\n    <Nav style={{\"display\": \"flex\", \"justifyContent\": \"space-around\", \"width\": \"100%\"}}>\n      <Nav.Link href=\"http://github.com/lombardpress/lombardpress-webjs\">Lbp-Web.js</Nav.Link>\n      <Nav.Link href=\"http://lombardpress.org\">A LombardPress Publication</Nav.Link>\n      <Nav.Link href=\"http://scta.info\">Powered by SCTA Data</Nav.Link>\n      <Nav.Link href=\"http://jeffreycwitt.com\">Designed by Jeffrey C. Witt</Nav.Link>\n    </Nav>\n    </Navbar.Collapse>\n\n    </Navbar>\n\n  );\n}\n\nexport default Footer;\n","import React from 'react';\nimport {HashRouter, Route, Switch} from 'react-router-dom';\nimport Home from \"./Home\"\nimport SearchWrapper from \"./SearchWrapper\"\nimport TextSwitch from \"./TextSwitch\"\nimport About from \"./About\"\nimport Codices from \"./Codices\"\nimport NavBar from './NavBar';\n\n\n\nimport Footer from './Footer';\n\nimport 'bootstrap/dist/css/bootstrap.css'\nimport '../styles/App.scss';\n//import '../styles/index.scss';\n\nconst AppRouter = () => (\n  <HashRouter forceRefresh={false}>\n    <div>\n      <NavBar/>\n      <Switch>\n        <Route path=\"/\" exact={true} component={Home}/>\n        <Route path=\"/res\" exact={true} component={TextSwitch}/>\n        <Route path=\"/text\"  exact={true} component={TextSwitch}/>\n        <Route path=\"/about\" exact={true} component={About}/>\n        <Route path=\"/codices\" exact={true} component={Codices}/>\n        <Route path=\"/search\" exact={true} render={(props) => <SearchWrapper {...props} hidden={false}/>}/>\n        {\n          //<Route path=\"/edit/:id\" exact={true} component={EditExpensePage}/>\n        //<Route path=\"/help\" exact={true} component={HelpPage}/>\n        // <Route component={NotFoundPage}/>\n        }\n      </Switch>\n      <Footer/>\n    </div>\n  </HashRouter>\n)\n\nexport default AppRouter\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n//import './styles/index.scss';\nimport AppRouter from './components/AppRouter';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<AppRouter/>, document.getElementById('root'));\n\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}