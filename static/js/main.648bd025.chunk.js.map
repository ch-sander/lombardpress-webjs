{"version":3,"sources":["components/config.js","components/utils.js","components/Text.js","components/Home.js","components/Search.js","components/SearchQuery.js","components/SearchWrapper.js","components/Surface.js","components/Image.js","components/LineText.js","components/ImageTextWrapper.js","components/Queries.js","components/Surface2.js","components/XmlView.js","components/Info.js","components/WindowNavBar.js","components/NextPrevBar.js","components/TextCompareItem.js","components/TextCompare.js","components/TextCompareWrapper.js","components/CommentItem.js","components/CommentCreate.js","components/Comments.js","components/Window.js","components/TextNavBar.js","components/VersionChain.js","components/TextWrapper.js","components/Item.js","components/Collection.js","components/AuthorCollection.js","components/TextSwitch.js","components/About.js","components/NavBar.js","components/Footer.js","components/AppRouter.js","serviceWorker.js","index.js"],"names":["sparqlEndpoint","resourceEndpoint","loadXMLDoc","filename","xhttp","XMLHttpRequest","open","responseType","err","send","responseXML","runQuery","query","Axios","get","params","output","scrollToParagraph","hash","highlight","element","$","css","backgroundColor","animate","length","stop","scrollTop","offset","top","Text","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","retrieveText","bind","assertThisInitialized","doc","topLevel","scrollTo","docFragment","split","topLevelFragment","resultDocument","xmlurl","xslurl","xml","xsl","xsltProcessor","XSLTProcessor","importStylesheet","transformToFragment","document","convertXMLDoc","includes","getElementById","innerHTML","appendChild","click","e","preventDefault","id","attr","setFocus","openWindow","handleSurfaceFocusChange","prevProps","prevState","newProps","react_default","a","createElement","React","Component","Home","Qs","parse","location","search","ignoreQueryPrefix","resourceid","components_Text","className","Container_default","fluid","Jumbotron_default","Button_default","Search","retrieveResults","state","searchResults","count","expressionid","then","d","setState","data","results","eid","nextProps","_this2","map","r","i","key","react_router_dom","to","pid","dangerouslySetInnerHTML","__html","text","SearchQuery","handleQueryUpdate","handleEidUpdate","handleRunSearch","target","value","Form_default","onSubmit","FormControl_default","type","placeholder","onChange","variant","SearchWrapper","hidden","components_SearchQuery","info","components_Search","Image","coordsSplitArray","coords","x","parseInt","y","w","h","console","log","newCoords","imageLink","imageUrl","displayWidth","src","LineText","style","white-space","ImageTextWrapper","searchText","defineProperty","targetLabel","label","getClass","components_Image","canvas","canvasShort","components_LineText","basicInfoQuery","itemExpressionUri","join","partsInfoQuery","resourceurl","Surface2","handleNext","handlePrevious","handleToggleTextLines","currentSurfaceId","manifest","region","width","next","previous","imageurl","annotationsDisplay","surfaceid","getSurfaceInfo","b","bindings","alUrl","d2","resources","surfaceTitle","next_surface","previous_surface","annotations","catch","error","retrieveSurfaceInfo","_this3","onClick","resource","chars","on","components_ImageTextWrapper","surfaceButton","XmlView","retrieveXML","xmlstring","cxml","light","language","docco","showLineNumbers","Info","inbox","displayInfo","manifestations","manifestation","manifestationTitle","displayManifestations","relatedExpressions","relationLabel","displayRelatedExpressions","WindowNavBar","Nav_default","Item","Link","handleTabChange","windowId","index_esm","openWidthHeight","handleMinimize","handleMiddlize","handleMaximize","handleClose","handleSwitchWindow","windowType","NextPrevBar","handleBlockFocusChange","title","TextCompareItem","handleToggleShow","mounted","compareText","rawText","show","base","transcription","dmp","Diff","diff_match_patch","diff","diff_main","diff_cleanupSemantic","ds","diff_prettyHtml","createCompare","compareTranscription","handleChangeBase","ref","TextCompare","handleToggleShowAll","baseText","manifestationCTranscription","structureType","cdoc","topLevelExpression","cmanifestation","ctranscription","arrangeTextInfo","isMainText","getTextInfo","m","components_TextCompareItem","displayComparisons","TextCompareWrapper","handleCompare","handleToggleCompare","getText","expressions","newExpressions","objectSpread","forEach","exObject","keys","components_TextCompare","displayExpressions","CommentItem","n","body","CommentCreate","handleCommentUpdate","handleSubmitComment","comment","handleSumbitComment","Comments","notifications","annotat","@context","uuidv4","motivation","method","url","config","headers","Content-Type","response","concat","toConsumableArray","retrieveComments","components_CommentCreate","components_CommentItem","Window","windowLoad","components_WindowNavBar","focus","components_NextPrevBar","components_SearchWrapper","components_TextCompareWrapper","components_XmlView","components_Info","components_Surface2","components_Comments","TextNavBar","Navbar_default","bg","expand","fixed","Toggle","aria-controls","Collapse","VersionChain","getVersionHistory","handleToggleShowVersions","versions","currentVersion","showVersions","itemInfo","transcriptionUri","transcriptionid","reviewUrl","reviewObject","img_url","reviewid","ipfsHash","html_link","rubric_link","summary","newVersion","versionTranscription","version","versionLabel","version_label","versionOrderNumber","order_number","versionReview","review","versionDoc","versionReviewInfo","_this4","Alert_default","v","currentlyViewing","href","class","displayAlert","TextWrapper","mount","itemFocus","windows","window1","position","window2","blockFocus","fullid","shortid","arrangeFocusInfo","isRelatedTo","arrangeItemFocusInfo","itemFocusInfo","expression","t","setItemFocus","blockDivFocus","components_VersionChain","aSideWindowOpen","textClass","components_TextNavBar","_React$createElement","components_Window","item","author","authorTitle","questionTitle","Collection","retrieveCollectionInfo","makeRequests","handleFilter","filter","createRef","items","parts","surfaceFocus","partsPromise","partsObject","pId","part","partTitle","partType","partQuestionTitle","level","partLevel","itemsPromise","itemsObject","itemId","itemTitle","itemType","itemQuestionTitle","itemAuthor","itemAuthorTitle","cm","cmTitle","ct","expressionsInfo","partsInfo","arrangeParts","arrangeItems","collectionInfo","newResourceId","retrieveWorkGroupInfo","refs","questions","toLowerCase","push","components_Item","testPart","Table_default","striped","bordered","hover","size","displayParts","displayQuestions","AuthorCollection","retrieveAuthorCollectionInfo","handleItemFilter","itemFilter","authorArticles","textArticles","Array","isArray","authorArticle","autherArticle","textArticle","hasTopLevelExpression","authorid","authorCollectionInfo","displayItems","list","TextSwitch","displayType","itemTranscriptionId","itemParent","getItemTranscriptionFromBlockDiv","blockDivExpression","getInfo","components_AuthorCollection","components_Collection","components_TextWrapper","About","NavBar","Brand","Footer","Row_default","Col_default","AppRouter","forceRefresh","components_NavBar","react_router","path","exact","component","render","assign","components_Footer","Boolean","window","hostname","match","ReactDOM","components_AppRouter","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.648bd025.chunk.js","sourcesContent":["//export const sparqlEndpoint = \"http://localhost:3030/ds/query\"\nexport const sparqlEndpoint = \"https://sparql-docker.scta.info/ds/query\"\n\nexport const resourceEndpoint = \"http://scta.info/resource/scta\"\n","import Axios from 'axios'\nimport {sparqlEndpoint} from './config';\nimport $ from 'jquery';\n\nexport function loadXMLDoc(filename)\n  {\n    const xhttp = new XMLHttpRequest();\n    xhttp.open(\"GET\", filename, false);\n    try {xhttp.responseType = \"msxml-document\"} catch(err) {} // Helping IE11\n    xhttp.send(\"\");\n    return xhttp.responseXML;\n  }\n\nexport function convertXMLDoc(xmlurl, xslurl){\n  const xml = loadXMLDoc(xmlurl)\n  const xsl = loadXMLDoc(xslurl)\n  const xsltProcessor = new XSLTProcessor();\n  xsltProcessor.importStylesheet(xsl);\n  const resultDocument = xsltProcessor.transformToFragment(xml, document);\n  return resultDocument;\n}\n\nexport function nsResolver(prefix) {\n    if(prefix === \"tei\") {\n      return 'http://www.tei-c.org/ns/1.0'\n    }\n}\n\n\n\nexport function runQuery(query){\n  //const sparqlEndpoint = \"https://sparql-docker.scta.info/ds/query\"\n  //const sparqlEndpoint = sparqlEndpoint\n  const queryPromise = Axios.get(sparqlEndpoint, { params: { \"query\": query, \"output\": \"json\" } })\n  return queryPromise\n}\n\n//handles scroll to paragraph procedure\nexport function scrollToParagraph(hash, highlight){\n    const element = $(\"#\" + hash);\n\n    // TODO: highlighting is NOT working\n    if (highlight){\n      element.css({backgroundColor: \"yellow\"});\n      element.animate({backgroundColor: \"none\"}, 5000);\n    }\n  \tif (element.length > 0) {\n  \t    $('html, body')\n              .stop()\n              .animate({\n                  scrollTop: element.offset().top - 100\n              }, 1000);\n     }\n\n  }\n","import React from 'react';\n\nimport $ from 'jquery';\n\nimport {loadXMLDoc, convertXMLDoc, scrollToParagraph} from './utils'\n\nclass Text extends React.Component {\n  constructor(props){\n    super(props)\n    this.retrieveText = this.retrieveText.bind(this)\n\n\n  }\n  retrieveText(doc, topLevel, scrollTo){\n    const _this = this;\n    if (doc){\n      //construct file url request ot exist db to get a cors enabled copy of the text (github does not serve files with cors enabled)\n      const doc = this.props.doc;\n      const topLevel = this.props.topLevel;\n      const docFragment = doc.split(\"/master/\")[1]\n      const topLevelFragment = topLevel.split(\"/resource/\")[1]\n\n      let xmlurl = \"\"\n      if (doc.includes(\"ipfs\")){\n        xmlurl = doc\n      }\n      else{\n        xmlurl = \"http://exist.scta.info/exist/apps/scta-app/text/\" + topLevelFragment + \"/\" + docFragment;\n      }\n      const xslurl = \"/xslt/main_view.xsl\"\n      const resultDocument = convertXMLDoc(xmlurl, xslurl)\n      // append resultDoc to div in DOM\n      document.getElementById(\"text\").innerHTML = \"\";\n      document.getElementById(\"text\").appendChild(resultDocument);\n      // if (this.state.blockFocus){\n      //   scrollToParagraph(this.state.blockFocus, true)\n      // }\n    }\n    // bind events to dom\n    // only seems to be working when they are here; not yet sure why\n\n    $('.lbp-paragraphmenu').click(function(e) {\n         e.preventDefault();\n         const id = $(this).attr('data-id')\n         _this.props.setFocus(id)\n         _this.props.openWindow(\"window1\", \"info\")\n    });\n\n    // scroll to paragraph after document has been appended\n    scrollToParagraph(scrollTo, true)\n\n  //   $('.lbp-paragraphmenu').click(function(e) {\n  //     e.preventDefault();\n  //     const id = $(this).attr('data-id')\n  //\n  //     //_this.setState({blockFocus: id})\n  //     _this.setState((prevState) => {\n  //       const windows = prevState.windows\n  //       windows.window1.open = true\n  //       return {\n  //         windows: windows,\n  //         blockFocus: id\n  //       }\n  //\n  //     })\n  //     // set block info to state.info\n  //     const fullid = \"http://scta.info/resource/\" + id\n  //     const info = runQuery(basicInfoQuery(fullid))\n  //     _this.arrangeTextInfo(info, fullid)\n  //\n  //     // retrieve relatedExpressions info\n  //     // get related expressions info\n  //     // TODO/Note this is getting called in handleBlockFocusChange as well;\n  //     // Strong candidate for  refactor\n  //     const relatedExpressions = runQuery(getRelatedExpressions(fullid))\n  //     _this.arrangeRelatedInfo(relatedExpressions)\n  //     // scroll to paragraph\n  //     scrollToParagraph(id, true)\n  //\n  //   });\n    $('.js-show-folio-image').click(function(e) {\n      e.preventDefault();\n      const id = $(this).attr('data-surfaceid')\n      //_this.setState({surfaceFocus: \"http://scta.info/resource/\" + id})\n      // _this.setState((prevState) => {\n      //   const windows = prevState.windows\n      //   windows.window2.open = true\n      //   windows.window2.windowLoad = \"surface2\"\n      //   return {\n      //     windows: windows,\n      //     surfaceFocus: \"http://scta.info/resource/\" + id\n      //   }\n\n        _this.props.handleSurfaceFocusChange(\"http://scta.info/resource/\" + id)\n        _this.props.openWindow(\"window2\", \"surface2\")\n    });\n  }\n\n  componentDidUpdate(prevProps, prevState){\n\n    //check to see if doc has changed\n    if (prevProps.doc != this.props.doc){\n      this.retrieveText(this.props.doc, this.props.topLevel, this.props.scrollTo)\n    }\n    // if doc has already been appended, still scroll to target block\n    else{\n      scrollToParagraph(this.props.scrollTo, true)\n    }\n\n\n    //this.retrieveText(this.props.doc, this.props.topLevel, this.props.scrollTo)\n  }\n\n  componentDidMount(){\n    this.retrieveText(this.props.doc, this.props.topLevel, this.props.scrollTo)\n  }\n  componentWillReceiveProps(newProps){\n\n  }\n  render(){\n\n    return (\n      <div>\n        <div id=\"text\"></div>\n      </div>\n    );\n  }\n}\n\nexport default Text;\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport Jumbotron from 'react-bootstrap/Jumbotron';\nimport Button from 'react-bootstrap/Button';\nimport Text from './Text';\nimport Qs from \"query-string\"\n\n\n\nfunction Home(props) {\n  const resourceid = Qs.parse(props.location.search, { ignoreQueryPrefix: true }).resourceid;\n  const displayBody = () => {\n    if (resourceid){\n      return <Text resourceid={props.location.search.resourceid}/>\n    }\n    else\n    return (\n      <div className=\"Home\">\n        <Container id=\"lbp-home\" fluid>\n            <Container>\n              <Jumbotron id=\"lbp-jumbo\">\n              \t<h1>The SCTA Reading Room</h1>\n              \t<p>A site for reading, viewing, and studying the scholastic tradition</p>\n                <Button>View the text</Button> | <Button>Learn More</Button>\n              </Jumbotron>\n            </Container>\n          </Container>\n          </div>\n    )\n  }\n  return (\n    displayBody()\n  )\n}\n\nexport default Home;\n","import React from 'react';\nimport Axios from 'axios'\nimport Qs from \"query-string\"\nimport {Link} from 'react-router-dom';\n\nclass Search extends React.Component {\n  constructor(props){\n    super(props)\n    this.retrieveResults = this.retrieveResults.bind(this)\n    this.state = {\n      searchResults: [],\n      count: \"\"\n    }\n  }\n  retrieveResults(query, expressionid){\n    const _this = this\n    Axios.get(\"http://exist.scta.info/exist/apps/scta-app/jsonsearch/json-search-text-by-expressionid.xq?query=\" + query + \"&expressionid=\" + expressionid).\n          then((d) => {\n            _this.setState({searchResults: d.data.results, count: d.data.count})\n          })\n  }\n  componentDidMount(){\n    // const query = Qs.parse(this.props.location.search, { ignoreQueryPrefix: true }).query\n    // const eid = Qs.parse(this.props.location.search, { ignoreQueryPrefix: true }).eid\n    const query = this.props.query\n    const eid =  this.props.eid\n\n    this.retrieveResults(query, eid)\n  }\n  componentWillReceiveProps(nextProps){\n    const query = nextProps.query\n    const eid =  nextProps.eid\n    this.retrieveResults(query, eid)\n  }\n  render(){\n    const displayResults = () => {\n      if (this.state.searchResults.length > 1){\n        const results = this.state.searchResults.map((r, i) => {\n          return (\n            <div key={i}>\n            <p><Link to={\"/text?resourceid=http://scta.info/resource/\" + r.pid}>{r.pid}</Link></p>\n            <p dangerouslySetInnerHTML={{ __html: r.text}}/>\n            </div>\n          )\n\n        })\n      return results\n    }\n    else if (this.state.searchResults){\n      return (\n        <div key={this.state.searchResults.pid}>\n        <p><Link to={\"/text?resourceid=http://scta.info/resource/\" + this.state.searchResults.pid}>{this.state.searchResults.pid}</Link></p>\n        <p dangerouslySetInnerHTML={{ __html: this.state.searchResults.text}}/>\n        </div>\n      )\n    }\n    else{\n      return (\n        <div><p>No results</p></div>\n      )\n    }\n  }\n  return (\n    <div>\n    {displayResults()}\n    </div>\n\n\n  );\n  }\n}\n\nexport default Search;\n","import React from 'react';\nimport Axios from 'axios'\n\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\n\nclass SearchQuery extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleQueryUpdate = this.handleQueryUpdate.bind(this)\n    this.handleEidUpdate = this.handleEidUpdate.bind(this)\n    this.handleRunSearch = this.handleRunSearch.bind(this)\n    this.state = {\n      query: \"\",\n      eid: \"\",\n    }\n  }\n  handleQueryUpdate(e){\n    e.preventDefault()\n\n    this.setState({query: e.target.value})\n\n  }\n  handleEidUpdate(e){\n    e.preventDefault()\n    this.setState({eid: e.target.value})\n\n  }\n  handleRunSearch(e){\n    e.preventDefault()\n    this.props.handleRunSearch(this.state.query, this.state.eid)\n  }\n  componentDidMount(){\n    this.props.eid && this.setState({eid: this.props.eid})\n  }\n  componentWillReceiveProps(nextProps){\n    nextProps.eid && this.setState({eid: nextProps.eid})\n  }\n  render(){\n    return (\n      <div>\n       <Form onSubmit={this.handleRunSearch}>\n        <FormControl type=\"text\" id=\"query\" placeholder=\"query\" className=\"mr-sm-2\" onChange={this.handleQueryUpdate} />\n        {!this.props.eid &&<FormControl type=\"text\" id=\"eid\" placeholder=\"eid\" className=\"mr-sm-2\" onChange={this.handleEidUpdate} />}\n        <Button type=\"submit\" variant=\"outline-success\">Search</Button>\n      </Form>\n\n      </div>\n    )\n  }\n}\n\nexport default SearchQuery;\n","import React from 'react';\nimport Axios from 'axios'\nimport Qs from \"query-string\"\nimport Search from \"./Search\"\nimport SearchQuery from \"./SearchQuery\"\n\nclass SearchWrapper extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleRunSearch = this.handleRunSearch.bind(this)\n    this.state = {\n      query: \"\",\n      eid: \"\",\n    }\n  }\n  handleRunSearch(query, eid){\n    this.setState({query: query, eid: eid})\n  }\n  componentDidMount(){\n\n  }\n  componentWillReceiveProps(){\n\n  }\n  render(){\n    return (\n      <div className={this.props.hidden ? \"hidden\" : \"showing\"}>\n        <h1>Search</h1>\n        <SearchQuery handleRunSearch={this.handleRunSearch} eid={this.props.info && this.props.info.topLevel.split(\"/resource/\")[1]}/>\n        {this.state.query && <Search query={this.state.query} eid={this.state.eid}/>}\n      </div>\n    )\n  }\n}\n\nexport default SearchWrapper;\n","import React from 'react';\n\n/// mirador imports\n\nimport { Provider } from 'react-redux';\nimport PluginProvider from 'mirador/dist/es/src/extend/PluginProvider';\nimport createRootReducer from 'mirador/dist/es/src/state/reducers/rootReducer';\nimport MiradorApp from 'mirador/dist/es/src/containers/App';\n//import {CollectionViewer} from 'mirador-collection-viewer';\n//import {miradorImageToolsPlugin} from 'mirador-image-tools';\nimport settings from 'mirador/dist/es/src/config/settings';\nimport * as actions from 'mirador/dist/es/src/state/actions';\nimport createStore from 'mirador/dist/es/src/state/createStore';\n\nclass Surface extends React.Component {\n  constructor(props){\n    super(props)\n    this.store = createStore();\n\n  }\n\n  componentWillMount(){\n\n      settings.id = \"yolo\";\n      // manifest id should be retrieved from query\n      // this is a temporary measure until db is corrected and query is posible\n      const manifest = \"http://scta.info/iiif/\" + this.props.topLevel.split(\"/resource/\")[1] + \"/\" + this.props.surfaceid.split(\"/resource/\")[1].split(\"/\")[0] + \"/\" + \"manifest\";\n      \n      const settings2 = {\n        ...settings,\n        windows: [{\n          loadedManifest: manifest,\n          canvasIndex: 2,\n          thumbnailNavigationPosition: 'far-bottom',\n        }],\n        window: {\n          allowClose: false,\n          allowMaximize: false,\n          defaultSideBarPanel: 'info',\n          defaultView: 'single',\n          sideBarOpenByDefault: true,\n        },\n        thumbnailNavigation: {\n          defaultPosition: 'off',\n        },\n        workspace: {\n          type: 'mosaic', // Which workspace type to load by default. Other possible values are \"elastic\"\n        },\n        workspaceControlPanel: {\n          enabled: true,\n        }\n      }\n\n      this.store.dispatch(actions.setConfig(settings2));\n      this.store.dispatch(actions.fetchManifest(manifest))\n      this.store.dispatch(actions.addWindow({canvasIndex: 1, sideBarOpen: false, sideBarPanel: false}))\n      this.setState({store: this.store})\n//\n//       function select(state, manifest) {\n//         return state.manifests[manifest].isFetching\n//       }\n//\n//       let isFetching = true\n//\n//       function handleChange() {\n//         isFetching = select(store.getState())\n// console.log(\"isFetching\", isFetching)\n//         if (!isFetching) {\n//\n//           store.dispatch(actions.setCanvas(\"http://scta.info/iiif/lon/canvas/L11v\", 0))\n//         }\n//       }\n//\n//       const unsubscribe = store.subscribe(handleChange)\n//       unsubscribe()\n\n\n\n\n\n\n  }\n  componentWillReceiveProps(){\n    // manifest id should be retrieved from query\n    // this is a temporary measure until db is corrected and query is posible\n    const manifest = \"http://scta.info/iiif/\" + this.props.topLevel.split(\"/resource/\")[1] + \"/\" + this.props.surfaceid.split(\"/resource/\")[1].split(\"/\")[0] + \"/\" + \"manifest\";\n    this.store.dispatch(actions.fetchManifest(manifest))\n    this.store.dispatch(actions.addWindow({canvasIndex: 1, sideBarOpen: false, sideBarPanel: false}))\n  }\n  render() {\n    return (\n      <div id=\"App\">\n        <Provider store={this.state.store}>\n          <PluginProvider plugins={[]} createRootReducer={createRootReducer}>\n            <MiradorApp />\n          </PluginProvider>\n        </Provider>\n      </div>\n    );\n  }\n\n}\n\nexport default Surface;\n","import React from 'react';\n\nfunction Image(props) {\n  const coordsSplitArray = props.coords.split(\",\")\n  const x = parseInt(coordsSplitArray[0]) - 20\n  const y = coordsSplitArray[1]\n  const w = parseInt(coordsSplitArray[2]) + 40\n  const h = coordsSplitArray[3]\n  console.log(props.coords)\n  const newCoords = x + \",\" + y + \",\" + w + \",\" + h\n  console.log(newCoords)\n  const imageLink = props.imageUrl + \"/\" + newCoords + \"/\" + props.displayWidth + \",/0/default.jpg\"\n  return (\n    <img src={imageLink}/>\n  );\n}\n\nexport default Image;\n","import React from 'react';\n\nfunction LineText(props) {\n  return (\n    <div className=\"text\" style={{\"white-space\": \"nowrap\"}}>\n     <span dangerouslySetInnerHTML={{__html: props.text}} />\n    </div>\n  );\n}\n\nexport default LineText;\n","// Note this component is a near duplicate of Image Text Wrapper in Paleographinator\n// TODO: This shoud be the target for a refactored independent React Component\n\nimport React, { Component } from 'react';\nimport Image from './Image';\nimport LineText from './LineText';\n\nclass ImageTextWrapper extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      searchText: \"\"\n    }\n  }\n  render() {\n    const getClass = () => {\n      if (this.props.targetLabel === this.props.label){\n        return \"target\"\n      }\n    }\n    return (\n      <div className=\"ImageTextWrapper\" className={getClass()}>\n        <div className=\"labelImageWrapper\">\n\n        <Image\n          imageUrl={this.props.imageUrl}\n          canvas={this.props.canvas}\n          coords={this.props.coords}\n          canvasShort={this.props.canvasShort}\n          displayWidth={this.props.displayWidth}\n          />\n        </div>\n        <LineText text={this.props.text}/>\n      </div>\n    );\n  }\n}\n\nexport default ImageTextWrapper;\n","//note; each query here represents an attempt an efficient single request for related information\n//each query therefore could be tranformed into a restful api\n\n\n export function getRelatedExpressions(itemExpressionUri){\n   const query = [\n     \"SELECT DISTINCT ?isRelatedTo ?label \",\n     \"WHERE { \",\n     \"{\",\n     \"<\" + itemExpressionUri + \"> ?o ?isRelatedTo .\",\n     \"?o a <http://scta.info/resource/textRelation> .\",\n     \"?o <http://www.w3.org/1999/02/22-rdf-syntax-ns#label> ?label . \",\n     \"?isRelatedTo a <http://scta.info/resource/expression> .\",\n     \"}\",\n     \"UNION\",\n     \"{\",\n     \"<\" + itemExpressionUri + \"> ?o ?p .\",\n     \"?o a <http://scta.info/resource/textRelation> .\",\n     \"?o <http://www.w3.org/1999/02/22-rdf-syntax-ns#label> ?label . \",\n     \"?p a <http://scta.info/resource/quotation> .\",\n     \"?p <http://scta.info/property/source> ?isRelatedTo .\",\n     \"}\",\n     \"}\"\n   ].join('');\n     return query\n }\n//get Related Expressions\n// export function getRelatedExpressions(itemExpressionUri){\n//   const query = [\n//     \"SELECT DISTINCT ?isRelatedTo \",\n//     \"WHERE { \",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/isRelatedTo> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/quotes> ?quote .\",\n//     \"?quote a <http://scta.info/resource/quotation> .\",\n//     \"?quote <http://scta.info/property/source> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/quotes> ?quote .\",\n//     \"?quote a <http://scta.info/resource/expression> .\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/quotes> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/quotedBy> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/abbreviates> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/abbreviatedBy> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/references> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/referencedBy> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/copies> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/isCopiedBy> ?isRelatedTo .\",\n//     \"}\",\n//     \"}\"\n//   ].join('');\n//\n//     return query\n// }\n\n// query info block, division, or item (possible also collection)\nexport function basicInfoQuery(itemExpressionUri){\n  const query = [\n    \"SELECT DISTINCT ?title ?structureType ?cmanifestation ?cmanifestationTitle ?manifestation ?manifestationTitle ?ctranscription ?manifestationCTranscription ?cdoc ?cxml ?expressionShortId ?longTitle ?topLevelExpression ?next ?previous ?inbox \",\n    \"WHERE { \",\n    \"<\" + itemExpressionUri + \"> <http://purl.org/dc/elements/1.1/title> ?title .\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/structureType> ?structureType .\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/hasCanonicalManifestation> ?cmanifestation .\",\n    \"?cmanifestation <http://purl.org/dc/elements/1.1/title> ?cmanifestationTitle .\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/hasManifestation> ?manifestation .\",\n    \"?manifestation <http://purl.org/dc/elements/1.1/title> ?manifestationTitle .\",\n    \"?manifestation <http://scta.info/property/hasCanonicalTranscription> ?manifestationCTranscription .\",\n    \"?cmanifestation <http://scta.info/property/hasCanonicalTranscription> ?ctranscription .\",\n    \"?ctranscription <http://scta.info/property/hasDocument> ?cdoc . \",\n    \"?ctranscription <http://scta.info/property/hasXML> ?cxml . \",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/shortId> ?expressionShortId .\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/longTitle> ?longTitle .\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/isPartOfTopLevelExpression> ?topLevelExpression .\",\n    \"OPTIONAL {\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/next> ?next .\",\n    \"}\",\n    \"OPTIONAL {\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/previous> ?previous .\",\n    \"}\",\n    \"<\" + itemExpressionUri + \"> <http://www.w3.org/ns/ldp#inbox> ?inbox . \",\n    \"}\",\n    \"ORDER BY ?title\"].join('');\n\n    return query\n  }\n\n  export function itemTranscriptionInfoQuery(itemTranscriptionUri){\n    const query = [\n      \"SELECT DISTINCT ?title ?manifestation ?doc ?xml ?expression ?expressionShortId ?longTitle ?topLevelExpression ?next ?previous ?inbox ?t \",\n      \"WHERE { \",\n      \"BIND(<\" + itemTranscriptionUri + \"> as ?t) . \",\n      \"?t <http://purl.org/dc/elements/1.1/title> ?title .\",\n      \"?t <http://scta.info/property/isTranscriptionOf> ?manifestation .\",\n      \"?t <http://scta.info/property/hasDocument> ?doc . \",\n      \"?t <http://scta.info/property/hasXML> ?xml . \",\n      \"?manifestation <http://scta.info/property/isManifestationOf> ?expression .\",\n      \"?expression <http://purl.org/dc/elements/1.1/title> ?expressionTitle .\",\n      \"?expression <http://scta.info/property/shortId> ?expressionShortId .\",\n      \"?expression <http://scta.info/property/longTitle> ?longTitle .\",\n      \"?expression <http://scta.info/property/isPartOfTopLevelExpression> ?topLevelExpression .\",\n      \"OPTIONAL {\",\n      \"?expression <http://scta.info/property/next> ?next .\",\n      \"}\",\n      \"OPTIONAL {\",\n      \"?expression <http://scta.info/property/previous> ?previous .\",\n      \"}\",\n      \"?expression <http://www.w3.org/ns/ldp#inbox> ?inbox . \",\n      \"}\",\n      \"ORDER BY ?expressionTitle\"].join('');\n\n      return query\n    }\n  // gets all structure items with basic item information\n  export function basicStructureAllItemsInfoQuery(topLevelExpressionUrl){\n    const query = [\n      \"SELECT DISTINCT ?item ?itemTitle ?topLevel ?itemQuestionTitle ?cm ?cmTitle ?ct ?next ?previous ?itemType ?doc \",\n      \"WHERE { \",\n      \"<\" + topLevelExpressionUrl + \"> <http://scta.info/property/hasStructureItem> ?item .\",\n      \"?item <http://scta.info/property/isPartOfTopLevelExpression> ?topLevel .\",\n      \"?item <http://purl.org/dc/elements/1.1/title> ?itemTitle .\",\n      \"?item <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?itemType . \",\n      \"OPTIONAL {\",\n      \"?item <http://scta.info/property/questionTitle> ?itemQuestionTitle .\",\n      \"}\",\n      \"OPTIONAL\",\n      \"{\",\n      \"?item <http://scta.info/property/next> ?next .\",\n      \"}\",\n      \"OPTIONAL\",\n      \"{\",\n      \"?item <http://scta.info/property/previous> ?previous .\",\n      \"}\",\n      \"?item <http://scta.info/property/hasCanonicalManifestation> ?cm .\",\n      \"?item <http://scta.info/property/totalOrderNumber> ?totalOrderNumber .\",\n      \"?cm <http://purl.org/dc/elements/1.1/title> ?cmTitle .\",\n      \"?cm <http://scta.info/property/hasCanonicalTranscription> ?ct .\",\n      \"?ct <http://scta.info/property/hasDocument> ?doc .\",\n      \"}\",\n      \"ORDER BY ?totalOrderNumber\"].join('');\n      return query\n    }\n    // gets all parts\n    export function partsInfoQuery(resourceurl){\n      const query = [\n        \"SELECT DISTINCT ?part ?partTitle ?partQuestionTitle ?partType ?partLevel \",\n        \"WHERE { \",\n        \"<\" + resourceurl + \"> <http://purl.org/dc/terms/hasPart> ?part .\",\n        \"?part <http://purl.org/dc/elements/1.1/title> ?partTitle .\",\n        \"?part <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?partType . \",\n        \"OPTIONAL {\",\n        \"?part <http://scta.info/property/questionTitle> ?partQuestionTitle .\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?part <http://scta.info/property/level> ?partLevel .\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?part <http://scta.info/property/totalOrderNumber> ?totalOrderNumber .\",\n        \"}\",\n        \"}\",\n        \"ORDER BY ?totalOrderNumber\"].join('');\n        return query\n      }\n    // gets all expressions for work Group\n    export function workGroupExpressionQuery(resourceurl){\n      const query = [\n        \"SELECT DISTINCT ?item ?itemTitle ?itemAuthor ?itemAuthorTitle ?itemType \",\n        \"WHERE { \",\n        \"<\" + resourceurl + \"> <http://scta.info/property/hasExpression> ?item .\",\n        \"?item <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?itemType . \",\n        \"?item <http://purl.org/dc/elements/1.1/title> ?itemTitle .\",\n        \"?item <http://www.loc.gov/loc.terms/relators/AUT> ?itemAuthor .\",\n        \"?itemAuthor <http://purl.org/dc/elements/1.1/title> ?itemAuthorTitle .\",\n        \"}\"].join('');\n        return query\n      }\n\n  export function getItemTranscription(resourceurl){\n    const query = [\n      \"SELECT DISTINCT ?ctranscription \",\n      \"WHERE { \",\n        \"{\",\n          \"<\" + resourceurl + \"> <http://scta.info/property/hasCanonicalManifestation> ?cmanifestation . \",\n          \"?cmanifestation <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . \",\n        \"}\",\n        \"UNION\",\n        \"{\",\n          \"<\" + resourceurl + \"> <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . \",\n        \"}\",\n      \"}\"].join('');\n      return query\n  }\n  export function getItemTranscriptionFromBlockDiv(resourceurl){\n    const query = [\n      \"SELECT DISTINCT ?ctranscription ?blockDivExpression \",\n      \"WHERE { \",\n        \"OPTIONAL\",\n        \"{\",\n        \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfStructureItem> ?itemParent . \",\n        \"{\",\n          \"{\",\n            \"?itemParent <http://scta.info/property/hasCanonicalManifestation> ?cmanifestation . \",\n            \"?cmanifestation <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . \",\n          \"}\",\n          \"UNION\",\n          \"{\",\n            \"?itemParent <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . \",\n          \"}\",\n        \"}\",\n        \"}\",\n        \"OPTIONAL\",\n        \"{\",\n        \"{\",\n          \"{\",\n            \"<\" + resourceurl + \"> <http://scta.info/property/isManifestationOf> ?blockDivExpression . \",\n          \"}\",\n          \"UNION\",\n          \"{\",\n            \"<\" + resourceurl + \"> <http://scta.info/property/isTranscriptionOf> ?blockDivManifestation . \",\n            \"?blockDivManifestation <http://scta.info/property/isManifestationOf> ?blockDivExpression . \",\n          \"}\",\n        \"}\",\n        \"}\",\n      \"}\"].join('');\n      return query\n  }\n  //TODO rename to getType\n  export function getStructureType(resourceurl){\n    const query = [\n      \"SELECT DISTINCT ?type ?structureType ?level ?topLevel ?itemParent \",\n      \"WHERE { \",\n      \"<\" + resourceurl + \"> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?type . \",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/structureType> ?structureType . \",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/level> ?level . \",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfTopLevelExpression> ?topLevel . \",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfTopLevelManifestation> ?topLevel . \",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfTopLevelTransription> ?topLevel . \",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfStructureItem> ?itemParent . \",\n      \"}\",\n      \"}\"].join('');\n      return query\n    }\n  //surface id query, gets canvas and manifestation\n  export function getSurfaceInfo(surfaceid){\n    const query = [\n      \"SELECT DISTINCT ?surfaceTitle ?c_height ?c_width ?isurface ?isurfaceTitle ?icodexTitle ?canvas ?imageurl ?next_surface ?previous_surface \",\n        \"{\",\n  \t\t\t\t\"<\" + surfaceid + \"> <http://purl.org/dc/elements/1.1/title> ?surfaceTitle .\",\n  \t\t\t\t\"<\" + surfaceid + \"> <http://scta.info/property/hasISurface> ?isurface .\",\n  \t\t\t\t\"OPTIONAL {\",\n  \t\t\t\t\t\"<\" + surfaceid + \"> <http://scta.info/property/next> ?next_surface .\",\n  \t\t\t\t\"}\",\n  \t\t\t\t\"OPTIONAL {\",\n  \t\t\t\t\t\"<\" + surfaceid + \"> <http://scta.info/property/previous> ?previous_surface .\",\n          \"}\",\n  \t\t\t\t\"OPTIONAL {\",\n  \t\t\t\t\t\"?isurface <http://purl.org/dc/elements/1.1/title> ?isurfaceTitle .\",\n  \t\t\t\t\t\"?isurface <http://purl.org/dc/elements/1.1/isPartOf> ?icodex .\",\n  \t\t\t\t\t\"?icodex <http://purl.org/dc/elements/1.1/title> ?icodexTitle .\",\n  \t\t\t\t\"}\",\n  \t\t\t\t\"?isurface <http://scta.info/property/hasCanvas> ?canvas .\",\n  \t\t\t\t\"OPTIONAL{\",\n  \t\t\t\t\t\"?canvas <http://iiif.io/api/presentation/2#hasImageAnnotations> ?blank .\",\n  \t\t\t\t\"}\",\n  \t\t\t\t\"OPTIONAL{\",\n  \t\t\t\t\t\"?canvas <http://www.shared-canvas.org/ns/hasImageAnnotations> ?blank .\",\n  \t\t\t\t\"}\",\n  \t\t\t\t\"?canvas <http://www.w3.org/2003/12/exif/ns#width> ?c_width .\",\n  \t\t\t\t\"?canvas <http://www.w3.org/2003/12/exif/ns#height> ?c_height .\",\n  \t\t     \"?blank <http://www.w3.org/1999/02/22-rdf-syntax-ns#first> ?o .\",\n  \t\t     \"?o <http://www.w3.org/ns/oa#hasBody> ?o2 .\",\n  \t\t    \"OPTIONAL{\",\n  \t\t\t\t\t \"?o2 <http://rdfs.org/sioc/services#has_service> ?imageurl .\",\n  \t\t\t\t \"}\",\n  \t\t\t\t \"OPTIONAL{\",\n  \t\t\t\t\t \"?o2 <http://www.shared-canvas.org/ns/hasRelatedService> ?imageurl .\",\n  \t\t\t\t \"}\",\n        \"}\"].join('');\n      return query\n    }\n\n//surface id query, gets canvas and manifestation\nexport function getAuthorInformation(authorid){\n    const query = [\n      \"CONSTRUCT\",\n      \"{\",\n      \"?author  <http://purl.org/dc/elements/1.1/title> ?authorTitle ;\",\n      \"<http://scta.info/resource/hasTopLevelExpression> ?expression ;\",\n      \"<http://scta.info/property/authorArticle> ?authorArticle;\",\n      \"<http://scta.info/property/textArticle> ?textArticle .\",\n    \t\"?authorArticle <http://purl.org/dc/elements/1.1/title> ?authorArticleTitle . \",\n      \"?textArticle <http://purl.org/dc/elements/1.1/title> ?textArticleTitle . \",\n    \t\"?expression <http://purl.org/dc/elements/1.1/title> ?topLevelExpressionTitle .\",\n      \"}\",\n      \"WHERE \",\n      \"{\",\n      \"<\" + authorid + \"> <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n      \"BIND(<\" + authorid + \"> as ?author) . \",\n      \"?expression <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n      \"?expression a <http://scta.info/resource/expression> .\",\n      \"?expression <http://scta.info/property/level> '1' .\",\n      \"?expression <http://purl.org/dc/elements/1.1/title> ?topLevelExpressionTitle .\",\n      \"?expression2 <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n      \"?textArticle <http://scta.info/property/isArticleOf> ?expression2 .\",\n      \"?textArticle <http://purl.org/dc/elements/1.1/title> ?textArticleTitle .\",\n      \"?authorArticle <http://scta.info/property/isArticleOf> ?author .\",\n      \"?authorArticle <http://purl.org/dc/elements/1.1/title> ?authorArticleTitle\",\n      \"}\"].join('');\n      return query\n      }\n\n  export function versionHistoryInfo(transcriptionUri){\n     \t \tconst query = [\n     \t \t\t\"SELECT ?version ?version_shortId ?order_number ?version_label ?review ?doc\",\n     \t    \"{\",\n            \"{\",\n               \"BIND(<\" + transcriptionUri + \"> as ?version) . \",\n     \t         \"?version <http://scta.info/property/shortId> ?version_shortId .\",\n               \"?version <http://scta.info/property/hasDocument> ?doc . \",\n     \t         \"?version <http://scta.info/property/versionOrderNumber> ?order_number .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/versionLabel> ?version_label .\",\n     \t\t\t\t\t \"OPTIONAL {\",\n     \t\t\t\t\t \t\"?version <http://scta.info/property/hasReview> ?review .\",\n     \t\t\t\t   \"}\",\n     \t\t\t\t \"}\",\n     \t       \"UNION\",\n            \"{\",\n     \t         \"<\" + transcriptionUri + \"> <http://scta.info/property/hasAncestor> ?version .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/shortId> ?version_shortId .\",\n               \"?version <http://scta.info/property/hasDocument> ?doc . \",\n     \t         \"?version <http://scta.info/property/versionOrderNumber> ?order_number .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/versionLabel> ?version_label .\",\n     \t\t\t\t\t \"OPTIONAL {\",\n     \t\t\t\t\t \t\"?version <http://scta.info/property/hasReview> ?review .\",\n     \t\t\t\t   \"}\",\n     \t\t\t\t \"}\",\n     \t       \"UNION\",\n     \t       \"{\",\n     \t         \"<\" + transcriptionUri + \"> <http://scta.info/property/hasDescendant> ?version .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/shortId> ?version_shortId .\",\n               \"?version <http://scta.info/property/hasDocument> ?doc . \",\n     \t         \"?version <http://scta.info/property/versionOrderNumber> ?order_number .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/versionLabel> ?version_label .\",\n     \t\t\t\t\t \"OPTIONAL {\",\n     \t\t\t\t\t \t\"?version <http://scta.info/property/hasReview> ?review .\",\n     \t\t\t\t   \"}\",\n     \t\t\t\t \"}\",\n     \t     \"}\",\n     \t     \"ORDER BY DESC(?order_number)\"].join('');\n           return query\n           }\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport Axios from 'axios'\n\nimport ImageTextWrapper from './ImageTextWrapper';\n\nimport {runQuery} from './utils'\nimport {getSurfaceInfo} from './Queries'\n\n\n\nclass Surface2 extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleNext = this.handleNext.bind(this)\n    this.handlePrevious = this.handlePrevious.bind(this)\n    this.handleToggleTextLines = this.handleToggleTextLines.bind(this)\n    this.state = {\n      currentSurfaceId: \"\",\n      manifest: \"\",\n      canvas: \"\",\n      region: \"full\",\n      width: \"1000\",\n      next: \"\",\n      previous: \"\",\n      imageurl: \"\",\n      annotationsDisplay: true\n    }\n\n  }\n  handleNext(){\n    //this.retrieveSurfaceInfo(this.state.next)\n    this.props.handleSurfaceFocusChange(this.state.next)\n  }\n  handlePrevious(){\n    //this.retrieveSurfaceInfo(this.state.previous)\n    this.props.handleSurfaceFocusChange(this.state.previous)\n\n  }\n  handleToggleTextLines(){\n    //this.retrieveSurfaceInfo(this.state.previous)\n    this.setState((prevState) => {\n      return {annotationsDisplay: !prevState.annotationsDisplay}\n    })\n  }\n  retrieveSurfaceInfo(surfaceid){\n    console.log('surfaceid', surfaceid)\n    // manifest id should be retrieved from query\n    // this is a temporary measure until db is corrected and query is posible\n\n    const manifest = \"http://scta.info/iiif/\" + this.props.topLevel.split(\"/resource/\")[1] + \"/\" + surfaceid.split(\"/resource/\")[1].split(\"/\")[0] + \"/\" + \"manifest\";\n    const surfaceInfo = runQuery(getSurfaceInfo(surfaceid))\n    surfaceInfo.then((d) => {\n      const b = d.data.results.bindings[0]\n      //second nested async call for annotation list\n      const alUrl = \"https://exist.scta.info/exist/apps/scta-app/folio-annotaiton-list-from-simpleXmlCoordinates.xq?surfaceid=\" + surfaceid.split(\"/resource/\")[1]\n      Axios.get(alUrl).then((d2) => {\n        const resources = d2.data.resources\n          this.setState({\n          currentSurfaceId: surfaceid,\n          surfaceTitle: b.surfaceTitle.value,\n          manifest: manifest,\n          canvas: b.canvas.value,\n          imageurl: b.imageurl.value,\n          next: b.next_surface ? b.next_surface.value : \"\",\n          previous: b.previous_surface ? b.previous_surface.value : \"\",\n          annotations: d2.data ? d2.data.resources : \"\"\n        })\n      }).catch((error) => {\n        console.log(\"failed retrieving annotationlist: \", error)\n        this.setState({\n        currentSurfaceId: surfaceid,\n        surfaceTitle: b.surfaceTitle.value,\n        manifest: manifest,\n        canvas: b.canvas.value,\n        imageurl: b.imageurl.value,\n        next: b.next_surface ? b.next_surface.value : \"\",\n        previous: b.previous_surface ? b.previous_surface.value : \"\",\n        annotations: \"\"\n      })\n    })\n  })\n}\ncomponentDidMount(){\n    if (this.props.surfaceid){\n      console.log('surfaceid', this.props.surfaceid)\n      this.retrieveSurfaceInfo(this.props.surfaceid)\n    }\n  }\n  componentWillReceiveProps(nextProps){\n    if (nextProps.surfaceid){\n    this.retrieveSurfaceInfo(nextProps.surfaceid)\n    }\n  }\n  render() {\n    const displayImages = () => {\n      if (this.state.annotations && this.state.annotationsDisplay){\n        const imageTextWrappers = this.state.annotations.map((h, i) => {\n          const text = h.resource.chars;\n          const canvas = h.on.split(\"#xywh=\")[0];\n          const canvasShort = canvas.split(\"/\")[canvas.split(\"/\").length - 1];\n          const coords = h.on.split(\"#xywh=\")[1];\n          const imageUrl = h.imageUrl\n          const label = h.label\n          const match = label === this.props.targetLabel ? true : false\n          return (\n            <ImageTextWrapper key={i}\n              imageUrl={imageUrl}\n              canvas={canvas}\n              coords={coords}\n              canvasShort={canvasShort}\n              text={text}\n              label={label}\n              targetLabel={this.props.targetLabel}\n              surfaceButton={false}\n              displayWidth=\"1000\"\n              />\n            )\n\n        })\n        return imageTextWrappers\n      }\n      else{\n        return <img src={this.state.imageurl + \"/\" + this.state.region + \"/\" + this.state.width + \",/0/default.jpg\"}/>\n      }\n    }\n    return (\n      <Container className={this.props.hidden ? \"hidden\" : \"showing\"}>\n      {this.state.currentSurfaceId ?\n        <div>\n          <div className=\"surface-navigation\">\n            <p>{this.state.surfaceTitle}</p>\n            {this.state.previous && <p><a onClick={this.handlePrevious}>Previous</a></p>}\n            {this.state.next && <p><a onClick={this.handleNext}>Next</a></p>}\n            {this.state.annotations && <p><a onClick={this.handleToggleTextLines}>Toggle Text Lines</a></p>}\n          </div>\n          {displayImages()}\n        </div> : <p>No surface selected</p>}\n      </Container>\n\n    );\n  }\n\n}\n\nexport default Surface2;\n","import React from 'react';\nimport Axios from 'axios'\nimport { Light as SyntaxHighlighter } from 'react-syntax-highlighter';\nimport xml from 'react-syntax-highlighter/dist/esm/languages/hljs/xml';\nimport { docco } from 'react-syntax-highlighter/dist/esm/styles/hljs';\n\nimport {loadXMLDoc, nsResolver} from './utils'\n//SyntaxHighlighter.registerLanguage('xml', xml);\nclass XmlView extends React.Component {\n\n  constructor(props){\n    super(props)\n    this.retrieveXML = this.retrieveXML.bind(this)\n    this.state = {\n      xmlstring: \"\"\n    }\n  }\n  retrieveXML(info){\n\n    //construct file url request ot exist db to get a cors enabled copy of the text (github does not serve files with cors enabled)\n    // const doc = info.cdoc\n    // const topLevel = info.topLevel\n    // const docFragment = doc.split(\"/master/\")[1]\n    // const topLevelFragment = info.topLevel.split(\"/resource/\")[1]\n\n    //const xmlurl = \"http://exist.scta.info/exist/apps/scta-app/text/\" + topLevelFragment + \"/\" + docFragment;\n    const xmlurl = info.cxml\n    // const xmlDoc = loadXMLDoc(xmlurl)\n    // console.log(\"xmlDoc\", xmlDoc, info.resourceid)\n    // const p = xmlDoc.evaluate(\"//tei:p[@xml:id='\" + info.resourceid + \"']\", xmlDoc, nsResolver, XPathResult.ANY_TYPE, null);\n    // console.log(\"paragraph\", p)\n    Axios.get(xmlurl).then((d) => {\n\n      this.setState({xmlstring: d.data})\n    })\n\n  }\n  componentDidMount(){\n    this.retrieveXML(this.props.info)\n\n  }\n  componentWillReceiveProps(nextProps){\n    this.retrieveXML(nextProps.info)\n  }\n\n  render(){\n    const codeString = '<xml><div>Test</div></xml>';\n    return (\n      <div className={this.props.hidden ? \"hidden\" : \"showing\"}>\n      <SyntaxHighlighter language=\"xml\" style={docco} showLineNumbers>\n        {this.state.xmlstring}\n      </SyntaxHighlighter>\n      </div>\n    )\n  }\n}\n\nexport default XmlView;\n","import React from 'react';\nimport Axios from \"axios\"\n\nimport {Link} from 'react-router-dom';\n\nclass Info extends React.Component {\n  constructor(props){\n    super(props)\n\n\n  }\n\n  componentDidMount(){\n\n\n  }\n  componentWillReceiveProps(newProps){\n\n  }\n\n  render(){\n    const displayRelatedExpressions = () => {\n      if (this.props.info.relatedExpressions){\n        const relatedExpressions = this.props.info.relatedExpressions.map((r) => {\n          return <p key={r.resourceid}>{r.relationLabel} <Link to={\"/text?resourceid=\" + r.resourceid}>{r.resourceid}</Link></p>\n        })\n        return relatedExpressions\n      }\n    }\n    const displayManifestations = () => {\n      if (this.props.info){\n        const manifestations = this.props.info.manifestations.map((i) => {\n          return <p key={i.manifestation}>{i.manifestationTitle} : <Link to={\"/text?resourceid=\" + i.manifestation}>{i.manifestation}</Link></p>\n        })\n        return manifestations\n      }\n    }\n    const displayInfo = () => {\n      if (this.props.info){\n        return(\n          <div>\n          <p key=\"id\">Resourceid: {this.props.info.resourceid.includes('http') ? this.props.info.resourceid : \"http://scta.info/resource/\" + this.props.info.resourceid}</p>\n          <p key=\"inbox\">LDN Inbox: {this.props.info.inbox}</p>\n          </div>\n        )\n      }\n    }\n  return (\n\n    <div className={this.props.hidden ? \"hidden\" : \"showing\"}>\n      <h1>Info</h1>\n      {displayInfo()}\n      <div>\n      <p>Manifestations</p>\n      {displayManifestations()}\n      </div>\n      <div>\n      <p>Related Expression</p>\n      {displayRelatedExpressions()}\n      </div>\n\n\n\n    </div>\n    );\n  }\n}\n\nexport default Info;\n","import React from 'react';\nimport {NavLink} from 'react-router-dom';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\n\nimport { FaTimes, FaSearch, FaGripVertical, FaCode, FaInfo, FaRegImage, FaAngleDoubleDown, FaAngleDoubleLeft, FaComments, FaRegWindowRestore, FaRegWindowMaximize, FaRegWindowMinimize, FaRegWindowClose} from 'react-icons/fa';\n\n\nimport {resourceEndpoint} from './config';\n\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\n\n\nfunction WindowNavBar(props) {\n\n  return (\n  <Nav variant=\"tabs\">\n  {\n    //<Navbar.Brand href=\"/\">Focus: {props.focus}</Navbar.Brand>\n  }\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleTabChange(\"info\", props.windowId)}}><FaInfo/></Nav.Link>\n  </Nav.Item>\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleTabChange(\"surface2\", props.windowId)}}><FaRegImage/></Nav.Link>\n  </Nav.Item>\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleTabChange(\"xml\", props.windowId)}}><FaCode/></Nav.Link>\n  </Nav.Item>\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleTabChange(\"textCompare\", props.windowId)}}><FaGripVertical/></Nav.Link>\n  </Nav.Item>\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleTabChange(\"search\", props.windowId)}}><FaSearch/></Nav.Link>\n  </Nav.Item>\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleTabChange(\"comments\", props.windowId)}}><FaComments/></Nav.Link>\n  </Nav.Item>\n  {props.openWidthHeight != \"minimum\" &&\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleMinimize(props.windowId)}}><FaRegWindowMinimize/></Nav.Link>\n  </Nav.Item>}\n  {props.openWidthHeight != \"middle\" &&\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleMiddlize(props.windowId)}}><FaRegWindowRestore/></Nav.Link>\n  </Nav.Item>\n  }\n  {props.openWidthHeight != \"maximum\" &&\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleMaximize(props.windowId)}}><FaRegWindowMaximize/></Nav.Link>\n  </Nav.Item>\n  }\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleClose(props.windowId)}}><FaRegWindowClose/></Nav.Link>\n  </Nav.Item>\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleSwitchWindow(props.windowId, props.windowType)}}>{props.windowType === \"sideWindow\" ? <FaAngleDoubleDown/> : <FaAngleDoubleLeft/>}</Nav.Link>\n  </Nav.Item>\n\n\n</Nav>\n\n  );\n}\n\nexport default WindowNavBar;\n","import React from 'react';\n\nimport { FaAngleLeft, FaAngleRight} from 'react-icons/fa';\n\nimport {NavLink} from 'react-router-dom';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\n\nfunction NextPrevBar(props) {\n  return (\n    <Nav variant=\"tabs\">\n    <Nav.Link onClick={() => {props.handleBlockFocusChange(props.info.resourceid)}}>{props.info.title}</Nav.Link>\n    <Nav.Item>\n      {props.info.previous && <Nav.Link onClick={() => {props.handleBlockFocusChange(props.info.previous)}}><FaAngleLeft/></Nav.Link>}\n    </Nav.Item>\n    <Nav.Item>\n      {props.info.next && <Nav.Link onClick={() => {props.handleBlockFocusChange(props.info.next)}}><FaAngleRight/></Nav.Link>}\n    </Nav.Item>\n\n    </Nav>\n  );\n}\n\nexport default NextPrevBar;\n","import React from 'react';\nimport Diff from 'diff-match-patch'\nimport Axios from 'axios'\nimport {Link} from 'react-router-dom';\n\nimport { FaEyeSlash, FaEye, FaStar } from 'react-icons/fa';\n\nclass TextCompareItem extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleToggleShow = this.handleToggleShow.bind(this)\n    this.mounted = \"\"\n    this.state = {\n      compareText: \"\",\n      rawText: \"\",\n      show: true\n    }\n  }\n  handleToggleShow(){\n    this.setState((prevState) => {\n      return{\n        show: !prevState.show\n      }\n    })\n  }\n  createCompare(base, transcription){\n\n    Axios.get(\"http://exist.scta.info/exist/apps/scta-app/csv-pct.xq?resourceid=\" + transcription)\n          .then((text) => {\n\n            const dmp = new Diff.diff_match_patch();\n\n            const diff = dmp.diff_main(base, text.data);\n            // Result: [(-1, \"Hell\"), (1, \"G\"), (0, \"o\"), (1, \"odbye\"), (0, \" World.\")]\n            dmp.diff_cleanupSemantic(diff);\n            const ds = dmp.diff_prettyHtml(diff);\n            if (this.mounted === true && base){\n              this.setState({compareText: ds, rawText: text.data})\n            }\n\n          })\n        }\n\n  componentDidMount(){\n    this.mounted = true;\n    this.setState({rawText: \"\", compareText: \"\"})\n    this.createCompare(this.props.base, this.props.compareTranscription)\n  }\n  componentWillReceiveProps(newProps){\n    // conditional try to restrict new async calls to only when props.info changes\n    if (newProps.base !== this.props.base || newProps.compareTranscription !== this.props.compareTranscription){\n      this.setState({rawText: \"\", compareText: \"\"})\n      this.createCompare(newProps.base, newProps.compareTranscription)\n    }\n  }\n  componentWillUnmount(){\n      this.mounted = false;\n    }\n\n\n  render(){\n    const displayComparison = () => {\n      if (this.props.base && this.state.compareText){\n        return (\n          <div>\n            <span><Link to={\"/text?resourceid=\" + this.props.compareTranscription}>{this.props.compareTranscription}</Link></span>\n            <span onClick={() => this.handleToggleShow()}>{this.state.show ? <FaEyeSlash/> : <FaEye/>}</span>\n            <span onClick={() => this.props.handleChangeBase(this.state.rawText)}><FaStar/></span>\n            <div className={this.state.show ? \"unhidden\" : \"hidden\"}>\n              <div ref=\"text\" dangerouslySetInnerHTML={{ __html: this.state.compareText}}></div>\n            </div>\n          </div>\n        )\n      }\n      else{\n        return <p>Loading</p>\n      }\n    }\n\n    return (\n      displayComparison()\n    );\n  }\n}\n\nexport default TextCompareItem;\n","import React from 'react';\nimport Diff from 'diff-match-patch'\nimport Axios from 'axios'\nimport {Link} from 'react-router-dom';\nimport { FaEyeSlash, FaEye } from 'react-icons/fa';\n\n\n\nimport {runQuery} from './utils'\nimport {basicInfoQuery} from './Queries'\n\n\nimport TextCompareItem from './TextCompareItem'\n\n\n\nclass TextCompare extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleToggleShowAll = this.handleToggleShowAll.bind(this)\n    this.mounted = \"\"\n    this.state = {\n      info: \"\",\n      show: false,\n      baseText: \"\"\n    }\n\n  }\n\n  handleToggleShowAll(){\n    this.setState((prevState) => {\n      return{\n        show: !prevState.show\n      }\n    })\n  }\n\n  // TODO dupblicate of function in Text Component\n  // needs refactoring\n  arrangeTextInfo(info, resourceid){\n      info.then((d) => {\n        const bindings = d.data.results.bindings[0]\n        const manifestations = d.data.results.bindings.map((b) => {\n          return {\n            manifestation: b.manifestation.value,\n            manifestationTitle: b.manifestationTitle.value,\n            transcription: b.manifestationCTranscription.value\n          }\n        })\n        if (this.mounted === true && bindings){\n          this.setState({\n            info: {\n              resourceid: resourceid,\n              title: bindings.title.value,\n              structureType: bindings.structureType.value,\n              inbox: bindings.inbox.value,\n              next: bindings.next ? bindings.next.value : \"\",\n              previous: bindings.previous ? bindings.previous.value : \"\",\n              cdoc: bindings.cdoc.value,\n              cxml: bindings.cxml.value,\n              topLevel: bindings.topLevelExpression.value,\n              cmanifestation: bindings.cmanifestation.value,\n              ctranscription: bindings.ctranscription.value,\n              manifestations: manifestations\n            }\n          });\n        }\n      });\n    }\n  getTextInfo(id){\n    const info = runQuery(basicInfoQuery(id))\n    this.arrangeTextInfo(info, id)\n  }\n\n  componentDidMount(){\n    this.mounted = true;\n    this.setState({show: this.props.show, baseText: this.props.baseText})\n\n    if (this.props.isMainText){\n\n      this.setState({info: this.props.info})\n    }\n    else{\n      this.getTextInfo(this.props.expressionid)\n    }\n  }\n\n\n  componentWillReceiveProps(nextProps){\n    // conditional try to restrict new async calls to only when props.info changes\n    if (this.props.info.resourceid != nextProps.info.resourceid){\n      this.setState({baseText: nextProps.baseText})\n\n      if (nextProps.isMainText){\n        this.setState({info: nextProps.info})\n      }\n      else{\n        this.getTextInfo(nextProps.expressionid)\n\n      }\n    }\n  }\n    componentWillUnmount(){\n      this.mounted = false;\n  }\n\n  render(){\n    const displayComparisons = () => {\n      if (this.state.info.manifestations){\n        const texts = this.state.info.manifestations.map((m) => {\n          return (\n            <TextCompareItem\n            key={m.transcription}\n            base={this.props.baseText}\n            compareTranscription={m.transcription}\n            handleChangeBase={this.props.handleChangeBase}\n            show={this.state.show}\n            />\n          )\n        })\n        return texts\n      }\n    }\n\n  return (\n    <div>\n      {\n        // the link to reroute is not quite working, because the base Text is not resetting, focusBlockChange might be better; but item structure will also need to be changed.\n      }\n      <p><span>{this.props.relationLabel}</span> <Link to={\"/text?resourceid=\" + this.state.info.resourceid}>{this.state.info.resourceid}</Link>\n      <span onClick={() => this.handleToggleShowAll()}>{this.state.show ? <FaEyeSlash/> : <FaEye/>}</span></p>\n      <div className={this.state.show ? \"unhidden\" : \"hidden\"}>\n      {displayComparisons()}\n      </div>\n    </div>\n\n  );\n  }\n}\n\nexport default TextCompare;\n","import React from 'react';\nimport Diff from 'diff-match-patch'\nimport Axios from 'axios'\n\nimport TextCompare from './TextCompare'\n\n\nclass TextCompareWrapper extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleCompare = this.handleToggleCompare.bind(this)\n    this.handleChangeBase = this.handleChangeBase.bind(this)\n    this.getText = this.getText.bind(this)\n    this.mounted = \"\"\n    this.state = {\n      expressions: {},\n      baseText: \"\"\n    }\n\n  }\n  handleChangeBase(rawText){\n    this.setState({baseText: rawText})\n  }\n  handleToggleCompare(expressionid){\n    this.setState((prevState) => {\n      const newExpressions = {...prevState.expressions}\n      newExpressions[expressionid].show = !newExpressions[expressionid].show\n      return {\n        expressions: newExpressions\n      }\n    })\n  }\n  getText(ctranscription){\n    const _this = this;\n    Axios.get(\"http://exist.scta.info/exist/apps/scta-app/csv-pct.xq?resourceid=\" + ctranscription).\n      then((text) => {\n        _this.setState({baseText: text.data})\n      })\n    }\n\n  componentDidMount(){\n    if (this.props.info.relatedExpressions){\n      this.getText(this.props.info.ctranscription)\n      const expressions = {}\n      expressions[this.props.info.resourceid] = {id: this.props.info.resourceid, show: true}\n\n      this.props.info.relatedExpressions.forEach((r) => {\n        expressions[r.resourceid] = {id: r.resourceid, relationLabel: r.relationLabel, show: false}\n      })\n      this.setState({expressions: expressions})\n    }\n  }\n  componentWillReceiveProps(nextProps){\n    // only fire reload if \"info resource\" has changed\"\n    if (this.props.info.resourceid != nextProps.info.resourceid){\n\n    // this conditional is needed, because props are waiting on multiple async calls.\n    // when an async call finishes it will up; and the related Expression query last,\n    // it will use the old ctranscription prop overriding the the update from the prop update from the other async call\n    if (this.props.info.relatedExpressions){\n      // this conditional may no longer be necessary based on first conditional check\n      if (this.props.info.ctranscription != nextProps.info.ctranscription){\n        this.getText(nextProps.info.ctranscription)\n      }\n      const expressions = {}\n      expressions[nextProps.info.resourceid] = {id: nextProps.info.resourceid, show: true}\n      nextProps.info.relatedExpressions.forEach((r) => {\n        expressions[r.resourceid] = {id: r.resourceid, relationLabel: r.relationLabel, show: false}\n      })\n      this.setState({expressions: expressions})\n    }\n  }\n  }\n  render(){\n    const displayExpressions = () => {\n      const exObject = this.state.expressions\n      const expressions = Object.keys(exObject).map((key) => {\n        const isMainText = this.props.info.resourceid === exObject[key].id ? true : false\n        return (\n          <div key={this.state.expressions[key].id}>\n            {<TextCompare\n              info={this.props.info}\n              expressionid={exObject[key].id}\n              relationLabel={exObject[key].relationLabel}\n              isMainText={isMainText}\n              handleChangeBase={this.handleChangeBase}\n              baseText={this.state.baseText}\n              show={exObject[key].show}\n              />}\n          </div>\n        )\n      })\n      return expressions\n    }\n\n  return (\n    <div className={this.props.hidden ? \"hidden\" : \"showing\"}>\n    {displayExpressions()}\n    </div>\n\n  );\n  }\n}\n\nexport default TextCompareWrapper;\n","import React from 'react';\n\nfunction CommentItem(props) {\n  return (\n    <div className=\"comment\">\n      <p>{props.n.body.value}</p>\n      </div>\n  );\n}\n\nexport default CommentItem;\n","import React from 'react';\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\n\nclass CommentCreate extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleCommentUpdate = this.handleCommentUpdate.bind(this)\n    this.handleSubmitComment = this.handleSubmitComment.bind(this)\n    this.state = {\n      comment: \"\"\n    }\n  }\n  handleCommentUpdate(e){\n    e.preventDefault()\n    this.setState({comment: e.target.value})\n\n  }\n  handleSubmitComment(e){\n    e.preventDefault()\n    this.props.handleSumbitComment(this.state.comment)\n  }\n  render(){\n    return (\n      <div className=\"comment\">\n        <Form onSubmit={this.handleSubmitComment}>\n         <FormControl type=\"text\" id=\"comment\" placeholder=\"comment\" className=\"mr-sm-2\" onChange={this.handleCommentUpdate} />\n         <Button type=\"submit\" variant=\"outline-success\">Search</Button>\n       </Form>\n      </div>\n    );\n  }\n}\n\nexport default CommentCreate;\n","import React from 'react';\nimport Axios from 'axios'\nimport uuidv4 from 'uuid/v4'\n\nimport CommentItem from \"./CommentItem\"\nimport CommentCreate from \"./CommentCreate\"\n\nclass Comments extends React.Component {\n  constructor(props){\n  super(props)\n  this.handleSumbitComment = this.handleSumbitComment.bind(this)\n  this.state = {\n    notifications: [],\n    inbox: \"\",\n    resourceid: \"\"\n  }\n}\nhandleSumbitComment(comment){\n  const _this = this;\n\n  const randomid = uuidv4();\n  const annotat = {\n    \"@context\": \"http://www.w3.org/ns/anno.jsonld\",\n    \"id\": \"http://inbox.scta.info/notifications/\" + randomid,\n    \"type\": \"Annotation\",\n    \"motivation\": \"commenting\",\n    \"body\": {\n      \"type\": \"TextualBody\",\n      \"value\": comment\n    },\n    \"target\": this.state.resourceid\n  }\n\n  console.log(\"annotat\", annotat)\n  console.log(\"inbox\", this.state.inbox)\n  Axios({\n    method: 'post',\n    url: this.state.inbox,\n    data: annotat,\n    config: { headers: {'Content-Type': 'application/json+ld' }}\n    })\n    .then(function (response) {\n      _this.setState((prevState) => {\n        return {notifications: [annotat, ...prevState.notifications, ]}\n      });\n        //handle success\n        console.log(response);\n    })\n    .catch(function (response) {\n        //handle error\n        console.log(response);\n    });\n\n\n  }\n  retrieveComments(inbox){\n    // using callback here to make sure state is set before making second a sync call.\n    // TODO: consider using this in other components to prevent out of sync behavior\n    // especially is TextCompareComponents\n    this.setState({notifications: []}, function() {\n      Axios.get(inbox).then((d) => {\n        d.data[\"ldp:contains\"].forEach((n) => {\n          //TODO annoying that each comment has to be requestd.\n          // if inbox main list included full comment, only one request would be needed\n          Axios.get(n[\"@id\"]).then((d2) => {\n            console.log(\"d2\", d2)\n            this.setState((prevState) => {\n              return {notifications: [...prevState.notifications, d2.data]}\n            });\n          });\n        })\n      }).catch((e) => {\n        console.log(e)\n      })\n    })\n  }\n  componentDidMount(){\n    this.setState({inbox: this.props.info.inbox, resourceid: this.props.info.resourceid})\n    this.retrieveComments(this.props.info.inbox)\n  }\n  componentWillReceiveProps(newProps){\n    if (newProps.info != this.props.info){\n      this.setState({inbox: newProps.info.inbox, resourceid: newProps.info.resourceid})\n      this.retrieveComments(newProps.info.inbox)\n    }\n  }\n  render(){\n    const displayComments = () => {\n      const comments = this.state.notifications.map((n, i) => {\n        return (\n          <CommentItem key={i} n={n}/>\n        )\n      })\n      return comments\n    }\n    return (\n      <div className={this.props.hidden ? \"hidden\" : \"showing\"}>\n        <h1>Comments</h1>\n        <CommentCreate handleSumbitComment={this.handleSumbitComment}/>\n        {displayComments()}\n      </div>\n    );\n\n  }\n\n\n\n\n}\n\nexport default Comments;\n","import React from 'react';\nimport Surface from \"./Surface\"\nimport Surface2 from \"./Surface2\"\nimport XmlView from \"./XmlView\"\nimport Info from \"./Info\"\nimport WindowNavBar from \"./WindowNavBar\"\nimport NextPrevBar from \"./NextPrevBar\"\nimport TextCompareWrapper from \"./TextCompareWrapper\"\nimport SearchWrapper from \"./SearchWrapper\"\nimport Comments from \"./Comments\"\n\n\n\nclass Window extends React.Component {\n  constructor(props){\n    super(props)\n    this.state = {\n      windowLoad: \"\",\n    }\n  }\n\n  componentDidMount(){\n    this.setState({windowLoad: this.props.windowLoad})\n\n\n  }\n  componentWillReceiveProps(newProps){\n    this.setState({windowLoad: newProps.windowLoad})\n\n\n  }\n\n\n  render(){\n    const displayManifestations = () => {\n      const newManifestations = this.state.manifestations.map((m) => {return <p>{m.value}</p>})\n      return newManifestations\n    }\n    const displayChild = () => {\n      return(\n        <div>\n          {// including search wrapper here as hidden instead of above in switch, so that results don't have to be reload\n          }\n          <SearchWrapper info={this.props.info} hidden={this.state.windowLoad != \"search\"} topLevel={this.props.info.topLevel}/>\n          <TextCompareWrapper info={this.props.info} relatedExpressions={this.props.relatedExpressions} hidden={this.state.windowLoad != \"textCompare\"}/>\n          <XmlView info={this.props.info} hidden={this.state.windowLoad != \"xml\"}/>\n          <Info info={this.props.info} relatedExpressions={this.props.relatedExpressions} topLevel={this.props.topLevel} hidden={this.state.windowLoad != \"info\"}/>\n          <Surface2 surfaceid={this.props.surfaceid} topLevel={this.props.topLevel} handleSurfaceFocusChange={this.props.handleSurfaceFocusChange} hidden={this.state.windowLoad != \"surface2\"}/>\n          <Comments info={this.props.info} hidden={this.state.windowLoad != \"comments\"}/>\n          {\n            //<Surface surfaceid={this.props.surfaceid} topLevel={this.props.topLevel}/>\n          }\n        </div>\n      )\n\n    }\n\n  return (\n    <div className={this.props.windowType + \" \" + this.props.windowType + this.props.openWidthHeight}>\n      <WindowNavBar handleTabChange={this.props.handleTabChange}\n      handleClose={this.props.handleClose}\n      handleMinimize={this.props.handleMinimize}\n      handleMaximize={this.props.handleMaximize}\n      handleMiddlize={this.props.handleMiddlize}\n      windowType={this.props.windowType}\n      openWidthHeight={this.props.openWidthHeight}\n      windowId={this.props.windowId}\n      focus={this.props.resourceid}\n      handleSwitchWindow={this.props.handleSwitchWindow}\n      />\n      <NextPrevBar info={this.props.info} handleBlockFocusChange={this.props.handleBlockFocusChange}/>\n\n      {displayChild()}\n\n    </div>\n    );\n  }\n}\n\nexport default Window;\n","import React from 'react';\nimport {NavLink} from 'react-router-dom';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\n\n\nclass TextNavBar extends React.Component {\n  constructor(props){\n    super(props)\n    this.state = {\n      next: \"\",\n      previous: \"\"\n    }\n  }\n  componentWillReceiveProps(nextProps){\n    this.setState({next: nextProps.next, previous: nextProps.previous})\n  }\n  render(){\n    return (\n      <Navbar bg=\"light\" variant=\"light\" expand=\"lg\" fixed=\"bottom\">\n        <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n        <Navbar.Collapse id=\"basic-navbar-nav\">\n        <Nav>\n          {this.props.previous && <NavLink className=\"nav-link\" to={\"/text?resourceid=\" + this.props.previous}>Previous</NavLink>}\n          {this.props.next && <NavLink className=\"nav-link\" to={\"/text?resourceid=\" + this.props.next}>Next</NavLink>}\n          {this.props.next && <NavLink className=\"nav-link\" to={\"/text?resourceid=\" + this.props.topLevel}>Text Home</NavLink>}\n        </Nav>\n        </Navbar.Collapse>\n      </Navbar>\n\n    );\n  }\n}\n\nexport default TextNavBar;\n","import React from 'react';\n\nimport {Link} from 'react-router-dom';\nimport Axios from 'axios'\nimport Alert from 'react-bootstrap/Alert';\n\nimport {runQuery} from './utils'\nimport {versionHistoryInfo} from './Queries'\n\nclass VersionChain extends React.Component {\n  constructor(props){\n    super(props)\n    this.getVersionHistory = this.getVersionHistory.bind(this)\n    this.handleToggleShowVersions = this.handleToggleShowVersions.bind(this)\n    this.state = {\n      versions: [],\n      currentVersion: {},\n      showVersions: false\n    }\n  }\n  handleToggleShowVersions(){\n    this.setState((prevState) => {\n      return {showVersions: !prevState.showVersions}\n    })\n  }\n  getVersionHistory(itemInfo){\n      const versionChainInfo = runQuery(versionHistoryInfo(itemInfo.transcriptionid))\n      versionChainInfo.then((d) => {\n        const b = d.data.results.bindings\n        const versions = []\n        b.forEach((b, i) => {\n          var reviewUrl = \"https://dll-review-registry.scta.info/api/v1/reviews/?url=\" + b.doc.value + \"?society=MAA\"\n          Axios(reviewUrl).then((d2) => {\n            const data = d2.data\n            var reviewObject = {}\n            if (data.length > 0){\n              reviewObject = {\n                img_url: data[0][\"badge-url\"],\n                reviewid: data[0][\"id\"],\n                ipfsHash: data[0][\"ipfs-hash\"],\n                html_link: \"https://dll-review-registry.scta.info/reviews/\" + data[0][\"id\"] + \".html\",\n                rubric_link: data[0][\"badge-rubric\"],\n                summary: data[0][\"review-summary\"]\n              }\n            }\n            this.setState((prevState) => {\n              const newVersion = {\n                versionTranscription: b.version ? b.version.value : \"\",\n                versionLabel: b.version_label ? b.version_label.value : \"\",\n                versionOrderNumber: b.order_number ? b.order_number.value : \"\",\n                versionReview: b.review ? b.review.value : \"\",\n                versionDoc: b.doc ? b.doc.value : \"\",\n                versionReviewInfo: reviewObject,\n              }\n              return {\n                versions: [...prevState.versions, newVersion],\n                currentVersion: itemInfo\n              }\n            })\n          })\n        })\n      })\n    }\n  componentDidMount(){\n    //this.setState({versions: []}, () => {\n      this.getVersionHistory(this.props.itemInfo)\n    //})\n  }\n  componentWillReceiveProps(newProps){\n      if (newProps.itemInfo.transcriptionid !== this.props.itemInfo.transcriptionid){\n        this.setState({versions: []}, () => {\n          this.getVersionHistory(newProps.itemInfo)\n        })\n      }\n\n\n  }\n  render(){\n    const displayVersions = () => {\n      const versions = this.state.versions.map((v) => {\n        const currentlyViewing = v.versionTranscription === this.state.currentVersion.transcriptionid ? \"currentlyViewing\" : \"\"\n        return (<p key={v.versionTranscription} className={currentlyViewing}>\n          {currentlyViewing ? <span>{v.versionLabel} (Currently Viewing)</span> : <Link to={\"/text?resourceid=\" + v.versionTranscription}>{v.versionLabel}</Link>}\n          {v.versionReviewInfo.html_link && <span> Peer Reviewed: <a href={v.versionReviewInfo.html_link}><img src={v.versionReviewInfo.img_url}/></a> </span>}\n          <span class=\"small\"> Data Source: <a href={v.versionDoc}>{v.versionDoc}</a> </span>\n          </p>)\n      })\n      return versions\n    }\n    const displayAlert = () => {\n      if (this.state.versions){\n        if (this.state.versions.length > 1){\n          return (\n            <Alert variant=\"info\">\n              <p onClick={this.handleToggleShowVersions}>This Text Has Multiple Indexed Versions</p>\n              {this.state.showVersions && displayVersions()}\n            </Alert>\n          )\n        }\n        else if (this.state.versions.length === 1){\n          const version = this.state.versions[0]\n          return (<Alert variant=\"info\">\n            <span>Version: {version.versionLabel} | Data Source: <a href={version.versionDoc}>{version.versionDoc}</a> </span>\n          </Alert>\n          )\n        }\n        else{\n          return null\n        }\n      }\n      else {\n        return null\n      }\n    }\n    return (\n      displayAlert()\n\n    );\n  }\n}\n\nexport default VersionChain;\n","import React from 'react';\nimport Qs from \"query-string\"\n\nimport Container from 'react-bootstrap/Container';\n\n\nimport Window from \"./Window\"\nimport TextNavBar from \"./TextNavBar\"\nimport Text from \"./Text\"\nimport VersionChain from \"./VersionChain\"\nimport {runQuery, scrollToParagraph} from './utils'\n\nimport {getRelatedExpressions, basicInfoQuery, itemTranscriptionInfoQuery} from './Queries'\n\n\nclass TextWrapper extends React.Component {\n  constructor(props){\n    super(props)\n    this.mount = false\n    this.openWindow = this.openWindow.bind(this)\n    this.setFocus = this.setFocus.bind(this)\n    this.handleTabChange = this.handleTabChange.bind(this)\n    this.handleClose = this.handleClose.bind(this)\n    this.handleMinimize = this.handleMinimize.bind(this)\n    this.handleMaximize = this.handleMaximize.bind(this)\n    this.handleMiddlize = this.handleMiddlize.bind(this)\n    this.handleSwitchWindow = this.handleSwitchWindow.bind(this)\n    this.handleSurfaceFocusChange = this.handleSurfaceFocusChange.bind(this)\n    this.state = {\n      doc: \"\",\n      focus: \"\",\n      //focusRelatedExpressions: \"\",\n      itemFocus: \"\",\n      surfaceid: \"\",\n      windows: {\n        window1: {\n          windowId: \"window1\",\n          open: false,\n          windowLoad: \"info\",\n          position: \"sideWindow\",\n          openWidthHeight: \"middle\"\n        },\n        window2: {\n          windowId: \"window2\",\n          open: false,\n          windowLoad: \"info\",\n          position: \"bottomWindow\",\n          openWidthHeight: \"middle\"\n        }\n      }\n    }\n  }\n  openWindow(id, windowLoad){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[id].open = true\n      windows[id].windowLoad = windowLoad\n      return {\n        windows: windows,\n      }\n    })\n  }\n  handleClose(windowId){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].open = !windows[windowId].open\n      return {windows: windows}\n\n    })\n    //scroll is supposed to re-align text scroll to focused paragraph after side bar close.\n    //but it is not quite working\n    scrollToParagraph(this.state.blockFocus, true)\n\n  }\n  handleMinimize(windowId){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].openWidthHeight = \"minimum\"\n      return {windows: windows}\n\n    })\n  }\n  handleMaximize(windowId){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].openWidthHeight = \"maximum\"\n      return {windows: windows}\n\n    })\n  }\n  handleMiddlize(windowId){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].openWidthHeight = \"middle\"\n      return {windows: windows}\n\n    })\n  }\n  handleSwitchWindow(windowId, windowType){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      if (windows[windowId].position === \"sideWindow\"){\n        windows[windowId].position = \"bottomWindow\"\n        // these conditionals control whether an already existing window will be closed when the other is moved\n        // while commented they allow window1 and window2 to stack on top of each other\n\n        // if (windowId === \"window1\"){\n        //   windows[\"window2\"].open = false\n        // }\n        // else if ((windowId === \"window2\")){\n        //   windows[\"window1\"].open = false\n        // }\n      }\n      else if (windows[windowId].position === \"bottomWindow\"){\n        windows[windowId].position = \"sideWindow\"\n        // these conditionals control whether an already existing window will be closed when the other is moved\n        // while commented they allow window1 and window2 to stack on top of each other\n\n        // if (windowId === \"window1\"){\n        //   windows[\"window2\"].open = false\n        // }\n        // else if ((windowId === \"window2\")){\n        //   windows[\"window1\"].open = false\n        // }\n      }\n      return {windows: windows}\n\n    })\n  }\n  handleTabChange(windowLoad, windowId){\n\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].windowLoad = windowLoad\n      return {windows: windows}\n\n    })\n\n  }\n\n  handleSurfaceFocusChange(surfaceid){\n    this.setState({surfaceid: surfaceid})\n  }\n\n\n  setFocus(id){\n    const fullid = id.includes(\"http\") ? id : \"http://scta.info/resource/\" + id\n    const shortid = id.includes(\"http\") ? id.split(\"/resource/\")[1] : id\n    // get info\n    const info = runQuery(basicInfoQuery(fullid))\n    //arrange info and set it to state\n    this.arrangeFocusInfo(info, fullid)\n    // get related expressions info\n// removed these second calls and embed the query in arrange focus info to keep information in sync.\n// TODO remove below three lines\n    //const relatedExpressions = runQuery(getRelatedExpressions(fullid))\n    //arrange info and set it to state\n    //this.arrangeFocusRelatedInfo(relatedExpressions)\n\n    scrollToParagraph(shortid, true)\n\n  }\n\n  arrangeFocusInfo(info, resourceid){\n      info.then((d) => {\n        const bindings = d.data.results.bindings[0]\n        const manifestations = d.data.results.bindings.map((b) => {\n          return {\n            manifestation: b.manifestation.value,\n            manifestationTitle: b.manifestationTitle.value,\n            transcription: b.manifestationCTranscription.value\n          }\n        })\n        // TODO the need for this 2nd query and async call might\n        // be able to be removed using a construct query\n        // see example pattern in articles collection\n        const relatedExpressions = runQuery(getRelatedExpressions(resourceid))\n        relatedExpressions.then((d) => {\n          const bindings2 = d.data.results.bindings\n          const relatedExpressions = bindings2.map((r) => {\n              return {\n                resourceid: r.isRelatedTo.value,\n                relationLabel: r.label.value\n              }\n            });\n\n          if (this.mount){\n            this.setState({\n              focus: {\n                resourceid: resourceid,\n                title: bindings.title.value,\n                structureType: bindings.structureType.value,\n                inbox: bindings.inbox.value,\n                next: bindings.next ? bindings.next.value : \"\",\n                previous: bindings.previous ? bindings.previous.value : \"\",\n                cdoc: bindings.cdoc.value,\n                cxml: bindings.cxml.value,\n                topLevel: bindings.topLevelExpression.value,\n                cmanifestation: bindings.cmanifestation.value,\n                ctranscription: bindings.ctranscription.value,\n                manifestations: manifestations,\n                relatedExpressions: relatedExpressions\n              }\n            });\n          }\n        })\n      });\n    }\n  // embeded this within arrang focus info, so that information remains in sync\n  // TODO remove this\n    // arrangeFocusRelatedInfo(relatedInfo){\n    //     relatedInfo.then((d) => {\n    //       console.log(\"new data\", d)\n    //       const bindings = d.data.results.bindings\n    //       const relatedExpressions = bindings.map((r) => {\n    //           return {\n    //             resourceid: r.isRelatedTo.value,\n    //             relationLabel: r.label.value\n    //           }\n    //         });\n    //     if (this.mount){\n    //       this.setState({\n    //         focusRelatedExpressions: relatedExpressions\n    //       });\n    //       }\n    //     });\n    //   }\n    setItemFocus(id){\n      const fullid = id.includes(\"http\") ? id : \"http://scta.info/resource/\" + id\n      const shortid = id.includes(\"http\") ? id.split(\"/resource/\")[1] : id\n      // get info\n      const info = runQuery(itemTranscriptionInfoQuery(fullid))\n      this.arrangeItemFocusInfo(info)\n    }\n    arrangeItemFocusInfo(itemFocusInfo){\n        itemFocusInfo.then((d) => {\n          const bindings = d.data.results.bindings[0]\n          if (this.mount){\n            this.setState({\n              itemFocus: {\n                title: bindings.title.value,\n                manifestation: bindings.manifestation.value,\n                expression: bindings.expression.value,\n                doc: bindings.doc.value,\n                xml: bindings.xml.value,\n                next: bindings.next ? bindings.next.value : \"\",\n                previous: bindings.previous ? bindings.previous.value : \"\",\n                inbox: bindings.inbox.value,\n                topLevel: bindings.topLevelExpression.value,\n                transcriptionid: bindings.t.value\n              }\n            });\n          }\n        });\n      }\n\n  componentDidMount(){\n    this.mount = true\n    this.setItemFocus(this.props.transcriptionid)\n    if (this.props.blockDivFocus){\n      this.setFocus(this.props.blockDivFocus)\n    }\n  }\n  componentWillReceiveProps(newProps){\n    this.setItemFocus(newProps.transcriptionid)\n    if (newProps.blockDivFocus){\n      this.setFocus(newProps.blockDivFocus)\n    }\n  }\n  componentWillUnmount(){\n    this.mount = false\n  }\n  render(){\n    const displayWindows = () => {\n      const windows = Object.keys(this.state.windows).map((key) => {\n        if (this.state.windows[key].open && (this.state.focus || this.state.surfaceid)){\n          return (<Window windowLoad={this.state.windows[key].windowLoad}\n              key={key}\n              handleClose={this.handleClose}\n              handleMinimize={this.handleMinimize}\n              handleMaximize={this.handleMaximize}\n              handleMiddlize={this.handleMiddlize}\n              handleTabChange={this.handleTabChange}\n              handleBlockFocusChange={this.setFocus}\n              handleSurfaceFocusChange={this.handleSurfaceFocusChange}\n              handleSwitchWindow={this.handleSwitchWindow}\n              resourceid={this.state.focus.resourceid}\n              windowType={this.state.windows[key].position}\n              windowId={this.state.windows[key].windowId}\n              windowLoad={this.state.windows[key].windowLoad}\n              openWidthHeight={this.state.windows[key].openWidthHeight}\n              surfaceid={this.state.surfaceid}\n              info={this.state.focus}\n              topLevel={this.state.itemFocus.topLevel}\n              />\n            )\n          }\n        })\n        return windows\n      }\n    const textClass = () => {\n      let aSideWindowOpen = false;\n      if (this.state.windows.window1.open && this.state.windows.window1.position === \"sideWindow\" && this.state.windows.window1.openWidthHeight === \"middle\"){\n        aSideWindowOpen = true\n      }\n      else if (this.state.windows.window2.open && this.state.windows.window2.position === \"sideWindow\"){\n        aSideWindowOpen = true\n      }\n      return aSideWindowOpen\n    }\n\n    return (\n      <div>\n        {this.state.itemFocus &&\n          <VersionChain itemInfo={this.state.itemFocus}/>\n        }\n        <Container className={textClass() ? \"lbp-text skinnyText\" : \"lbp-text fullText\"}>\n          {this.state.itemFocus &&\n          <Text\n            doc={this.state.itemFocus.doc}\n            topLevel={this.state.itemFocus.topLevel}\n            setFocus={this.setFocus}\n            handleSurfaceFocusChange={this.handleSurfaceFocusChange}\n            openWindow={this.openWindow}\n            scrollTo={this.state.focus ? this.state.focus.resourceid.split(\"/resource/\")[1] : null}\n            />\n          }\n        </Container>\n        <TextNavBar\n          next={this.state.itemFocus && this.state.itemFocus.next}\n          previous={this.state.itemFocus && this.state.itemFocus.previous}\n          topLevel={this.state.itemFocus && this.state.itemFocus.topLevel}\n          handleClose={this.handleClose}\n        />\n        <div>\n        {\n        // <TextNavBar\n        // next={this.state.items[this.state.itemFocus] && this.state.items[this.state.itemFocus].next}\n        // previous={this.state.items[this.state.itemFocus] && this.state.items[this.state.itemFocus].previous}\n        // topLevel={this.state.items[this.state.itemFocus] && this.state.items[this.state.itemFocus].topLevel}\n        // handleClose={this.handleClose}\n        // />\n        }\n        {displayWindows()}\n        </div>\n      </div>\n    );\n  }\n}\nexport default TextWrapper;\n","import React from 'react';\nimport {Link} from 'react-router-dom';\nfunction Item(props) {\n  //<p>{this.state.items[key].itemAuthor && <Link to={\"/text?resourceid=\" + this.state.items[key].itemAuthor}>{this.state.items[key].itemAuthorTitle}</Link>} |\n  //<Link to={\"/text?resourceid=\" + this.state.items[key].item}>{this.state.items[key].title}:\n  //{this.state.items[key].itemQuestionTitle}</Link></p>\n\n  return (\n    <tr>\n      {props.item.author && <td><Link to={\"/text?resourceid=\" + props.item.author}>{props.item.authorTitle}</Link></td>}\n      <td><Link to={\"/text?resourceid=\" + props.item.id}>{props.item.title}</Link></td>\n      {props.item.questionTitle ? <td><Link to={\"/text?resourceid=\" + props.item.id}>{props.item.questionTitle}</Link></td> : <td/>}\n    </tr>\n  );\n}\n\nexport default Item;\n","import React from 'react';\nimport Qs from \"query-string\"\nimport Container from 'react-bootstrap/Container';\nimport InputGroup from 'react-bootstrap/InputGroup';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Table from 'react-bootstrap/Table';\n\nimport {loadXMLDoc, convertXMLDoc, runQuery, scrollToParagraph} from './utils'\nimport {getRelatedExpressions, basicInfoQuery, basicStructureItemInfoQuery, basicStructureAllItemsInfoQuery, getStructureType, partsInfoQuery,workGroupExpressionQuery} from './Queries'\nimport {Link} from 'react-router-dom';\n\nimport $ from 'jquery';\n\nimport Window from \"./Window\"\n\nimport TextNavBar from \"./TextNavBar\"\nimport Item from \"./Item\"\n\n//import Lbp from \"lbp.js/lib\"\n\n\nclass Collection extends React.Component {\n  constructor(props){\n    super(props)\n    //this.handleClose = this.handleClose.bind(this)\n    //this.handleBlockFocusChange = this.handleBlockFocusChange.bind(this)\n    //this.handleSurfaceFocusChange = this.handleSurfaceFocusChange.bind(this)\n    //this.handleTabChange = this.handleTabChange.bind(this)\n    //this.handleSwitchWindow = this.handleSwitchWindow.bind(this)\n    //this.retrieveText = this.retrieveText.bind(this)\n    this.retrieveCollectionInfo = this.retrieveCollectionInfo.bind(this)\n    this.makeRequests = this.makeRequests.bind(this)\n    this.handleFilter = this.handleFilter.bind(this)\n    this.filter = React.createRef();\n    this.mount = false\n    this.state = {\n      items: {},\n      parts: {},\n      filter: \"\",\n      surfaceFocus: \"\"\n    }\n\n  }\n  handleFilter(e){\n    const item = e.target.value\n    this.setState({filter: item})\n\n  }\n  handleSurfaceFocusChange(surfaceid){\n    this.setState({surfaceFocus: surfaceid})\n  }\n  arrangeParts(partsPromise){\n    const _this = this\n    partsPromise.then((d) => {\n        const bindings = d.data.results.bindings\n        let partsObject = {}\n        bindings.forEach((b) => {\n          const pId = b.part.value\n          partsObject[pId] = {\n            id: b.part.value,\n            title: b.partTitle.value,\n            type: b.partType.value,\n            questionTitle: b.partQuestionTitle ? b.partQuestionTitle.value : null,\n            level: b.partLevel ? b.partLevel.value : \"unknown\",\n        }\n      });\n      if (this.mount){\n        _this.setState(\n          {\n            parts: partsObject\n          }\n        )\n      }\n    });\n  }\n  arrangeItems(itemsPromise){\n    const _this = this\n    itemsPromise.then((d) => {\n      const bindings = d.data.results.bindings\n      let itemsObject = {}\n      bindings.forEach((b) => {\n        const itemId = b.item.value\n        itemsObject[itemId] = {\n          title: b.itemTitle.value,\n          id: b.item.value,\n          type: b.itemType.value,\n          questionTitle: b.itemQuestionTitle ? b.itemQuestionTitle.value : null,\n          author: b.itemAuthor ? b.itemAuthor.value : null,\n          authorTitle: b.itemAuthorTitle ? b.itemAuthorTitle.value : null,\n          next: b.next ? b.next.value : null,\n          previous: b.previous ? b.previous.value : null,\n          cm: b.cm ? b.cm.value : null,\n          cmTitle: b.cmTitle ? b.cmTitle.value : null,\n          ct: b.ct ? b.ct.value : null,\n          topLevel: b.topLevel ? b.topLevel.value : null,\n          doc: b.doc ? b.doc.value : null\n        }\n      });\n      if (this.mount){\n        _this.setState(\n          {\n            items: itemsObject\n          }\n        )\n      }\n    }).\n    catch((err) => {\n      console.log(err)\n    })\n  }\n\n  retrieveWorkGroupInfo(resourceid){\n    const _this = this;\n    const expressionsInfo = runQuery(workGroupExpressionQuery(resourceid))\n    const partsInfo = runQuery(partsInfoQuery(resourceid))\n    this.arrangeParts(partsInfo)\n    this.arrangeItems(expressionsInfo)\n  }\n  retrieveCollectionInfo(resourceid, structureType, topLevel){\n    const _this = this;\n    const collectionInfo = runQuery(basicStructureAllItemsInfoQuery(topLevel))\n    const partsInfo = runQuery(partsInfoQuery(resourceid))\n\n    //add parts to state\n    this.arrangeParts(partsInfo)\n    /// add items to state\n    this.arrangeItems(collectionInfo)\n  }\n  makeRequests(newResourceId, structureType, topLevel, type){\n\n    //\n    //   // get all expressions for this workGroup\n      if (type === \"http://scta.info/resource/workGroup\"){\n          this.retrieveWorkGroupInfo(newResourceId, structureType, topLevel)\n          //this.setState({itemFocus: \"\"})\n      }\n      // get all items for this collection\n      else if (structureType === \"http://scta.info/resource/structureCollection\"){\n          this.retrieveCollectionInfo(newResourceId, structureType, topLevel)\n          //this.setState({itemFocus: \"\"})\n      }\n\n  }\n  componentDidUpdate(prevProps, prevState){\n\n  }\n  componentDidMount(){\n    this.mount = true\n    const _this = this;\n    this.setState({resourceid: this.props.resourceid})\n    this.makeRequests(this.props.resourceid, this.props.structureType, this.props.topLevel, this.props.type)\n\n  }\n\n  componentWillReceiveProps(nextProps) {\n\n    this.refs.filter ? this.refs.filter.value = \"\" :\n    this.setState({resourceid: nextProps.resourceid, filter: \"\", blockFocus: \"\"})\n    this.makeRequests(nextProps.resourceid, nextProps.structureType, nextProps.topLevel, nextProps.type)\n  }\n  componentWillUnmount(){\n    this.mount = false\n  }\n  render(){\n    //const resourceid = Qs.parse(this.props.location.search, { ignoreQueryPrefix: true }).resourceid;\n\n    const displayQuestions = () => {\n      const questions = []\n      Object.keys(this.state.items).forEach((key) => {\n        const filterCheck = this.state.items[key].title + \" \" + this.state.items[key].authorTitle + \" \" + this.state.items[key].questionTitle\n        if (filterCheck.toLowerCase().includes(this.state.filter.toLowerCase())){\n        questions.push(\n          <Item item={this.state.items[key]}/>\n        )}\n      });\n      return (\n        <Container>\n\n        <h1>Items</h1>\n        <br/>\n        <Table striped bordered hover size=\"sm\">\n        <tbody>\n        {questions}\n        </tbody>\n        </Table>\n        </Container>\n      )\n    }\n    const displayParts = () => {\n        const questions = []\n        Object.keys(this.state.parts).forEach((key) => {\n          //check against filter\n            if (this.state.parts[key].title.toLowerCase().includes(this.state.filter.toLowerCase())){\n            questions.push(\n              <Item item={this.state.parts[key]}/>\n              )\n            }\n\n        });\n        //check against top level expression as parts; if parts are top level expression; don't display parts\n        const testPart = this.state.parts[Object.keys(this.state.parts)[0]]\n        if (testPart){\n          if (!(testPart.type === \"http://scta.info/resource/expression\" && testPart.level === \"1\")){\n            return (\n              <Container>\n              <h1>Parts</h1>\n              <br/>\n              <Table striped bordered hover size=\"sm\">\n              <tbody>\n              {questions}\n              </tbody>\n              </Table>\n              </Container>\n            )\n          }\n        }\n      }\n\n    return (\n      <Container>\n      <FormControl ref={this.filter} id=\"filter\" placeholder=\"type to filter\" onChange={this.handleFilter}/>\n      {displayParts()}\n      {displayQuestions()}\n      </Container>\n    );\n  }\n}\n\nexport default Collection;\n","import React from 'react';\nimport Qs from \"query-string\"\nimport Container from 'react-bootstrap/Container';\nimport InputGroup from 'react-bootstrap/InputGroup';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Table from 'react-bootstrap/Table';\n\nimport {runQuery} from './utils'\nimport {getAuthorInformation} from './Queries'\nimport {Link} from 'react-router-dom';\nimport Item from \"./Item\"\n\n//import Lbp from \"lbp.js/lib\"\n\n\nclass AuthorCollection extends React.Component {\n  constructor(props){\n    super(props)\n\n    this.retrieveAuthorCollectionInfo = this.retrieveAuthorCollectionInfo.bind(this)\n    this.handleItemFilter = this.handleItemFilter.bind(this)\n    this.itemFilter = React.createRef();\n\n    this.mount = false\n    this.state = {\n      authorTitle: \"\",\n      authorArticles: [],\n      textArticles: [],\n      expressions: [],\n      itemFilter: \"\",\n    }\n\n  }\n  handleItemFilter(e){\n    const item = e.target.value\n    this.setState({itemFilter: item})\n\n  }\n  arrangeItems(itemsPromise, resourceid){\n    const _this = this\n    itemsPromise.then((d) => {\n      console.log(\"data\", d)\n      const author = d.data[\"@graph\"].filter((i) => i[\"@id\"] === resourceid)[0]\n      console.log(\"author\", author)\n      //const authorExpressions = d.data[\"@graph\"].filter((i) => {i[\"@id\"] === author.hasTopLevelExpression})\n      const authorTitle = author[\"http://purl.org/dc/elements/1.1/title\"]\n      let authorArticles = null\n      if(Array.isArray(author.authorArticle)){\n        authorArticles =  author.authorArticle.map((a) => {\n          return {\n            id: a,\n            title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === a)[0][\"http://purl.org/dc/elements/1.1/title\"]\n          }\n        })\n      }\n      else{\n        authorArticles = [{id: author.autherArticle, title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === author.autherArticle)[0][\"http://purl.org/dc/elements/1.1/title\"]}]\n      }\n      let textArticles = null\n      if(Array.isArray(author.textArticle)){\n          textArticles =  author.textArticle.map((a) => {\n          return {\n            id: a,\n            title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === a)[0][\"http://purl.org/dc/elements/1.1/title\"]\n          }\n        })\n      }\n      else{\n        textArticles = [{id: author.textArticle, title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === author.textArticle)[0][\"http://purl.org/dc/elements/1.1/title\"]}]\n      }\n\n      let expressions = null\n      if(Array.isArray(author.hasTopLevelExpression)){\n        expressions =  author.hasTopLevelExpression.map((a) => {\n          return {\n            id: a,\n            title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === a)[0][\"http://purl.org/dc/elements/1.1/title\"]\n          }\n        })\n      }\n      else{\n        expressions = [{id: author.hasTopLevelExpression, title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === author.hasTopLevelExpression)[0][\"http://purl.org/dc/elements/1.1/title\"]}]\n      }\n      console.log(\"articles\", authorArticles)\n      console.log(\"textArticles\", textArticles)\n      console.log(\"expressions\", expressions)\n\n      this.setState({authorArticles: authorArticles, textArticles: textArticles, expressions: expressions, authorTitle: authorTitle })\n    }).\n    catch((err) => {\n      console.log(err)\n    })\n  }\n  retrieveAuthorCollectionInfo(resourceid){\n    const authorCollectionInfo = runQuery(getAuthorInformation(resourceid))\n    /// add items to state\n    this.arrangeItems(authorCollectionInfo, resourceid)\n  }\n  componentDidUpdate(prevProps, prevState){\n\n  }\n  componentDidMount(){\n    this.mount = true\n    this.retrieveAuthorCollectionInfo(this.props.resourceid)\n\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.refs.itemFilter ? this.refs.itemFilter.value = \"\" :\n    this.retrieveAuthorCollectionInfo(nextProps.resourceid)\n  }\n  componentWillUnmount(){\n    this.mount = false\n  }\n  render(){\n    //const resourceid = Qs.parse(this.props.location.search, { ignoreQueryPrefix: true }).resourceid;\n\n    const displayItems = (list) => {\n      const items = list.map((i) => {\n        return (\n\n          <Item item={i}/>\n\n        )\n      });\n      return items\n    }\n\n\n\n\n\n\n    return (\n      <div>\n      <h1>{this.state.authorTitle}</h1>\n      {this.state.expressions &&\n        <Container>\n        <h1>Expressions</h1>\n        <br/>\n        <Table striped bordered hover size=\"sm\">\n        <tbody>\n        {displayItems(this.state.expressions)}\n        </tbody>\n        </Table>\n        </Container>\n      }\n      {this.state.authorArticles &&\n        <Container>\n        <h1>Author Related Articles</h1>\n        <br/>\n        <Table striped bordered hover size=\"sm\">\n        <tbody>\n        {displayItems(this.state.authorArticles)}\n        </tbody>\n        </Table>\n        </Container>\n      }\n      {this.state.textArticles &&\n        <Container>\n        <h1>Text Related Articles</h1>\n        <br/>\n        <Table striped bordered hover size=\"sm\">\n        <tbody>\n        {displayItems(this.state.textArticles)}\n        </tbody>\n        </Table>\n        </Container>\n      }\n      </div>\n    );\n  }\n}\n\nexport default AuthorCollection;\n","import React from 'react';\nimport Qs from \"query-string\"\nimport TextWrapper from \"./TextWrapper\"\nimport Collection from \"./Collection\"\nimport AuthorCollection from \"./AuthorCollection\"\n\nimport {runQuery} from './utils'\nimport {getItemTranscription, getItemTranscriptionFromBlockDiv, getStructureType} from './Queries'\n\nclass TextSwitch extends React.Component {\n  constructor(props){\n    super(props)\n    this.state = {\n      displayType: \"\",\n      resourceid: \"\",\n      itemTranscriptionId: \"\",\n      blockDivFocus: \"\"\n    }\n  }\n  getInfo(resourceid){\n    const structureTypePromise = runQuery(getStructureType(resourceid))\n    structureTypePromise.then((t) => {\n      const type = t.data.results.bindings[0].type.value\n      const structureType = t.data.results.bindings[0].structureType ? t.data.results.bindings[0].structureType.value : null\n      const level = t.data.results.bindings[0].level ? t.data.results.bindings[0].level.value : null\n      const topLevel = t.data.results.bindings[0].topLevel ? t.data.results.bindings[0].topLevel.value : resourceid\n      const itemParent = t.data.results.bindings[0].itemParent ? t.data.results.bindings[0].itemParent.value : null\n      const itemTranscriptionId = t.data.results.bindings[0].ctranscription ? t.data.results.bindings[0].ctranscription.value : null\n      if (type === \"http://scta.info/resource/person\"){\n          this.setState({displayType: \"person\", resourceid: resourceid, structureType: \"\", topLevel: \"\", type: type})\n      }\n      else if (type === \"http://scta.info/resource/workGroup\"){\n          this.setState({displayType: \"collection\", resourceid: resourceid, structureType: structureType, topLevel: topLevel, type: type})\n      }\n      else if (structureType === \"http://scta.info/resource/structureCollection\"){\n          this.setState({displayType: \"collection\", resourceid: resourceid, structureType: structureType, topLevel: topLevel, type: type})\n      }\n      else if (structureType === \"http://scta.info/resource/structureItem\" ){\n        if (type === \"http://scta.info/resource/transcription\"){\n          this.setState({itemTranscriptionId: resourceid, displayType: \"item\"})\n        }\n        else {\n          const structureTypePromise = runQuery(getItemTranscription(resourceid))\n          structureTypePromise.then((t) => {\n            this.setState({itemTranscriptionId: t.data.results.bindings[0].ctranscription.value, displayType: \"item\"})\n          });\n        }\n      }\n      else if (structureType === \"http://scta.info/resource/structureBlock\" || structureType === \"http://scta.info/resource/structureDivision\" ){\n        const structureTypePromise = runQuery(getItemTranscriptionFromBlockDiv(resourceid))\n        structureTypePromise.then((t) => {\n          if (type === \"http://scta.info/resource/transcription\"){\n            this.setState({itemTranscriptionId: itemParent, blockDivFocus: t.data.results.bindings[0].blockDivExpression.value, displayType: \"item\"})\n          }\n          else if (type === \"http://scta.info/resource/expression\"){\n            this.setState({itemTranscriptionId: t.data.results.bindings[0].ctranscription.value, blockDivFocus: resourceid, displayType: \"item\"})\n          }\n          else {\n            this.setState({itemTranscriptionId: t.data.results.bindings[0].ctranscription.value, blockDivFocus: t.data.results.bindings[0].blockDivExpression.value, displayType: \"item\"})\n          }\n        });\n      }\n    });\n  }\n\n  componentDidMount(){\n    const _this = this;\n    const newResourceId = Qs.parse(this.props.location.search, { ignoreQueryPrefix: true }).resourceid\n    this.getInfo(newResourceId)\n  }\n  componentWillReceiveProps(nextProps) {\n    const newResourceId = Qs.parse(nextProps.location.search, { ignoreQueryPrefix: true }).resourceid\n    this.getInfo(newResourceId)\n  }\n\n\n\n  render(){\n    const display = () => {\n      if (this.state.displayType === \"person\"){\n        return (<AuthorCollection resourceid={this.state.resourceid}/>)\n\n      }\n      else if (this.state.displayType === \"collection\"){\n        return (<Collection resourceid={this.state.resourceid} structureType={this.state.structureType} topLevel={this.state.topLevel} type={this.state.type}/>)\n\n      }\n      else if (this.state.displayType === \"item\"){\n        return (<TextWrapper transcriptionid={this.state.itemTranscriptionId} blockDivFocus={this.state.blockDivFocus}/>)\n      }\n      else{\n        return null\n      }\n    }\n  return (\n    display()\n    );\n  }\n\n}\n\nexport default TextSwitch;\n","import React from 'react';\n\nfunction About() {\n  return (\n    <div className=\"About\">\n    <h1>About</h1>\n\n    </div>\n  );\n}\n\nexport default About;\n","import React from 'react';\nimport {NavLink} from 'react-router-dom';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\nimport NavDropdown from 'react-bootstrap/NavDropdown';\n\nimport {resourceEndpoint} from './config';\n\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\n\n\nfunction NavBar() {\n  return (\n    <Navbar bg=\"dark\" variant=\"light\" expand=\"lg\" fixed=\"top\">\n      <Navbar.Brand href=\"/\">SCTA</Navbar.Brand>\n      <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n      <Navbar.Collapse id=\"basic-navbar-nav\">\n      <Nav>\n\n        <NavLink className=\"nav-link\" to={\"/text?resourceid=\" + resourceEndpoint}>Text</NavLink>\n        {// example drop down\n          // <NavDropdown title=\"Dropdown\" id=\"basic-nav-dropdown\">\n        //   <NavDropdown.Item href=\"#action/3.1\">Action</NavDropdown.Item>\n        //   <NavDropdown.Item href=\"#action/3.2\">Another action</NavDropdown.Item>\n        //   <NavDropdown.Item href=\"#action/3.3\">Something</NavDropdown.Item>\n        //   <NavDropdown.Divider />\n        //   <NavDropdown.Item href=\"#action/3.4\">Separated link</NavDropdown.Item>\n        // </NavDropdown>\n      }\n      <NavLink className=\"nav-link\" to=\"/Search\">Search</NavLink>\n      </Nav>\n\n      <Nav>\n        <NavLink className=\"nav-link\" to=\"/about\">About</NavLink>\n        <NavLink className=\"nav-link\" to=\"/donate\">Donate</NavLink>\n      </Nav>\n      </Navbar.Collapse>\n    </Navbar>\n\n  );\n}\n\nexport default NavBar;\n","import React from 'react';\n\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\n\n\n\n\n\nfunction Footer() {\n  return (\n    <Container className=\"lbp-footer\" fluid>\n    <Row>\n    <Col>\n    <p>Designed by <a href=\"http://jeffreycwitt.com\">Jeffrey C. Witt</a></p>\n    </Col>\n    <Col>\n    <p>A <a href=\"http://lombardpress.org\">LombardPress</a> Publication</p>\n    </Col>\n    <Col>\n    <p>Powered by <a href=\"http://scta.info\">SCTA</a> Data</p>\n    </Col>\n    </Row>\n    </Container>\n\n  );\n}\n\nexport default Footer;\n","import React from 'react';\nimport {BrowserRouter, HashRouter, Route, Switch, Link, NavLink} from 'react-router-dom';\nimport Home from \"./Home\"\nimport SearchWrapper from \"./SearchWrapper\"\nimport Text from \"./Text\"\nimport TextSwitch from \"./TextSwitch\"\nimport About from \"./About\"\nimport NavBar from './NavBar';\n\n\n\nimport Footer from './Footer';\n\nimport 'bootstrap/dist/css/bootstrap.css'\nimport '../styles/App.scss';\n//import '../styles/index.scss';\n\nconst AppRouter = () => (\n  <HashRouter forceRefresh={false}>\n    <div>\n      <NavBar/>\n      <Switch>\n        <Route path=\"/\" exact={true} component={Home}/>\n        <Route path=\"/text\"  exact={true} component={TextSwitch}/>\n        <Route path=\"/about\" exact={true} component={About}/>\n        <Route path=\"/search\" exact={true} render={(props) => <SearchWrapper {...props} hidden={false}/>}/>\n        {\n          //<Route path=\"/edit/:id\" exact={true} component={EditExpensePage}/>\n        //<Route path=\"/help\" exact={true} component={HelpPage}/>\n        // <Route component={NotFoundPage}/>\n        }\n      </Switch>\n      <Footer/>\n    </div>\n  </HashRouter>\n)\n\nexport default AppRouter\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n//import './styles/index.scss';\nimport AppRouter from './components/AppRouter';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<AppRouter/>, document.getElementById('root'));\n\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}