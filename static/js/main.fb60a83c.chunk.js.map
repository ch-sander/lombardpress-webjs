{"version":3,"sources":["components/config.js","components/utils.js","components/Text.js","components/Home.js","components/Search.js","components/SearchQuery.js","components/SearchWrapper.js","components/Surface.js","components/Image.js","components/LineText.js","components/ImageTextWrapper.js","components/Queries.js","components/Surface2.js","components/XmlView.js","components/Info.js","components/WindowNavBar.js","components/NextPrevBar.js","components/TextCompareItem.js","components/TextCompare.js","components/TextCompareWrapper.js","components/CommentItem.js","components/CommentCreate.js","components/Comments.js","components/Window.js","components/TextNavBar.js","components/VersionChain.js","components/TextWrapper.js","components/Item.js","components/Collection.js","components/AuthorCollection.js","components/TextSwitch.js","components/About.js","components/NavBar.js","components/Footer.js","components/AppRouter.js","serviceWorker.js","index.js"],"names":["sparqlEndpoint","resourceEndpoint","loadXMLDoc","filename","xhttp","XMLHttpRequest","open","responseType","err","send","responseXML","runQuery","query","Axios","get","params","output","scrollToParagraph","hash","highlight","element","$","addClass","setTimeout","length","stop","animate","scrollTop","offset","top","Text","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","retrieveText","bind","assertThisInitialized","doc","topLevel","scrollTo","docFragment","split","topLevelFragment","resultDocument","xmlurl","xslurl","xml","xsl","xsltProcessor","XSLTProcessor","importStylesheet","transformToFragment","document","convertXMLDoc","includes","getElementById","innerHTML","appendChild","click","e","preventDefault","id","attr","setFocus","openWindow","handleSurfaceFocusChange","prevProps","prevState","newProps","react_default","a","createElement","React","Component","Home","location","Qs","parse","search","ignoreQueryPrefix","resourceid","components_Text","className","Container_default","fluid","Jumbotron_default","Button_default","Search","retrieveResults","state","searchResults","count","expressionid","then","d","setState","data","results","eid","nextProps","_this2","map","r","i","key","react_router_dom","to","pid","dangerouslySetInnerHTML","__html","text","SearchQuery","handleQueryUpdate","handleEidUpdate","handleRunSearch","target","value","Form_default","onSubmit","FormControl_default","type","placeholder","onChange","variant","SearchWrapper","hidden","components_SearchQuery","info","components_Search","Image","newCoords","coords","coordsSplitArray","parseInt","console","log","imageLink","imageUrl","displayWidth","src","LineText","style","white-space","ImageTextWrapper","searchText","defineProperty","targetLabel","label","getClass","components_Image","canvas","canvasShort","components_LineText","basicInfoQuery","itemExpressionUri","join","partsInfoQuery","resourceurl","Surface2","handleNext","handlePrevious","handleToggleTextLines","currentSurfaceId","manifest","region","width","next","previous","imageurl","annotationsDisplay","surfaceid","getSurfaceInfo","b","bindings","alUrl","d2","resources","surfaceTitle","next_surface","previous_surface","annotations","catch","error","retrieveSurfaceInfo","_this3","onClick","h","resource","chars","on","components_ImageTextWrapper","surfaceButton","XmlView","retrieveXML","xmlstring","cxml","light","language","docco","showLineNumbers","Info","inbox","displayInfo","manifestations","manifestation","manifestationTitle","displayManifestations","relatedExpressions","relationLabel","displayRelatedExpressions","WindowNavBar","Nav_default","Item","Link","handleTabChange","windowId","index_esm","openWidthHeight","handleMinimize","handleMiddlize","handleMaximize","handleClose","handleSwitchWindow","windowType","NextPrevBar","handleBlockFocusChange","title","TextCompareItem","handleToggleShow","mounted","compareText","rawText","show","base","transcription","dmp","Diff","diff_match_patch","diff","diff_main","diff_cleanupSemantic","ds","diff_prettyHtml","createCompare","compareTranscription","handleChangeBase","ref","TextCompare","handleToggleShowAll","baseText","manifestationCTranscription","structureType","cdoc","topLevelExpression","cmanifestation","ctranscription","arrangeTextInfo","isMainText","getTextInfo","m","components_TextCompareItem","displayComparisons","TextCompareWrapper","handleCompare","handleToggleCompare","getText","expressions","newExpressions","objectSpread","forEach","exObject","keys","components_TextCompare","displayExpressions","CommentItem","n","body","CommentCreate","handleCommentUpdate","handleSubmitComment","comment","handleSumbitComment","Comments","notifications","annotat","@context","uuidv4","motivation","method","url","config","headers","Content-Type","response","concat","toConsumableArray","retrieveComments","components_CommentCreate","components_CommentItem","Window","windowLoad","components_WindowNavBar","focus","components_NextPrevBar","components_SearchWrapper","components_TextCompareWrapper","components_XmlView","components_Info","components_Surface2","components_Comments","TextNavBar","Navbar_default","bg","expand","fixed","Toggle","aria-controls","Collapse","VersionChain","getVersionHistory","handleToggleShowVersions","versions","currentVersion","showVersions","itemInfo","transcriptionUri","transcriptionid","reviewUrl","reviewObject","img_url","reviewid","ipfsHash","html_link","rubric_link","summary","newVersion","versionTranscription","version","versionLabel","version_label","versionOrderNumber","order_number","versionReview","review","versionDoc","versionReviewInfo","_this4","Alert_default","v","currentlyViewing","href","class","displayAlert","TextWrapper","mount","itemFocus","windows","window1","position","window2","blockFocus","fullid","shortid","arrangeFocusInfo","isRelatedTo","arrangeItemFocusInfo","itemFocusInfo","expression","t","setItemFocus","blockDivFocus","components_VersionChain","aSideWindowOpen","textClass","components_TextNavBar","_React$createElement","components_Window","item","author","authorTitle","questionTitle","Collection","retrieveCollectionInfo","makeRequests","handleFilter","filter","createRef","items","parts","surfaceFocus","partsPromise","partsObject","pId","part","partTitle","partType","partQuestionTitle","level","partLevel","itemsPromise","itemsObject","itemId","itemTitle","itemType","itemQuestionTitle","itemAuthor","itemAuthorTitle","cm","cmTitle","ct","expressionsInfo","partsInfo","arrangeParts","arrangeItems","collectionInfo","newResourceId","retrieveWorkGroupInfo","refs","questions","toLowerCase","push","components_Item","testPart","Table_default","striped","bordered","hover","size","displayParts","displayQuestions","AuthorCollection","retrieveAuthorCollectionInfo","handleItemFilter","itemFilter","authorArticles","textArticles","Array","isArray","authorArticle","autherArticle","textArticle","hasTopLevelExpression","authorid","authorCollectionInfo","displayItems","list","TextSwitch","displayType","itemTranscriptionId","itemParent","getItemTranscriptionFromBlockDiv","blockDivExpression","getInfo","components_AuthorCollection","components_Collection","components_TextWrapper","About","NavBar","Brand","Footer","Row_default","Col_default","AppRouter","forceRefresh","components_NavBar","react_router","path","exact","component","render","assign","components_Footer","Boolean","window","hostname","match","ReactDOM","components_AppRouter","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.fb60a83c.chunk.js","sourcesContent":["//export const sparqlEndpoint = \"http://localhost:3030/ds/query\"\nexport const sparqlEndpoint = \"https://sparql-docker.scta.info/ds/query\"\n\nexport const resourceEndpoint = \"http://scta.info/resource/scta\"\n","import Axios from 'axios'\nimport {sparqlEndpoint} from './config';\nimport $ from 'jquery';\n\nexport function loadXMLDoc(filename)\n  {\n    const xhttp = new XMLHttpRequest();\n    xhttp.open(\"GET\", filename, false);\n    try {xhttp.responseType = \"msxml-document\"} catch(err) {} // Helping IE11\n    xhttp.send(\"\");\n    return xhttp.responseXML;\n  }\n\nexport function convertXMLDoc(xmlurl, xslurl){\n  const xml = loadXMLDoc(xmlurl)\n  const xsl = loadXMLDoc(xslurl)\n  const xsltProcessor = new XSLTProcessor();\n  xsltProcessor.importStylesheet(xsl);\n  const resultDocument = xsltProcessor.transformToFragment(xml, document);\n  return resultDocument;\n}\n\nexport function nsResolver(prefix) {\n    if(prefix === \"tei\") {\n      return 'http://www.tei-c.org/ns/1.0'\n    }\n}\n\n\n\nexport function runQuery(query){\n  //const sparqlEndpoint = \"https://sparql-docker.scta.info/ds/query\"\n  //const sparqlEndpoint = sparqlEndpoint\n  const queryPromise = Axios.get(sparqlEndpoint, { params: { \"query\": query, \"output\": \"json\" } })\n  return queryPromise\n}\n\n//handles scroll to paragraph procedure\nexport function scrollToParagraph(hash, highlight){\n    const element = $(\"#\" + hash);\n\n    // TODO: highlighting is NOT working\n    if (highlight){\n      element.addClass( \"highlight\");\n      setTimeout(function(){\n        element.addClass(\"highlightNone\");\n    }, 2000);\n\n    }\n  \tif (element.length > 0) {\n  \t    $('html, body')\n              .stop()\n              .animate({\n                  scrollTop: element.offset().top - 100\n              }, 1000);\n     }\n\n  }\n","import React from 'react';\n\nimport $ from 'jquery';\n\nimport {loadXMLDoc, convertXMLDoc, scrollToParagraph} from './utils'\n\nclass Text extends React.Component {\n  constructor(props){\n    super(props)\n    this.retrieveText = this.retrieveText.bind(this)\n\n\n  }\n  retrieveText(doc, topLevel, scrollTo){\n    const _this = this;\n    if (doc){\n      //construct file url request ot exist db to get a cors enabled copy of the text (github does not serve files with cors enabled)\n      const doc = this.props.doc;\n      const topLevel = this.props.topLevel;\n      const docFragment = doc.split(\"/master/\")[1]\n      const topLevelFragment = topLevel.split(\"/resource/\")[1]\n\n      let xmlurl = \"\"\n      if (doc.includes(\"ipfs\")){\n        xmlurl = doc\n      }\n      else{\n        xmlurl = \"http://exist.scta.info/exist/apps/scta-app/text/\" + topLevelFragment + \"/\" + docFragment;\n      }\n      const xslurl = \"/xslt/main_view.xsl\"\n      const resultDocument = convertXMLDoc(xmlurl, xslurl)\n      // append resultDoc to div in DOM\n      document.getElementById(\"text\").innerHTML = \"\";\n      document.getElementById(\"text\").appendChild(resultDocument);\n      // if (this.state.blockFocus){\n      //   scrollToParagraph(this.state.blockFocus, true)\n      // }\n    }\n    // bind events to dom\n    // only seems to be working when they are here; not yet sure why\n\n    $('.lbp-paragraphmenu').click(function(e) {\n         e.preventDefault();\n         const id = $(this).attr('data-id')\n         _this.props.setFocus(id)\n         _this.props.openWindow(\"window1\", \"info\")\n    });\n\n    // scroll to paragraph after document has been appended\n    scrollToParagraph(scrollTo, true)\n\n  //   $('.lbp-paragraphmenu').click(function(e) {\n  //     e.preventDefault();\n  //     const id = $(this).attr('data-id')\n  //\n  //     //_this.setState({blockFocus: id})\n  //     _this.setState((prevState) => {\n  //       const windows = prevState.windows\n  //       windows.window1.open = true\n  //       return {\n  //         windows: windows,\n  //         blockFocus: id\n  //       }\n  //\n  //     })\n  //     // set block info to state.info\n  //     const fullid = \"http://scta.info/resource/\" + id\n  //     const info = runQuery(basicInfoQuery(fullid))\n  //     _this.arrangeTextInfo(info, fullid)\n  //\n  //     // retrieve relatedExpressions info\n  //     // get related expressions info\n  //     // TODO/Note this is getting called in handleBlockFocusChange as well;\n  //     // Strong candidate for  refactor\n  //     const relatedExpressions = runQuery(getRelatedExpressions(fullid))\n  //     _this.arrangeRelatedInfo(relatedExpressions)\n  //     // scroll to paragraph\n  //     scrollToParagraph(id, true)\n  //\n  //   });\n    $('.js-show-folio-image').click(function(e) {\n      e.preventDefault();\n      const id = $(this).attr('data-surfaceid')\n      //_this.setState({surfaceFocus: \"http://scta.info/resource/\" + id})\n      // _this.setState((prevState) => {\n      //   const windows = prevState.windows\n      //   windows.window2.open = true\n      //   windows.window2.windowLoad = \"surface2\"\n      //   return {\n      //     windows: windows,\n      //     surfaceFocus: \"http://scta.info/resource/\" + id\n      //   }\n\n        _this.props.handleSurfaceFocusChange(\"http://scta.info/resource/\" + id)\n        _this.props.openWindow(\"window2\", \"surface2\")\n    });\n  }\n\n  componentDidUpdate(prevProps, prevState){\n\n    //check to see if doc has changed\n    if (prevProps.doc != this.props.doc){\n      this.retrieveText(this.props.doc, this.props.topLevel, this.props.scrollTo)\n    }\n    // if doc has already been appended, still scroll to target block\n    else{\n      scrollToParagraph(this.props.scrollTo, true)\n    }\n\n\n    //this.retrieveText(this.props.doc, this.props.topLevel, this.props.scrollTo)\n  }\n\n  componentDidMount(){\n    this.retrieveText(this.props.doc, this.props.topLevel, this.props.scrollTo)\n  }\n  componentWillReceiveProps(newProps){\n\n  }\n  render(){\n\n    return (\n      <div>\n        <div id=\"text\"></div>\n      </div>\n    );\n  }\n}\n\nexport default Text;\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport Jumbotron from 'react-bootstrap/Jumbotron';\nimport Button from 'react-bootstrap/Button';\nimport Text from './Text';\nimport Qs from \"query-string\"\n\n\n\nfunction Home(props) {\n  const resourceid = props.location ? Qs.parse(props.location.search, { ignoreQueryPrefix: true }).resourceid : null;\n  const displayBody = () => {\n    if (resourceid){\n      return <Text resourceid={props.location.search.resourceid}/>\n    }\n    else\n    return (\n      <div className=\"Home\">\n        <Container id=\"lbp-home\" fluid>\n            <Container>\n              <Jumbotron id=\"lbp-jumbo\">\n              \t<h1>The SCTA Reading Room</h1>\n              \t<p>A site for reading, viewing, and studying the scholastic tradition</p>\n                <Button>View the text</Button> | <Button>Learn More</Button>\n              </Jumbotron>\n            </Container>\n          </Container>\n          </div>\n    )\n  }\n  return (\n    displayBody()\n  )\n}\n\nexport default Home;\n","import React from 'react';\nimport Axios from 'axios'\nimport Qs from \"query-string\"\nimport {Link} from 'react-router-dom';\n\nclass Search extends React.Component {\n  constructor(props){\n    super(props)\n    this.retrieveResults = this.retrieveResults.bind(this)\n    this.state = {\n      searchResults: [],\n      count: \"\"\n    }\n  }\n  retrieveResults(query, expressionid){\n    const _this = this\n    Axios.get(\"http://exist.scta.info/exist/apps/scta-app/jsonsearch/json-search-text-by-expressionid.xq?query=\" + query + \"&expressionid=\" + expressionid).\n          then((d) => {\n            _this.setState({searchResults: d.data.results, count: d.data.count})\n          })\n  }\n  componentDidMount(){\n    // const query = Qs.parse(this.props.location.search, { ignoreQueryPrefix: true }).query\n    // const eid = Qs.parse(this.props.location.search, { ignoreQueryPrefix: true }).eid\n    const query = this.props.query\n    const eid =  this.props.eid\n\n    this.retrieveResults(query, eid)\n  }\n  componentWillReceiveProps(nextProps){\n    const query = nextProps.query\n    const eid =  nextProps.eid\n    this.retrieveResults(query, eid)\n  }\n  render(){\n    const displayResults = () => {\n      if (this.state.searchResults.length > 1){\n        const results = this.state.searchResults.map((r, i) => {\n          return (\n            <div key={i}>\n            <p><Link to={\"/text?resourceid=http://scta.info/resource/\" + r.pid}>{r.pid}</Link></p>\n            <p dangerouslySetInnerHTML={{ __html: r.text}}/>\n            </div>\n          )\n\n        })\n      return results\n    }\n    else if (this.state.searchResults){\n      return (\n        <div key={this.state.searchResults.pid}>\n        <p><Link to={\"/text?resourceid=http://scta.info/resource/\" + this.state.searchResults.pid}>{this.state.searchResults.pid}</Link></p>\n        <p dangerouslySetInnerHTML={{ __html: this.state.searchResults.text}}/>\n        </div>\n      )\n    }\n    else{\n      return (\n        <div><p>No results</p></div>\n      )\n    }\n  }\n  return (\n    <div>\n    {displayResults()}\n    </div>\n\n\n  );\n  }\n}\n\nexport default Search;\n","import React from 'react';\nimport Axios from 'axios'\n\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\n\nclass SearchQuery extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleQueryUpdate = this.handleQueryUpdate.bind(this)\n    this.handleEidUpdate = this.handleEidUpdate.bind(this)\n    this.handleRunSearch = this.handleRunSearch.bind(this)\n    this.state = {\n      query: \"\",\n      eid: \"\",\n    }\n  }\n  handleQueryUpdate(e){\n    e.preventDefault()\n\n    this.setState({query: e.target.value})\n\n  }\n  handleEidUpdate(e){\n    e.preventDefault()\n    this.setState({eid: e.target.value})\n\n  }\n  handleRunSearch(e){\n    e.preventDefault()\n    this.props.handleRunSearch(this.state.query, this.state.eid)\n  }\n  componentDidMount(){\n    this.props.eid && this.setState({eid: this.props.eid})\n  }\n  componentWillReceiveProps(nextProps){\n    nextProps.eid && this.setState({eid: nextProps.eid})\n  }\n  render(){\n    return (\n      <div>\n       <Form onSubmit={this.handleRunSearch}>\n        <FormControl type=\"text\" id=\"query\" placeholder=\"query\" className=\"mr-sm-2\" onChange={this.handleQueryUpdate} />\n        {!this.props.eid &&<FormControl type=\"text\" id=\"eid\" placeholder=\"eid\" className=\"mr-sm-2\" onChange={this.handleEidUpdate} />}\n        <Button type=\"submit\" variant=\"outline-success\">Search</Button>\n      </Form>\n\n      </div>\n    )\n  }\n}\n\nexport default SearchQuery;\n","import React from 'react';\nimport Axios from 'axios'\nimport Qs from \"query-string\"\nimport Search from \"./Search\"\nimport SearchQuery from \"./SearchQuery\"\n\nclass SearchWrapper extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleRunSearch = this.handleRunSearch.bind(this)\n    this.state = {\n      query: \"\",\n      eid: \"\",\n    }\n  }\n  handleRunSearch(query, eid){\n    this.setState({query: query, eid: eid})\n  }\n  componentDidMount(){\n\n  }\n  componentWillReceiveProps(){\n\n  }\n  render(){\n    return (\n      <div className={this.props.hidden ? \"hidden\" : \"showing\"}>\n        <h1>Search</h1>\n        <SearchQuery handleRunSearch={this.handleRunSearch} eid={this.props.info && this.props.info.topLevel.split(\"/resource/\")[1]}/>\n        {this.state.query && <Search query={this.state.query} eid={this.state.eid}/>}\n      </div>\n    )\n  }\n}\n\nexport default SearchWrapper;\n","import React from 'react';\n\n/// mirador imports\n\nimport { Provider } from 'react-redux';\nimport PluginProvider from 'mirador/dist/es/src/extend/PluginProvider';\nimport createRootReducer from 'mirador/dist/es/src/state/reducers/rootReducer';\nimport MiradorApp from 'mirador/dist/es/src/containers/App';\n//import {CollectionViewer} from 'mirador-collection-viewer';\n//import {miradorImageToolsPlugin} from 'mirador-image-tools';\nimport settings from 'mirador/dist/es/src/config/settings';\nimport * as actions from 'mirador/dist/es/src/state/actions';\nimport createStore from 'mirador/dist/es/src/state/createStore';\n\nclass Surface extends React.Component {\n  constructor(props){\n    super(props)\n    this.store = createStore();\n\n  }\n\n  componentWillMount(){\n\n      settings.id = \"yolo\";\n      // manifest id should be retrieved from query\n      // this is a temporary measure until db is corrected and query is posible\n      const manifest = \"http://scta.info/iiif/\" + this.props.topLevel.split(\"/resource/\")[1] + \"/\" + this.props.surfaceid.split(\"/resource/\")[1].split(\"/\")[0] + \"/\" + \"manifest\";\n      \n      const settings2 = {\n        ...settings,\n        windows: [{\n          loadedManifest: manifest,\n          canvasIndex: 2,\n          thumbnailNavigationPosition: 'far-bottom',\n        }],\n        window: {\n          allowClose: false,\n          allowMaximize: false,\n          defaultSideBarPanel: 'info',\n          defaultView: 'single',\n          sideBarOpenByDefault: true,\n        },\n        thumbnailNavigation: {\n          defaultPosition: 'off',\n        },\n        workspace: {\n          type: 'mosaic', // Which workspace type to load by default. Other possible values are \"elastic\"\n        },\n        workspaceControlPanel: {\n          enabled: true,\n        }\n      }\n\n      this.store.dispatch(actions.setConfig(settings2));\n      this.store.dispatch(actions.fetchManifest(manifest))\n      this.store.dispatch(actions.addWindow({canvasIndex: 1, sideBarOpen: false, sideBarPanel: false}))\n      this.setState({store: this.store})\n//\n//       function select(state, manifest) {\n//         return state.manifests[manifest].isFetching\n//       }\n//\n//       let isFetching = true\n//\n//       function handleChange() {\n//         isFetching = select(store.getState())\n// console.log(\"isFetching\", isFetching)\n//         if (!isFetching) {\n//\n//           store.dispatch(actions.setCanvas(\"http://scta.info/iiif/lon/canvas/L11v\", 0))\n//         }\n//       }\n//\n//       const unsubscribe = store.subscribe(handleChange)\n//       unsubscribe()\n\n\n\n\n\n\n  }\n  componentWillReceiveProps(){\n    // manifest id should be retrieved from query\n    // this is a temporary measure until db is corrected and query is posible\n    const manifest = \"http://scta.info/iiif/\" + this.props.topLevel.split(\"/resource/\")[1] + \"/\" + this.props.surfaceid.split(\"/resource/\")[1].split(\"/\")[0] + \"/\" + \"manifest\";\n    this.store.dispatch(actions.fetchManifest(manifest))\n    this.store.dispatch(actions.addWindow({canvasIndex: 1, sideBarOpen: false, sideBarPanel: false}))\n  }\n  render() {\n    return (\n      <div id=\"App\">\n        <Provider store={this.state.store}>\n          <PluginProvider plugins={[]} createRootReducer={createRootReducer}>\n            <MiradorApp />\n          </PluginProvider>\n        </Provider>\n      </div>\n    );\n  }\n\n}\n\nexport default Surface;\n","import React from 'react';\n\nfunction Image(props) {\n  let newCoords = \"\"\n  if (props.coords){\n    const coordsSplitArray = props.coords.split(\",\")\n    const x = parseInt(coordsSplitArray[0]) - 20\n    const y = coordsSplitArray[1]\n    const w = parseInt(coordsSplitArray[2]) + 40\n    const h = coordsSplitArray[3]\n    newCoords = x + \",\" + y + \",\" + w + \",\" + h\n    console.log(newCoords)\n  }\n\n  const imageLink = props.imageUrl + \"/\" + newCoords + \"/\" + props.displayWidth + \",/0/default.jpg\"\n  return (\n    <img src={imageLink}/>\n  );\n}\n\nexport default Image;\n","import React from 'react';\n\nfunction LineText(props) {\n  return (\n    <div className=\"text\" style={{\"white-space\": \"nowrap\"}}>\n     <span dangerouslySetInnerHTML={{__html: props.text}} />\n    </div>\n  );\n}\n\nexport default LineText;\n","// Note this component is a near duplicate of Image Text Wrapper in Paleographinator\n// TODO: This shoud be the target for a refactored independent React Component\n\nimport React, { Component } from 'react';\nimport Image from './Image';\nimport LineText from './LineText';\n\nclass ImageTextWrapper extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      searchText: \"\"\n    }\n  }\n  render() {\n    const getClass = () => {\n      if (this.props.targetLabel === this.props.label){\n        return \"target\"\n      }\n    }\n    return (\n      <div className=\"ImageTextWrapper\" className={getClass()}>\n        <div className=\"labelImageWrapper\">\n\n        <Image\n          imageUrl={this.props.imageUrl}\n          canvas={this.props.canvas}\n          coords={this.props.coords}\n          canvasShort={this.props.canvasShort}\n          displayWidth={this.props.displayWidth}\n          />\n        </div>\n        <LineText text={this.props.text}/>\n      </div>\n    );\n  }\n}\n\nexport default ImageTextWrapper;\n","//note; each query here represents an attempt an efficient single request for related information\n//each query therefore could be tranformed into a restful api\n\n\n export function getRelatedExpressions(itemExpressionUri){\n   const query = [\n     \"SELECT DISTINCT ?isRelatedTo ?label \",\n     \"WHERE { \",\n     \"{\",\n     \"<\" + itemExpressionUri + \"> ?o ?isRelatedTo .\",\n     \"?o a <http://scta.info/resource/textRelation> .\",\n     \"?o <http://www.w3.org/1999/02/22-rdf-syntax-ns#label> ?label . \",\n     \"?isRelatedTo a <http://scta.info/resource/expression> .\",\n     \"}\",\n     \"UNION\",\n     \"{\",\n     \"<\" + itemExpressionUri + \"> ?o ?p .\",\n     \"?o a <http://scta.info/resource/textRelation> .\",\n     \"?o <http://www.w3.org/1999/02/22-rdf-syntax-ns#label> ?label . \",\n     \"?p a <http://scta.info/resource/quotation> .\",\n     \"?p <http://scta.info/property/source> ?isRelatedTo .\",\n     \"}\",\n     \"}\"\n   ].join('');\n     return query\n }\n//get Related Expressions\n// export function getRelatedExpressions(itemExpressionUri){\n//   const query = [\n//     \"SELECT DISTINCT ?isRelatedTo \",\n//     \"WHERE { \",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/isRelatedTo> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/quotes> ?quote .\",\n//     \"?quote a <http://scta.info/resource/quotation> .\",\n//     \"?quote <http://scta.info/property/source> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/quotes> ?quote .\",\n//     \"?quote a <http://scta.info/resource/expression> .\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/quotes> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/quotedBy> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/abbreviates> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/abbreviatedBy> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/references> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/referencedBy> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/copies> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/isCopiedBy> ?isRelatedTo .\",\n//     \"}\",\n//     \"}\"\n//   ].join('');\n//\n//     return query\n// }\n\n// query info block, division, or item (possible also collection)\nexport function basicInfoQuery(itemExpressionUri){\n  const query = [\n    \"SELECT DISTINCT ?title ?structureType ?cmanifestation ?cmanifestationTitle ?manifestation ?manifestationTitle ?ctranscription ?manifestationCTranscription ?cdoc ?cxml ?expressionShortId ?longTitle ?topLevelExpression ?next ?previous ?inbox \",\n    \"WHERE { \",\n    \"<\" + itemExpressionUri + \"> <http://purl.org/dc/elements/1.1/title> ?title .\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/structureType> ?structureType .\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/hasCanonicalManifestation> ?cmanifestation .\",\n    \"?cmanifestation <http://purl.org/dc/elements/1.1/title> ?cmanifestationTitle .\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/hasManifestation> ?manifestation .\",\n    \"?manifestation <http://purl.org/dc/elements/1.1/title> ?manifestationTitle .\",\n    \"?manifestation <http://scta.info/property/hasCanonicalTranscription> ?manifestationCTranscription .\",\n    \"?cmanifestation <http://scta.info/property/hasCanonicalTranscription> ?ctranscription .\",\n    \"?ctranscription <http://scta.info/property/hasDocument> ?cdoc . \",\n    \"?ctranscription <http://scta.info/property/hasXML> ?cxml . \",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/shortId> ?expressionShortId .\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/longTitle> ?longTitle .\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/isPartOfTopLevelExpression> ?topLevelExpression .\",\n    \"OPTIONAL {\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/next> ?next .\",\n    \"}\",\n    \"OPTIONAL {\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/previous> ?previous .\",\n    \"}\",\n    \"<\" + itemExpressionUri + \"> <http://www.w3.org/ns/ldp#inbox> ?inbox . \",\n    \"}\",\n    \"ORDER BY ?title\"].join('');\n\n    return query\n  }\n\n  export function itemTranscriptionInfoQuery(itemTranscriptionUri){\n    const query = [\n      \"SELECT DISTINCT ?title ?manifestation ?doc ?xml ?expression ?expressionShortId ?longTitle ?topLevelExpression ?next ?previous ?inbox ?t \",\n      \"WHERE { \",\n      \"BIND(<\" + itemTranscriptionUri + \"> as ?t) . \",\n      \"?t <http://purl.org/dc/elements/1.1/title> ?title .\",\n      \"?t <http://scta.info/property/isTranscriptionOf> ?manifestation .\",\n      \"?t <http://scta.info/property/hasDocument> ?doc . \",\n      \"?t <http://scta.info/property/hasXML> ?xml . \",\n      \"?manifestation <http://scta.info/property/isManifestationOf> ?expression .\",\n      \"?expression <http://purl.org/dc/elements/1.1/title> ?expressionTitle .\",\n      \"?expression <http://scta.info/property/shortId> ?expressionShortId .\",\n      \"?expression <http://scta.info/property/longTitle> ?longTitle .\",\n      \"?expression <http://scta.info/property/isPartOfTopLevelExpression> ?topLevelExpression .\",\n      \"OPTIONAL {\",\n      \"?expression <http://scta.info/property/next> ?next .\",\n      \"}\",\n      \"OPTIONAL {\",\n      \"?expression <http://scta.info/property/previous> ?previous .\",\n      \"}\",\n      \"?expression <http://www.w3.org/ns/ldp#inbox> ?inbox . \",\n      \"}\",\n      \"ORDER BY ?expressionTitle\"].join('');\n\n      return query\n    }\n  // gets all structure items with basic item information\n  export function basicStructureAllItemsInfoQuery(topLevelExpressionUrl){\n    const query = [\n      \"SELECT DISTINCT ?item ?itemTitle ?topLevel ?itemQuestionTitle ?cm ?cmTitle ?ct ?next ?previous ?itemType ?doc \",\n      \"WHERE { \",\n      \"<\" + topLevelExpressionUrl + \"> <http://scta.info/property/hasStructureItem> ?item .\",\n      \"?item <http://scta.info/property/isPartOfTopLevelExpression> ?topLevel .\",\n      \"?item <http://purl.org/dc/elements/1.1/title> ?itemTitle .\",\n      \"?item <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?itemType . \",\n      \"OPTIONAL {\",\n      \"?item <http://scta.info/property/questionTitle> ?itemQuestionTitle .\",\n      \"}\",\n      \"OPTIONAL\",\n      \"{\",\n      \"?item <http://scta.info/property/next> ?next .\",\n      \"}\",\n      \"OPTIONAL\",\n      \"{\",\n      \"?item <http://scta.info/property/previous> ?previous .\",\n      \"}\",\n      \"?item <http://scta.info/property/hasCanonicalManifestation> ?cm .\",\n      \"?item <http://scta.info/property/totalOrderNumber> ?totalOrderNumber .\",\n      \"?cm <http://purl.org/dc/elements/1.1/title> ?cmTitle .\",\n      \"?cm <http://scta.info/property/hasCanonicalTranscription> ?ct .\",\n      \"?ct <http://scta.info/property/hasDocument> ?doc .\",\n      \"}\",\n      \"ORDER BY ?totalOrderNumber\"].join('');\n      return query\n    }\n    // gets all parts\n    export function partsInfoQuery(resourceurl){\n      const query = [\n        \"SELECT DISTINCT ?part ?partTitle ?partQuestionTitle ?partType ?partLevel \",\n        \"WHERE { \",\n        \"<\" + resourceurl + \"> <http://purl.org/dc/terms/hasPart> ?part .\",\n        \"?part <http://purl.org/dc/elements/1.1/title> ?partTitle .\",\n        \"?part <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?partType . \",\n        \"OPTIONAL {\",\n        \"?part <http://scta.info/property/questionTitle> ?partQuestionTitle .\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?part <http://scta.info/property/level> ?partLevel .\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?part <http://scta.info/property/totalOrderNumber> ?totalOrderNumber .\",\n        \"}\",\n        \"}\",\n        \"ORDER BY ?totalOrderNumber\"].join('');\n        return query\n      }\n    // gets all expressions for work Group\n    export function workGroupExpressionQuery(resourceurl){\n      const query = [\n        \"SELECT DISTINCT ?item ?itemTitle ?itemAuthor ?itemAuthorTitle ?itemType \",\n        \"WHERE { \",\n        \"<\" + resourceurl + \"> <http://scta.info/property/hasExpression> ?item .\",\n        \"?item <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?itemType . \",\n        \"?item <http://purl.org/dc/elements/1.1/title> ?itemTitle .\",\n        \"?item <http://www.loc.gov/loc.terms/relators/AUT> ?itemAuthor .\",\n        \"?itemAuthor <http://purl.org/dc/elements/1.1/title> ?itemAuthorTitle .\",\n        \"}\"].join('');\n        return query\n      }\n\n  export function getItemTranscription(resourceurl){\n    const query = [\n      \"SELECT DISTINCT ?ctranscription \",\n      \"WHERE { \",\n        \"{\",\n          \"<\" + resourceurl + \"> <http://scta.info/property/hasCanonicalManifestation> ?cmanifestation . \",\n          \"?cmanifestation <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . \",\n        \"}\",\n        \"UNION\",\n        \"{\",\n          \"<\" + resourceurl + \"> <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . \",\n        \"}\",\n      \"}\"].join('');\n      return query\n  }\n  export function getItemTranscriptionFromBlockDiv(resourceurl){\n    const query = [\n      \"SELECT DISTINCT ?ctranscription ?blockDivExpression \",\n      \"WHERE { \",\n        \"OPTIONAL\",\n        \"{\",\n        \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfStructureItem> ?itemParent . \",\n        \"{\",\n          \"{\",\n            \"?itemParent <http://scta.info/property/hasCanonicalManifestation> ?cmanifestation . \",\n            \"?cmanifestation <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . \",\n          \"}\",\n          \"UNION\",\n          \"{\",\n            \"?itemParent <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . \",\n          \"}\",\n        \"}\",\n        \"}\",\n        \"OPTIONAL\",\n        \"{\",\n        \"{\",\n          \"{\",\n            \"<\" + resourceurl + \"> <http://scta.info/property/isManifestationOf> ?blockDivExpression . \",\n          \"}\",\n          \"UNION\",\n          \"{\",\n            \"<\" + resourceurl + \"> <http://scta.info/property/isTranscriptionOf> ?blockDivManifestation . \",\n            \"?blockDivManifestation <http://scta.info/property/isManifestationOf> ?blockDivExpression . \",\n          \"}\",\n        \"}\",\n        \"}\",\n      \"}\"].join('');\n      return query\n  }\n  //TODO rename to getType\n  export function getStructureType(resourceurl){\n    const query = [\n      \"SELECT DISTINCT ?type ?structureType ?level ?topLevel ?itemParent \",\n      \"WHERE { \",\n      \"<\" + resourceurl + \"> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?type . \",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/structureType> ?structureType . \",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/level> ?level . \",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfTopLevelExpression> ?topLevel . \",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfTopLevelManifestation> ?topLevel . \",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfTopLevelTransription> ?topLevel . \",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfStructureItem> ?itemParent . \",\n      \"}\",\n      \"}\"].join('');\n      return query\n    }\n  //surface id query, gets canvas and manifestation\n  export function getSurfaceInfo(surfaceid){\n    const query = [\n      \"SELECT DISTINCT ?surfaceTitle ?c_height ?c_width ?isurface ?isurfaceTitle ?icodexTitle ?canvas ?imageurl ?next_surface ?previous_surface \",\n        \"{\",\n  \t\t\t\t\"<\" + surfaceid + \"> <http://purl.org/dc/elements/1.1/title> ?surfaceTitle .\",\n  \t\t\t\t\"<\" + surfaceid + \"> <http://scta.info/property/hasISurface> ?isurface .\",\n  \t\t\t\t\"OPTIONAL {\",\n  \t\t\t\t\t\"<\" + surfaceid + \"> <http://scta.info/property/next> ?next_surface .\",\n  \t\t\t\t\"}\",\n  \t\t\t\t\"OPTIONAL {\",\n  \t\t\t\t\t\"<\" + surfaceid + \"> <http://scta.info/property/previous> ?previous_surface .\",\n          \"}\",\n  \t\t\t\t\"OPTIONAL {\",\n  \t\t\t\t\t\"?isurface <http://purl.org/dc/elements/1.1/title> ?isurfaceTitle .\",\n  \t\t\t\t\t\"?isurface <http://purl.org/dc/elements/1.1/isPartOf> ?icodex .\",\n  \t\t\t\t\t\"?icodex <http://purl.org/dc/elements/1.1/title> ?icodexTitle .\",\n  \t\t\t\t\"}\",\n  \t\t\t\t\"?isurface <http://scta.info/property/hasCanvas> ?canvas .\",\n  \t\t\t\t\"OPTIONAL{\",\n  \t\t\t\t\t\"?canvas <http://iiif.io/api/presentation/2#hasImageAnnotations> ?blank .\",\n  \t\t\t\t\"}\",\n  \t\t\t\t\"OPTIONAL{\",\n  \t\t\t\t\t\"?canvas <http://www.shared-canvas.org/ns/hasImageAnnotations> ?blank .\",\n  \t\t\t\t\"}\",\n  \t\t\t\t\"?canvas <http://www.w3.org/2003/12/exif/ns#width> ?c_width .\",\n  \t\t\t\t\"?canvas <http://www.w3.org/2003/12/exif/ns#height> ?c_height .\",\n  \t\t     \"?blank <http://www.w3.org/1999/02/22-rdf-syntax-ns#first> ?o .\",\n  \t\t     \"?o <http://www.w3.org/ns/oa#hasBody> ?o2 .\",\n  \t\t    \"OPTIONAL{\",\n  \t\t\t\t\t \"?o2 <http://rdfs.org/sioc/services#has_service> ?imageurl .\",\n  \t\t\t\t \"}\",\n  \t\t\t\t \"OPTIONAL{\",\n  \t\t\t\t\t \"?o2 <http://www.shared-canvas.org/ns/hasRelatedService> ?imageurl .\",\n  \t\t\t\t \"}\",\n        \"}\"].join('');\n      return query\n    }\n\n//surface id query, gets canvas and manifestation\nexport function getAuthorInformation(authorid){\n    const query = [\n      \"CONSTRUCT\",\n      \"{\",\n      \"?author  <http://purl.org/dc/elements/1.1/title> ?authorTitle ;\",\n      \"<http://scta.info/resource/hasTopLevelExpression> ?expression ;\",\n      \"<http://scta.info/property/authorArticle> ?authorArticle;\",\n      \"<http://scta.info/property/textArticle> ?textArticle .\",\n    \t\"?authorArticle <http://purl.org/dc/elements/1.1/title> ?authorArticleTitle . \",\n      \"?textArticle <http://purl.org/dc/elements/1.1/title> ?textArticleTitle . \",\n    \t\"?expression <http://purl.org/dc/elements/1.1/title> ?topLevelExpressionTitle .\",\n      \"}\",\n      \"WHERE \",\n      \"{\",\n      \"<\" + authorid + \"> <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n      \"BIND(<\" + authorid + \"> as ?author) . \",\n      \"?expression <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n      \"?expression a <http://scta.info/resource/expression> .\",\n      \"?expression <http://scta.info/property/level> '1' .\",\n      \"?expression <http://purl.org/dc/elements/1.1/title> ?topLevelExpressionTitle .\",\n      \"?expression2 <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n      \"?textArticle <http://scta.info/property/isArticleOf> ?expression2 .\",\n      \"?textArticle <http://purl.org/dc/elements/1.1/title> ?textArticleTitle .\",\n      \"?authorArticle <http://scta.info/property/isArticleOf> ?author .\",\n      \"?authorArticle <http://purl.org/dc/elements/1.1/title> ?authorArticleTitle\",\n      \"}\"].join('');\n      return query\n      }\n\n  export function versionHistoryInfo(transcriptionUri){\n     \t \tconst query = [\n     \t \t\t\"SELECT ?version ?version_shortId ?order_number ?version_label ?review ?doc\",\n     \t    \"{\",\n            \"{\",\n               \"BIND(<\" + transcriptionUri + \"> as ?version) . \",\n     \t         \"?version <http://scta.info/property/shortId> ?version_shortId .\",\n               \"?version <http://scta.info/property/hasDocument> ?doc . \",\n     \t         \"?version <http://scta.info/property/versionOrderNumber> ?order_number .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/versionLabel> ?version_label .\",\n     \t\t\t\t\t \"OPTIONAL {\",\n     \t\t\t\t\t \t\"?version <http://scta.info/property/hasReview> ?review .\",\n     \t\t\t\t   \"}\",\n     \t\t\t\t \"}\",\n     \t       \"UNION\",\n            \"{\",\n     \t         \"<\" + transcriptionUri + \"> <http://scta.info/property/hasAncestor> ?version .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/shortId> ?version_shortId .\",\n               \"?version <http://scta.info/property/hasDocument> ?doc . \",\n     \t         \"?version <http://scta.info/property/versionOrderNumber> ?order_number .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/versionLabel> ?version_label .\",\n     \t\t\t\t\t \"OPTIONAL {\",\n     \t\t\t\t\t \t\"?version <http://scta.info/property/hasReview> ?review .\",\n     \t\t\t\t   \"}\",\n     \t\t\t\t \"}\",\n     \t       \"UNION\",\n     \t       \"{\",\n     \t         \"<\" + transcriptionUri + \"> <http://scta.info/property/hasDescendant> ?version .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/shortId> ?version_shortId .\",\n               \"?version <http://scta.info/property/hasDocument> ?doc . \",\n     \t         \"?version <http://scta.info/property/versionOrderNumber> ?order_number .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/versionLabel> ?version_label .\",\n     \t\t\t\t\t \"OPTIONAL {\",\n     \t\t\t\t\t \t\"?version <http://scta.info/property/hasReview> ?review .\",\n     \t\t\t\t   \"}\",\n     \t\t\t\t \"}\",\n     \t     \"}\",\n     \t     \"ORDER BY DESC(?order_number)\"].join('');\n           return query\n           }\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport Axios from 'axios'\n\nimport ImageTextWrapper from './ImageTextWrapper';\n\nimport {runQuery} from './utils'\nimport {getSurfaceInfo} from './Queries'\n\n\n\nclass Surface2 extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleNext = this.handleNext.bind(this)\n    this.handlePrevious = this.handlePrevious.bind(this)\n    this.handleToggleTextLines = this.handleToggleTextLines.bind(this)\n    this.state = {\n      currentSurfaceId: \"\",\n      manifest: \"\",\n      canvas: \"\",\n      region: \"full\",\n      width: \"1000\",\n      next: \"\",\n      previous: \"\",\n      imageurl: \"\",\n      annotationsDisplay: true\n    }\n\n  }\n  handleNext(){\n    //this.retrieveSurfaceInfo(this.state.next)\n    this.props.handleSurfaceFocusChange(this.state.next)\n  }\n  handlePrevious(){\n    //this.retrieveSurfaceInfo(this.state.previous)\n    this.props.handleSurfaceFocusChange(this.state.previous)\n\n  }\n  handleToggleTextLines(){\n    //this.retrieveSurfaceInfo(this.state.previous)\n    this.setState((prevState) => {\n      return {annotationsDisplay: !prevState.annotationsDisplay}\n    })\n  }\n  retrieveSurfaceInfo(surfaceid){\n    console.log('surfaceid', surfaceid)\n    // manifest id should be retrieved from query\n    // this is a temporary measure until db is corrected and query is posible\n\n    const manifest = \"http://scta.info/iiif/\" + this.props.topLevel.split(\"/resource/\")[1] + \"/\" + surfaceid.split(\"/resource/\")[1].split(\"/\")[0] + \"/\" + \"manifest\";\n    const surfaceInfo = runQuery(getSurfaceInfo(surfaceid))\n    surfaceInfo.then((d) => {\n      const b = d.data.results.bindings[0]\n      //second nested async call for annotation list\n      const alUrl = \"https://exist.scta.info/exist/apps/scta-app/folio-annotaiton-list-from-simpleXmlCoordinates.xq?surfaceid=\" + surfaceid.split(\"/resource/\")[1]\n      Axios.get(alUrl).then((d2) => {\n        const resources = d2.data.resources\n          this.setState({\n          currentSurfaceId: surfaceid,\n          surfaceTitle: b.surfaceTitle.value,\n          manifest: manifest,\n          canvas: b.canvas.value,\n          imageurl: b.imageurl.value,\n          next: b.next_surface ? b.next_surface.value : \"\",\n          previous: b.previous_surface ? b.previous_surface.value : \"\",\n          annotations: d2.data ? d2.data.resources : \"\"\n        })\n      }).catch((error) => {\n        console.log(\"failed retrieving annotationlist: \", error)\n        this.setState({\n        currentSurfaceId: surfaceid,\n        surfaceTitle: b.surfaceTitle.value,\n        manifest: manifest,\n        canvas: b.canvas.value,\n        imageurl: b.imageurl.value,\n        next: b.next_surface ? b.next_surface.value : \"\",\n        previous: b.previous_surface ? b.previous_surface.value : \"\",\n        annotations: \"\"\n      })\n    })\n  })\n}\ncomponentDidMount(){\n    if (this.props.surfaceid){\n      console.log('surfaceid', this.props.surfaceid)\n      this.retrieveSurfaceInfo(this.props.surfaceid)\n    }\n  }\n  componentWillReceiveProps(nextProps){\n    if (nextProps.surfaceid){\n    this.retrieveSurfaceInfo(nextProps.surfaceid)\n    }\n  }\n  render() {\n    const displayImages = () => {\n      if (this.state.annotations && this.state.annotationsDisplay){\n        const imageTextWrappers = this.state.annotations.map((h, i) => {\n          const text = h.resource.chars;\n          const canvas = h.on.split(\"#xywh=\")[0];\n          const canvasShort = canvas.split(\"/\")[canvas.split(\"/\").length - 1];\n          const coords = h.on.split(\"#xywh=\")[1];\n          const imageUrl = h.imageUrl\n          const label = h.label\n          const match = label === this.props.targetLabel ? true : false\n          return (\n            <ImageTextWrapper key={i}\n              imageUrl={imageUrl}\n              canvas={canvas}\n              coords={coords}\n              canvasShort={canvasShort}\n              text={text}\n              label={label}\n              targetLabel={this.props.targetLabel}\n              surfaceButton={false}\n              displayWidth=\"1000\"\n              />\n            )\n\n        })\n        return imageTextWrappers\n      }\n      else{\n        return <img src={this.state.imageurl + \"/\" + this.state.region + \"/\" + this.state.width + \",/0/default.jpg\"}/>\n      }\n    }\n    return (\n      <Container className={this.props.hidden ? \"hidden\" : \"showing\"}>\n      {this.state.currentSurfaceId ?\n        <div>\n          <div className=\"surface-navigation\">\n            <p>{this.state.surfaceTitle}</p>\n            {this.state.previous && <p><a onClick={this.handlePrevious}>Previous</a></p>}\n            {this.state.next && <p><a onClick={this.handleNext}>Next</a></p>}\n            {this.state.annotations && <p><a onClick={this.handleToggleTextLines}>Toggle Text Lines</a></p>}\n          </div>\n          {displayImages()}\n        </div> : <p>No surface selected</p>}\n      </Container>\n\n    );\n  }\n\n}\n\nexport default Surface2;\n","import React from 'react';\nimport Axios from 'axios'\nimport { Light as SyntaxHighlighter } from 'react-syntax-highlighter';\n//import xml from 'react-syntax-highlighter/dist/esm/languages/hljs/xml';\nimport { docco } from 'react-syntax-highlighter/dist/esm/styles/hljs';\n\nimport {loadXMLDoc, nsResolver} from './utils'\n//SyntaxHighlighter.registerLanguage('xml', xml);\nclass XmlView extends React.Component {\n\n  constructor(props){\n    super(props)\n    this.retrieveXML = this.retrieveXML.bind(this)\n    this.state = {\n      xmlstring: \"\"\n    }\n  }\n  retrieveXML(info){\n\n    //construct file url request ot exist db to get a cors enabled copy of the text (github does not serve files with cors enabled)\n    // const doc = info.cdoc\n    // const topLevel = info.topLevel\n    // const docFragment = doc.split(\"/master/\")[1]\n    // const topLevelFragment = info.topLevel.split(\"/resource/\")[1]\n\n    //const xmlurl = \"http://exist.scta.info/exist/apps/scta-app/text/\" + topLevelFragment + \"/\" + docFragment;\n    const xmlurl = info.cxml\n    // const xmlDoc = loadXMLDoc(xmlurl)\n    // console.log(\"xmlDoc\", xmlDoc, info.resourceid)\n    // const p = xmlDoc.evaluate(\"//tei:p[@xml:id='\" + info.resourceid + \"']\", xmlDoc, nsResolver, XPathResult.ANY_TYPE, null);\n    // console.log(\"paragraph\", p)\n    Axios.get(xmlurl).then((d) => {\n\n      this.setState({xmlstring: d.data})\n    })\n\n  }\n  componentDidMount(){\n    this.retrieveXML(this.props.info)\n\n  }\n  componentWillReceiveProps(nextProps){\n    this.retrieveXML(nextProps.info)\n  }\n\n  render(){\n    const codeString = '<xml><div>Test</div></xml>';\n    return (\n      <div className={this.props.hidden ? \"hidden\" : \"showing\"}>\n      <SyntaxHighlighter language=\"xml\" style={docco} showLineNumbers>\n        {this.state.xmlstring}\n      </SyntaxHighlighter>\n      </div>\n    )\n  }\n}\n\nexport default XmlView;\n","import React from 'react';\nimport Axios from \"axios\"\n\nimport {Link} from 'react-router-dom';\n\nclass Info extends React.Component {\n  constructor(props){\n    super(props)\n\n\n  }\n\n  componentDidMount(){\n\n\n  }\n  componentWillReceiveProps(newProps){\n\n  }\n\n  render(){\n    const displayRelatedExpressions = () => {\n      //prevents against rendering if info is not present\n      if (this.props.info){\n        //prevents against rendering if relatedExpressions is not present\n        if (this.props.info.relatedExpressions){\n          const relatedExpressions = this.props.info.relatedExpressions.map((r) => {\n            return <p key={r.resourceid}>{r.relationLabel} <Link to={\"/text?resourceid=\" + r.resourceid}>{r.resourceid}</Link></p>\n          })\n          return relatedExpressions\n        }\n      }\n    }\n    const displayManifestations = () => {\n      if (this.props.info){\n        const manifestations = this.props.info.manifestations.map((i) => {\n          return <p key={i.manifestation}>{i.manifestationTitle} : <Link to={\"/text?resourceid=\" + i.manifestation}>{i.manifestation}</Link></p>\n        })\n        return manifestations\n      }\n    }\n    const displayInfo = () => {\n      if (this.props.info){\n        return(\n          <div>\n          <p key=\"id\">Resourceid: {this.props.info.resourceid.includes('http') ? this.props.info.resourceid : \"http://scta.info/resource/\" + this.props.info.resourceid}</p>\n          <p key=\"inbox\">LDN Inbox: {this.props.info.inbox}</p>\n          </div>\n        )\n      }\n    }\n  return (\n\n    <div className={this.props.hidden ? \"hidden\" : \"showing\"}>\n      <h1>Info</h1>\n      {displayInfo()}\n      <div>\n      <p>Manifestations</p>\n      {displayManifestations()}\n      </div>\n      <div>\n      <p>Related Expression</p>\n      {displayRelatedExpressions()}\n      </div>\n\n\n\n    </div>\n    );\n  }\n}\n\nexport default Info;\n","import React from 'react';\nimport {NavLink} from 'react-router-dom';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\n\nimport { FaTimes, FaSearch, FaGripVertical, FaCode, FaInfo, FaRegImage, FaAngleDoubleDown, FaAngleDoubleLeft, FaComments, FaRegWindowRestore, FaRegWindowMaximize, FaRegWindowMinimize, FaRegWindowClose} from 'react-icons/fa';\n\n\nimport {resourceEndpoint} from './config';\n\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\n\n\nfunction WindowNavBar(props) {\n\n  return (\n  <Nav variant=\"tabs\">\n  {\n    //<Navbar.Brand href=\"/\">Focus: {props.focus}</Navbar.Brand>\n  }\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleTabChange(\"info\", props.windowId)}}><FaInfo/></Nav.Link>\n  </Nav.Item>\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleTabChange(\"surface2\", props.windowId)}}><FaRegImage/></Nav.Link>\n  </Nav.Item>\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleTabChange(\"xml\", props.windowId)}}><FaCode/></Nav.Link>\n  </Nav.Item>\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleTabChange(\"textCompare\", props.windowId)}}><FaGripVertical/></Nav.Link>\n  </Nav.Item>\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleTabChange(\"search\", props.windowId)}}><FaSearch/></Nav.Link>\n  </Nav.Item>\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleTabChange(\"comments\", props.windowId)}}><FaComments/></Nav.Link>\n  </Nav.Item>\n  {props.openWidthHeight != \"minimum\" &&\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleMinimize(props.windowId)}}><FaRegWindowMinimize/></Nav.Link>\n  </Nav.Item>}\n  {props.openWidthHeight != \"middle\" &&\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleMiddlize(props.windowId)}}><FaRegWindowRestore/></Nav.Link>\n  </Nav.Item>\n  }\n  {props.openWidthHeight != \"maximum\" &&\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleMaximize(props.windowId)}}><FaRegWindowMaximize/></Nav.Link>\n  </Nav.Item>\n  }\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleClose(props.windowId)}}><FaRegWindowClose/></Nav.Link>\n  </Nav.Item>\n  <Nav.Item>\n    <Nav.Link onClick={() => {props.handleSwitchWindow(props.windowId, props.windowType)}}>{props.windowType === \"sideWindow\" ? <FaAngleDoubleDown/> : <FaAngleDoubleLeft/>}</Nav.Link>\n  </Nav.Item>\n\n\n</Nav>\n\n  );\n}\n\nexport default WindowNavBar;\n","import React from 'react';\n\nimport { FaAngleLeft, FaAngleRight} from 'react-icons/fa';\n\nimport {NavLink} from 'react-router-dom';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\n\nfunction NextPrevBar(props) {\n  const displayNextPrevBar = () => {\n    if (props.info){\n      return (\n        <Nav variant=\"tabs\">\n        <Nav.Link onClick={() => {props.handleBlockFocusChange(props.info.resourceid)}}>{props.info.title}</Nav.Link>\n        <Nav.Item>\n          {(props.info.previous && props.info.previous !== \"http://scta.info/resource/\")  && <Nav.Link onClick={() => {props.handleBlockFocusChange(props.info.previous)}}><FaAngleLeft/></Nav.Link>}\n        </Nav.Item>\n        <Nav.Item>\n          {(props.info.next && props.info.next !== \"http://scta.info/resource/\") && <Nav.Link onClick={() => {props.handleBlockFocusChange(props.info.next)}}><FaAngleRight/></Nav.Link>}\n        </Nav.Item>\n\n        </Nav>\n      )\n    }\n    else{\n      return null\n    }\n  }\n  return (\n    displayNextPrevBar()\n  );\n}\n\nexport default NextPrevBar;\n","import React from 'react';\nimport Diff from 'diff-match-patch'\nimport Axios from 'axios'\nimport {Link} from 'react-router-dom';\n\nimport { FaEyeSlash, FaEye, FaStar } from 'react-icons/fa';\n\nclass TextCompareItem extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleToggleShow = this.handleToggleShow.bind(this)\n    this.mounted = \"\"\n    this.state = {\n      compareText: \"\",\n      rawText: \"\",\n      show: true\n    }\n  }\n  handleToggleShow(){\n    this.setState((prevState) => {\n      return{\n        show: !prevState.show\n      }\n    })\n  }\n  createCompare(base, transcription){\n\n    Axios.get(\"http://exist.scta.info/exist/apps/scta-app/csv-pct.xq?resourceid=\" + transcription)\n          .then((text) => {\n\n            const dmp = new Diff.diff_match_patch();\n\n            const diff = dmp.diff_main(base, text.data);\n            // Result: [(-1, \"Hell\"), (1, \"G\"), (0, \"o\"), (1, \"odbye\"), (0, \" World.\")]\n            dmp.diff_cleanupSemantic(diff);\n            const ds = dmp.diff_prettyHtml(diff);\n            if (this.mounted === true && base){\n              this.setState({compareText: ds, rawText: text.data})\n            }\n\n          })\n        }\n\n  componentDidMount(){\n    this.mounted = true;\n    this.setState({rawText: \"\", compareText: \"\"})\n    this.createCompare(this.props.base, this.props.compareTranscription)\n  }\n  componentWillReceiveProps(newProps){\n    // conditional try to restrict new async calls to only when props.info changes\n    if (newProps.base !== this.props.base || newProps.compareTranscription !== this.props.compareTranscription){\n      this.setState({rawText: \"\", compareText: \"\"})\n      this.createCompare(newProps.base, newProps.compareTranscription)\n    }\n  }\n  componentWillUnmount(){\n      this.mounted = false;\n    }\n\n\n  render(){\n    const displayComparison = () => {\n      if (this.props.base && this.state.compareText){\n        return (\n          <div>\n            <span><Link to={\"/text?resourceid=\" + this.props.compareTranscription}>{this.props.compareTranscription}</Link></span>\n            <span onClick={() => this.handleToggleShow()}>{this.state.show ? <FaEyeSlash/> : <FaEye/>}</span>\n            <span onClick={() => this.props.handleChangeBase(this.state.rawText)}><FaStar/></span>\n            <div className={this.state.show ? \"unhidden\" : \"hidden\"}>\n              <div ref=\"text\" dangerouslySetInnerHTML={{ __html: this.state.compareText}}></div>\n            </div>\n          </div>\n        )\n      }\n      else{\n        return <p>Loading</p>\n      }\n    }\n\n    return (\n      displayComparison()\n    );\n  }\n}\n\nexport default TextCompareItem;\n","import React from 'react';\nimport Diff from 'diff-match-patch'\nimport Axios from 'axios'\nimport {Link} from 'react-router-dom';\nimport { FaEyeSlash, FaEye } from 'react-icons/fa';\n\n\n\nimport {runQuery} from './utils'\nimport {basicInfoQuery} from './Queries'\n\n\nimport TextCompareItem from './TextCompareItem'\n\n\n\nclass TextCompare extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleToggleShowAll = this.handleToggleShowAll.bind(this)\n    this.mounted = \"\"\n    this.state = {\n      info: \"\",\n      show: false,\n      baseText: \"\"\n    }\n\n  }\n\n  handleToggleShowAll(){\n    this.setState((prevState) => {\n      return{\n        show: !prevState.show\n      }\n    })\n  }\n\n  // TODO dupblicate of function in Text Component\n  // needs refactoring\n  arrangeTextInfo(info, resourceid){\n      info.then((d) => {\n        const bindings = d.data.results.bindings[0]\n        const manifestations = d.data.results.bindings.map((b) => {\n          return {\n            manifestation: b.manifestation.value,\n            manifestationTitle: b.manifestationTitle.value,\n            transcription: b.manifestationCTranscription.value\n          }\n        })\n        if (this.mounted === true && bindings){\n          this.setState({\n            info: {\n              resourceid: resourceid,\n              title: bindings.title.value,\n              structureType: bindings.structureType.value,\n              inbox: bindings.inbox.value,\n              next: bindings.next ? bindings.next.value : \"\",\n              previous: bindings.previous ? bindings.previous.value : \"\",\n              cdoc: bindings.cdoc.value,\n              cxml: bindings.cxml.value,\n              topLevel: bindings.topLevelExpression.value,\n              cmanifestation: bindings.cmanifestation.value,\n              ctranscription: bindings.ctranscription.value,\n              manifestations: manifestations\n            }\n          });\n        }\n      });\n    }\n  getTextInfo(id){\n    const info = runQuery(basicInfoQuery(id))\n    this.arrangeTextInfo(info, id)\n  }\n\n  componentDidMount(){\n    this.mounted = true;\n    this.setState({show: this.props.show, baseText: this.props.baseText})\n\n    if (this.props.isMainText){\n\n      this.setState({info: this.props.info})\n    }\n    else{\n      this.getTextInfo(this.props.expressionid)\n    }\n  }\n\n\n  componentWillReceiveProps(nextProps){\n    // conditional try to restrict new async calls to only when props.info changes\n    if (this.props.info.resourceid != nextProps.info.resourceid){\n      this.setState({baseText: nextProps.baseText})\n\n      if (nextProps.isMainText){\n        this.setState({info: nextProps.info})\n      }\n      else{\n        this.getTextInfo(nextProps.expressionid)\n\n      }\n    }\n  }\n    componentWillUnmount(){\n      this.mounted = false;\n  }\n\n  render(){\n    const displayComparisons = () => {\n      if (this.state.info.manifestations){\n        const texts = this.state.info.manifestations.map((m) => {\n          return (\n            <TextCompareItem\n            key={m.transcription}\n            base={this.props.baseText}\n            compareTranscription={m.transcription}\n            handleChangeBase={this.props.handleChangeBase}\n            show={this.state.show}\n            />\n          )\n        })\n        return texts\n      }\n    }\n\n  return (\n    <div>\n      {\n        // the link to reroute is not quite working, because the base Text is not resetting, focusBlockChange might be better; but item structure will also need to be changed.\n      }\n      <p><span>{this.props.relationLabel}</span> <Link to={\"/text?resourceid=\" + this.state.info.resourceid}>{this.state.info.resourceid}</Link>\n      <span onClick={() => this.handleToggleShowAll()}>{this.state.show ? <FaEyeSlash/> : <FaEye/>}</span></p>\n      <div className={this.state.show ? \"unhidden\" : \"hidden\"}>\n      {displayComparisons()}\n      </div>\n    </div>\n\n  );\n  }\n}\n\nexport default TextCompare;\n","import React from 'react';\nimport Diff from 'diff-match-patch'\nimport Axios from 'axios'\n\nimport TextCompare from './TextCompare'\n\n\nclass TextCompareWrapper extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleCompare = this.handleToggleCompare.bind(this)\n    this.handleChangeBase = this.handleChangeBase.bind(this)\n    this.getText = this.getText.bind(this)\n    this.mounted = \"\"\n    this.state = {\n      expressions: {},\n      baseText: \"\"\n    }\n\n  }\n  handleChangeBase(rawText){\n    this.setState({baseText: rawText})\n  }\n  handleToggleCompare(expressionid){\n    this.setState((prevState) => {\n      const newExpressions = {...prevState.expressions}\n      newExpressions[expressionid].show = !newExpressions[expressionid].show\n      return {\n        expressions: newExpressions\n      }\n    })\n  }\n  getText(ctranscription){\n    const _this = this;\n    Axios.get(\"http://exist.scta.info/exist/apps/scta-app/csv-pct.xq?resourceid=\" + ctranscription).\n      then((text) => {\n        _this.setState({baseText: text.data})\n      })\n    }\n\n  componentDidMount(){\n    // prevents check when prop.info is not set\n    if (this.props.info){\n      // prevents check when prop.info.relatedExpressions is not set\n      if (this.props.info.relatedExpressions){\n        this.getText(this.props.info.ctranscription)\n        const expressions = {}\n        expressions[this.props.info.resourceid] = {id: this.props.info.resourceid, show: true}\n\n        this.props.info.relatedExpressions.forEach((r) => {\n          expressions[r.resourceid] = {id: r.resourceid, relationLabel: r.relationLabel, show: false}\n        })\n        this.setState({expressions: expressions})\n      }\n    }\n  }\n  componentWillReceiveProps(nextProps){\n    // only fire reload if \"info resource\" has changed\"\n    if (this.props.info.resourceid != nextProps.info.resourceid){\n\n    // this conditional is needed, because props are waiting on multiple async calls.\n    // when an async call finishes it will up; and the related Expression query last,\n    // it will use the old ctranscription prop overriding the the update from the prop update from the other async call\n    if (this.props.info.relatedExpressions){\n      // this conditional may no longer be necessary based on first conditional check\n      if (this.props.info.ctranscription != nextProps.info.ctranscription){\n        this.getText(nextProps.info.ctranscription)\n      }\n      const expressions = {}\n      expressions[nextProps.info.resourceid] = {id: nextProps.info.resourceid, show: true}\n      nextProps.info.relatedExpressions.forEach((r) => {\n        expressions[r.resourceid] = {id: r.resourceid, relationLabel: r.relationLabel, show: false}\n      })\n      this.setState({expressions: expressions})\n    }\n  }\n  }\n  render(){\n    const displayExpressions = () => {\n      const exObject = this.state.expressions\n      const expressions = Object.keys(exObject).map((key) => {\n        const isMainText = this.props.info.resourceid === exObject[key].id ? true : false\n        return (\n          <div key={this.state.expressions[key].id}>\n            {<TextCompare\n              info={this.props.info}\n              expressionid={exObject[key].id}\n              relationLabel={exObject[key].relationLabel}\n              isMainText={isMainText}\n              handleChangeBase={this.handleChangeBase}\n              baseText={this.state.baseText}\n              show={exObject[key].show}\n              />}\n          </div>\n        )\n      })\n      return expressions\n    }\n\n  return (\n    <div className={this.props.hidden ? \"hidden\" : \"showing\"}>\n    {displayExpressions()}\n    </div>\n\n  );\n  }\n}\n\nexport default TextCompareWrapper;\n","import React from 'react';\n\nfunction CommentItem(props) {\n  return (\n    <div className=\"comment\">\n      <p>{props.n && props.n.body.value}</p>\n      </div>\n  );\n}\n\nexport default CommentItem;\n","import React from 'react';\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\n\nclass CommentCreate extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleCommentUpdate = this.handleCommentUpdate.bind(this)\n    this.handleSubmitComment = this.handleSubmitComment.bind(this)\n    this.state = {\n      comment: \"\"\n    }\n  }\n  handleCommentUpdate(e){\n    e.preventDefault()\n    this.setState({comment: e.target.value})\n\n  }\n  handleSubmitComment(e){\n    e.preventDefault()\n    this.props.handleSumbitComment(this.state.comment)\n  }\n  render(){\n    return (\n      <div className=\"comment\">\n        <Form onSubmit={this.handleSubmitComment}>\n         <FormControl type=\"text\" id=\"comment\" placeholder=\"comment\" className=\"mr-sm-2\" onChange={this.handleCommentUpdate} />\n         <Button type=\"submit\" variant=\"outline-success\">Search</Button>\n       </Form>\n      </div>\n    );\n  }\n}\n\nexport default CommentCreate;\n","import React from 'react';\nimport Axios from 'axios'\nimport uuidv4 from 'uuid/v4'\n\nimport CommentItem from \"./CommentItem\"\nimport CommentCreate from \"./CommentCreate\"\n\nclass Comments extends React.Component {\n  constructor(props){\n  super(props)\n  this.handleSumbitComment = this.handleSumbitComment.bind(this)\n  this.state = {\n    notifications: [],\n    inbox: \"\",\n    resourceid: \"\"\n  }\n}\nhandleSumbitComment(comment){\n  const _this = this;\n\n  const randomid = uuidv4();\n  const annotat = {\n    \"@context\": \"http://www.w3.org/ns/anno.jsonld\",\n    \"id\": \"http://inbox.scta.info/notifications/\" + randomid,\n    \"type\": \"Annotation\",\n    \"motivation\": \"commenting\",\n    \"body\": {\n      \"type\": \"TextualBody\",\n      \"value\": comment\n    },\n    \"target\": this.state.resourceid\n  }\n  Axios({\n    method: 'post',\n    url: this.state.inbox,\n    data: annotat,\n    config: { headers: {'Content-Type': 'application/json+ld' }}\n    })\n    .then(function (response) {\n      _this.setState((prevState) => {\n        return {notifications: [annotat, ...prevState.notifications, ]}\n      });\n        //handle success\n        console.log(response);\n    })\n    .catch(function (response) {\n        //handle error\n        console.log(response);\n    });\n\n\n  }\n  retrieveComments(inbox){\n    // using callback here to make sure state is set before making second a sync call.\n    // TODO: consider using this in other components to prevent out of sync behavior\n    // especially is TextCompareComponents\n    this.setState({notifications: []}, function() {\n      Axios.get(inbox).then((d) => {\n        d.data[\"ldp:contains\"].forEach((n) => {\n          //TODO annoying that each comment has to be requestd.\n          // if inbox main list included full comment, only one request would be needed\n          Axios.get(n[\"@id\"]).then((d2) => {\n            console.log(\"d2\", d2)\n            this.setState((prevState) => {\n              return {notifications: [...prevState.notifications, d2.data]}\n            });\n          });\n        })\n      }).catch((e) => {\n        console.log(e)\n      })\n    })\n  }\n  componentDidMount(){\n    // conditional prevents against needless attempt to retreive comments with info is not present\n    if (this.props.info){\n      this.setState({inbox: this.props.info.inbox, resourceid: this.props.info.resourceid})\n      this.retrieveComments(this.props.info.inbox)\n    }\n  }\n  componentWillReceiveProps(newProps){\n    // conditional prevents against needlessly rerequesting information when \"info\" is the same\n    if (newProps.info != this.props.info){\n      this.setState({inbox: newProps.info.inbox, resourceid: newProps.info.resourceid})\n      this.retrieveComments(newProps.info.inbox)\n    }\n  }\n  render(){\n    const displayComments = () => {\n      const comments = this.state.notifications.map((n, i) => {\n        return (\n          <CommentItem key={i} n={n}/>\n        )\n      })\n      return comments\n    }\n    return (\n      <div className={this.props.hidden ? \"hidden\" : \"showing\"}>\n        <h1>Comments</h1>\n        <CommentCreate handleSumbitComment={this.handleSumbitComment}/>\n        {displayComments()}\n      </div>\n    );\n\n  }\n\n\n\n\n}\n\nexport default Comments;\n","import React from 'react';\nimport Surface from \"./Surface\"\nimport Surface2 from \"./Surface2\"\nimport XmlView from \"./XmlView\"\nimport Info from \"./Info\"\nimport WindowNavBar from \"./WindowNavBar\"\nimport NextPrevBar from \"./NextPrevBar\"\nimport TextCompareWrapper from \"./TextCompareWrapper\"\nimport SearchWrapper from \"./SearchWrapper\"\nimport Comments from \"./Comments\"\n\n\n\nclass Window extends React.Component {\n  constructor(props){\n    super(props)\n    this.state = {\n      windowLoad: \"\",\n    }\n  }\n\n  componentDidMount(){\n    this.setState({windowLoad: this.props.windowLoad})\n\n\n  }\n  componentWillReceiveProps(newProps){\n    this.setState({windowLoad: newProps.windowLoad})\n\n\n  }\n\n\n  render(){\n    const displayManifestations = () => {\n      const newManifestations = this.state.manifestations.map((m) => {return <p>{m.value}</p>})\n      return newManifestations\n    }\n    const displayChild = () => {\n      return(\n        <div>\n          {// including search wrapper here as hidden instead of above in switch, so that results don't have to be reload\n          }\n          <SearchWrapper info={this.props.info} hidden={this.state.windowLoad != \"search\"} topLevel={this.props.info.topLevel}/>\n          <TextCompareWrapper info={this.props.info} relatedExpressions={this.props.relatedExpressions} hidden={this.state.windowLoad != \"textCompare\"}/>\n          <XmlView info={this.props.info} hidden={this.state.windowLoad != \"xml\"}/>\n          <Info info={this.props.info} relatedExpressions={this.props.relatedExpressions} topLevel={this.props.topLevel} hidden={this.state.windowLoad != \"info\"}/>\n          <Surface2 surfaceid={this.props.surfaceid} topLevel={this.props.topLevel} handleSurfaceFocusChange={this.props.handleSurfaceFocusChange} hidden={this.state.windowLoad != \"surface2\"}/>\n          <Comments info={this.props.info} hidden={this.state.windowLoad != \"comments\"}/>\n          {\n            //<Surface surfaceid={this.props.surfaceid} topLevel={this.props.topLevel}/>\n          }\n        </div>\n      )\n\n    }\n\n  return (\n    <div className={this.props.windowType + \" \" + this.props.windowType + this.props.openWidthHeight}>\n      <WindowNavBar handleTabChange={this.props.handleTabChange}\n      handleClose={this.props.handleClose}\n      handleMinimize={this.props.handleMinimize}\n      handleMaximize={this.props.handleMaximize}\n      handleMiddlize={this.props.handleMiddlize}\n      windowType={this.props.windowType}\n      openWidthHeight={this.props.openWidthHeight}\n      windowId={this.props.windowId}\n      focus={this.props.resourceid}\n      handleSwitchWindow={this.props.handleSwitchWindow}\n      />\n      <NextPrevBar info={this.props.info} handleBlockFocusChange={this.props.handleBlockFocusChange}/>\n\n      {displayChild()}\n\n    </div>\n    );\n  }\n}\n\nexport default Window;\n","import React from 'react';\nimport {NavLink} from 'react-router-dom';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\n\n\nclass TextNavBar extends React.Component {\n  constructor(props){\n    super(props)\n    this.state = {\n      next: \"\",\n      previous: \"\"\n    }\n  }\n  componentWillReceiveProps(nextProps){\n    this.setState({next: nextProps.next, previous: nextProps.previous})\n  }\n  render(){\n    return (\n      <Navbar bg=\"light\" variant=\"light\" expand=\"lg\" fixed=\"bottom\">\n        <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n        <Navbar.Collapse id=\"basic-navbar-nav\">\n        <Nav>\n          {this.props.previous && <NavLink className=\"nav-link\" to={\"/text?resourceid=\" + this.props.previous}>Previous</NavLink>}\n          {this.props.next && <NavLink className=\"nav-link\" to={\"/text?resourceid=\" + this.props.next}>Next</NavLink>}\n          {this.props.next && <NavLink className=\"nav-link\" to={\"/text?resourceid=\" + this.props.topLevel}>Text Home</NavLink>}\n        </Nav>\n        </Navbar.Collapse>\n      </Navbar>\n\n    );\n  }\n}\n\nexport default TextNavBar;\n","import React from 'react';\n\nimport {Link} from 'react-router-dom';\nimport Axios from 'axios'\nimport Alert from 'react-bootstrap/Alert';\n\nimport {runQuery} from './utils'\nimport {versionHistoryInfo} from './Queries'\n\nclass VersionChain extends React.Component {\n  constructor(props){\n    super(props)\n    this.getVersionHistory = this.getVersionHistory.bind(this)\n    this.handleToggleShowVersions = this.handleToggleShowVersions.bind(this)\n    this.state = {\n      versions: [],\n      currentVersion: {},\n      showVersions: false\n    }\n  }\n  handleToggleShowVersions(){\n    this.setState((prevState) => {\n      return {showVersions: !prevState.showVersions}\n    })\n  }\n  getVersionHistory(itemInfo){\n      const versionChainInfo = runQuery(versionHistoryInfo(itemInfo.transcriptionid))\n      versionChainInfo.then((d) => {\n        const b = d.data.results.bindings\n        const versions = []\n        b.forEach((b, i) => {\n          var reviewUrl = \"https://dll-review-registry.scta.info/api/v1/reviews/?url=\" + b.doc.value + \"?society=MAA\"\n          Axios(reviewUrl).then((d2) => {\n            const data = d2.data\n            var reviewObject = {}\n            if (data.length > 0){\n              reviewObject = {\n                img_url: data[0][\"badge-url\"],\n                reviewid: data[0][\"id\"],\n                ipfsHash: data[0][\"ipfs-hash\"],\n                html_link: \"https://dll-review-registry.scta.info/reviews/\" + data[0][\"id\"] + \".html\",\n                rubric_link: data[0][\"badge-rubric\"],\n                summary: data[0][\"review-summary\"]\n              }\n            }\n            this.setState((prevState) => {\n              const newVersion = {\n                versionTranscription: b.version ? b.version.value : \"\",\n                versionLabel: b.version_label ? b.version_label.value : \"\",\n                versionOrderNumber: b.order_number ? b.order_number.value : \"\",\n                versionReview: b.review ? b.review.value : \"\",\n                versionDoc: b.doc ? b.doc.value : \"\",\n                versionReviewInfo: reviewObject,\n              }\n              return {\n                versions: [...prevState.versions, newVersion],\n                currentVersion: itemInfo\n              }\n            })\n          })\n        })\n      })\n    }\n  componentDidMount(){\n    //prevents call when itemInfo prop is not present\n    if (this.props.itemInfo){\n      this.getVersionHistory(this.props.itemInfo)\n    }\n  }\n  componentWillReceiveProps(newProps){\n      if (newProps.itemInfo.transcriptionid !== this.props.itemInfo.transcriptionid){\n        this.setState({versions: []}, () => {\n          this.getVersionHistory(newProps.itemInfo)\n        })\n      }\n\n\n  }\n  render(){\n    const displayVersions = () => {\n      const versions = this.state.versions.map((v) => {\n        const currentlyViewing = v.versionTranscription === this.state.currentVersion.transcriptionid ? \"currentlyViewing\" : \"\"\n        return (<p key={v.versionTranscription} className={currentlyViewing}>\n          {currentlyViewing ? <span>{v.versionLabel} (Currently Viewing)</span> : <Link to={\"/text?resourceid=\" + v.versionTranscription}>{v.versionLabel}</Link>}\n          {v.versionReviewInfo.html_link && <span> Peer Reviewed: <a href={v.versionReviewInfo.html_link}><img src={v.versionReviewInfo.img_url}/></a> </span>}\n          <span class=\"small\"> Data Source: <a href={v.versionDoc}>{v.versionDoc}</a> </span>\n          </p>)\n      })\n      return versions\n    }\n    const displayAlert = () => {\n      if (this.state.versions){\n        if (this.state.versions.length > 1){\n          return (\n            <Alert variant=\"info\">\n              <p onClick={this.handleToggleShowVersions}>This Text Has Multiple Indexed Versions</p>\n              {this.state.showVersions && displayVersions()}\n            </Alert>\n          )\n        }\n        else if (this.state.versions.length === 1){\n          const version = this.state.versions[0]\n          return (<Alert variant=\"info\">\n            <span>Version: {version.versionLabel} | Data Source: <a href={version.versionDoc}>{version.versionDoc}</a> </span>\n          </Alert>\n          )\n        }\n        else{\n          return null\n        }\n      }\n      else {\n        return null\n      }\n    }\n    return (\n      displayAlert()\n    );\n  }\n}\n\nexport default VersionChain;\n","import React from 'react';\nimport Qs from \"query-string\"\n\nimport Container from 'react-bootstrap/Container';\n\n\nimport Window from \"./Window\"\nimport TextNavBar from \"./TextNavBar\"\nimport Text from \"./Text\"\nimport VersionChain from \"./VersionChain\"\nimport {runQuery, scrollToParagraph} from './utils'\n\nimport {getRelatedExpressions, basicInfoQuery, itemTranscriptionInfoQuery} from './Queries'\n\n\nclass TextWrapper extends React.Component {\n  constructor(props){\n    super(props)\n    this.mount = false\n    this.openWindow = this.openWindow.bind(this)\n    this.setFocus = this.setFocus.bind(this)\n    this.handleTabChange = this.handleTabChange.bind(this)\n    this.handleClose = this.handleClose.bind(this)\n    this.handleMinimize = this.handleMinimize.bind(this)\n    this.handleMaximize = this.handleMaximize.bind(this)\n    this.handleMiddlize = this.handleMiddlize.bind(this)\n    this.handleSwitchWindow = this.handleSwitchWindow.bind(this)\n    this.handleSurfaceFocusChange = this.handleSurfaceFocusChange.bind(this)\n    this.state = {\n      doc: \"\",\n      focus: \"\",\n      //focusRelatedExpressions: \"\",\n      itemFocus: \"\",\n      surfaceid: \"\",\n      windows: {\n        window1: {\n          windowId: \"window1\",\n          open: false,\n          windowLoad: \"info\",\n          position: \"sideWindow\",\n          openWidthHeight: \"middle\"\n        },\n        window2: {\n          windowId: \"window2\",\n          open: false,\n          windowLoad: \"info\",\n          position: \"bottomWindow\",\n          openWidthHeight: \"middle\"\n        }\n      }\n    }\n  }\n  openWindow(id, windowLoad){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[id].open = true\n      windows[id].windowLoad = windowLoad\n      return {\n        windows: windows,\n      }\n    })\n  }\n  handleClose(windowId){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].open = !windows[windowId].open\n      return {windows: windows}\n\n    })\n    //scroll is supposed to re-align text scroll to focused paragraph after side bar close.\n    //but it is not quite working\n    scrollToParagraph(this.state.blockFocus, true)\n\n  }\n  handleMinimize(windowId){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].openWidthHeight = \"minimum\"\n      return {windows: windows}\n\n    })\n  }\n  handleMaximize(windowId){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].openWidthHeight = \"maximum\"\n      return {windows: windows}\n\n    })\n  }\n  handleMiddlize(windowId){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].openWidthHeight = \"middle\"\n      return {windows: windows}\n\n    })\n  }\n  handleSwitchWindow(windowId, windowType){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      if (windows[windowId].position === \"sideWindow\"){\n        windows[windowId].position = \"bottomWindow\"\n        // these conditionals control whether an already existing window will be closed when the other is moved\n        // while commented they allow window1 and window2 to stack on top of each other\n\n        // if (windowId === \"window1\"){\n        //   windows[\"window2\"].open = false\n        // }\n        // else if ((windowId === \"window2\")){\n        //   windows[\"window1\"].open = false\n        // }\n      }\n      else if (windows[windowId].position === \"bottomWindow\"){\n        windows[windowId].position = \"sideWindow\"\n        // these conditionals control whether an already existing window will be closed when the other is moved\n        // while commented they allow window1 and window2 to stack on top of each other\n\n        // if (windowId === \"window1\"){\n        //   windows[\"window2\"].open = false\n        // }\n        // else if ((windowId === \"window2\")){\n        //   windows[\"window1\"].open = false\n        // }\n      }\n      return {windows: windows}\n\n    })\n  }\n  handleTabChange(windowLoad, windowId){\n\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].windowLoad = windowLoad\n      return {windows: windows}\n\n    })\n\n  }\n\n  handleSurfaceFocusChange(surfaceid){\n    this.setState({surfaceid: surfaceid})\n  }\n\n\n  setFocus(id){\n    const fullid = id.includes(\"http\") ? id : \"http://scta.info/resource/\" + id\n    const shortid = id.includes(\"http\") ? id.split(\"/resource/\")[1] : id\n    // get info\n    const info = runQuery(basicInfoQuery(fullid))\n    //arrange info and set it to state\n    this.arrangeFocusInfo(info, fullid)\n    // get related expressions info\n// removed these second calls and embed the query in arrange focus info to keep information in sync.\n// TODO remove below three lines\n    //const relatedExpressions = runQuery(getRelatedExpressions(fullid))\n    //arrange info and set it to state\n    //this.arrangeFocusRelatedInfo(relatedExpressions)\n\n    scrollToParagraph(shortid, true)\n\n  }\n\n  arrangeFocusInfo(info, resourceid){\n      info.then((d) => {\n        const bindings = d.data.results.bindings[0]\n        const manifestations = d.data.results.bindings.map((b) => {\n          return {\n            manifestation: b.manifestation.value,\n            manifestationTitle: b.manifestationTitle.value,\n            transcription: b.manifestationCTranscription.value\n          }\n        })\n        // TODO the need for this 2nd query and async call might\n        // be able to be removed using a construct query\n        // see example pattern in articles collection\n        const relatedExpressions = runQuery(getRelatedExpressions(resourceid))\n        relatedExpressions.then((d) => {\n          const bindings2 = d.data.results.bindings\n          const relatedExpressions = bindings2.map((r) => {\n              return {\n                resourceid: r.isRelatedTo.value,\n                relationLabel: r.label.value\n              }\n            });\n\n          if (this.mount){\n            this.setState({\n              focus: {\n                resourceid: resourceid,\n                title: bindings.title.value,\n                structureType: bindings.structureType.value,\n                inbox: bindings.inbox.value,\n                next: bindings.next ? bindings.next.value : \"\",\n                previous: bindings.previous ? bindings.previous.value : \"\",\n                cdoc: bindings.cdoc.value,\n                cxml: bindings.cxml.value,\n                topLevel: bindings.topLevelExpression.value,\n                cmanifestation: bindings.cmanifestation.value,\n                ctranscription: bindings.ctranscription.value,\n                manifestations: manifestations,\n                relatedExpressions: relatedExpressions\n              }\n            });\n          }\n        })\n      });\n    }\n  // embeded this within arrang focus info, so that information remains in sync\n  // TODO remove this\n    // arrangeFocusRelatedInfo(relatedInfo){\n    //     relatedInfo.then((d) => {\n    //       console.log(\"new data\", d)\n    //       const bindings = d.data.results.bindings\n    //       const relatedExpressions = bindings.map((r) => {\n    //           return {\n    //             resourceid: r.isRelatedTo.value,\n    //             relationLabel: r.label.value\n    //           }\n    //         });\n    //     if (this.mount){\n    //       this.setState({\n    //         focusRelatedExpressions: relatedExpressions\n    //       });\n    //       }\n    //     });\n    //   }\n    setItemFocus(id){\n      const fullid = id.includes(\"http\") ? id : \"http://scta.info/resource/\" + id\n      const shortid = id.includes(\"http\") ? id.split(\"/resource/\")[1] : id\n      // get info\n      const info = runQuery(itemTranscriptionInfoQuery(fullid))\n      this.arrangeItemFocusInfo(info)\n    }\n    arrangeItemFocusInfo(itemFocusInfo){\n        itemFocusInfo.then((d) => {\n          const bindings = d.data.results.bindings[0]\n          if (this.mount){\n            this.setState({\n              itemFocus: {\n                title: bindings.title.value,\n                manifestation: bindings.manifestation.value,\n                expression: bindings.expression.value,\n                doc: bindings.doc.value,\n                xml: bindings.xml.value,\n                next: bindings.next ? bindings.next.value : \"\",\n                previous: bindings.previous ? bindings.previous.value : \"\",\n                inbox: bindings.inbox.value,\n                topLevel: bindings.topLevelExpression.value,\n                transcriptionid: bindings.t.value\n              }\n            });\n          }\n        });\n      }\n\n  componentDidMount(){\n    this.mount = true\n    this.setItemFocus(this.props.transcriptionid)\n    if (this.props.blockDivFocus){\n      this.setFocus(this.props.blockDivFocus)\n    }\n  }\n  componentWillReceiveProps(newProps){\n    this.setItemFocus(newProps.transcriptionid)\n    if (newProps.blockDivFocus){\n      this.setFocus(newProps.blockDivFocus)\n    }\n  }\n  componentWillUnmount(){\n    this.mount = false\n  }\n  render(){\n    const displayWindows = () => {\n      const windows = Object.keys(this.state.windows).map((key) => {\n        if (this.state.windows[key].open && (this.state.focus || this.state.surfaceid)){\n          return (<Window windowLoad={this.state.windows[key].windowLoad}\n              key={key}\n              handleClose={this.handleClose}\n              handleMinimize={this.handleMinimize}\n              handleMaximize={this.handleMaximize}\n              handleMiddlize={this.handleMiddlize}\n              handleTabChange={this.handleTabChange}\n              handleBlockFocusChange={this.setFocus}\n              handleSurfaceFocusChange={this.handleSurfaceFocusChange}\n              handleSwitchWindow={this.handleSwitchWindow}\n              resourceid={this.state.focus.resourceid}\n              windowType={this.state.windows[key].position}\n              windowId={this.state.windows[key].windowId}\n              windowLoad={this.state.windows[key].windowLoad}\n              openWidthHeight={this.state.windows[key].openWidthHeight}\n              surfaceid={this.state.surfaceid}\n              info={this.state.focus}\n              topLevel={this.state.itemFocus.topLevel}\n              />\n            )\n          }\n        })\n        return windows\n      }\n    const textClass = () => {\n      let aSideWindowOpen = false;\n      if (this.state.windows.window1.open && this.state.windows.window1.position === \"sideWindow\" && this.state.windows.window1.openWidthHeight === \"middle\"){\n        aSideWindowOpen = true\n      }\n      else if (this.state.windows.window2.open && this.state.windows.window2.position === \"sideWindow\"){\n        aSideWindowOpen = true\n      }\n      return aSideWindowOpen\n    }\n\n    return (\n      <div>\n        {this.state.itemFocus &&\n          <VersionChain itemInfo={this.state.itemFocus}/>\n        }\n        <Container className={textClass() ? \"lbp-text skinnyText\" : \"lbp-text fullText\"}>\n          {this.state.itemFocus &&\n          <Text\n            doc={this.state.itemFocus.doc}\n            topLevel={this.state.itemFocus.topLevel}\n            setFocus={this.setFocus}\n            handleSurfaceFocusChange={this.handleSurfaceFocusChange}\n            openWindow={this.openWindow}\n            scrollTo={this.state.focus ? this.state.focus.resourceid.split(\"/resource/\")[1] : null}\n            />\n          }\n        </Container>\n        <TextNavBar\n          next={this.state.itemFocus && this.state.itemFocus.next}\n          previous={this.state.itemFocus && this.state.itemFocus.previous}\n          topLevel={this.state.itemFocus && this.state.itemFocus.topLevel}\n          handleClose={this.handleClose}\n        />\n        <div>\n        {\n        // <TextNavBar\n        // next={this.state.items[this.state.itemFocus] && this.state.items[this.state.itemFocus].next}\n        // previous={this.state.items[this.state.itemFocus] && this.state.items[this.state.itemFocus].previous}\n        // topLevel={this.state.items[this.state.itemFocus] && this.state.items[this.state.itemFocus].topLevel}\n        // handleClose={this.handleClose}\n        // />\n        }\n        {displayWindows()}\n        </div>\n      </div>\n    );\n  }\n}\nexport default TextWrapper;\n","import React from 'react';\nimport {Link} from 'react-router-dom';\nfunction Item(props) {\n  const displayItem = () => {\n    // conditions prevents attempt to render when props.item is not present\n    if (props.item){\n      return (\n        <tr>\n          {props.item.author && <td><Link to={\"/text?resourceid=\" + props.item.author}>{props.item.authorTitle}</Link></td>}\n          <td><Link to={\"/text?resourceid=\" + props.item.id}>{props.item.title}</Link></td>\n          {props.item.questionTitle ? <td><Link to={\"/text?resourceid=\" + props.item.id}>{props.item.questionTitle}</Link></td> : <td/>}\n        </tr>\n      )\n    }\n    else{\n      return null\n    }\n  }\n  return (\n    displayItem()\n  );\n}\n\nexport default Item;\n","import React from 'react';\nimport Qs from \"query-string\"\nimport Container from 'react-bootstrap/Container';\nimport InputGroup from 'react-bootstrap/InputGroup';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Table from 'react-bootstrap/Table';\n\nimport {loadXMLDoc, convertXMLDoc, runQuery, scrollToParagraph} from './utils'\nimport {getRelatedExpressions, basicInfoQuery, basicStructureItemInfoQuery, basicStructureAllItemsInfoQuery, getStructureType, partsInfoQuery,workGroupExpressionQuery} from './Queries'\nimport {Link} from 'react-router-dom';\n\nimport $ from 'jquery';\n\nimport Window from \"./Window\"\n\nimport TextNavBar from \"./TextNavBar\"\nimport Item from \"./Item\"\n\n//import Lbp from \"lbp.js/lib\"\n\n\nclass Collection extends React.Component {\n  constructor(props){\n    super(props)\n    //this.handleClose = this.handleClose.bind(this)\n    //this.handleBlockFocusChange = this.handleBlockFocusChange.bind(this)\n    //this.handleSurfaceFocusChange = this.handleSurfaceFocusChange.bind(this)\n    //this.handleTabChange = this.handleTabChange.bind(this)\n    //this.handleSwitchWindow = this.handleSwitchWindow.bind(this)\n    //this.retrieveText = this.retrieveText.bind(this)\n    this.retrieveCollectionInfo = this.retrieveCollectionInfo.bind(this)\n    this.makeRequests = this.makeRequests.bind(this)\n    this.handleFilter = this.handleFilter.bind(this)\n    this.filter = React.createRef();\n    this.mount = false\n    this.state = {\n      items: {},\n      parts: {},\n      filter: \"\",\n      surfaceFocus: \"\"\n    }\n\n  }\n  handleFilter(e){\n    const item = e.target.value\n    this.setState({filter: item})\n\n  }\n  handleSurfaceFocusChange(surfaceid){\n    this.setState({surfaceFocus: surfaceid})\n  }\n  arrangeParts(partsPromise){\n    const _this = this\n    partsPromise.then((d) => {\n        const bindings = d.data.results.bindings\n        let partsObject = {}\n        bindings.forEach((b) => {\n          const pId = b.part.value\n          partsObject[pId] = {\n            id: b.part.value,\n            title: b.partTitle.value,\n            type: b.partType.value,\n            questionTitle: b.partQuestionTitle ? b.partQuestionTitle.value : null,\n            level: b.partLevel ? b.partLevel.value : \"unknown\",\n        }\n      });\n      if (this.mount){\n        _this.setState(\n          {\n            parts: partsObject\n          }\n        )\n      }\n    });\n  }\n  arrangeItems(itemsPromise){\n    const _this = this\n    itemsPromise.then((d) => {\n      const bindings = d.data.results.bindings\n      let itemsObject = {}\n      bindings.forEach((b) => {\n        const itemId = b.item.value\n        itemsObject[itemId] = {\n          title: b.itemTitle.value,\n          id: b.item.value,\n          type: b.itemType.value,\n          questionTitle: b.itemQuestionTitle ? b.itemQuestionTitle.value : null,\n          author: b.itemAuthor ? b.itemAuthor.value : null,\n          authorTitle: b.itemAuthorTitle ? b.itemAuthorTitle.value : null,\n          next: b.next ? b.next.value : null,\n          previous: b.previous ? b.previous.value : null,\n          cm: b.cm ? b.cm.value : null,\n          cmTitle: b.cmTitle ? b.cmTitle.value : null,\n          ct: b.ct ? b.ct.value : null,\n          topLevel: b.topLevel ? b.topLevel.value : null,\n          doc: b.doc ? b.doc.value : null\n        }\n      });\n      if (this.mount){\n        _this.setState(\n          {\n            items: itemsObject\n          }\n        )\n      }\n    }).\n    catch((err) => {\n      console.log(err)\n    })\n  }\n\n  retrieveWorkGroupInfo(resourceid){\n    const _this = this;\n    const expressionsInfo = runQuery(workGroupExpressionQuery(resourceid))\n    const partsInfo = runQuery(partsInfoQuery(resourceid))\n    this.arrangeParts(partsInfo)\n    this.arrangeItems(expressionsInfo)\n  }\n  retrieveCollectionInfo(resourceid, structureType, topLevel){\n    const _this = this;\n    const collectionInfo = runQuery(basicStructureAllItemsInfoQuery(topLevel))\n    const partsInfo = runQuery(partsInfoQuery(resourceid))\n\n    //add parts to state\n    this.arrangeParts(partsInfo)\n    /// add items to state\n    this.arrangeItems(collectionInfo)\n  }\n  makeRequests(newResourceId, structureType, topLevel, type){\n\n    //\n    //   // get all expressions for this workGroup\n      if (type === \"http://scta.info/resource/workGroup\"){\n          this.retrieveWorkGroupInfo(newResourceId, structureType, topLevel)\n          //this.setState({itemFocus: \"\"})\n      }\n      // get all items for this collection\n      else if (structureType === \"http://scta.info/resource/structureCollection\"){\n          this.retrieveCollectionInfo(newResourceId, structureType, topLevel)\n          //this.setState({itemFocus: \"\"})\n      }\n\n  }\n  componentDidUpdate(prevProps, prevState){\n\n  }\n  componentDidMount(){\n    this.mount = true\n    const _this = this;\n    this.setState({resourceid: this.props.resourceid})\n    this.makeRequests(this.props.resourceid, this.props.structureType, this.props.topLevel, this.props.type)\n\n  }\n\n  componentWillReceiveProps(nextProps) {\n\n    this.refs.filter ? this.refs.filter.value = \"\" :\n    this.setState({resourceid: nextProps.resourceid, filter: \"\", blockFocus: \"\"})\n    this.makeRequests(nextProps.resourceid, nextProps.structureType, nextProps.topLevel, nextProps.type)\n  }\n  componentWillUnmount(){\n    this.mount = false\n  }\n  render(){\n    //const resourceid = Qs.parse(this.props.location.search, { ignoreQueryPrefix: true }).resourceid;\n\n    const displayQuestions = () => {\n      const questions = []\n      Object.keys(this.state.items).forEach((key) => {\n        const filterCheck = this.state.items[key].title + \" \" + this.state.items[key].authorTitle + \" \" + this.state.items[key].questionTitle\n        if (filterCheck.toLowerCase().includes(this.state.filter.toLowerCase())){\n        questions.push(\n          <Item item={this.state.items[key]}/>\n        )}\n      });\n      return (\n        <Container>\n\n        <h1>Items</h1>\n        <br/>\n        <Table striped bordered hover size=\"sm\">\n        <tbody>\n        {questions}\n        </tbody>\n        </Table>\n        </Container>\n      )\n    }\n    const displayParts = () => {\n        const questions = []\n        Object.keys(this.state.parts).forEach((key) => {\n          //check against filter\n            if (this.state.parts[key].title.toLowerCase().includes(this.state.filter.toLowerCase())){\n            questions.push(\n              <Item item={this.state.parts[key]}/>\n              )\n            }\n\n        });\n        //check against top level expression as parts; if parts are top level expression; don't display parts\n        const testPart = this.state.parts[Object.keys(this.state.parts)[0]]\n        if (testPart){\n          if (!(testPart.type === \"http://scta.info/resource/expression\" && testPart.level === \"1\")){\n            return (\n              <Container>\n              <h1>Parts</h1>\n              <br/>\n              <Table striped bordered hover size=\"sm\">\n              <tbody>\n              {questions}\n              </tbody>\n              </Table>\n              </Container>\n            )\n          }\n        }\n      }\n\n    return (\n      <Container>\n      <FormControl ref={this.filter} id=\"filter\" placeholder=\"type to filter\" onChange={this.handleFilter}/>\n      {displayParts()}\n      {displayQuestions()}\n      </Container>\n    );\n  }\n}\n\nexport default Collection;\n","import React from 'react';\nimport Qs from \"query-string\"\nimport Container from 'react-bootstrap/Container';\nimport InputGroup from 'react-bootstrap/InputGroup';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Table from 'react-bootstrap/Table';\n\nimport {runQuery} from './utils'\nimport {getAuthorInformation} from './Queries'\nimport {Link} from 'react-router-dom';\nimport Item from \"./Item\"\n\n//import Lbp from \"lbp.js/lib\"\n\n\nclass AuthorCollection extends React.Component {\n  constructor(props){\n    super(props)\n\n    this.retrieveAuthorCollectionInfo = this.retrieveAuthorCollectionInfo.bind(this)\n    this.handleItemFilter = this.handleItemFilter.bind(this)\n    this.itemFilter = React.createRef();\n\n    this.mount = false\n    this.state = {\n      authorTitle: \"\",\n      authorArticles: [],\n      textArticles: [],\n      expressions: [],\n      itemFilter: \"\",\n    }\n\n  }\n  handleItemFilter(e){\n    const item = e.target.value\n    this.setState({itemFilter: item})\n\n  }\n  arrangeItems(itemsPromise, resourceid){\n    const _this = this\n    itemsPromise.then((d) => {\n      console.log(\"data\", d)\n      const author = d.data[\"@graph\"].filter((i) => i[\"@id\"] === resourceid)[0]\n      console.log(\"author\", author)\n      //const authorExpressions = d.data[\"@graph\"].filter((i) => {i[\"@id\"] === author.hasTopLevelExpression})\n      const authorTitle = author[\"http://purl.org/dc/elements/1.1/title\"]\n      let authorArticles = null\n      if(Array.isArray(author.authorArticle)){\n        authorArticles =  author.authorArticle.map((a) => {\n          return {\n            id: a,\n            title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === a)[0][\"http://purl.org/dc/elements/1.1/title\"]\n          }\n        })\n      }\n      else{\n        authorArticles = [{id: author.autherArticle, title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === author.autherArticle)[0][\"http://purl.org/dc/elements/1.1/title\"]}]\n      }\n      let textArticles = null\n      if(Array.isArray(author.textArticle)){\n          textArticles =  author.textArticle.map((a) => {\n          return {\n            id: a,\n            title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === a)[0][\"http://purl.org/dc/elements/1.1/title\"]\n          }\n        })\n      }\n      else{\n        textArticles = [{id: author.textArticle, title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === author.textArticle)[0][\"http://purl.org/dc/elements/1.1/title\"]}]\n      }\n\n      let expressions = null\n      if(Array.isArray(author.hasTopLevelExpression)){\n        expressions =  author.hasTopLevelExpression.map((a) => {\n          return {\n            id: a,\n            title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === a)[0][\"http://purl.org/dc/elements/1.1/title\"]\n          }\n        })\n      }\n      else{\n        expressions = [{id: author.hasTopLevelExpression, title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === author.hasTopLevelExpression)[0][\"http://purl.org/dc/elements/1.1/title\"]}]\n      }\n      console.log(\"articles\", authorArticles)\n      console.log(\"textArticles\", textArticles)\n      console.log(\"expressions\", expressions)\n\n      this.setState({authorArticles: authorArticles, textArticles: textArticles, expressions: expressions, authorTitle: authorTitle })\n    }).\n    catch((err) => {\n      console.log(err)\n    })\n  }\n  retrieveAuthorCollectionInfo(resourceid){\n    const authorCollectionInfo = runQuery(getAuthorInformation(resourceid))\n    /// add items to state\n    this.arrangeItems(authorCollectionInfo, resourceid)\n  }\n  componentDidUpdate(prevProps, prevState){\n\n  }\n  componentDidMount(){\n    this.mount = true\n    this.retrieveAuthorCollectionInfo(this.props.resourceid)\n\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.refs.itemFilter ? this.refs.itemFilter.value = \"\" :\n    this.retrieveAuthorCollectionInfo(nextProps.resourceid)\n  }\n  componentWillUnmount(){\n    this.mount = false\n  }\n  render(){\n    //const resourceid = Qs.parse(this.props.location.search, { ignoreQueryPrefix: true }).resourceid;\n\n    const displayItems = (list) => {\n      const items = list.map((i) => {\n        return (\n\n          <Item item={i}/>\n\n        )\n      });\n      return items\n    }\n\n\n\n\n\n\n    return (\n      <div>\n      <h1>{this.state.authorTitle}</h1>\n      {this.state.expressions &&\n        <Container>\n        <h1>Expressions</h1>\n        <br/>\n        <Table striped bordered hover size=\"sm\">\n        <tbody>\n        {displayItems(this.state.expressions)}\n        </tbody>\n        </Table>\n        </Container>\n      }\n      {this.state.authorArticles &&\n        <Container>\n        <h1>Author Related Articles</h1>\n        <br/>\n        <Table striped bordered hover size=\"sm\">\n        <tbody>\n        {displayItems(this.state.authorArticles)}\n        </tbody>\n        </Table>\n        </Container>\n      }\n      {this.state.textArticles &&\n        <Container>\n        <h1>Text Related Articles</h1>\n        <br/>\n        <Table striped bordered hover size=\"sm\">\n        <tbody>\n        {displayItems(this.state.textArticles)}\n        </tbody>\n        </Table>\n        </Container>\n      }\n      </div>\n    );\n  }\n}\n\nexport default AuthorCollection;\n","import React from 'react';\nimport Qs from \"query-string\"\nimport TextWrapper from \"./TextWrapper\"\nimport Collection from \"./Collection\"\nimport AuthorCollection from \"./AuthorCollection\"\n\nimport {runQuery} from './utils'\nimport {getItemTranscription, getItemTranscriptionFromBlockDiv, getStructureType} from './Queries'\n\nclass TextSwitch extends React.Component {\n  constructor(props){\n    super(props)\n    this.state = {\n      displayType: \"\",\n      resourceid: \"\",\n      itemTranscriptionId: \"\",\n      blockDivFocus: \"\"\n    }\n  }\n  getInfo(resourceid){\n    const structureTypePromise = runQuery(getStructureType(resourceid))\n    structureTypePromise.then((t) => {\n      const type = t.data.results.bindings[0].type.value\n      const structureType = t.data.results.bindings[0].structureType ? t.data.results.bindings[0].structureType.value : null\n      const level = t.data.results.bindings[0].level ? t.data.results.bindings[0].level.value : null\n      const topLevel = t.data.results.bindings[0].topLevel ? t.data.results.bindings[0].topLevel.value : resourceid\n      const itemParent = t.data.results.bindings[0].itemParent ? t.data.results.bindings[0].itemParent.value : null\n      const itemTranscriptionId = t.data.results.bindings[0].ctranscription ? t.data.results.bindings[0].ctranscription.value : null\n      if (type === \"http://scta.info/resource/person\"){\n          this.setState({displayType: \"person\", resourceid: resourceid, structureType: \"\", topLevel: \"\", type: type})\n      }\n      else if (type === \"http://scta.info/resource/workGroup\"){\n          this.setState({displayType: \"collection\", resourceid: resourceid, structureType: structureType, topLevel: topLevel, type: type})\n      }\n      else if (structureType === \"http://scta.info/resource/structureCollection\"){\n          this.setState({displayType: \"collection\", resourceid: resourceid, structureType: structureType, topLevel: topLevel, type: type})\n      }\n      else if (structureType === \"http://scta.info/resource/structureItem\" ){\n        if (type === \"http://scta.info/resource/transcription\"){\n          this.setState({itemTranscriptionId: resourceid, displayType: \"item\"})\n        }\n        else {\n          const structureTypePromise = runQuery(getItemTranscription(resourceid))\n          structureTypePromise.then((t) => {\n            this.setState({itemTranscriptionId: t.data.results.bindings[0].ctranscription.value, displayType: \"item\"})\n          });\n        }\n      }\n      else if (structureType === \"http://scta.info/resource/structureBlock\" || structureType === \"http://scta.info/resource/structureDivision\" ){\n        const structureTypePromise = runQuery(getItemTranscriptionFromBlockDiv(resourceid))\n        structureTypePromise.then((t) => {\n          if (type === \"http://scta.info/resource/transcription\"){\n            this.setState({itemTranscriptionId: itemParent, blockDivFocus: t.data.results.bindings[0].blockDivExpression.value, displayType: \"item\"})\n          }\n          else if (type === \"http://scta.info/resource/expression\"){\n            this.setState({itemTranscriptionId: t.data.results.bindings[0].ctranscription.value, blockDivFocus: resourceid, displayType: \"item\"})\n          }\n          else {\n            this.setState({itemTranscriptionId: t.data.results.bindings[0].ctranscription.value, blockDivFocus: t.data.results.bindings[0].blockDivExpression.value, displayType: \"item\"})\n          }\n        });\n      }\n    });\n  }\n\n  componentDidMount(){\n    const _this = this;\n    const newResourceId = Qs.parse(this.props.location.search, { ignoreQueryPrefix: true }).resourceid\n    this.getInfo(newResourceId)\n  }\n  componentWillReceiveProps(nextProps) {\n    const newResourceId = Qs.parse(nextProps.location.search, { ignoreQueryPrefix: true }).resourceid\n    this.getInfo(newResourceId)\n  }\n\n\n\n  render(){\n    const display = () => {\n      if (this.state.displayType === \"person\"){\n        return (<AuthorCollection resourceid={this.state.resourceid}/>)\n\n      }\n      else if (this.state.displayType === \"collection\"){\n        return (<Collection resourceid={this.state.resourceid} structureType={this.state.structureType} topLevel={this.state.topLevel} type={this.state.type}/>)\n\n      }\n      else if (this.state.displayType === \"item\"){\n        return (<TextWrapper transcriptionid={this.state.itemTranscriptionId} blockDivFocus={this.state.blockDivFocus}/>)\n      }\n      else{\n        return null\n      }\n    }\n  return (\n    display()\n    );\n  }\n\n}\n\nexport default TextSwitch;\n","import React from 'react';\n\nfunction About() {\n  return (\n    <div className=\"About\">\n    <h1>About</h1>\n\n    </div>\n  );\n}\n\nexport default About;\n","import React from 'react';\nimport {NavLink} from 'react-router-dom';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\nimport NavDropdown from 'react-bootstrap/NavDropdown';\n\nimport {resourceEndpoint} from './config';\n\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\n\n\nfunction NavBar() {\n  return (\n    <Navbar bg=\"dark\" variant=\"light\" expand=\"lg\" fixed=\"top\">\n      <Navbar.Brand href=\"/\">SCTA</Navbar.Brand>\n      <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n      <Navbar.Collapse id=\"basic-navbar-nav\">\n      <Nav>\n\n        <NavLink className=\"nav-link\" to={\"/text?resourceid=\" + resourceEndpoint}>Text</NavLink>\n        {// example drop down\n          // <NavDropdown title=\"Dropdown\" id=\"basic-nav-dropdown\">\n        //   <NavDropdown.Item href=\"#action/3.1\">Action</NavDropdown.Item>\n        //   <NavDropdown.Item href=\"#action/3.2\">Another action</NavDropdown.Item>\n        //   <NavDropdown.Item href=\"#action/3.3\">Something</NavDropdown.Item>\n        //   <NavDropdown.Divider />\n        //   <NavDropdown.Item href=\"#action/3.4\">Separated link</NavDropdown.Item>\n        // </NavDropdown>\n      }\n      <NavLink className=\"nav-link\" to=\"/Search\">Search</NavLink>\n      </Nav>\n\n      <Nav>\n        <NavLink className=\"nav-link\" to=\"/about\">About</NavLink>\n        <NavLink className=\"nav-link\" to=\"/donate\">Donate</NavLink>\n      </Nav>\n      </Navbar.Collapse>\n    </Navbar>\n\n  );\n}\n\nexport default NavBar;\n","import React from 'react';\n\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\n\n\n\n\n\nfunction Footer() {\n  return (\n    <Container className=\"lbp-footer\" fluid>\n    <Row>\n    <Col>\n    <p>Designed by <a href=\"http://jeffreycwitt.com\">Jeffrey C. Witt</a></p>\n    </Col>\n    <Col>\n    <p>A <a href=\"http://lombardpress.org\">LombardPress</a> Publication</p>\n    </Col>\n    <Col>\n    <p>Powered by <a href=\"http://scta.info\">SCTA</a> Data</p>\n    </Col>\n    </Row>\n    </Container>\n\n  );\n}\n\nexport default Footer;\n","import React from 'react';\nimport {BrowserRouter, HashRouter, Route, Switch, Link, NavLink} from 'react-router-dom';\nimport Home from \"./Home\"\nimport SearchWrapper from \"./SearchWrapper\"\nimport Text from \"./Text\"\nimport TextSwitch from \"./TextSwitch\"\nimport About from \"./About\"\nimport NavBar from './NavBar';\n\n\n\nimport Footer from './Footer';\n\nimport 'bootstrap/dist/css/bootstrap.css'\nimport '../styles/App.scss';\n//import '../styles/index.scss';\n\nconst AppRouter = () => (\n  <HashRouter forceRefresh={false}>\n    <div>\n      <NavBar/>\n      <Switch>\n        <Route path=\"/\" exact={true} component={Home}/>\n        <Route path=\"/text\"  exact={true} component={TextSwitch}/>\n        <Route path=\"/about\" exact={true} component={About}/>\n        <Route path=\"/search\" exact={true} render={(props) => <SearchWrapper {...props} hidden={false}/>}/>\n        {\n          //<Route path=\"/edit/:id\" exact={true} component={EditExpensePage}/>\n        //<Route path=\"/help\" exact={true} component={HelpPage}/>\n        // <Route component={NotFoundPage}/>\n        }\n      </Switch>\n      <Footer/>\n    </div>\n  </HashRouter>\n)\n\nexport default AppRouter\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n//import './styles/index.scss';\nimport AppRouter from './components/AppRouter';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<AppRouter/>, document.getElementById('root'));\n\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}