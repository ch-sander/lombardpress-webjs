(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1294:function(e,t,n){},1295:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(40),o=n.n(r),s=n(37),l=n(105),c=n(51),u=n.n(c),p=n(507),h=n.n(p),d=n(82),m=n.n(d),f=n(25),v=n(26),b=n(28),y=n(27),w=n(22),E=n(29),g=n(83),T=n.n(g),x=n(48),O=n.n(x),k="https://sparql-docker.scta.info/ds/query",C="http://scta.info/resource/scta";function L(e){var t=new XMLHttpRequest;t.open("GET",e,!1);try{t.responseType="msxml-document"}catch(n){}return t.send(""),t.responseXML}function I(e){return O.a.get(k,{params:{query:e,output:"json"}})}function S(e,t){var n=T()("#"+e);t&&(n.addClass("highlight"),setTimeout(function(){n.addClass("highlightNone")},2e3)),n.length>0&&T()("html, body").stop().animate({scrollTop:n.offset().top-100},1e3)}var j=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e))).retrieveText=n.retrieveText.bind(Object(w.a)(n)),n}return Object(E.a)(t,e),Object(v.a)(t,[{key:"retrieveText",value:function(e,t,n){var a=this;if(e){var i=this.props.doc,r=this.props.topLevel,o=i.split("/master/")[1],s=r.split("/resource/")[1],l=function(e,t){var n=L(e),a=L(t),i=new XSLTProcessor;return i.importStylesheet(a),i.transformToFragment(n,document)}(i.includes("ipfs")?i:"http://exist.scta.info/exist/apps/scta-app/text/"+s+"/"+o,"/xslt/main_view.xsl");document.getElementById("text").innerHTML="",document.getElementById("text").appendChild(l)}T()(".lbp-paragraphmenu").click(function(e){e.preventDefault();var t=T()(this).attr("data-id");a.props.setFocus(t),a.props.openWindow("window1","info")}),S(n,!0),T()(".js-show-folio-image").click(function(e){e.preventDefault();var t=T()(this).attr("data-surfaceid");a.props.handleSurfaceFocusChange("http://scta.info/resource/"+t),a.props.openWindow("window2","surface2")})}},{key:"componentDidUpdate",value:function(e,t){e.doc!=this.props.doc?this.retrieveText(this.props.doc,this.props.topLevel,this.props.scrollTo):S(this.props.scrollTo,!0)}},{key:"componentDidMount",value:function(){this.retrieveText(this.props.doc,this.props.topLevel,this.props.scrollTo)}},{key:"componentWillReceiveProps",value:function(e){}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("div",{id:"text"}))}}]),t}(i.a.Component),N=n(73),A=n.n(N);var R=function(e){return A.a.parse(e.location.search,{ignoreQueryPrefix:!0}).resourceid?i.a.createElement(j,{resourceid:e.location.search.resourceid}):i.a.createElement("div",{className:"Home"},i.a.createElement(u.a,{id:"lbp-home",fluid:!0},i.a.createElement(u.a,null,i.a.createElement(h.a,{id:"lbp-jumbo"},i.a.createElement("h1",null,"The SCTA Reading Room"),i.a.createElement("p",null,"A site for reading, viewing, and studying the scholastic tradition"),i.a.createElement(m.a,null,"View the text")," | ",i.a.createElement(m.a,null,"Learn More")))))},D=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e))).retrieveResults=n.retrieveResults.bind(Object(w.a)(n)),n.state={searchResults:[],count:""},n}return Object(E.a)(t,e),Object(v.a)(t,[{key:"retrieveResults",value:function(e,t){var n=this;O.a.get("http://exist.scta.info/exist/apps/scta-app/jsonsearch/json-search-text-by-expressionid.xq?query="+e+"&expressionid="+t).then(function(e){n.setState({searchResults:e.data.results,count:e.data.count})})}},{key:"componentDidMount",value:function(){var e=this.props.query,t=this.props.eid;this.retrieveResults(e,t)}},{key:"componentWillReceiveProps",value:function(e){var t=e.query,n=e.eid;this.retrieveResults(t,n)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,e.state.searchResults.length>1?e.state.searchResults.map(function(e,t){return i.a.createElement("div",{key:t},i.a.createElement("p",null,i.a.createElement(s.b,{to:"/text?resourceid=http://scta.info/resource/"+e.pid},e.pid)),i.a.createElement("p",{dangerouslySetInnerHTML:{__html:e.text}}))}):e.state.searchResults?i.a.createElement("div",{key:e.state.searchResults.pid},i.a.createElement("p",null,i.a.createElement(s.b,{to:"/text?resourceid=http://scta.info/resource/"+e.state.searchResults.pid},e.state.searchResults.pid)),i.a.createElement("p",{dangerouslySetInnerHTML:{__html:e.state.searchResults.text}})):i.a.createElement("div",null,i.a.createElement("p",null,"No results")))}}]),t}(i.a.Component),W=n(133),P=n.n(W),F=n(66),M=n.n(F),_=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e))).handleQueryUpdate=n.handleQueryUpdate.bind(Object(w.a)(n)),n.handleEidUpdate=n.handleEidUpdate.bind(Object(w.a)(n)),n.handleRunSearch=n.handleRunSearch.bind(Object(w.a)(n)),n.state={query:"",eid:""},n}return Object(E.a)(t,e),Object(v.a)(t,[{key:"handleQueryUpdate",value:function(e){e.preventDefault(),this.setState({query:e.target.value})}},{key:"handleEidUpdate",value:function(e){e.preventDefault(),this.setState({eid:e.target.value})}},{key:"handleRunSearch",value:function(e){e.preventDefault(),this.props.handleRunSearch(this.state.query,this.state.eid)}},{key:"componentDidMount",value:function(){this.props.eid&&this.setState({eid:this.props.eid})}},{key:"componentWillReceiveProps",value:function(e){e.eid&&this.setState({eid:e.eid})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(P.a,{onSubmit:this.handleRunSearch},i.a.createElement(M.a,{type:"text",id:"query",placeholder:"query",className:"mr-sm-2",onChange:this.handleQueryUpdate}),!this.props.eid&&i.a.createElement(M.a,{type:"text",id:"eid",placeholder:"eid",className:"mr-sm-2",onChange:this.handleEidUpdate}),i.a.createElement(m.a,{type:"submit",variant:"outline-success"},"Search")))}}]),t}(i.a.Component),H=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e))).handleRunSearch=n.handleRunSearch.bind(Object(w.a)(n)),n.state={query:"",eid:""},n}return Object(E.a)(t,e),Object(v.a)(t,[{key:"handleRunSearch",value:function(e,t){this.setState({query:e,eid:t})}},{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(){}},{key:"render",value:function(){return i.a.createElement("div",{className:this.props.hidden?"hidden":"showing"},i.a.createElement("h1",null,"Search"),i.a.createElement(_,{handleRunSearch:this.handleRunSearch,eid:this.props.info&&this.props.info.topLevel.split("/resource/")[1]}),this.state.query&&i.a.createElement(D,{query:this.state.query,eid:this.state.eid}))}}]),t}(i.a.Component),q=n(75),U=n(211),B=n(19),z=n(511),V=n.n(z),Q=n(306),X=n.n(Q),G=n(512),Y=n.n(G),J=n(309),$=n.n(J),K=n(23),Z=n(514),ee=n.n(Z);i.a.Component;var te=function(e){var t=e.coords.split(","),n=parseInt(t[0])-20,a=t[1],r=parseInt(t[2])+40,o=t[3];console.log(e.coords);var s=n+","+a+","+r+","+o;console.log(s);var l=e.imageUrl+"/"+s+"/"+e.displayWidth+",/0/default.jpg";return i.a.createElement("img",{src:l})};var ne=function(e){return i.a.createElement("div",{className:"text",style:{"white-space":"nowrap"}},i.a.createElement("span",{dangerouslySetInnerHTML:{__html:e.text}}))},ae=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e))).state={searchText:""},n}return Object(E.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",Object(q.a)({className:"ImageTextWrapper"},"className",function(){if(e.props.targetLabel===e.props.label)return"target"}()),i.a.createElement("div",{className:"labelImageWrapper"},i.a.createElement(te,{imageUrl:this.props.imageUrl,canvas:this.props.canvas,coords:this.props.coords,canvasShort:this.props.canvasShort,displayWidth:this.props.displayWidth})),i.a.createElement(ne,{text:this.props.text}))}}]),t}(a.Component);function ie(e){return["SELECT DISTINCT ?title ?structureType ?cmanifestation ?cmanifestationTitle ?manifestation ?manifestationTitle ?ctranscription ?manifestationCTranscription ?cdoc ?cxml ?expressionShortId ?longTitle ?topLevelExpression ?next ?previous ?inbox ","WHERE { ","<"+e+"> <http://purl.org/dc/elements/1.1/title> ?title .","<"+e+"> <http://scta.info/property/structureType> ?structureType .","<"+e+"> <http://scta.info/property/hasCanonicalManifestation> ?cmanifestation .","?cmanifestation <http://purl.org/dc/elements/1.1/title> ?cmanifestationTitle .","<"+e+"> <http://scta.info/property/hasManifestation> ?manifestation .","?manifestation <http://purl.org/dc/elements/1.1/title> ?manifestationTitle .","?manifestation <http://scta.info/property/hasCanonicalTranscription> ?manifestationCTranscription .","?cmanifestation <http://scta.info/property/hasCanonicalTranscription> ?ctranscription .","?ctranscription <http://scta.info/property/hasDocument> ?cdoc . ","?ctranscription <http://scta.info/property/hasXML> ?cxml . ","<"+e+"> <http://scta.info/property/shortId> ?expressionShortId .","<"+e+"> <http://scta.info/property/longTitle> ?longTitle .","<"+e+"> <http://scta.info/property/isPartOfTopLevelExpression> ?topLevelExpression .","OPTIONAL {","<"+e+"> <http://scta.info/property/next> ?next .","}","OPTIONAL {","<"+e+"> <http://scta.info/property/previous> ?previous .","}","<"+e+"> <http://www.w3.org/ns/ldp#inbox> ?inbox . ","}","ORDER BY ?title"].join("")}function re(e){return["SELECT DISTINCT ?part ?partTitle ?partQuestionTitle ?partType ?partLevel ","WHERE { ","<"+e+"> <http://purl.org/dc/terms/hasPart> ?part .","?part <http://purl.org/dc/elements/1.1/title> ?partTitle .","?part <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?partType . ","OPTIONAL {","?part <http://scta.info/property/questionTitle> ?partQuestionTitle .","}","OPTIONAL {","?part <http://scta.info/property/level> ?partLevel .","}","OPTIONAL {","?part <http://scta.info/property/totalOrderNumber> ?totalOrderNumber .","}","}","ORDER BY ?totalOrderNumber"].join("")}var oe=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e))).handleNext=n.handleNext.bind(Object(w.a)(n)),n.handlePrevious=n.handlePrevious.bind(Object(w.a)(n)),n.handleToggleTextLines=n.handleToggleTextLines.bind(Object(w.a)(n)),n.state={currentSurfaceId:"",manifest:"",canvas:"",region:"full",width:"1000",next:"",previous:"",imageurl:"",annotationsDisplay:!0},n}return Object(E.a)(t,e),Object(v.a)(t,[{key:"handleNext",value:function(){this.props.handleSurfaceFocusChange(this.state.next)}},{key:"handlePrevious",value:function(){this.props.handleSurfaceFocusChange(this.state.previous)}},{key:"handleToggleTextLines",value:function(){this.setState(function(e){return{annotationsDisplay:!e.annotationsDisplay}})}},{key:"retrieveSurfaceInfo",value:function(e){var t=this;console.log("surfaceid",e);var n="http://scta.info/iiif/"+this.props.topLevel.split("/resource/")[1]+"/"+e.split("/resource/")[1].split("/")[0]+"/manifest";I(function(e){return["SELECT DISTINCT ?surfaceTitle ?c_height ?c_width ?isurface ?isurfaceTitle ?icodexTitle ?canvas ?imageurl ?next_surface ?previous_surface ","{","<"+e+"> <http://purl.org/dc/elements/1.1/title> ?surfaceTitle .","<"+e+"> <http://scta.info/property/hasISurface> ?isurface .","OPTIONAL {","<"+e+"> <http://scta.info/property/next> ?next_surface .","}","OPTIONAL {","<"+e+"> <http://scta.info/property/previous> ?previous_surface .","}","OPTIONAL {","?isurface <http://purl.org/dc/elements/1.1/title> ?isurfaceTitle .","?isurface <http://purl.org/dc/elements/1.1/isPartOf> ?icodex .","?icodex <http://purl.org/dc/elements/1.1/title> ?icodexTitle .","}","?isurface <http://scta.info/property/hasCanvas> ?canvas .","OPTIONAL{","?canvas <http://iiif.io/api/presentation/2#hasImageAnnotations> ?blank .","}","OPTIONAL{","?canvas <http://www.shared-canvas.org/ns/hasImageAnnotations> ?blank .","}","?canvas <http://www.w3.org/2003/12/exif/ns#width> ?c_width .","?canvas <http://www.w3.org/2003/12/exif/ns#height> ?c_height .","?blank <http://www.w3.org/1999/02/22-rdf-syntax-ns#first> ?o .","?o <http://www.w3.org/ns/oa#hasBody> ?o2 .","OPTIONAL{","?o2 <http://rdfs.org/sioc/services#has_service> ?imageurl .","}","OPTIONAL{","?o2 <http://www.shared-canvas.org/ns/hasRelatedService> ?imageurl .","}","}"].join("")}(e)).then(function(a){var i=a.data.results.bindings[0],r="https://exist.scta.info/exist/apps/scta-app/folio-annotaiton-list-from-simpleXmlCoordinates.xq?surfaceid="+e.split("/resource/")[1];O.a.get(r).then(function(a){a.data.resources;t.setState({currentSurfaceId:e,surfaceTitle:i.surfaceTitle.value,manifest:n,canvas:i.canvas.value,imageurl:i.imageurl.value,next:i.next_surface?i.next_surface.value:"",previous:i.previous_surface?i.previous_surface.value:"",annotations:a.data?a.data.resources:""})}).catch(function(a){console.log("failed retrieving annotationlist: ",a),t.setState({currentSurfaceId:e,surfaceTitle:i.surfaceTitle.value,manifest:n,canvas:i.canvas.value,imageurl:i.imageurl.value,next:i.next_surface?i.next_surface.value:"",previous:i.previous_surface?i.previous_surface.value:"",annotations:""})})})}},{key:"componentDidMount",value:function(){this.props.surfaceid&&(console.log("surfaceid",this.props.surfaceid),this.retrieveSurfaceInfo(this.props.surfaceid))}},{key:"componentWillReceiveProps",value:function(e){e.surfaceid&&this.retrieveSurfaceInfo(e.surfaceid)}},{key:"render",value:function(){var e=this;return i.a.createElement(u.a,{className:this.props.hidden?"hidden":"showing"},this.state.currentSurfaceId?i.a.createElement("div",null,i.a.createElement("div",{className:"surface-navigation"},i.a.createElement("p",null,this.state.surfaceTitle),this.state.previous&&i.a.createElement("p",null,i.a.createElement("a",{onClick:this.handlePrevious},"Previous")),this.state.next&&i.a.createElement("p",null,i.a.createElement("a",{onClick:this.handleNext},"Next")),this.state.annotations&&i.a.createElement("p",null,i.a.createElement("a",{onClick:this.handleToggleTextLines},"Toggle Text Lines"))),e.state.annotations&&e.state.annotationsDisplay?e.state.annotations.map(function(t,n){var a=t.resource.chars,r=t.on.split("#xywh=")[0],o=r.split("/")[r.split("/").length-1],s=t.on.split("#xywh=")[1],l=t.imageUrl,c=t.label;return e.props.targetLabel,i.a.createElement(ae,{key:n,imageUrl:l,canvas:r,coords:s,canvasShort:o,text:a,label:c,targetLabel:e.props.targetLabel,surfaceButton:!1,displayWidth:"1000"})}):i.a.createElement("img",{src:e.state.imageurl+"/"+e.state.region+"/"+e.state.width+",/0/default.jpg"})):i.a.createElement("p",null,"No surface selected"))}}]),t}(i.a.Component),se=n(1304),le=n(1303),ce=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e))).retrieveXML=n.retrieveXML.bind(Object(w.a)(n)),n.state={xmlstring:""},n}return Object(E.a)(t,e),Object(v.a)(t,[{key:"retrieveXML",value:function(e){var t=this,n=e.cxml;O.a.get(n).then(function(e){t.setState({xmlstring:e.data})})}},{key:"componentDidMount",value:function(){this.retrieveXML(this.props.info)}},{key:"componentWillReceiveProps",value:function(e){this.retrieveXML(e.info)}},{key:"render",value:function(){return i.a.createElement("div",{className:this.props.hidden?"hidden":"showing"},i.a.createElement(se.a,{language:"xml",style:le.a,showLineNumbers:!0},this.state.xmlstring))}}]),t}(i.a.Component),ue=function(e){function t(e){return Object(f.a)(this,t),Object(b.a)(this,Object(y.a)(t).call(this,e))}return Object(E.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillReceiveProps",value:function(e){}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:this.props.hidden?"hidden":"showing"},i.a.createElement("h1",null,"Info"),function(){if(e.props.info)return i.a.createElement("div",null,i.a.createElement("p",{key:"id"},"Resourceid: ",e.props.info.resourceid.includes("http")?e.props.info.resourceid:"http://scta.info/resource/"+e.props.info.resourceid),i.a.createElement("p",{key:"inbox"},"LDN Inbox: ",e.props.info.inbox))}(),i.a.createElement("div",null,i.a.createElement("p",null,"Manifestations"),function(){if(e.props.info)return e.props.info.manifestations.map(function(e){return i.a.createElement("p",{key:e.manifestation},e.manifestationTitle," : ",i.a.createElement(s.b,{to:"/text?resourceid="+e.manifestation},e.manifestation))})}()),i.a.createElement("div",null,i.a.createElement("p",null,"Related Expression"),function(){if(e.props.info.relatedExpressions)return e.props.info.relatedExpressions.map(function(e){return i.a.createElement("p",{key:e.resourceid},e.relationLabel," ",i.a.createElement(s.b,{to:"/text?resourceid="+e.resourceid},e.resourceid))})}()))}}]),t}(i.a.Component),pe=n(31),he=n.n(pe),de=n(46);var me=function(e){return i.a.createElement(he.a,{variant:"tabs"},i.a.createElement(he.a.Item,null,i.a.createElement(he.a.Link,{onClick:function(){e.handleTabChange("info",e.windowId)}},i.a.createElement(de.j,null))),i.a.createElement(he.a.Item,null,i.a.createElement(he.a.Link,{onClick:function(){e.handleTabChange("surface2",e.windowId)}},i.a.createElement(de.k,null))),i.a.createElement(he.a.Item,null,i.a.createElement(he.a.Link,{onClick:function(){e.handleTabChange("xml",e.windowId)}},i.a.createElement(de.e,null))),i.a.createElement(he.a.Item,null,i.a.createElement(he.a.Link,{onClick:function(){e.handleTabChange("textCompare",e.windowId)}},i.a.createElement(de.i,null))),i.a.createElement(he.a.Item,null,i.a.createElement(he.a.Link,{onClick:function(){e.handleTabChange("search",e.windowId)}},i.a.createElement(de.p,null))),i.a.createElement(he.a.Item,null,i.a.createElement(he.a.Link,{onClick:function(){e.handleTabChange("comments",e.windowId)}},i.a.createElement(de.f,null))),"minimum"!=e.openWidthHeight&&i.a.createElement(he.a.Item,null,i.a.createElement(he.a.Link,{onClick:function(){e.handleMinimize(e.windowId)}},i.a.createElement(de.n,null))),"middle"!=e.openWidthHeight&&i.a.createElement(he.a.Item,null,i.a.createElement(he.a.Link,{onClick:function(){e.handleMiddlize(e.windowId)}},i.a.createElement(de.o,null))),"maximum"!=e.openWidthHeight&&i.a.createElement(he.a.Item,null,i.a.createElement(he.a.Link,{onClick:function(){e.handleMaximize(e.windowId)}},i.a.createElement(de.m,null))),i.a.createElement(he.a.Item,null,i.a.createElement(he.a.Link,{onClick:function(){e.handleClose(e.windowId)}},i.a.createElement(de.l,null))),i.a.createElement(he.a.Item,null,i.a.createElement(he.a.Link,{onClick:function(){e.handleSwitchWindow(e.windowId,e.windowType)}},"sideWindow"===e.windowType?i.a.createElement(de.a,null):i.a.createElement(de.b,null))))};var fe=function(e){return i.a.createElement(he.a,{variant:"tabs"},i.a.createElement(he.a.Link,{onClick:function(){e.handleBlockFocusChange(e.info.resourceid)}},e.info.title),i.a.createElement(he.a.Item,null,e.info.previous&&"http://scta.info/resource/"!==e.info.previous&&i.a.createElement(he.a.Link,{onClick:function(){e.handleBlockFocusChange(e.info.previous)}},i.a.createElement(de.c,null))),i.a.createElement(he.a.Item,null,e.info.next&&"http://scta.info/resource/"!==e.info.next&&i.a.createElement(he.a.Link,{onClick:function(){e.handleBlockFocusChange(e.info.next)}},i.a.createElement(de.d,null))))},ve=n(210),be=n.n(ve),ye=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e))).handleToggleShow=n.handleToggleShow.bind(Object(w.a)(n)),n.mounted="",n.state={compareText:"",rawText:"",show:!0},n}return Object(E.a)(t,e),Object(v.a)(t,[{key:"handleToggleShow",value:function(){this.setState(function(e){return{show:!e.show}})}},{key:"createCompare",value:function(e,t){var n=this;O.a.get("http://exist.scta.info/exist/apps/scta-app/csv-pct.xq?resourceid="+t).then(function(t){var a=new be.a.diff_match_patch,i=a.diff_main(e,t.data);a.diff_cleanupSemantic(i);var r=a.diff_prettyHtml(i);!0===n.mounted&&e&&n.setState({compareText:r,rawText:t.data})})}},{key:"componentDidMount",value:function(){this.mounted=!0,this.setState({rawText:"",compareText:""}),this.createCompare(this.props.base,this.props.compareTranscription)}},{key:"componentWillReceiveProps",value:function(e){e.base===this.props.base&&e.compareTranscription===this.props.compareTranscription||(this.setState({rawText:"",compareText:""}),this.createCompare(e.base,e.compareTranscription))}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e=this;return e.props.base&&e.state.compareText?i.a.createElement("div",null,i.a.createElement("span",null,i.a.createElement(s.b,{to:"/text?resourceid="+e.props.compareTranscription},e.props.compareTranscription)),i.a.createElement("span",{onClick:function(){return e.handleToggleShow()}},e.state.show?i.a.createElement(de.h,null):i.a.createElement(de.g,null)),i.a.createElement("span",{onClick:function(){return e.props.handleChangeBase(e.state.rawText)}},i.a.createElement(de.q,null)),i.a.createElement("div",{className:e.state.show?"unhidden":"hidden"},i.a.createElement("div",{ref:"text",dangerouslySetInnerHTML:{__html:e.state.compareText}}))):i.a.createElement("p",null,"Loading")}}]),t}(i.a.Component),we=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e))).handleToggleShowAll=n.handleToggleShowAll.bind(Object(w.a)(n)),n.mounted="",n.state={info:"",show:!1,baseText:""},n}return Object(E.a)(t,e),Object(v.a)(t,[{key:"handleToggleShowAll",value:function(){this.setState(function(e){return{show:!e.show}})}},{key:"arrangeTextInfo",value:function(e,t){var n=this;e.then(function(e){var a=e.data.results.bindings[0],i=e.data.results.bindings.map(function(e){return{manifestation:e.manifestation.value,manifestationTitle:e.manifestationTitle.value,transcription:e.manifestationCTranscription.value}});!0===n.mounted&&a&&n.setState({info:{resourceid:t,title:a.title.value,structureType:a.structureType.value,inbox:a.inbox.value,next:a.next?a.next.value:"",previous:a.previous?a.previous.value:"",cdoc:a.cdoc.value,cxml:a.cxml.value,topLevel:a.topLevelExpression.value,cmanifestation:a.cmanifestation.value,ctranscription:a.ctranscription.value,manifestations:i}})})}},{key:"getTextInfo",value:function(e){var t=I(ie(e));this.arrangeTextInfo(t,e)}},{key:"componentDidMount",value:function(){this.mounted=!0,this.setState({show:this.props.show,baseText:this.props.baseText}),this.props.isMainText?this.setState({info:this.props.info}):this.getTextInfo(this.props.expressionid)}},{key:"componentWillReceiveProps",value:function(e){this.props.info.resourceid!=e.info.resourceid&&(this.setState({baseText:e.baseText}),e.isMainText?this.setState({info:e.info}):this.getTextInfo(e.expressionid))}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("p",null,i.a.createElement("span",null,this.props.relationLabel)," ",i.a.createElement(s.b,{to:"/text?resourceid="+this.state.info.resourceid},this.state.info.resourceid),i.a.createElement("span",{onClick:function(){return e.handleToggleShowAll()}},this.state.show?i.a.createElement(de.h,null):i.a.createElement(de.g,null))),i.a.createElement("div",{className:this.state.show?"unhidden":"hidden"},function(){if(e.state.info.manifestations)return e.state.info.manifestations.map(function(t){return i.a.createElement(ye,{key:t.transcription,base:e.props.baseText,compareTranscription:t.transcription,handleChangeBase:e.props.handleChangeBase,show:e.state.show})})}()))}}]),t}(i.a.Component),Ee=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e))).handleCompare=n.handleToggleCompare.bind(Object(w.a)(n)),n.handleChangeBase=n.handleChangeBase.bind(Object(w.a)(n)),n.getText=n.getText.bind(Object(w.a)(n)),n.mounted="",n.state={expressions:{},baseText:""},n}return Object(E.a)(t,e),Object(v.a)(t,[{key:"handleChangeBase",value:function(e){this.setState({baseText:e})}},{key:"handleToggleCompare",value:function(e){this.setState(function(t){var n=Object(U.a)({},t.expressions);return n[e].show=!n[e].show,{expressions:n}})}},{key:"getText",value:function(e){var t=this;O.a.get("http://exist.scta.info/exist/apps/scta-app/csv-pct.xq?resourceid="+e).then(function(e){t.setState({baseText:e.data})})}},{key:"componentDidMount",value:function(){if(this.props.info.relatedExpressions){this.getText(this.props.info.ctranscription);var e={};e[this.props.info.resourceid]={id:this.props.info.resourceid,show:!0},this.props.info.relatedExpressions.forEach(function(t){e[t.resourceid]={id:t.resourceid,relationLabel:t.relationLabel,show:!1}}),this.setState({expressions:e})}}},{key:"componentWillReceiveProps",value:function(e){if(this.props.info.resourceid!=e.info.resourceid&&this.props.info.relatedExpressions){this.props.info.ctranscription!=e.info.ctranscription&&this.getText(e.info.ctranscription);var t={};t[e.info.resourceid]={id:e.info.resourceid,show:!0},e.info.relatedExpressions.forEach(function(e){t[e.resourceid]={id:e.resourceid,relationLabel:e.relationLabel,show:!1}}),this.setState({expressions:t})}}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:this.props.hidden?"hidden":"showing"},function(){var t=e.state.expressions;return Object.keys(t).map(function(n){var a=e.props.info.resourceid===t[n].id;return i.a.createElement("div",{key:e.state.expressions[n].id},i.a.createElement(we,{info:e.props.info,expressionid:t[n].id,relationLabel:t[n].relationLabel,isMainText:a,handleChangeBase:e.handleChangeBase,baseText:e.state.baseText,show:t[n].show}))})}())}}]),t}(i.a.Component),ge=n(161),Te=n(81),xe=n.n(Te);var Oe=function(e){return i.a.createElement("div",{className:"comment"},i.a.createElement("p",null,e.n.body.value))},ke=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e))).handleCommentUpdate=n.handleCommentUpdate.bind(Object(w.a)(n)),n.handleSubmitComment=n.handleSubmitComment.bind(Object(w.a)(n)),n.state={comment:""},n}return Object(E.a)(t,e),Object(v.a)(t,[{key:"handleCommentUpdate",value:function(e){e.preventDefault(),this.setState({comment:e.target.value})}},{key:"handleSubmitComment",value:function(e){e.preventDefault(),this.props.handleSumbitComment(this.state.comment)}},{key:"render",value:function(){return i.a.createElement("div",{className:"comment"},i.a.createElement(P.a,{onSubmit:this.handleSubmitComment},i.a.createElement(M.a,{type:"text",id:"comment",placeholder:"comment",className:"mr-sm-2",onChange:this.handleCommentUpdate}),i.a.createElement(m.a,{type:"submit",variant:"outline-success"},"Search")))}}]),t}(i.a.Component),Ce=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e))).handleSumbitComment=n.handleSumbitComment.bind(Object(w.a)(n)),n.state={notifications:[],inbox:"",resourceid:""},n}return Object(E.a)(t,e),Object(v.a)(t,[{key:"handleSumbitComment",value:function(e){var t=this,n={"@context":"http://www.w3.org/ns/anno.jsonld",id:"http://inbox.scta.info/notifications/"+xe()(),type:"Annotation",motivation:"commenting",body:{type:"TextualBody",value:e},target:this.state.resourceid};console.log("annotat",n),console.log("inbox",this.state.inbox),O()({method:"post",url:this.state.inbox,data:n,config:{headers:{"Content-Type":"application/json+ld"}}}).then(function(e){t.setState(function(e){return{notifications:[n].concat(Object(ge.a)(e.notifications))}}),console.log(e)}).catch(function(e){console.log(e)})}},{key:"retrieveComments",value:function(e){this.setState({notifications:[]},function(){var t=this;O.a.get(e).then(function(e){e.data["ldp:contains"].forEach(function(e){O.a.get(e["@id"]).then(function(e){console.log("d2",e),t.setState(function(t){return{notifications:[].concat(Object(ge.a)(t.notifications),[e.data])}})})})}).catch(function(e){console.log(e)})})}},{key:"componentDidMount",value:function(){this.setState({inbox:this.props.info.inbox,resourceid:this.props.info.resourceid}),this.retrieveComments(this.props.info.inbox)}},{key:"componentWillReceiveProps",value:function(e){e.info!=this.props.info&&(this.setState({inbox:e.info.inbox,resourceid:e.info.resourceid}),this.retrieveComments(e.info.inbox))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:this.props.hidden?"hidden":"showing"},i.a.createElement("h1",null,"Comments"),i.a.createElement(ke,{handleSumbitComment:this.handleSumbitComment}),e.state.notifications.map(function(e,t){return i.a.createElement(Oe,{key:t,n:e})}))}}]),t}(i.a.Component),Le=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e))).state={windowLoad:""},n}return Object(E.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.setState({windowLoad:this.props.windowLoad})}},{key:"componentWillReceiveProps",value:function(e){this.setState({windowLoad:e.windowLoad})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:this.props.windowType+" "+this.props.windowType+this.props.openWidthHeight},i.a.createElement(me,{handleTabChange:this.props.handleTabChange,handleClose:this.props.handleClose,handleMinimize:this.props.handleMinimize,handleMaximize:this.props.handleMaximize,handleMiddlize:this.props.handleMiddlize,windowType:this.props.windowType,openWidthHeight:this.props.openWidthHeight,windowId:this.props.windowId,focus:this.props.resourceid,handleSwitchWindow:this.props.handleSwitchWindow}),i.a.createElement(fe,{info:this.props.info,handleBlockFocusChange:this.props.handleBlockFocusChange}),i.a.createElement("div",null,i.a.createElement(H,{info:e.props.info,hidden:"search"!=e.state.windowLoad,topLevel:e.props.info.topLevel}),i.a.createElement(Ee,{info:e.props.info,relatedExpressions:e.props.relatedExpressions,hidden:"textCompare"!=e.state.windowLoad}),i.a.createElement(ce,{info:e.props.info,hidden:"xml"!=e.state.windowLoad}),i.a.createElement(ue,{info:e.props.info,relatedExpressions:e.props.relatedExpressions,topLevel:e.props.topLevel,hidden:"info"!=e.state.windowLoad}),i.a.createElement(oe,{surfaceid:e.props.surfaceid,topLevel:e.props.topLevel,handleSurfaceFocusChange:e.props.handleSurfaceFocusChange,hidden:"surface2"!=e.state.windowLoad}),i.a.createElement(Ce,{info:e.props.info,hidden:"comments"!=e.state.windowLoad})))}}]),t}(i.a.Component),Ie=n(67),Se=n.n(Ie),je=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e))).state={next:"",previous:""},n}return Object(E.a)(t,e),Object(v.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({next:e.next,previous:e.previous})}},{key:"render",value:function(){return i.a.createElement(Se.a,{bg:"light",variant:"light",expand:"lg",fixed:"bottom"},i.a.createElement(Se.a.Toggle,{"aria-controls":"basic-navbar-nav"}),i.a.createElement(Se.a.Collapse,{id:"basic-navbar-nav"},i.a.createElement(he.a,null,this.props.previous&&i.a.createElement(s.c,{className:"nav-link",to:"/text?resourceid="+this.props.previous},"Previous"),this.props.next&&i.a.createElement(s.c,{className:"nav-link",to:"/text?resourceid="+this.props.next},"Next"),this.props.next&&i.a.createElement(s.c,{className:"nav-link",to:"/text?resourceid="+this.props.topLevel},"Text Home"))))}}]),t}(i.a.Component),Ne=n(311),Ae=n.n(Ne),Re=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e))).getVersionHistory=n.getVersionHistory.bind(Object(w.a)(n)),n.handleToggleShowVersions=n.handleToggleShowVersions.bind(Object(w.a)(n)),n.state={versions:[],currentVersion:{},showVersions:!1},n}return Object(E.a)(t,e),Object(v.a)(t,[{key:"handleToggleShowVersions",value:function(){this.setState(function(e){return{showVersions:!e.showVersions}})}},{key:"getVersionHistory",value:function(e){var t,n=this;I(["SELECT ?version ?version_shortId ?order_number ?version_label ?review ?doc","{","{","BIND(<"+(t=e.transcriptionid)+"> as ?version) . ","?version <http://scta.info/property/shortId> ?version_shortId .","?version <http://scta.info/property/hasDocument> ?doc . ","?version <http://scta.info/property/versionOrderNumber> ?order_number .","?version <http://scta.info/property/versionLabel> ?version_label .","OPTIONAL {","?version <http://scta.info/property/hasReview> ?review .","}","}","UNION","{","<"+t+"> <http://scta.info/property/hasAncestor> ?version .","?version <http://scta.info/property/shortId> ?version_shortId .","?version <http://scta.info/property/hasDocument> ?doc . ","?version <http://scta.info/property/versionOrderNumber> ?order_number .","?version <http://scta.info/property/versionLabel> ?version_label .","OPTIONAL {","?version <http://scta.info/property/hasReview> ?review .","}","}","UNION","{","<"+t+"> <http://scta.info/property/hasDescendant> ?version .","?version <http://scta.info/property/shortId> ?version_shortId .","?version <http://scta.info/property/hasDocument> ?doc . ","?version <http://scta.info/property/versionOrderNumber> ?order_number .","?version <http://scta.info/property/versionLabel> ?version_label .","OPTIONAL {","?version <http://scta.info/property/hasReview> ?review .","}","}","}","ORDER BY DESC(?order_number)"].join("")).then(function(t){t.data.results.bindings.forEach(function(t,a){var i="https://dll-review-registry.scta.info/api/v1/reviews/?url="+t.doc.value+"?society=MAA";O()(i).then(function(a){var i=a.data,r={};i.length>0&&(r={img_url:i[0]["badge-url"],reviewid:i[0].id,ipfsHash:i[0]["ipfs-hash"],html_link:"https://dll-review-registry.scta.info/reviews/"+i[0].id+".html",rubric_link:i[0]["badge-rubric"],summary:i[0]["review-summary"]}),n.setState(function(n){var a={versionTranscription:t.version?t.version.value:"",versionLabel:t.version_label?t.version_label.value:"",versionOrderNumber:t.order_number?t.order_number.value:"",versionReview:t.review?t.review.value:"",versionDoc:t.doc?t.doc.value:"",versionReviewInfo:r};return{versions:[].concat(Object(ge.a)(n.versions),[a]),currentVersion:e}})})})})}},{key:"componentDidMount",value:function(){this.getVersionHistory(this.props.itemInfo)}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.itemInfo.transcriptionid!==this.props.itemInfo.transcriptionid&&this.setState({versions:[]},function(){t.getVersionHistory(e.itemInfo)})}},{key:"render",value:function(){var e=this;return function(){if(e.state.versions){if(e.state.versions.length>1)return i.a.createElement(Ae.a,{variant:"info"},i.a.createElement("p",{onClick:e.handleToggleShowVersions},"This Text Has Multiple Indexed Versions"),e.state.showVersions&&e.state.versions.map(function(t){var n=t.versionTranscription===e.state.currentVersion.transcriptionid?"currentlyViewing":"";return i.a.createElement("p",{key:t.versionTranscription,className:n},n?i.a.createElement("span",null,t.versionLabel," (Currently Viewing)"):i.a.createElement(s.b,{to:"/text?resourceid="+t.versionTranscription},t.versionLabel),t.versionReviewInfo.html_link&&i.a.createElement("span",null," Peer Reviewed: ",i.a.createElement("a",{href:t.versionReviewInfo.html_link},i.a.createElement("img",{src:t.versionReviewInfo.img_url}))," "),i.a.createElement("span",{class:"small"}," Data Source: ",i.a.createElement("a",{href:t.versionDoc},t.versionDoc)," "))}));if(1===e.state.versions.length){var t=e.state.versions[0];return i.a.createElement(Ae.a,{variant:"info"},i.a.createElement("span",null,"Version: ",t.versionLabel," | Data Source: ",i.a.createElement("a",{href:t.versionDoc},t.versionDoc)," "))}return null}return null}()}}]),t}(i.a.Component),De=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e))).mount=!1,n.openWindow=n.openWindow.bind(Object(w.a)(n)),n.setFocus=n.setFocus.bind(Object(w.a)(n)),n.handleTabChange=n.handleTabChange.bind(Object(w.a)(n)),n.handleClose=n.handleClose.bind(Object(w.a)(n)),n.handleMinimize=n.handleMinimize.bind(Object(w.a)(n)),n.handleMaximize=n.handleMaximize.bind(Object(w.a)(n)),n.handleMiddlize=n.handleMiddlize.bind(Object(w.a)(n)),n.handleSwitchWindow=n.handleSwitchWindow.bind(Object(w.a)(n)),n.handleSurfaceFocusChange=n.handleSurfaceFocusChange.bind(Object(w.a)(n)),n.state={doc:"",focus:"",itemFocus:"",surfaceid:"",windows:{window1:{windowId:"window1",open:!1,windowLoad:"info",position:"sideWindow",openWidthHeight:"middle"},window2:{windowId:"window2",open:!1,windowLoad:"info",position:"bottomWindow",openWidthHeight:"middle"}}},n}return Object(E.a)(t,e),Object(v.a)(t,[{key:"openWindow",value:function(e,t){this.setState(function(n){var a=n.windows;return a[e].open=!0,a[e].windowLoad=t,{windows:a}})}},{key:"handleClose",value:function(e){this.setState(function(t){var n=t.windows;return n[e].open=!n[e].open,{windows:n}}),S(this.state.blockFocus,!0)}},{key:"handleMinimize",value:function(e){this.setState(function(t){var n=t.windows;return n[e].openWidthHeight="minimum",{windows:n}})}},{key:"handleMaximize",value:function(e){this.setState(function(t){var n=t.windows;return n[e].openWidthHeight="maximum",{windows:n}})}},{key:"handleMiddlize",value:function(e){this.setState(function(t){var n=t.windows;return n[e].openWidthHeight="middle",{windows:n}})}},{key:"handleSwitchWindow",value:function(e,t){this.setState(function(t){var n=t.windows;return"sideWindow"===n[e].position?n[e].position="bottomWindow":"bottomWindow"===n[e].position&&(n[e].position="sideWindow"),{windows:n}})}},{key:"handleTabChange",value:function(e,t){this.setState(function(n){var a=n.windows;return a[t].windowLoad=e,{windows:a}})}},{key:"handleSurfaceFocusChange",value:function(e){this.setState({surfaceid:e})}},{key:"setFocus",value:function(e){var t=e.includes("http")?e:"http://scta.info/resource/"+e,n=e.includes("http")?e.split("/resource/")[1]:e,a=I(ie(t));this.arrangeFocusInfo(a,t),S(n,!0)}},{key:"arrangeFocusInfo",value:function(e,t){var n=this;e.then(function(e){var a,i=e.data.results.bindings[0],r=e.data.results.bindings.map(function(e){return{manifestation:e.manifestation.value,manifestationTitle:e.manifestationTitle.value,transcription:e.manifestationCTranscription.value}});I(["SELECT DISTINCT ?isRelatedTo ?label ","WHERE { ","{","<"+(a=t)+"> ?o ?isRelatedTo .","?o a <http://scta.info/resource/textRelation> .","?o <http://www.w3.org/1999/02/22-rdf-syntax-ns#label> ?label . ","?isRelatedTo a <http://scta.info/resource/expression> .","}","UNION","{","<"+a+"> ?o ?p .","?o a <http://scta.info/resource/textRelation> .","?o <http://www.w3.org/1999/02/22-rdf-syntax-ns#label> ?label . ","?p a <http://scta.info/resource/quotation> .","?p <http://scta.info/property/source> ?isRelatedTo .","}","}"].join("")).then(function(e){var a=e.data.results.bindings.map(function(e){return{resourceid:e.isRelatedTo.value,relationLabel:e.label.value}});n.mount&&n.setState({focus:{resourceid:t,title:i.title.value,structureType:i.structureType.value,inbox:i.inbox.value,next:i.next?i.next.value:"",previous:i.previous?i.previous.value:"",cdoc:i.cdoc.value,cxml:i.cxml.value,topLevel:i.topLevelExpression.value,cmanifestation:i.cmanifestation.value,ctranscription:i.ctranscription.value,manifestations:r,relatedExpressions:a}})})})}},{key:"setItemFocus",value:function(e){var t=e.includes("http")?e:"http://scta.info/resource/"+e,n=(e.includes("http")&&e.split("/resource/")[1],I(["SELECT DISTINCT ?title ?manifestation ?doc ?xml ?expression ?expressionShortId ?longTitle ?topLevelExpression ?next ?previous ?inbox ?t ","WHERE { ","BIND(<"+t+"> as ?t) . ","?t <http://purl.org/dc/elements/1.1/title> ?title .","?t <http://scta.info/property/isTranscriptionOf> ?manifestation .","?t <http://scta.info/property/hasDocument> ?doc . ","?t <http://scta.info/property/hasXML> ?xml . ","?manifestation <http://scta.info/property/isManifestationOf> ?expression .","?expression <http://purl.org/dc/elements/1.1/title> ?expressionTitle .","?expression <http://scta.info/property/shortId> ?expressionShortId .","?expression <http://scta.info/property/longTitle> ?longTitle .","?expression <http://scta.info/property/isPartOfTopLevelExpression> ?topLevelExpression .","OPTIONAL {","?expression <http://scta.info/property/next> ?next .","}","OPTIONAL {","?expression <http://scta.info/property/previous> ?previous .","}","?expression <http://www.w3.org/ns/ldp#inbox> ?inbox . ","}","ORDER BY ?expressionTitle"].join("")));this.arrangeItemFocusInfo(n)}},{key:"arrangeItemFocusInfo",value:function(e){var t=this;e.then(function(e){var n=e.data.results.bindings[0];t.mount&&t.setState({itemFocus:{title:n.title.value,manifestation:n.manifestation.value,expression:n.expression.value,doc:n.doc.value,xml:n.xml.value,next:n.next?n.next.value:"",previous:n.previous?n.previous.value:"",inbox:n.inbox.value,topLevel:n.topLevelExpression.value,transcriptionid:n.t.value}})})}},{key:"componentDidMount",value:function(){this.mount=!0,this.setItemFocus(this.props.transcriptionid),this.props.blockDivFocus&&this.setFocus(this.props.blockDivFocus)}},{key:"componentWillReceiveProps",value:function(e){this.setItemFocus(e.transcriptionid),e.blockDivFocus&&this.setFocus(e.blockDivFocus)}},{key:"componentWillUnmount",value:function(){this.mount=!1}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,this.state.itemFocus&&i.a.createElement(Re,{itemInfo:this.state.itemFocus}),i.a.createElement(u.a,{className:function(){var t=!1;return e.state.windows.window1.open&&"sideWindow"===e.state.windows.window1.position&&"middle"===e.state.windows.window1.openWidthHeight?t=!0:e.state.windows.window2.open&&"sideWindow"===e.state.windows.window2.position&&(t=!0),t}()?"lbp-text skinnyText":"lbp-text fullText"},this.state.itemFocus&&i.a.createElement(j,{doc:this.state.itemFocus.doc,topLevel:this.state.itemFocus.topLevel,setFocus:this.setFocus,handleSurfaceFocusChange:this.handleSurfaceFocusChange,openWindow:this.openWindow,scrollTo:this.state.focus?this.state.focus.resourceid.split("/resource/")[1]:null})),i.a.createElement(je,{next:this.state.itemFocus&&this.state.itemFocus.next,previous:this.state.itemFocus&&this.state.itemFocus.previous,topLevel:this.state.itemFocus&&this.state.itemFocus.topLevel,handleClose:this.handleClose}),i.a.createElement("div",null,Object.keys(e.state.windows).map(function(t){var n;if(e.state.windows[t].open&&(e.state.focus||e.state.surfaceid))return i.a.createElement(Le,(n={windowLoad:e.state.windows[t].windowLoad,key:t,handleClose:e.handleClose,handleMinimize:e.handleMinimize,handleMaximize:e.handleMaximize,handleMiddlize:e.handleMiddlize,handleTabChange:e.handleTabChange,handleBlockFocusChange:e.setFocus,handleSurfaceFocusChange:e.handleSurfaceFocusChange,handleSwitchWindow:e.handleSwitchWindow,resourceid:e.state.focus.resourceid,windowType:e.state.windows[t].position,windowId:e.state.windows[t].windowId},Object(q.a)(n,"windowLoad",e.state.windows[t].windowLoad),Object(q.a)(n,"openWidthHeight",e.state.windows[t].openWidthHeight),Object(q.a)(n,"surfaceid",e.state.surfaceid),Object(q.a)(n,"info",e.state.focus),Object(q.a)(n,"topLevel",e.state.itemFocus.topLevel),n))})))}}]),t}(i.a.Component),We=n(106),Pe=n.n(We);var Fe=function(e){return i.a.createElement("tr",null,e.item.author&&i.a.createElement("td",null,i.a.createElement(s.b,{to:"/text?resourceid="+e.item.author},e.item.authorTitle)),i.a.createElement("td",null,i.a.createElement(s.b,{to:"/text?resourceid="+e.item.id},e.item.title)),e.item.questionTitle?i.a.createElement("td",null,i.a.createElement(s.b,{to:"/text?resourceid="+e.item.id},e.item.questionTitle)):i.a.createElement("td",null))},Me=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e))).retrieveCollectionInfo=n.retrieveCollectionInfo.bind(Object(w.a)(n)),n.makeRequests=n.makeRequests.bind(Object(w.a)(n)),n.handleFilter=n.handleFilter.bind(Object(w.a)(n)),n.filter=i.a.createRef(),n.mount=!1,n.state={items:{},parts:{},filter:"",surfaceFocus:""},n}return Object(E.a)(t,e),Object(v.a)(t,[{key:"handleFilter",value:function(e){var t=e.target.value;this.setState({filter:t})}},{key:"handleSurfaceFocusChange",value:function(e){this.setState({surfaceFocus:e})}},{key:"arrangeParts",value:function(e){var t=this,n=this;e.then(function(e){var a=e.data.results.bindings,i={};a.forEach(function(e){var t=e.part.value;i[t]={id:e.part.value,title:e.partTitle.value,type:e.partType.value,questionTitle:e.partQuestionTitle?e.partQuestionTitle.value:null,level:e.partLevel?e.partLevel.value:"unknown"}}),t.mount&&n.setState({parts:i})})}},{key:"arrangeItems",value:function(e){var t=this,n=this;e.then(function(e){var a=e.data.results.bindings,i={};a.forEach(function(e){var t=e.item.value;i[t]={title:e.itemTitle.value,id:e.item.value,type:e.itemType.value,questionTitle:e.itemQuestionTitle?e.itemQuestionTitle.value:null,author:e.itemAuthor?e.itemAuthor.value:null,authorTitle:e.itemAuthorTitle?e.itemAuthorTitle.value:null,next:e.next?e.next.value:null,previous:e.previous?e.previous.value:null,cm:e.cm?e.cm.value:null,cmTitle:e.cmTitle?e.cmTitle.value:null,ct:e.ct?e.ct.value:null,topLevel:e.topLevel?e.topLevel.value:null,doc:e.doc?e.doc.value:null}}),t.mount&&n.setState({items:i})}).catch(function(e){console.log(e)})}},{key:"retrieveWorkGroupInfo",value:function(e){var t=I(["SELECT DISTINCT ?item ?itemTitle ?itemAuthor ?itemAuthorTitle ?itemType ","WHERE { ","<"+e+"> <http://scta.info/property/hasExpression> ?item .","?item <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?itemType . ","?item <http://purl.org/dc/elements/1.1/title> ?itemTitle .","?item <http://www.loc.gov/loc.terms/relators/AUT> ?itemAuthor .","?itemAuthor <http://purl.org/dc/elements/1.1/title> ?itemAuthorTitle .","}"].join("")),n=I(re(e));this.arrangeParts(n),this.arrangeItems(t)}},{key:"retrieveCollectionInfo",value:function(e,t,n){var a=I(["SELECT DISTINCT ?item ?itemTitle ?topLevel ?itemQuestionTitle ?cm ?cmTitle ?ct ?next ?previous ?itemType ?doc ","WHERE { ","<"+n+"> <http://scta.info/property/hasStructureItem> ?item .","?item <http://scta.info/property/isPartOfTopLevelExpression> ?topLevel .","?item <http://purl.org/dc/elements/1.1/title> ?itemTitle .","?item <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?itemType . ","OPTIONAL {","?item <http://scta.info/property/questionTitle> ?itemQuestionTitle .","}","OPTIONAL","{","?item <http://scta.info/property/next> ?next .","}","OPTIONAL","{","?item <http://scta.info/property/previous> ?previous .","}","?item <http://scta.info/property/hasCanonicalManifestation> ?cm .","?item <http://scta.info/property/totalOrderNumber> ?totalOrderNumber .","?cm <http://purl.org/dc/elements/1.1/title> ?cmTitle .","?cm <http://scta.info/property/hasCanonicalTranscription> ?ct .","?ct <http://scta.info/property/hasDocument> ?doc .","}","ORDER BY ?totalOrderNumber"].join("")),i=I(re(e));this.arrangeParts(i),this.arrangeItems(a)}},{key:"makeRequests",value:function(e,t,n,a){"http://scta.info/resource/workGroup"===a?this.retrieveWorkGroupInfo(e,t,n):"http://scta.info/resource/structureCollection"===t&&this.retrieveCollectionInfo(e,t,n)}},{key:"componentDidUpdate",value:function(e,t){}},{key:"componentDidMount",value:function(){this.mount=!0;this.setState({resourceid:this.props.resourceid}),this.makeRequests(this.props.resourceid,this.props.structureType,this.props.topLevel,this.props.type)}},{key:"componentWillReceiveProps",value:function(e){this.refs.filter?this.refs.filter.value="":this.setState({resourceid:e.resourceid,filter:"",blockFocus:""}),this.makeRequests(e.resourceid,e.structureType,e.topLevel,e.type)}},{key:"componentWillUnmount",value:function(){this.mount=!1}},{key:"render",value:function(){var e=this;return i.a.createElement(u.a,null,i.a.createElement(M.a,{ref:this.filter,id:"filter",placeholder:"type to filter",onChange:this.handleFilter}),function(){var t=[];Object.keys(e.state.parts).forEach(function(n){e.state.parts[n].title.toLowerCase().includes(e.state.filter.toLowerCase())&&t.push(i.a.createElement(Fe,{item:e.state.parts[n]}))});var n=e.state.parts[Object.keys(e.state.parts)[0]];if(n&&("http://scta.info/resource/expression"!==n.type||"1"!==n.level))return i.a.createElement(u.a,null,i.a.createElement("h1",null,"Parts"),i.a.createElement("br",null),i.a.createElement(Pe.a,{striped:!0,bordered:!0,hover:!0,size:"sm"},i.a.createElement("tbody",null,t)))}(),function(){var t=[];return Object.keys(e.state.items).forEach(function(n){(e.state.items[n].title+" "+e.state.items[n].authorTitle+" "+e.state.items[n].questionTitle).toLowerCase().includes(e.state.filter.toLowerCase())&&t.push(i.a.createElement(Fe,{item:e.state.items[n]}))}),i.a.createElement(u.a,null,i.a.createElement("h1",null,"Items"),i.a.createElement("br",null),i.a.createElement(Pe.a,{striped:!0,bordered:!0,hover:!0,size:"sm"},i.a.createElement("tbody",null,t)))}())}}]),t}(i.a.Component),_e=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e))).retrieveAuthorCollectionInfo=n.retrieveAuthorCollectionInfo.bind(Object(w.a)(n)),n.handleItemFilter=n.handleItemFilter.bind(Object(w.a)(n)),n.itemFilter=i.a.createRef(),n.mount=!1,n.state={authorTitle:"",authorArticles:[],textArticles:[],expressions:[],itemFilter:""},n}return Object(E.a)(t,e),Object(v.a)(t,[{key:"handleItemFilter",value:function(e){var t=e.target.value;this.setState({itemFilter:t})}},{key:"arrangeItems",value:function(e,t){var n=this;e.then(function(e){console.log("data",e);var a=e.data["@graph"].filter(function(e){return e["@id"]===t})[0];console.log("author",a);var i=a["http://purl.org/dc/elements/1.1/title"],r=null;r=Array.isArray(a.authorArticle)?a.authorArticle.map(function(t){return{id:t,title:e.data["@graph"].filter(function(e){return e["@id"]===t})[0]["http://purl.org/dc/elements/1.1/title"]}}):[{id:a.autherArticle,title:e.data["@graph"].filter(function(e){return e["@id"]===a.autherArticle})[0]["http://purl.org/dc/elements/1.1/title"]}];var o=null;o=Array.isArray(a.textArticle)?a.textArticle.map(function(t){return{id:t,title:e.data["@graph"].filter(function(e){return e["@id"]===t})[0]["http://purl.org/dc/elements/1.1/title"]}}):[{id:a.textArticle,title:e.data["@graph"].filter(function(e){return e["@id"]===a.textArticle})[0]["http://purl.org/dc/elements/1.1/title"]}];var s=null;s=Array.isArray(a.hasTopLevelExpression)?a.hasTopLevelExpression.map(function(t){return{id:t,title:e.data["@graph"].filter(function(e){return e["@id"]===t})[0]["http://purl.org/dc/elements/1.1/title"]}}):[{id:a.hasTopLevelExpression,title:e.data["@graph"].filter(function(e){return e["@id"]===a.hasTopLevelExpression})[0]["http://purl.org/dc/elements/1.1/title"]}],console.log("articles",r),console.log("textArticles",o),console.log("expressions",s),n.setState({authorArticles:r,textArticles:o,expressions:s,authorTitle:i})}).catch(function(e){console.log(e)})}},{key:"retrieveAuthorCollectionInfo",value:function(e){var t,n=I(["CONSTRUCT","{","?author  <http://purl.org/dc/elements/1.1/title> ?authorTitle ;","<http://scta.info/resource/hasTopLevelExpression> ?expression ;","<http://scta.info/property/authorArticle> ?authorArticle;","<http://scta.info/property/textArticle> ?textArticle .","?authorArticle <http://purl.org/dc/elements/1.1/title> ?authorArticleTitle . ","?textArticle <http://purl.org/dc/elements/1.1/title> ?textArticleTitle . ","?expression <http://purl.org/dc/elements/1.1/title> ?topLevelExpressionTitle .","}","WHERE ","{","<"+(t=e)+"> <http://purl.org/dc/elements/1.1/title> ?authorTitle .","BIND(<"+t+"> as ?author) . ","?expression <http://www.loc.gov/loc.terms/relators/AUT> ?author .","?expression a <http://scta.info/resource/expression> .","?expression <http://scta.info/property/level> '1' .","?expression <http://purl.org/dc/elements/1.1/title> ?topLevelExpressionTitle .","?expression2 <http://www.loc.gov/loc.terms/relators/AUT> ?author .","?textArticle <http://scta.info/property/isArticleOf> ?expression2 .","?textArticle <http://purl.org/dc/elements/1.1/title> ?textArticleTitle .","?authorArticle <http://scta.info/property/isArticleOf> ?author .","?authorArticle <http://purl.org/dc/elements/1.1/title> ?authorArticleTitle","}"].join(""));this.arrangeItems(n,e)}},{key:"componentDidUpdate",value:function(e,t){}},{key:"componentDidMount",value:function(){this.mount=!0,this.retrieveAuthorCollectionInfo(this.props.resourceid)}},{key:"componentWillReceiveProps",value:function(e){this.refs.itemFilter?this.refs.itemFilter.value="":this.retrieveAuthorCollectionInfo(e.resourceid)}},{key:"componentWillUnmount",value:function(){this.mount=!1}},{key:"render",value:function(){var e=function(e){return e.map(function(e){return i.a.createElement(Fe,{item:e})})};return i.a.createElement("div",null,i.a.createElement("h1",null,this.state.authorTitle),this.state.expressions&&i.a.createElement(u.a,null,i.a.createElement("h1",null,"Expressions"),i.a.createElement("br",null),i.a.createElement(Pe.a,{striped:!0,bordered:!0,hover:!0,size:"sm"},i.a.createElement("tbody",null,e(this.state.expressions)))),this.state.authorArticles&&i.a.createElement(u.a,null,i.a.createElement("h1",null,"Author Related Articles"),i.a.createElement("br",null),i.a.createElement(Pe.a,{striped:!0,bordered:!0,hover:!0,size:"sm"},i.a.createElement("tbody",null,e(this.state.authorArticles)))),this.state.textArticles&&i.a.createElement(u.a,null,i.a.createElement("h1",null,"Text Related Articles"),i.a.createElement("br",null),i.a.createElement(Pe.a,{striped:!0,bordered:!0,hover:!0,size:"sm"},i.a.createElement("tbody",null,e(this.state.textArticles)))))}}]),t}(i.a.Component),He=function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(b.a)(this,Object(y.a)(t).call(this,e))).state={displayType:"",resourceid:"",itemTranscriptionId:"",blockDivFocus:""},n}return Object(E.a)(t,e),Object(v.a)(t,[{key:"getInfo",value:function(e){var t,n=this;I(["SELECT DISTINCT ?type ?structureType ?level ?topLevel ?itemParent ","WHERE { ","<"+(t=e)+"> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?type . ","OPTIONAL {","<"+t+"> <http://scta.info/property/structureType> ?structureType . ","}","OPTIONAL {","<"+t+"> <http://scta.info/property/level> ?level . ","}","OPTIONAL {","<"+t+"> <http://scta.info/property/isPartOfTopLevelExpression> ?topLevel . ","}","OPTIONAL {","<"+t+"> <http://scta.info/property/isPartOfTopLevelManifestation> ?topLevel . ","}","OPTIONAL {","<"+t+"> <http://scta.info/property/isPartOfTopLevelTransription> ?topLevel . ","}","OPTIONAL {","<"+t+"> <http://scta.info/property/isPartOfStructureItem> ?itemParent . ","}","}"].join("")).then(function(t){var a,i=t.data.results.bindings[0].type.value,r=t.data.results.bindings[0].structureType?t.data.results.bindings[0].structureType.value:null,o=(t.data.results.bindings[0].level&&t.data.results.bindings[0].level.value,t.data.results.bindings[0].topLevel?t.data.results.bindings[0].topLevel.value:e),s=t.data.results.bindings[0].itemParent?t.data.results.bindings[0].itemParent.value:null;t.data.results.bindings[0].ctranscription&&t.data.results.bindings[0].ctranscription.value;if("http://scta.info/resource/person"===i)n.setState({displayType:"person",resourceid:e,structureType:"",topLevel:"",type:i});else if("http://scta.info/resource/workGroup"===i)n.setState({displayType:"collection",resourceid:e,structureType:r,topLevel:o,type:i});else if("http://scta.info/resource/structureCollection"===r)n.setState({displayType:"collection",resourceid:e,structureType:r,topLevel:o,type:i});else if("http://scta.info/resource/structureItem"===r){if("http://scta.info/resource/transcription"===i)n.setState({itemTranscriptionId:e,displayType:"item"});else I(["SELECT DISTINCT ?ctranscription ","WHERE { ","{","<"+(a=e)+"> <http://scta.info/property/hasCanonicalManifestation> ?cmanifestation . ","?cmanifestation <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . ","}","UNION","{","<"+a+"> <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . ","}","}"].join("")).then(function(e){n.setState({itemTranscriptionId:e.data.results.bindings[0].ctranscription.value,displayType:"item"})})}else if("http://scta.info/resource/structureBlock"===r||"http://scta.info/resource/structureDivision"===r){I(function(e){return["SELECT DISTINCT ?ctranscription ?blockDivExpression ","WHERE { ","OPTIONAL","{","<"+e+"> <http://scta.info/property/isPartOfStructureItem> ?itemParent . ","{","{","?itemParent <http://scta.info/property/hasCanonicalManifestation> ?cmanifestation . ","?cmanifestation <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . ","}","UNION","{","?itemParent <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . ","}","}","}","OPTIONAL","{","{","{","<"+e+"> <http://scta.info/property/isManifestationOf> ?blockDivExpression . ","}","UNION","{","<"+e+"> <http://scta.info/property/isTranscriptionOf> ?blockDivManifestation . ","?blockDivManifestation <http://scta.info/property/isManifestationOf> ?blockDivExpression . ","}","}","}","}"].join("")}(e)).then(function(t){"http://scta.info/resource/transcription"===i?n.setState({itemTranscriptionId:s,blockDivFocus:t.data.results.bindings[0].blockDivExpression.value,displayType:"item"}):"http://scta.info/resource/expression"===i?n.setState({itemTranscriptionId:t.data.results.bindings[0].ctranscription.value,blockDivFocus:e,displayType:"item"}):n.setState({itemTranscriptionId:t.data.results.bindings[0].ctranscription.value,blockDivFocus:t.data.results.bindings[0].blockDivExpression.value,displayType:"item"})})}})}},{key:"componentDidMount",value:function(){var e=A.a.parse(this.props.location.search,{ignoreQueryPrefix:!0}).resourceid;this.getInfo(e)}},{key:"componentWillReceiveProps",value:function(e){var t=A.a.parse(e.location.search,{ignoreQueryPrefix:!0}).resourceid;this.getInfo(t)}},{key:"render",value:function(){var e=this;return"person"===e.state.displayType?i.a.createElement(_e,{resourceid:e.state.resourceid}):"collection"===e.state.displayType?i.a.createElement(Me,{resourceid:e.state.resourceid,structureType:e.state.structureType,topLevel:e.state.topLevel,type:e.state.type}):"item"===e.state.displayType?i.a.createElement(De,{transcriptionid:e.state.itemTranscriptionId,blockDivFocus:e.state.blockDivFocus}):null}}]),t}(i.a.Component);var qe=function(){return i.a.createElement("div",{className:"About"},i.a.createElement("h1",null,"About"))};var Ue=function(){return i.a.createElement(Se.a,{bg:"dark",variant:"light",expand:"lg",fixed:"top"},i.a.createElement(Se.a.Brand,{href:"/"},"SCTA"),i.a.createElement(Se.a.Toggle,{"aria-controls":"basic-navbar-nav"}),i.a.createElement(Se.a.Collapse,{id:"basic-navbar-nav"},i.a.createElement(he.a,null,i.a.createElement(s.c,{className:"nav-link",to:"/text?resourceid="+C},"Text"),i.a.createElement(s.c,{className:"nav-link",to:"/Search"},"Search")),i.a.createElement(he.a,null,i.a.createElement(s.c,{className:"nav-link",to:"/about"},"About"),i.a.createElement(s.c,{className:"nav-link",to:"/donate"},"Donate"))))},Be=n(515),ze=n.n(Be),Ve=n(160),Qe=n.n(Ve);var Xe=function(){return i.a.createElement(u.a,{className:"lbp-footer",fluid:!0},i.a.createElement(ze.a,null,i.a.createElement(Qe.a,null,i.a.createElement("p",null,"Designed by ",i.a.createElement("a",{href:"http://jeffreycwitt.com"},"Jeffrey C. Witt"))),i.a.createElement(Qe.a,null,i.a.createElement("p",null,"A ",i.a.createElement("a",{href:"http://lombardpress.org"},"LombardPress")," Publication")),i.a.createElement(Qe.a,null,i.a.createElement("p",null,"Powered by ",i.a.createElement("a",{href:"http://scta.info"},"SCTA")," Data"))))},Ge=(n(1293),n(1294),function(){return i.a.createElement(s.a,{forceRefresh:!1},i.a.createElement("div",null,i.a.createElement(Ue,null),i.a.createElement(l.c,null,i.a.createElement(l.a,{path:"/",exact:!0,component:R}),i.a.createElement(l.a,{path:"/text",exact:!0,component:He}),i.a.createElement(l.a,{path:"/about",exact:!0,component:qe}),i.a.createElement(l.a,{path:"/search",exact:!0,render:function(e){return i.a.createElement(H,Object.assign({},e,{hidden:!1}))}})),i.a.createElement(Xe,null)))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(Ge,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},517:function(e,t,n){e.exports=n(1295)},628:function(e,t){},630:function(e,t){}},[[517,1,2]]]);
//# sourceMappingURL=main.6b3fef41.chunk.js.map