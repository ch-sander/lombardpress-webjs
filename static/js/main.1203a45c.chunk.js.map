{"version":3,"sources":["components/config.js","components/Home.js","components/utils.js","components/Spinner.js","reducers/searchExpressionsListReducer.js","actions/searchExpressionsListActions.js","reducers/searchAuthorsListReducer.js","actions/searchAuthorsListActions.js","reducers/searchWorkGroupsListReducer.js","actions/searchWorkGroupsListActions.js","reducers/searchExpressionTypesListReducer.js","components/Search3Parameters.js","actions/searchExpressionTypesListActions.js","components/searchUtils.js","components/Search3.js","queries/questionTitleQuery.js","components/Print.js","components/OSDInstance.js","components/Image.js","components/LineText.js","components/ImageTextWrapper.js","components/ImageLogo.js","components/Queries.js","components/Surface2.js","components/Surface3.js","components/Surface3Wrapper.js","components/XmlView.js","components/WindowNavBar.js","components/NextPrevBar.js","components/TextCompareItem.js","components/TextCompare.js","components/TextCompareWrapper.js","components/Comment2Create.js","components/Comment2Item.js","components/Comments2ImportExport.js","components/Comments2.js","components/Citation.js","components/CitationExplanation.js","components/ManifestationList.js","components/CitationWrapper.js","components/TextOutline.js","components/TextOutlineWrapper.js","components/TextPreviewWrapper.js","queries/TextPreviewWrapperQueries.js","components/Dictionary.js","components/Window.js","components/TextNavBar.js","components/Text.js","components/VersionChain.js","components/TextWrapper.js","components/TextArticle.js","components/Collection.js","components/Item.js","components/AuthorCollection.js","components/CommentItem.js","components/CommentCreate.js","components/Comments.js","components/SurfaceInfo.js","queries/SurfaceInfoQuery.js","components/Codex.js","components/ExpressionType.js","queries/expressionTypeQuery.js","components/ResourceTypeList.js","queries/resourceTypeQuery.js","components/TextSwitch.js","components/About.js","components/NavBar.js","components/Footer.js","components/AppRouter.js","serviceWorker.js","i18n.js","index.js"],"names":["sparqlEndpoint","Home","props","t","useTranslation","className","Container","id","fluid","Jumbotron","Button","to","style","color","loadXMLDoc","url","Promise","resolve","req","XMLHttpRequest","open","XSLTProcessor","responseType","e","console","log","onload","this","responseXML","send","convertXMLDoc","xmlurl","xslurl","reject","all","then","data","xsltProcessor","importStylesheet","resultDocument","transformToFragment","document","reason","Error","copyToClipboard","string","dummy","createElement","body","appendChild","value","select","execCommand","removeChild","runQuery","query","Axios","get","params","scrollToParagraph","hash","highlight","element","$","addClass","removeClass","children","includes","setTimeout","length","stop","animate","scrollTop","offset","top","nodeFilterCheck","node","check","parentElement","NodeFilter","FILTER_REJECT","nodeValue","FILTER_ACCEPT","cleanText","selectedText","replace","getInstanceNumber","wordArray","wordPosition","number","i","getStringBeforeWord","text","word","instanceNumber","first","splitText","split","join","goToGitHubEdit","selectedElementTargetId","newRawUrl","d","findElement","newLineCount","afterText","regexp","RegExp","getLineNumber","editUrl","window","Spinner","animation","role","variant","searchExpressionsListReducer","state","action","type","expressions","fetchExpressionsList","searchParameters","dispatch","workGroupSparql","searchWorkGroup","expressionAuthorTypeSparql","expressionAuthorType","authorSparql","searchAuthor","res","searchWorks","results","bindings","map","result","expression","expressionShortId","expressionTitle","workGroup","workGroupTitle","author","authorTitle","searchAuthorsListReducer","authors","fetchAuthorsList","authorShortId","completeAuthorsFetch","searchWorkGroupsListReducer","workGroups","fetchWorkGroupsList","authorQuery","completeWorkGroupsListFetch","searchExpressionTypesListReducer","expressionTypes","Search3Parameters","useState","searchType","setSearchType","searchTerm","setSearchTerm","setSearchAuthor","searchEid","setSearchEid","searchEType","setSearchEType","setSearchWorkGroup","resultsFilter","setResultsFilter","useReducer","searchExpressionTypesList","searchExpressionTypesListDispatch","searchExpressionsList","searchExpressionsListDispatch","searchAuthorsList","searchAuthorsListDispatch","searchWorkGroupsList","searchWorkGroupsListDispatch","displayAllParameters","setDisplayAllParameters","useEffect","handleSetSearchParameters","searchExpressionsListActions","searchAuthorsListActions","searchWorkGroupsListActions","expressionType","expressionTypeTitle","completeExpressionTypesListFetch","searchExpressionTypesListActions","InputGroup","size","Prepend","Text","Form","Control","as","placeholder","onChange","target","content","key","showAdvancedParameters","onClick","retrieveExpressionResults","displayTextResults","textResults","r","textString","previous","hit","next","range","start","end","pid","dangerouslySetInnerHTML","__html","displayQuestionResults","displayResults","resource","longTitle","qtitle","toLowerCase","toUpperCase","Search3","setSearchParameters","setResults","questionResults","setQuestionResults","filterQuestionResults","filterResults","handleRunSearch","preventDefault","retrieveAuthorResults","retrieveWorkGroupResults","workGroupQuery","expressionTypeQuery","eidQuery","questionTitleQuery","newResults","forEach","push","combinedString","hidden","onSubmit","parameters","showLabels","showSubmit","marginRight","defaultProps","Print","getPdf","bind","status","pdf","hashWithExtension","setState","Status","prevProps","newUrl","width","height","href","React","Component","OSDInstance","instance","setInstance","w","h","viewerWidthHeight","setViewerWidthHeight","uuidv4","viewerId","coords","computeViewerWidthHeight","imageurl","addTiledImage","tileSource","sc","getScalarCoordinates","rect","OpenSeadragon","Rect","x","y","setBounds","setOverlay","lineFocusCoords","lsc","linerect","setGoHome","viewport","fitBounds","prefixUrl","preserveViewport","visibilityRatio","minZoomLevel","defaultZoomLevel","tileSources","controlsFadeDelay","controlsFadeLength","addHandler","elt","addOverlay","location","goHome","inputCoords","imageH","imageW","ar","parseInt","displayWidth","Image","imageUrl","LineText","label","ImageTextWrapper","searchText","targetLabel","canvas","canvasShort","ImageLogo","logoUrl","setLogoUrl","logo","catch","error","src","margin","alt","basicInfoQuery","itemExpressionUri","partsInfoQuery","resourceurl","getSurfaceInfo","surfaceid","Surface2","mount","handleNext","handlePrevious","handleLineFocusNext","handleLineFocusPrev","isLineNumberLast","isLineNumberFirst","handleToggleTextLines","handleToggleAllLines","currentSurfaceId","manifest","region","annotationsDisplay","showAllLines","handleSurfaceFocusChange","prevState","b","alUrl","d2","surfaceTitle","next_surface","previous_surface","annotations","resources","currentLineNumber","lineFocusId","newLineArray","pop","toString","handleLineFocusChange","previousLineArray","total","retrieveSurfaceInfo","chars","on","surfaceButton","Surface3","mounted","surfaces","manifestationid","d1","z","surface","firstLine","lastLine","last","order","newSurface","displayImages","fl","flcanvas","flcanvasShort","flcoords","ll","llcoords","lly","llh","llbottom","sort","a","Surface3Wrapper","handleChangeManifestation","handleToggleTextLinesView","handleSetCustomExpressionId","handleGetCustomManifestations","handleChangeCustomManifestation","focusedManifestation","userAddedExpressionId","userAddedManifestations","focusedCustomManifestation","manifestations","manifestation","manifestationTitle","transcription","manifestationCTranscription","cmanifestation","view","hideSelectionList","m","hideDisplayChoice","title","isDependentSurface3","marginTop","padding","fontSize","inline","FormControl","XmlView","retrieveXML","xmlstring","tresourceid","language","docco","showLineNumbers","WindowNavBar","Nav","focusSet","Item","Link","active","windowLoad","handleTabChange","windowId","openWidthHeight","handleMinimize","handleMiddlize","handleMaximize","handleClose","altWindowState","handleDuplicateWindow","windowType","NextPrevBar","info","handleBlockFocusChange","resourceid","TextCompareItem","handleToggleShow","handleToggleCompare","showCompare","compareText","rawText","show","levenshteinDistance","undefined","usedBase","usedCompareTranscription","base","dmp","Diff","diff_match_patch","diff","diff_main","textClean","diff_cleanupSemantic","diff_levenshtein","ds","diff_prettyHtml","compareTranscription","createCompare","displayImage","newManifestations","showImage","surfaceWidth","isBase","levenNum","heatColor","borderLeft","paddingLeft","handleChangeBase","ref","displayComparison","TextCompare","handleToggleShowAll","baseText","structureType","inbox","cdoc","cxml","topLevel","topLevelExpression","ctranscription","arrangeTextInfo","isMainText","getTextInfo","expressionid","relatedExpressions","relationLabel","referringResource","displayComparisons","TextCompareWrapper","handleCustomUpdateRelatedExpressions","getText","customExpressionId","customExpressionObject","expressionObject","newExpressions","_this","concat","exObject","Object","keys","displayExpressions","rel","Comment2Create","comment","setComment","motivation","setMotivation","editedTextDefault","selectionRange","textEdited","editedText","setEditedText","noTarget","setNoTarget","orderNumber","setOrderNumber","wordRange","commentType","submitComment","rows","border","display","checked","block","Comment2Item","editable","setEditable","source","selectedFragment","selectedFragmentRange","selector","filter","exact","editedValue","update","updateComment","link","match","strings","l","linkComponent","linkCopy","prunedString","addSCTALinksToValue","created","removeComment","ImportExport","newListName","setNewListName","newListUrl","setNewListUrl","showImport","setShowImport","name","reader","FileReader","readAsText","files","fileName","list","handleImportList","JSON","parse","stringify","currentList","encodeURI","packageData","download","currentListName","Date","toISOString","slice","Comments2","localStorage","getItem","lists","setLists","comments","setComments","showFocusComments","setShowFocusComments","commentFilter","setCommentFilter","mentionedBy","setMentionedBy","showFilters","setShowFilters","newLists","c","targetComment","old_index","indexOf","k","splice","getMentionedBy","setItem","annoId","dateObject","annotation","textEdit","focused","handleOnClickComment","Comments2ImportExport","listname","parsedList","Citation","eurl","etitle","murl","mtitle","turl","fetching","transcriptionid","allBindings","eLongTitle","editorTitle","editor","datasource","codexTitle","retrieveCitation","fullCitationString","CitationExplanation","toggleCitationExplanation","showCitationExplanation","ManifestationList","toggleAlternativeManifestations","showAlternativeManifestations","optionalDisplay","handleFocusChange","displayManifestations","propTypes","PropTypes","isRequired","array","bool","func","CitationWrapper","TextOutline","handleToggleChildren","parts","showChildren","isPartOf","getChildParts","newData","part","level","questionTitle","isPartOfId","isPartOfTitle","retrieveParts","membersOf","indent","bold","showParentLink","showAuthor","collectionLink","mtFocus","p","focusResourceid","TextOutlineWrapper","getMembersOf","memberOf","retrieveMembersOf","TextPreviewWrapper","handleToggleShowTokenPosition","showTokenPosition","textPreviewResourceId","getTranscriptionId","textPreviewStart","textPreviewEnd","referringStart","referringSelectionRange","referringEnd","handleTextPreviewFocusChange","context","Dictionary","dictionary","Window","mountStatus","textCompare","surface3","xml","search","textOutline","citation","manifestationSlug","newMountStatus","tempNewMount","focus","handleSwitchWindow","defaultManifestationSlug","itemFocus","withTranslation","Navbar","bg","expand","fixed","Toggle","aria-controls","Collapse","pdfView","handleTogglePdfView","retrieveText","handleShowToolTip","handleHideToolTip","handleHideFootnoteToolTip","handleShowFootnoteToolTip","handleOnToolTipClick","selectionCoords","doc","scrollTo","docFragment","topLevelFragment","getElementById","innerHTML","setEvents","mark","sel","getSelection","rangeCount","rng","getRangeAt","pAncestor","nodeType","tagName","getContainingP","commonAncestorContainer","cnt","cloneContents","find","remove","textContent","clone","startOffset","startContainer","selectionText","precedingTextLength","n","getRangeWordCount","root","endContainer","endOffset","ownerDocument","createRange","setStart","setEnd","oRect","getBoundingClientRect","click","parent","attr","setFocus","openWindow","markWithElement","paragraphid","closest","ln","html","footnoteOffset","footnoteText","targetText","targetParagraph","addEventListener","markElementRemove","container","startWordOffset","endWordOffset","nodeIter","createNodeIterator","SHOW_TEXT","breaks","wordLength","nextNode","previousSibling","getAttribute","nodeTextArray","newWordLength","toRange","extractContents","backgroundColor","insertNode","handleUpdateSelectionRange","contents","unwrap","s","ReactTooltip","hide","fooRef","foonoteRef","scrollToNew","displayText","position","left","data-tip","data-for","clickable","place","VersionChain","getVersionHistory","handleToggleShowVersions","versions","currentVersion","showVersions","transcriptionUri","reviewUrl","reviewObject","img_url","reviewid","ipfsHash","html_link","rubric_link","summary","newVersion","versionTranscription","version","versionLabel","version_label","versionOrderNumber","order_number","versionReview","review","versionDoc","versionReviewInfo","Alert","v","currentlyViewing","gitHubEdit","displayAlert","TextWrapper","setFocus2","windows","window1","window2","blockFocus","altWindowId","fullid","handleUpdateUrlResource","newid","arrangeFocusInfo","isRelatedTo","arrangeItemFocusInfo","itemFocusInfo","setItemFocus","mFocus","tFocus","tokenRange","blockDivFocus","retrieveFocusInfo","textHide","aSideWindowOpen","textClass","itemid","TextArticle","articleType","toggleClass","noteDisplay","Collection","retrieveCollectionInfo","makeRequests","handleFilter","createRef","description","items","item","partsPromise","partsObject","pId","partTitle","partType","partQuestionTitle","partLevel","itemsPromise","itemsObject","itemId","itemTitle","itemType","itemQuestionTitle","itemAuthor","itemAuthorTitle","cm","cmTitle","ct","err","expressionsInfo","partsInfo","arrangeParts","arrangeItems","collectionInfo","newResourceId","retrieveWorkGroupInfo","Row","Col","xs","AuthorCollection","retrieveAuthorCollectionInfo","handleItemFilter","itemFilter","authorArticles","textArticles","Array","isArray","authorArticle","textArticle","hasTopLevelExpression","authorCollectionInfo","refs","displayItems","Table","striped","bordered","hover","CommentItem","CommentCreate","handleCommentUpdate","handleSubmitComment","handleSumbitComment","Comments","notifications","annotat","method","config","headers","response","retrieveComments","newProps","SurfaceInfo","handleToggleRelatedDiscussion","handleSurface3Manifestations","handleToggleShowQuery","surfaceMap","showTextRegion","showQuery","eid","showComments","showRelatedSurfaces","hasManifestation","isOnSurface","handleToggleRelatedSurfaces","Codex","retrieveCodexInfo","handleToggleShowContents","focusedSurface","relatedCodices","showContents","surface3Manifestations","surface3FocusedManifestation","codexSlug","unique","expressionList","item_expression_title","surface_title","item_expression_question_title","surfaceFocus","canvasid","manifestid","codexid","ExpressionType","setExpressions","expressionTypeId","ResourceTypeList","setResources","setFilter","resourceTypeId","resourceTitle","TextSwitch","displayType","itemTranscriptionId","history","itemParent","getArticleTranscriptionDoc","articleDoc","getItemTranscription","getItemTranscriptionFromBlockDiv","blockDivExpression","Qs","ignoreQueryPrefix","getInfo","Helmet","About","NavBar","Footer","AppRouter","fallback","forceRefresh","path","component","Boolean","hostname","i18n","use","Backend","LanguageDetector","initReactI18next","init","fallbackLng","debug","interpolation","escapeValue","ReactDOM","render","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.1203a45c.chunk.js","sourcesContent":["//qqexport const sparqlEndpoint = \"http://localhost:3030/ds/query\"\nexport const sparqlEndpoint = \"https://sparql-docker.scta.info/ds/query\"\n//export const sparqlEndpoint = \"https://sparql-staging.scta.info/ds/query\"\n\nexport const resourceEndpoint = \"http://scta.info/resource/scta\"\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport Jumbotron from 'react-bootstrap/Jumbotron';\nimport Button from 'react-bootstrap/Button';\nimport {Link} from 'react-router-dom';\nimport {resourceEndpoint} from './config';\nimport {useTranslation} from 'react-i18next'\n\n\n\nfunction Home(props) {\n  const {t} = useTranslation();\n  //const resourceid = props.location ? Qs.parse(props.location.search, { ignoreQueryPrefix: true }).resourceid : null;\n  const displayBody = () => {\n    // if (resourceid){\n    //   return <Text resourceid={props.location.search.resourceid}/>\n    // }\n    // else\n    return (\n      <div className=\"Home\">\n        <Container id=\"lbp-home\" fluid>\n            <Container>\n              <Jumbotron id=\"lbp-jumbo\">\n              \t<h1>{t(\"Title\")}</h1>\n                <p>{t(\"Subtitle\")}</p>\n                <Button><Link className=\"nav-link\" to={\"/text?resourceid=\" + resourceEndpoint} style={{color: \"black\"}}>{t(\"Enter\")}</Link></Button>\n              </Jumbotron>\n            </Container>\n          </Container>\n          </div>\n    )\n  }\n  return (\n    displayBody()\n  )\n}\n\nexport default Home;\n","import Axios from 'axios'\nimport {sparqlEndpoint} from './config';\nimport $ from 'jquery';\n\n\nexport function loadXMLDoc(url){\n  //See https://github.com/martin-honnen/martin-honnen.github.io/blob/master/xslt/arcor-archive/2016/test2016081501.html\n  return new Promise(function(resolve) {\n    var req = new XMLHttpRequest();\n    req.open(\"GET\", url);\n    if (typeof XSLTProcessor === 'undefined') {\n     try {\n       req.responseType = 'msxml-document';\n     }\n     catch (e) {\n       console.log('error', e)\n     }\n    }\n    req.onload = function() {\n     resolve(this.responseXML)\n    }\n    req.send();\n  });\n}\n\nexport function convertXMLDoc(xmlurl, xslurl){\n  //See https://github.com/martin-honnen/martin-honnen.github.io/blob/master/xslt/arcor-archive/2016/test2016081501.html\n  return new Promise(function(resolve, reject){\n    Promise.all([loadXMLDoc(xmlurl), loadXMLDoc(xslurl)]).then(function(data) {\n      const xsltProcessor = new XSLTProcessor();\n      xsltProcessor.importStylesheet(data[1]);\n      if (data[0]){\n        const resultDocument = xsltProcessor.transformToFragment(data[0], document);\n        resolve(resultDocument)\n      }\n      else{\n        const reason = new Error('xml document could not be retrieved');\n        reject(reason); // reject\n      }\n    })\n  })\n}\n\nexport function loadHtmlResultDocFromExist(url){\n  return Axios.get(\"https://exist.scta.info/exist/apps/scta-app/xslt-conversion.xq?xmlurl=\" + url)\n}\n\nexport function nsResolver(prefix) {\n    if(prefix === \"tei\") {\n      return 'http://www.tei-c.org/ns/1.0'\n    }\n}\n\nexport function copyToClipboard(string){\n  var dummy = document.createElement(\"textarea\");\n  document.body.appendChild(dummy);\n  dummy.value = string;\n  dummy.select();\n  document.execCommand(\"copy\");\n  document.body.removeChild(dummy);\n}\n\nexport function runQuery(query){\n  //const sparqlEndpoint = \"https://sparql-docker.scta.info/ds/query\"\n  //const sparqlEndpoint = sparqlEndpoint\n  const queryPromise = Axios.get(sparqlEndpoint, { params: { \"query\": query, \"output\": \"json\" } })\n  return queryPromise\n}\n\n//handles scroll to paragraph procedure\nexport function scrollToParagraph(hash, highlight){\n    const element = $(\"#\" + hash);\n\n    // TODO: refactor. this could be a lot simpler\n    if (highlight){\n      element.addClass(\"highlightNone\");\n      $(\".paragraphnumber\").removeClass(\"highlight2\")\n      $(\".plaoulparagraph\").removeClass(\"highlightNone\")\n      $(\".lbp-quote\").removeClass(\"highlightNone\")\n      $(\".lbp-quote\").removeClass(\"highlight\")\n      $(\".lbp-ref\").removeClass(\"highlightNone\")\n      $(\".lbp-ref\").removeClass(\"highlight\")\n      $(\".plaoulparagraph\").removeClass(\"highlight\")\n      element.children(\".paragraphnumber\").addClass(\"highlight2\")\n      element.addClass( \"highlight\");\n      \n      // TODO: Refactor\n      // conditional to ensure fire of next conditional ONLY IF element[0] is found\n      // prevents error with include method below when element does not exist\n      if (element[0]){\n        // condition set to prevent fade if element is quote or ref \n        if (!element[0].className.includes('lbp-quote') && !element[0].className.includes('lbp-ref')){\n          setTimeout(function(){\n            $(\".lbp-ref\").removeClass(\"highlight\")\n            $(\".lbp-quote\").removeClass(\"highlight\")\n            $(\".plaoulparagraph\").removeClass(\"highlight\")\n            element.addClass(\"highlightNone\");\n          }, 2000);\n        }\n      }\n\n    }\n  \tif (element.length > 0) {\n  \t    $('html, body')\n              .stop()\n              .animate({\n                  scrollTop: element.offset().top - 100\n              }, 1000);\n     }\n\n  }\n\n  // adopted from https://github.com/hypothesis/client/blob/master/src/annotator/anchoring/text-position.js\n  /**\n * Convert `start` and `end` character offset positions within the `textContent`\n * of a `root` element into a `Range`.\n *\n * Throws if the `start` or `end` offsets are outside of the range `[0,\n * root.textContent.length]`.\n *\n * @param {HTMLElement} root\n * @param {number} start - Character offset within `root.textContent`\n * @param {number} end - Character offset within `root.textContent`\n * @return {Range} Range spanning text from `start` to `end`\n */\n\nfunction nodeFilterCheck(node){\n  \n  const check = node.parentElement.className\n  // skip text nodes if their parent has the following classes\n  if (check.includes(\"paragraphnumber\") \n  || check.includes(\"lbp-line-number\")\n  || check.includes(\"appnote\") \n  || check.includes(\"paragraphnumber\")\n  || check.includes(\"footnote\")\n  || check.includes(\"lbp-reg\")\n  || check.includes(\"lbp-folionumber\")\n  || check.includes(\"js-show-folio-image\") // removes folio number\n  ){\n    return NodeFilter.FILTER_REJECT\n  }\n  else if (!node.nodeValue){\n    return NodeFilter.FILTER_REJECT\n  }\n  else{\n    return NodeFilter.FILTER_ACCEPT;\n  }\n  \n}\n\nexport function toRange(root, start, end) {\n  // The `filter` and `expandEntityReferences` arguments are mandatory in IE\n  // although optional according to the spec.\n  //console.log(\"root\", root)\n  const nodeIter = root.ownerDocument.createNodeIterator(\n    root,\n    NodeFilter.SHOW_TEXT,\n    nodeFilterCheck, // filter\n    true // expandEntityReferences\n  );\n\n  let startContainer;\n  let startOffset;\n  let startWordOffset\n  let endContainer;\n  let endOffset;\n  let endWordOffset;\n  let breaks = 0;\n\n // let textLength = 0;\n  let wordLength = 0;\n  let node;\n\n  \n  while ((node = nodeIter.nextNode()) && (!startContainer || !endContainer)) {\n    // keep running total of break words and then use this to adjust word count \n    // in comparison to word count with broken words; then adjust;\n    // NOTE: requires xslt to add data-break='no' to line break span\n    if (node.previousSibling){\n      if (node.previousSibling.getAttribute){\n        if (node.previousSibling && node.previousSibling.getAttribute(\"data-break\") === \"no\"){\n          breaks += 1\n        }\n      }\n    }\n    const nodeText = node.nodeValue;\n    // get array of words in node\n    const nodeTextArray = cleanText(nodeText).split(\" \").filter(n=>n)\n    // use clean text to remove punctuation and unwanted white space, then filter to get rid of blank array items, then count\n    const newWordLength = nodeTextArray.length\n    \n    // if start word is greater than length of word count in preceding nodes, but less than or equal \n    // to word count of of preceding plus this node, then selection starts somewhere within this node\n    // select node, then find precise word and character position start\n    if (\n      !startContainer &&\n      start + breaks >= wordLength &&\n      start + breaks <= wordLength + newWordLength\n    ) {\n      startContainer = node;\n      startWordOffset = (start + breaks) - wordLength;\n      \n      // get the occurrence instance within the node (needed in case there are two more instances of the same word in the node)\n      const instanceNumber = getInstanceNumber(nodeTextArray, startWordOffset - 1)\n      // calculate character offset of word within containing node\n      startOffset = getStringBeforeWord(node.nodeValue, nodeTextArray[startWordOffset - 1], instanceNumber, true)\n    }\n    // similar to above only for final position\n    if (\n      !endContainer &&\n      end + breaks >= wordLength &&\n      end + breaks <= wordLength + newWordLength\n    ) {\n      endContainer = node;\n      endWordOffset = (end + breaks) - wordLength;\n      // get the occurrence instance within the node (needed in case there are two more instances of the same word in the node)\n      const instanceNumber = getInstanceNumber(nodeTextArray, endWordOffset - 1)\n      // calculate character offset of word within containing node\n      endOffset = getStringBeforeWord(node.nodeValue, nodeTextArray[endWordOffset - 1], instanceNumber, false)\n    }\n\n    //textLength += nodeText.length;\n    wordLength += newWordLength\n    \n    \n  }\n\n  if (!startContainer) {\n    throw new Error('invalid start offset');\n  }\n  if (!endContainer) {\n    throw new Error('invalid end offset');\n  }\n\n  const range = root.ownerDocument.createRange();\n  range.setStart(startContainer, startOffset);\n  range.setEnd(endContainer, endOffset);\n\n  return range;\n}\n\n// function to remove spaces from selected html text\nexport function cleanText(selectedText){\n  selectedText = selectedText.replace(/^[ ]+|[ ]+$/g,''); // remove leading and trailing white space\n    // remove all punctuation with escape slashes; escape slashes don't seem needed as the line below with slashes seems to work.\n    // this line with extra slashes produces lint errors\n    // selectedText = selectedText.replace(/[.,\\/#!$%\\^&\\*;:{}=\\-_`~()\"]/g,\"\") //remove all punctuation\n  selectedText = selectedText.replace(/[.,/#!$%^&*;:{}=\\-_`~()\"]/g,\"\") //remove all punctuation\n  \n  selectedText = selectedText.replace(/\\s+/gi, ' ' ) // condences 1 or more space to single space\n  return selectedText\n}\n\n/**\n * @description returns identical instance number of a certain item in array,\n * e.g. if we have array [1, 2, 3, 4, 5, 1, 2, 3] \n * and we ask for the instanceNumber of index position 5, \n * the function will return 2, as this is the second instance of the number 1 in this array\n * @param {array} wordArray \n * @param {number} wordPosition \n */\nfunction getInstanceNumber(wordArray, wordPosition){\n  let number = 0\n  // using <= to include self in count\n  for (let i=0; i <= wordPosition; i++){\n    if (wordArray[i] === wordArray[wordPosition]){\n      number++\n    }\n  }\n  return number\n}\n/**\n * @description get strings before nth instance of a word\n * @param {string} text - string to be search\n * @param {string} word - word to be matched\n * @param {number} instanceNumber - number instance of word to be matched\n * modified from https://stackoverflow.com/questions/14480345/how-to-get-the-nth-occurrence-in-a-string\n */\nfunction getStringBeforeWord(text, word, instanceNumber, first) {\n  const splitText = text.split(word, instanceNumber).join(word);  \n  if (first){\n    const characterOffset = splitText.length\n    return characterOffset\n  }\n  else{\n    const characterOffset = splitText.length + word.length\n    return characterOffset\n\n  }\n}\n/**\n * @description creates a range\n * @param {*} root \n * @param {*} startContainer \n * @param {number} startOffset start character relative to containing node\n * @param {*} endContainer \n * @param {number} endOffset - end character length relative to containing node\n */\n\nexport function createRange(root, startContainer, startOffset, endContainer, endOffset){\n  console.log(\"endOffset\", endOffset)\n  const range = root.ownerDocument.createRange();\n  range.setStart(startContainer, startOffset);\n  range.setEnd(endContainer, endOffset);\n  return range;\n}\n/**\n * @description takes a range object and computes the Word Count after filtering elements nodes not to be counted\n * @param {Range} rng - must take a Range object\n */\nexport function getRangeWordCount(rng){\n  var cnt = rng.cloneContents();\n  $(cnt).find(\".lbp-line-number, .paragraphnumber, br, .lbp-folionumber, .appnote, .footnote, .lbp-reg\").remove();\n  const selectionText = cleanText(cnt.textContent)\n  console.log(\"selectionText\", selectionText)\n  console.log(\"precedingSelectionTextArray\", selectionText.split(\" \").filter(n=>n))\n  const length = selectionText.split(\" \").filter(n=>n).length\n  return length;\n}\n\n \n/**\n * @description gets the containing paragraph node for a node somewhere within the paragraph node\n * @param {node} node \n */\nexport function getContainingP(node) {\n  while (node) {\n    if (node.nodeType === 1 && node.tagName.toLowerCase() === \"p\") {\n        return node;\n    }\n    node = node.parentElement;\n  }\n}\n\n/**\n * @description retrieves plain text and counts line breaks based on input\n */\nexport function getLineNumber(url, selectedText, selectedElementTargetId){\n  //https://github.com/scta-texts/plaoulcommentary/edit/master/lectio1/lectio1.xml#L117\n  //https://raw.githubusercontent.com/scta-texts/plaoulcommentary/master/lectio1/lectio1.xml\n  //https://raw.githubusercontent.com/scta-texts/plaoulcommentarymaster/lectio1/lectio1.xml\n  const newRawUrl = url.replace(\"https://github.com\", \"https://raw.githubusercontent.com\").replace(\"/raw/\", '/')\n  const file = Axios.get(newRawUrl)\n  const data = file.then((d) => {\n    const findElement = \"xml:id=\\\"\" + selectedElementTargetId + \"\\\"\"\n    const splitText = d.data.split(findElement);\n    const beforeText = splitText[0]\n    const splitBeforeText = beforeText.split('\\n');\n    const newLineCount = splitBeforeText.length\n    \n    const afterText = splitText[1]\n    const regexp = new RegExp(`\\\\W${selectedText}\\\\W`, 'gi')\n    const elementBeforeText = afterText.split(regexp)[0] // this is flawed, first instance of the same text will be used\n    const splitElementBeforeText = elementBeforeText.split('\\n');\n    const newElementLineCount = splitElementBeforeText.length\n    return newLineCount + newElementLineCount - 1\n  })\n  return data\n}\n\nexport function goToGitHubEdit(url, selectedText, selectedElementTargetId){\n  console.log(url, selectedText, selectedElementTargetId)\n  const data = getLineNumber(url, selectedText, selectedElementTargetId)\n  //https://github.com/scta-texts/plaoulcommentary/raw/master/lectio1/lectio1.xml\n  data.then((d) => {\n    console.log(d)\n    const editUrl = url.replace(\"raw\", \"edit\") + \"#L\" + d\n    window.open(editUrl,\"gitHubEditWindow\",'height=750,width=750');\n    //window.open(editUrl, \"_blank\"); \n\n  })\n  \n  //window.location = \n  \n}","import React from 'react';\nimport BSpinner from 'react-bootstrap/Spinner';\n\nfunction Spinner() {\n  return (\n    <div className=\"spinner\" style={{\"padding\": \"20px 5px\"}}>\n      <BSpinner animation=\"grow\" role=\"status\">\n        <span className=\"sr-only\">Loading...</span>\n      </BSpinner>\n      <BSpinner animation=\"grow\" variant=\"primary\" />\n      <BSpinner animation=\"grow\" variant=\"secondary\" />\n      <BSpinner animation=\"grow\" variant=\"success\" />\n      <BSpinner animation=\"grow\" variant=\"danger\" />\n      <BSpinner animation=\"grow\" variant=\"warning\" />\n      <BSpinner animation=\"grow\" variant=\"info\" />\n    </div>\n  );\n}\n\nexport default Spinner;\n","const searchExpressionsListReducer = (state, action) => {\n  if (action){\n    switch (action.type){\n      case 'START_EXPRESSIONS_FETCH':\n          return {\n\n          }\n      case 'COMPLETE_EXPRESSIONS_FETCH':\n        return [...action.expressions]\n      default:\n        return state\n    }\n  }\n}\n\nexport {searchExpressionsListReducer as default}\n","import Axios from 'axios'\nimport {sparqlEndpoint} from '../components/config';\n\nexport var startExpressionsFetch = () => {\n  return{\n    type: \"START_EXPRESSIONS_FETCH\"\n  };\n};\nexport var completeExpressionsFetch = (expressions) => {\n  return{\n    type: \"COMPLETE_EXPRESSIONS_FETCH\",\n    expressions\n  };\n};\nexport var fetchExpressionsList = (searchParameters, dispatch) =>{\n    let workGroupSparql = \"\"\n    if (searchParameters.searchWorkGroup){\n      workGroupSparql = [\n      \"<\" + searchParameters.searchWorkGroup + \"> <http://scta.info/property/hasExpression> ?expression .\"\n      ].join(' ');\n    }\n    let expressionAuthorTypeSparql = \"\"\n    if (searchParameters.expressionAuthorType){\n      expressionAuthorTypeSparql = [\n      \"?expression <http://www.loc.gov/loc.terms/relators/AUT> ?expressionAuthor . \",\n      \"?expressionAuthor <http://scta.info/property/personType> <http://scta.info/resource/\" + searchParameters.expressionAuthorType + \"> .\"\n      ].join('');\n    }\n\n    let authorSparql = \"\"\n    if (searchParameters.searchAuthor){\n      authorSparql = [\n      \"?expression <http://www.loc.gov/loc.terms/relators/AUT> <\" + searchParameters.searchAuthor + \"> .\"\n      ].join('');\n    }\n    var query = [\n        \"SELECT ?type ?expression ?expressionShortId ?expressionTitle ?author ?authorTitle ?workGroup ?workGroupTitle\",\n        \"WHERE { \",\n          \"?expression a <http://scta.info/resource/expression> .\",\n          \"?expression a ?type .\",\n          \"?expression <http://scta.info/property/level> '1' . \",\n          expressionAuthorTypeSparql,\n          workGroupSparql,\n          authorSparql,\n          \"?expression <http://scta.info/property/shortId> ?expressionShortId .\",\n          \"?expression <http://scta.info/property/shortId> ?expressionShortId .\",\n          \"?expression <http://purl.org/dc/elements/1.1/title> ?expressionTitle .\",\n          \"?expression <http://www.loc.gov/loc.terms/relators/AUT> ?author . \",\n          \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n          \"?expression <http://purl.org/dc/terms/isPartOf> ?workGroup .\",\n          \"?workGroup <http://purl.org/dc/elements/1.1/title> ?workGroupTitle .\",\n          \"}\",\n        \"ORDER BY ?expressionTitle\"].join('');\n\n  dispatch(startExpressionsFetch());\n  Axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var searchWorks = results.map((result) => {\n      var workInfo = {\n          expression: result.expression.value,\n          expressionShortId: result.expressionShortId ? result.expressionShortId.value : \"\",\n          expressionTitle: result.expressionTitle.value,\n          workGroup: result.workGroup ? result.workGroup.value : \"\",\n          workGroupTitle: result.workGroupTitle ? result.workGroupTitle.value : \"\",\n          author: result.author ? result.author.value : \"\",\n          authorTitle: result.author ? result.authorTitle.value : \"\",\n          type: result.type.value\n\n        }\n        return workInfo\n\n      });\n      dispatch(completeExpressionsFetch(searchWorks));\n    });\n\n};\n","const searchAuthorsListReducer = (state, action) => {\n  if (action){\n    switch (action.type){\n      case 'START_AUTHORS_FETCH':\n          return {\n\n          }\n      case 'COMPLETE_AUTHORS_FETCH':\n        return [...action.authors]\n      default:\n        return state\n    }\n  }\n}\n\nexport {searchAuthorsListReducer as default}\n","import Axios from 'axios'\nimport {sparqlEndpoint} from '../components/config';\n\nexport var startAuthorsFetch = () => {\n  return{\n    type: \"START_AUTHORS_FETCH\"\n  };\n};\nexport var completeAuthorsFetch = (authors) => {\n  return{\n    type: \"COMPLETE_AUTHORS_FETCH\",\n    authors\n  };\n};\nexport var fetchAuthorsList = (searchParameters, dispatch) =>{\n    let workGroupSparql = \"\";\n      if (searchParameters.searchWorkGroup){\n        workGroupSparql = \"<\" + searchParameters.searchWorkGroup + \"> <http://scta.info/property/hasExpression> ?resource .\"\n      }\n    const query = [\n        \"SELECT DISTINCT ?author ?authorTitle ?authorShortId \",\n        \"WHERE { \",\n        \"?author a <http://scta.info/resource/person> .\",\n        \"?resource a <http://scta.info/resource/expression> .\",\n        \"?resource <http://scta.info/property/level> '1' .\",\n        workGroupSparql,\n        \"?resource <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n        \"?author <http://scta.info/property/shortId> ?authorShortId .\",\n        \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n        \"}\",\n        \"ORDER BY ?authorTitle\"].join('');\n  dispatch(startAuthorsFetch());\n  Axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var authors = results.map((result) => {\n        var authorInfo = {\n          author: result.author.value,\n          authorShortId: result.authorShortId.value,\n          authorTitle: result.authorTitle.value,\n        }\n        return authorInfo\n\n      });\n      dispatch(completeAuthorsFetch(authors));\n    });\n  };\n","const searchWorkGroupsListReducer = (state, action) => {\n  if (action){\n    switch (action.type){\n      case 'START_WORK_GROUPS_LIST_FETCH':\n          return {\n\n          }\n      case 'COMPLETE_WORK_GROUPS_LIST_FETCH':\n        return [...action.workGroups]\n      default:\n        return state\n    }\n  }\n}\n\nexport {searchWorkGroupsListReducer as default}\n","import Axios from 'axios'\nimport {sparqlEndpoint} from '../components/config';\n\nexport var startWorkGroupsListFetch = () => {\n  return{\n    type: \"START_WORK_GROUPS_LIST_FETCH\"\n  };\n};\nexport var completeWorkGroupsListFetch = (workGroups) => {\n  return{\n    type: \"COMPLETE_WORK_GROUPS_LIST_FETCH\",\n    workGroups\n  };\n};\nexport var fetchWorkGroupsList = (searchParameters, dispatch) =>{\n  let authorQuery = \"\";\n    if (searchParameters.searchAuthor){\n      authorQuery = [\n      \"?workGroup <http://scta.info/property/hasExpression> ?expression .\",\n      \"?expression <http://www.loc.gov/loc.terms/relators/AUT> <\" + searchParameters.searchAuthor + \"> .\"\n      ].join('');\n    }\n  //   // Begin Author date sparql filters\n  //   let quotationAuthorDateSparql = \"\";\n  //   if (searchParameters.quotationAuthorDateAfter || searchParameters.quotationAuthorDateBefore){\n  //     quotationAuthorDateSparql = \"?author <http://scta.info/property/dateOfBirth> ?dateOfBirth .\"\n  //   }\n  //   let quotationAuthorDateAfterSparqlFilter = \"\";\n  //   if (searchParameters.quotationAuthorDateAfter){\n  //     quotationAuthorDateAfterSparqlFilter = \"FILTER (?dateOfBirth >= '\" + searchParameters.quotationAuthorDateAfter + \"').\"\n  //   }\n  //   let quotationAuthorDateBeforeSparqlFilter = \"\";\n  //   if (searchParameters.quotationAuthorDateBefore){\n  //     quotationAuthorDateBeforeSparqlFilter = \"FILTER (?dateOfBirth <= '\" + searchParameters.quotationAuthorDateBefore + \"').\"\n  //   }\n    // END author date sparql filter\n    var query = [\n        \"SELECT DISTINCT ?workGroup ?workGroupTitle \",\n        \"WHERE { \",\n        \"?workGroup a <http://scta.info/resource/workGroup> .\",\n        \"?workGroup <http://purl.org/dc/elements/1.1/title> ?workGroupTitle .\",\n        authorQuery,\n        \"}\",\n        \"ORDER BY ?workGroupTitle\"].join(' ');\n  dispatch(startWorkGroupsListFetch());\n  Axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var workGroups = results.map((result) => {\n        var workGroupInfo = {\n          workGroup: result.workGroup.value,\n          workGroupTitle: result.workGroupTitle.value,\n        }\n        return workGroupInfo\n\n      });\n      dispatch(completeWorkGroupsListFetch(workGroups));\n    });\n  };\n","const searchExpressionTypesListReducer = (state, action) => {\n  if (action){\n    switch (action.type){\n      case 'START_EXPRESSION_TYPES_LIST_FETCH':\n          return {\n\n          }\n      case 'COMPLETE_EXPRESSION_TYPES_LIST_FETCH':\n        return [...action.expressionTypes]\n      default:\n        return state\n    }\n  }\n}\n\nexport {searchExpressionTypesListReducer as default}\n","import React, {useState, useEffect, useReducer} from 'react';\nimport searchExpressionsListReducer from '../reducers/searchExpressionsListReducer'\nimport * as searchExpressionsListActions from '../actions/searchExpressionsListActions'\nimport searchAuthorsListReducer from '../reducers/searchAuthorsListReducer'\nimport * as searchAuthorsListActions from '../actions/searchAuthorsListActions'\nimport searchWorkGroupsListReducer from '../reducers/searchWorkGroupsListReducer'\nimport * as searchWorkGroupsListActions from '../actions/searchWorkGroupsListActions'\nimport searchExpressionTypesListReducer from '../reducers/searchExpressionTypesListReducer'\nimport * as searchExpressionTypesListActions from '../actions/searchExpressionTypesListActions'\nimport Form from 'react-bootstrap/Form';\nimport Button from 'react-bootstrap/Button';\nimport InputGroup from 'react-bootstrap/InputGroup';\n\nconst Search3Parameters = (props) => {\n  const [searchType, setSearchType] = useState(props.searchType ? props.searchType : \"text\")\n  const [searchTerm, setSearchTerm] = useState(props.searchTerm)\n  const [searchAuthor, setSearchAuthor] = useState(props.searchAuthor)\n  const [searchEid, setSearchEid] = useState(props.searchEid)\n  const [searchEType, setSearchEType] = useState(props.searchEType)\n  const [searchWorkGroup, setSearchWorkGroup] = useState(props.searchWorkGroup)\n\n  const [resultsFilter, setResultsFilter] = useState(\"\")\n\n  const [searchExpressionTypesList, searchExpressionTypesListDispatch] = useReducer(searchExpressionTypesListReducer, [])\n  const [searchExpressionsList, searchExpressionsListDispatch] = useReducer(searchExpressionsListReducer, [])\n  const [searchAuthorsList, searchAuthorsListDispatch] = useReducer(searchAuthorsListReducer, [])\n  const [searchWorkGroupsList, searchWorkGroupsListDispatch] = useReducer(searchWorkGroupsListReducer, [])\n  const searchParameters = {searchTerm, searchAuthor, searchEid, searchWorkGroup, searchType, searchEType, resultsFilter}\n\n  const [displayAllParameters, setDisplayAllParameters] = useState(false)\n\n  const handleSetSearchParameters = () => {\n    props.handleSetSearchParameters(searchParameters)\n  }\n  const handleSetResultsFilter = (content) => {\n    setResultsFilter(content)\n  }\n\n  //begin effects to update hooks when props change\n  // perhaps this could be combined into a single custom hood\n  useEffect(() => {\n    setSearchType(props.searchType ? props.searchType : \"text\")\n  }, [props.searchType])\n  useEffect(() => {\n    setSearchAuthor(props.searchAuthor)\n  }, [props.searchAuthor])\n  useEffect(() => {\n    setSearchEid(props.searchEid)\n  }, [props.searchEid])\n  useEffect(() => {\n    setSearchWorkGroup(props.searchWorkGroup)\n  }, [props.searchWorkGroup])\n  useEffect(() => {\n    setSearchTerm(props.searchTerm)\n  }, [props.searchTerm])\n  //end effects to update hooks when props change\n  //begin other effects\n  useEffect(handleSetSearchParameters, [searchTerm, searchAuthor, searchEid, searchWorkGroup, searchType, searchEType, resultsFilter])\n  useEffect(() => {\n    searchExpressionsListDispatch(searchExpressionsListActions.fetchExpressionsList(searchParameters, searchExpressionsListDispatch))\n    searchAuthorsListDispatch(searchAuthorsListActions.fetchAuthorsList(searchParameters, searchAuthorsListDispatch))\n    searchWorkGroupsListDispatch(searchWorkGroupsListActions.fetchWorkGroupsList(searchParameters, searchWorkGroupsListDispatch))\n    searchExpressionTypesListDispatch(searchExpressionTypesListActions.fetchExpressionTypesList(searchParameters, searchExpressionTypesListDispatch))\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n  useEffect(() => {\n    searchExpressionsListDispatch(searchExpressionsListActions.fetchExpressionsList(searchParameters, searchExpressionsListDispatch))\n    searchWorkGroupsListDispatch(searchWorkGroupsListActions.fetchWorkGroupsList(searchParameters, searchWorkGroupsListDispatch))\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [searchAuthor])\n  useEffect(() => {\n    searchExpressionsListDispatch(searchExpressionsListActions.fetchExpressionsList(searchParameters, searchExpressionsListDispatch))\n    searchAuthorsListDispatch(searchAuthorsListActions.fetchAuthorsList(searchParameters, searchAuthorsListDispatch))\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [searchWorkGroup])\n\n\n  return(\n    <div>\n      <InputGroup size=\"sm\" className=\"mb-2\">\n        <InputGroup.Prepend>\n            <InputGroup.Text>Search Term</InputGroup.Text>\n        </InputGroup.Prepend>\n        <Form.Control as=\"input\" type=\"text\" placeholder=\"search term\" onChange={(e) => setSearchTerm(e.target.value)} value={searchParameters.searchTerm}/>\n      </InputGroup>\n      {/* {NOTE filter results parameter is useful only when results are of manageable size;\n        when results are big, javascript locks up while filtering\n        if paging is used, then this could prevent performance slow down \n        but paging makes the tool less than useful, because it will only filter what is on the page\n        TODO: reconsider if you want to keep this; or this is not worth the trouble\n        NOTE: if this parameters is removed, then filterResults() and filterQuestionResults() functions \n        in Search3 should be removed\n        } */}\n      <InputGroup size=\"sm\" className=\"mb-2\">\n          <InputGroup.Prepend>\n            <InputGroup.Text>Filter Results</InputGroup.Text>\n          </InputGroup.Prepend>\n        <Form.Control as=\"input\" type=\"secondary results filter\" placeholder=\"secondary results filter\" onChange={(e) => handleSetResultsFilter(e.target.value)} value={resultsFilter}/>\n      </InputGroup>\n      {displayAllParameters &&\n        <div>\n          <InputGroup size=\"sm\" className=\"mb-2\">\n            <InputGroup.Prepend>\n              <InputGroup.Text>Search Type</InputGroup.Text>\n            </InputGroup.Prepend>\n            <Form.Control as=\"select\" onChange={(e) => {setSearchType(e.target.value)}} value={searchParameters.searchType}>\n              <option value=\"questionTitles\">Questions Titles</option>\n              <option value=\"text\">Text</option>\n            </Form.Control>\n          </InputGroup>\n          <InputGroup size=\"sm\" className=\"mb-2\">\n            <InputGroup.Prepend>\n              <InputGroup.Text>Work Group</InputGroup.Text>\n            </InputGroup.Prepend>\n            <Form.Control as=\"select\" onChange={(e) => {setSearchWorkGroup(e.target.value)}} value={searchParameters.searchWorkGroup}>\n                <option value=\"\">All</option>\n                {searchWorkGroupsList && searchWorkGroupsList.map((e, i) => {\n                    return (<option key={e.workGroup + \"-\" + i} value={e.workGroup}>{e.workGroupTitle}</option>)\n                  })\n                }\n              </Form.Control>\n          </InputGroup>\n          <InputGroup size=\"sm\" className=\"mb-2\">\n            <InputGroup.Prepend>\n              <InputGroup.Text>Expression Type</InputGroup.Text>\n            </InputGroup.Prepend>\n            <Form.Control as=\"select\" onChange={(e) => {setSearchEType(e.target.value)}} value={searchParameters.searchEType}>\n                <option value=\"\">All</option>\n                {searchExpressionTypesList && searchExpressionTypesList.map((e, i) => {\n                    return (<option key={e.expressionType + \"-\" + i} value={e.expressionType}>{e.expressionTypeTitle}</option>)\n                  })\n                }\n            </Form.Control>\n          </InputGroup>\n          <InputGroup size=\"sm\" className=\"mb-2\">\n            <InputGroup.Prepend>\n              <InputGroup.Text>Author</InputGroup.Text>\n            </InputGroup.Prepend>\n            <Form.Control as=\"select\" onChange={(e) => {setSearchAuthor(e.target.value)}} value={searchParameters.searchAuthor}>\n              <option value=\"\">All</option>\n              {searchAuthorsList && searchAuthorsList.map((e, i) => {\n                  return (<option key={e.author + \"-\" + i} value={e.author}>{e.authorTitle}</option>)\n                })\n              }\n            </Form.Control>\n          </InputGroup>\n          <InputGroup size=\"sm\" className=\"mb-2\">\n            <InputGroup.Prepend>\n              <InputGroup.Text>Text</InputGroup.Text>\n            </InputGroup.Prepend>\n            <Form.Control as=\"select\" onChange={(e) => {setSearchEid(e.target.value)}} value={searchParameters.searchEid}>\n              <option value=\"\">All</option>\n              {searchExpressionsList && searchExpressionsList.map((e, i) => {\n                  return (<option key={e.expression + \"-\" + i} value={e.expression}>{e.authorTitle}: {e.expressionTitle}</option>)\n                })\n              }\n            </Form.Control>\n          </InputGroup>\n        </div>\n      }\n      <InputGroup.Prepend size=\"sm\" className=\"mb-2\">\n        {props.children}\n        {props.showAdvancedParameters && <Button className=\"btn-sm\" onClick={() => {setDisplayAllParameters(!displayAllParameters)}}>{displayAllParameters ? \"Hide\" : \"Show\"} More Filter Options</Button>}        \n      </InputGroup.Prepend>\n      \n      \n    </div>\n  )\n}\n\nexport {Search3Parameters as default}\n","import Axios from 'axios'\nimport {sparqlEndpoint} from '../components/config';\n\nexport var startExpressionTypesListFetch = () => {\n  return{\n    type: \"START_EXPRESSION_TYPES_LIST_FETCH\"\n  };\n};\nexport var completeExpressionTypesListFetch = (expressionTypes) => {\n  return{\n    type: \"COMPLETE_EXPRESSION_TYPES_LIST_FETCH\",\n    expressionTypes\n  };\n};\nexport var fetchExpressionTypesList = (searchParameters, dispatch) =>{\n  //TODO: delete this or uncomment if authorQuery should be included in expressionTypeList Fetch\n  // let authorQuery = \"\";\n  //   if (searchParameters.searchAuthor){\n  //     authorQuery = [\n  //     \"?workGroup <http://scta.info/property/hasExpression> ?expression .\",\n  //     \"?expression <http://www.loc.gov/loc.terms/relators/AUT> <\" + searchParameters.searchAuthor + \"> .\"\n  //     ].join('');\n  //   }\n\n    var query = [\n        \"SELECT DISTINCT ?expressionType ?expressionTypeTitle \",\n        \"WHERE { \",\n        \"?expressionType a <http://scta.info/resource/expressionType> .\",\n        \"?expressionType <http://purl.org/dc/elements/1.1/title> ?expressionTypeTitle .\",\n        \"}\",\n        \"ORDER BY ?expressionTypeTitle\"].join(' ');\n  dispatch(startExpressionTypesListFetch());\n  Axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    const results = res.data.results.bindings;\n    const expressionTypes = results.map((result) => {\n        return {\n          expressionType: result.expressionType.value,\n          expressionTypeTitle: result.expressionTypeTitle.value,\n        }\n      });\n      dispatch(completeExpressionTypesListFetch(expressionTypes));\n    });\n  };\n","import React from 'react';\nimport {Link} from 'react-router-dom';\nimport Axios from 'axios'\n\n//TODO: these retrieves need to be refactored into; \n// if exist db api is improved then a single request should be easier\nexport function retrieveExpressionResults(searchTerm, searchEid){\n  const expressionShortId = searchEid === \"all\" ? searchEid : searchEid.split(\"/resource/\")[1]\n  const url = \"https://exist.scta.info/exist/apps/scta-app/jsonsearch/json-search-text-by-expressionid.xq?query=\" + searchTerm + \"&expressionid=\" + expressionShortId\n  const queryPromise = Axios.get(url)\n  return queryPromise\n}\nexport function retrieveAuthorResults(searchTerm, searchAuthor){\n  const authorShortId = searchAuthor.split(\"/resource/\")[1]\n  const url = \"https://exist.scta.info/exist/apps/scta-app/jsonsearch/json-search-text-by-authorid.xq?query=\" + searchTerm + \"&authorid=\" + authorShortId\n  const queryPromise = Axios.get(url)\n  return queryPromise\n\n}\nexport function retrieveWorkGroupResults(searchTerm, searchWorkGroup){\n  const workGroupShortId = searchWorkGroup.split(\"/resource/\")[1]\n  const url = \"https://exist.scta.info/exist/apps/scta-app/jsonsearch/json-search-text-by-workGroupId.xq?query=\" + searchTerm + \"&workGroupId=\" + workGroupShortId\n  const queryPromise = Axios.get(url)\n  return queryPromise\n\n}\n\nexport function displayTextResults(results){\n  if (!results || results.length === 0){\n    return (<div>\n      <p>No results found</p>\n    </div>)\n  }\n  else if (results.length > 0){\n    const textResults = results.map((r, i) => {\n      const textString = r.previous + \" <span class='highlight'>\" + r.hit + \"</span> \" + r.next\n      const range = r.start + \"-\" + r.end\n      return (\n        <div key={i}>\n        <p><Link to={\"/text?resourceid=http://scta.info/resource/\" + r.pid + \"@\" + range}>{r.pid + \"@\" + range}</Link></p>\n        <p dangerouslySetInnerHTML={{ __html: textString}}/>\n        </div>\n      )\n\n    })\n    return (\n      <div>\n          <p>{results.length + \" results\"}</p>\n          {textResults}\n      </div>\n    )\n  }\n  else if (results){\n    const r = results\n    const textString = r.previous + \" <span class='highlight'>\" + r.hit + \"</span> \" + r.next\n    const range = r.start + \"-\" + r.end\n    return (\n      <div>\n        <p>{1 + \" results\"}</p>\n      <div key={results.pid}>\n      <p><Link to={\"/text?resourceid=http://scta.info/resource/\" + r.pid + \"@\" + range}>{r.pid + \"@\" + range}</Link></p>\n      <p dangerouslySetInnerHTML={{ __html: textString}}/>\n      </div>\n      </div>\n    )\n  }\n  else{\n    return (\n      <div><p>No results</p></div>\n    )\n  }\n}\n\nexport function displayQuestionResults(results, searchParameters){\n  if (results.length > 0){\n    const displayResults = results.map((r, i) => {\n      return (\n      <div key={r.resource.value + \"-\" + i}>\n        <p><Link to={\"/text?resourceid=\" + r.author.value}>{r.authorTitle.value}</Link>: <Link to={\"/text?resourceid=\" + r.resource.value}>{r.longTitle.value}</Link></p>\n        <p>{r.qtitle.value.toLowerCase().replace(searchParameters.searchTerm.toLowerCase(), searchParameters.searchTerm.toUpperCase())}</p>\n      </div>\n      )\n    })\n    return (\n      <div>\n        <p>{displayResults.length + \" results\"}</p>\n        {displayResults}\n      </div>\n    )\n  }\n  else{\n    return (\n      <div>\n        <p>No results</p>\n      </div>\n    )\n\n  }\n}\n","import React, {useEffect, useState} from 'react';\nimport Form from 'react-bootstrap/Form';\nimport Button from 'react-bootstrap/Button';\nimport {runQuery} from './utils'\nimport {questionTitleQuery} from '../queries/questionTitleQuery'\nimport Spinner from './Spinner';\nimport Container from 'react-bootstrap/Container';\nimport Search3Parameters from './Search3Parameters';\nimport {retrieveAuthorResults, retrieveExpressionResults, retrieveWorkGroupResults, displayTextResults, displayQuestionResults} from './searchUtils'\n\nconst Search3 = (props) => {\n  const [searchParameters, setSearchParameters] = useState({})\n  const [results, setResults] = useState([])\n  const [questionResults, setQuestionResults] = useState([])\n  \n  useEffect(() => {\n    if (searchParameters.searchType === \"questionTitles\"){\n      displayQuestionResults(filterQuestionResults(questionResults, searchParameters.resultsFilter), searchParameters)\n    }\n    else if (searchParameters.searchType === \"text\"){\n      displayTextResults(filterResults(results, searchParameters.resultsFilter))\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [searchParameters.resultsFilter])\n  \n  \n  const handleSetSearchParameters = (parameters) => {\n    setSearchParameters(parameters)\n  }\n\n  const handleRunSearch = (e) => {\n    e.preventDefault()\n    if (!searchParameters.searchTerm){\n      setResults([])\n    }\n    else{\n      if (searchParameters.searchType === \"text\"){\n        setResults(\"fetching\")\n        setQuestionResults([])\n        if (searchParameters.searchEid){\n          const textResults = retrieveExpressionResults(searchParameters.searchTerm, searchParameters.searchEid)\n          textResults.then((d) => {\n            setResults(d.data.results)\n          })\n        }\n        else if (searchParameters.searchAuthor){\n          const textResults = retrieveAuthorResults(searchParameters.searchTerm, searchParameters.searchAuthor)\n          textResults.then((d) => {\n            setResults(d.data.results)\n          })\n        }\n        else if (searchParameters.searchWorkGroup){\n          const textResults = retrieveWorkGroupResults(searchParameters.searchTerm, searchParameters.searchWorkGroup)\n          textResults.then((d) => {\n            setResults(d.data.results)\n          })\n        }\n        else{\n          const textResults = retrieveExpressionResults(searchParameters.searchTerm, \"all\")\n          textResults.then((d) => {\n            setResults(d.data.results)\n          })\n        }\n\n\n      }\n      else{\n        const questionResults = runQuery(questionTitleQuery(searchParameters))\n        setQuestionResults(\"fetching\")\n        setResults([])\n        questionResults.then((d) => {\n          setQuestionResults(d.data.results.bindings)\n        })\n      }\n    }\n  }\n  const displayResults = (results) => {\n    if (results === \"fetching\" || questionResults === \"fetching\"){ \n      return <Spinner/>\n    }\n    else if (searchParameters.searchType === \"questionTitles\"){\n      return displayQuestionResults(filterQuestionResults(questionResults, searchParameters.resultsFilter), searchParameters)\n    }\n    else if (searchParameters.searchType === \"text\"){\n      \n      return displayTextResults(filterResults(results, searchParameters.resultsFilter))\n    }\n  }\n  const filterResults = (results, resultsFilter) => {\n    let newResults = [] \n    if (!results || results.length === 0){\n      newResults = [] \n    }\n    else if (results.length > 1){\n      results.forEach((r) => {\n        const combinedString = [r.previous.toLowerCase(), r.hit.toLowerCase(), r.next.toLowerCase()].join(\" \")\n        if (combinedString.includes(resultsFilter.toLowerCase())){\n          newResults.push(r)\n        }\n      })\n    }\n    else if (results){\n      const r = results;\n      const combinedString = [r.previous.toLowerCase(), r.hit.toLowerCase(), r.next.toLowerCase()].join(\" \")\n      newResults = combinedString.includes(resultsFilter.toLowerCase()) ? results : \"\";\n    }\n    return newResults\n  }\n  // similar filter to above; but modified to handle question title data structure\n  const filterQuestionResults = (results, resultsFilter) => {\n    let newResults = [] \n    if (!results || results.length === 0){\n      newResults = [] \n    }\n    else if (results.length > 0){\n      results.forEach((r) => {\n        if (r.qtitle && r.qtitle.value.toLowerCase().includes(resultsFilter.toLowerCase())){\n          newResults.push(r)\n        }\n      })\n    }\n    return newResults\n  }\n\n  return(\n    <Container className={props.hidden ? \"hidden\" : \"showing\"}>\n      <Form onSubmit={handleRunSearch}>\n        <Search3Parameters\n          handleSetSearchParameters={handleSetSearchParameters}\n          searchAuthor={props.searchAuthor}\n          searchEid={props.searchEid}\n          searchEType={props.searchEType}\n          searchWorkGroup={props.searchWorkGroup}\n          showAdvancedParameters={props.showAdvancedParameters}\n          showLabels={props.showLabels}\n          searchType={props.searchType}\n          searchTerm={props.searchTerm}\n          >\n            {props.showSubmit && <Button onClick={handleRunSearch} className=\"btn-sm\" style={{marginRight: \"5px\"}}>Submit</Button>}\n            </Search3Parameters>\n          \n      \n    </Form>\n    {displayResults(results)}\n    </Container>\n\n  )\n}\n\nSearch3.defaultProps = {\n  showLabels: true,\n  showAdvancedParameters: true,\n  searchAuthor: \"\",\n  searchEid: \"\",\n  showSubmit: true\n};\n\nexport {Search3 as default}\n","export function questionTitleQuery(searchParameters){\n  const searchTerm = searchParameters.searchTerm\n  let workGroupQuery = \"\";\n    if (searchParameters.searchWorkGroup){\n      workGroupQuery = [\n        \"BIND(<\" + searchParameters.searchWorkGroup + \"> AS ?workGroup) .\",\n        \"?workGroup <http://scta.info/property/hasExpression> ?topLevel .\"\n      ].join(' ')\n    }\n  let expressionTypeQuery = \"\";\n    if (searchParameters.searchEType){\n      expressionTypeQuery = [\n        \"BIND(<\" + searchParameters.searchEType + \"> AS ?expressionType) .\",\n        \"{\",\n          \"?resource <http://scta.info/property/expressionType> ?expressionType .\",\n        \"}\",\n        \"UNION\",\n        \"{\",\n          \"?resource <http://scta.info/property/isMemberOf> ?ancestor .\",\n          \"?ancestor <http://scta.info/property/expressionType> ?expressionType .\",\n        \"}\"].join(' ')\n    }\n  let authorQuery = \"\";\n    if (searchParameters.searchAuthor){\n      authorQuery = \"BIND(<\" + searchParameters.searchAuthor + \"> AS ?author).\"\n    }\n  let eidQuery = \"\";\n    if (searchParameters.searchEid){\n      eidQuery = \"BIND(<\" + searchParameters.searchEid + \"> AS ?topLevel).\"\n    }\n   const query = [\n     \"SELECT ?resource ?qtitle ?resourceTitle ?structureType ?longTitle ?author ?authorTitle\",\n     \"WHERE\",\n     \"{\",\n\n       \"?resource <http://scta.info/property/questionTitle> ?qtitle  .\",\n       \"?resource <http://purl.org/dc/elements/1.1/title> ?resourceTitle .\",\n       \"?resource <http://scta.info/property/structureType> ?structureType .\",\n       \"?resource <http://scta.info/property/longTitle> ?longTitle .\",\n       expressionTypeQuery,\n       eidQuery,\n       \"?resource <http://scta.info/property/isPartOfTopLevelExpression> ?topLevel .\",\n       authorQuery,\n       \"?topLevel <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n       \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n       workGroupQuery,\n       \"FILTER (REGEX(STR(?qtitle), '\" + searchTerm + \"', 'i')) .\",\n     \"}\"\n   ].join(' ');\n   return query\n }\n","//Vendor Imports\nimport React from 'react';\nimport Axios from 'axios'\nimport PropTypes from 'prop-types';\n\nclass Print extends React.Component {\n  constructor(props){\n    super(props)\n    this.getPdf = this.getPdf.bind(this)\n    this.state = {\n      status: \"\",\n      pdf: \"\",\n    }\n  }\n  getPdf(url){\n    Axios.get(\"https://print.lombardpress.org/api/v1/resource?url=\" + url)\n      .then((data) => {\n        console.log(data)\n        if (data.data.url){\n          console.log(\"first condition passed\", data.data.url)\n          const hashWithExtension = data.data.url\n          //window.location = \"http://print.lombardpress.org/api/v1/cache/\" + hashWithExtension\n          this.setState({pdf: \"https://print.lombardpress.org/api/v1/cache/\" + hashWithExtension})\n        }\n        else{\n          this.setState({status: data.data.Status + \"Please check back in a few minutes\", pdf: \"\"})\n        }\n      })\n\n  }\n  componentDidMount(){\n    const url = this.props.url\n    this.getPdf(url)\n  }\n  \n  componentDidUpdate(prevProps){\n    const newUrl = this.props.url\n    const oldUrl = prevProps.url\n    if (newUrl !== oldUrl){\n      this.getPdf(newUrl)\n    }\n  }\n  render(){\n\n    return (\n      <div style={{\"width\": \"100%\", \"height\": \"77vh\", \"margin\": \"auto\"}}>\n      {this.state.pdf ?\n        <object data={this.state.pdf} type=\"application/pdf\" width=\"100%\" height=\"100%\">\n            alt : <a href={this.state.pdf}>{this.state.pdf}</a>\n        </object>\n        :\n        <p>{this.state.status}</p>\n        }\n    </div>\n    );\n  }\n}\n\nPrint.propTypes = {\n  /**\n  * url to raw xml source file\n  */\n url: PropTypes.string.isRequired,\n}\n\nexport default Print;\n","import React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport OpenSeadragon from 'openseadragon';\nimport Axios from 'axios'\nimport uuidv4 from 'uuid/v4';\n\nconst OSDInstance = (props) => {\n  const [instance, setInstance] = useState()\n  const [viewerWidthHeight, setViewerWidthHeight] = useState({ w: \"\", h: \"\" })\n  const [viewerId] = useState(uuidv4())\n  useEffect(() => {\n    if (props.coords){\n      setViewerWidthHeight(computeViewerWidthHeight(props.coords.split(\",\")[2], props.coords.split(\",\")[3]))\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [props.coords])\n  useEffect(() => {\n    Axios.get(props.imageurl + \"/info.json\").then((d) => {\n      if (instance) {\n        // Modify tile source as needed to already existing instance\n        instance.addTiledImage({\n          tileSource: d.data\n        });\n        if (props.coords) {\n          // this should be another way to get Scalar coordinates, but it doesn't seem to be working\n          //const newRect = instance.viewport.imageToViewportRectangle(x, y, w, h)\n          const sc = getScalarCoordinates(props.coords, d.data.height, d.data.width)\n          const rect = new OpenSeadragon.Rect(sc.x, sc.y, sc.w, sc.h)\n          setBounds(instance, rect)\n          setOverlay(instance, rect)\n          if (props.lineFocusCoords){\n            const lsc = getScalarCoordinates(props.lineFocusCoords, d.data.height, d.data.width)\n            const linerect = new OpenSeadragon.Rect(lsc.x, lsc.y, lsc.w, lsc.h)\n            setOverlay(instance, linerect)\n          \n          }\n          setGoHome(instance, rect)\n          instance.viewport.fitBounds(rect)\n        }\n      }\n      else {\n        const id = \"osd-\" + viewerId\n        const instance = OpenSeadragon({\n          id: id,\n          prefixUrl: \"/img/openseadragon/\",\n          preserveViewport: true, //this helps to keep the viewer in the same spot when toggling full screen\n          visibilityRatio: 1,\n          minZoomLevel: 1,\n          defaultZoomLevel: 1,\n          tileSources: [d.data],\n          controlsFadeDelay: 0,\n          controlsFadeLength: 25\n        })\n        if (props.coords) {\n          // this should be another way to get Scalar coordinates, but it doesn't seem to be working\n          //const newRect = instance.viewport.imageToViewportRectangle(x, y, w, h)\n          const sc = getScalarCoordinates(props.coords, d.data.height, d.data.width)\n          const rect = new OpenSeadragon.Rect(sc.x, sc.y, sc.w, sc.h)\n          setBounds(instance, rect)\n          setOverlay(instance, rect)\n          if (props.lineFocusCoords){\n            const lsc = getScalarCoordinates(props.lineFocusCoords, d.data.height, d.data.width)\n            const linerect = new OpenSeadragon.Rect(lsc.x, lsc.y, lsc.w, lsc.h)\n            setOverlay(instance, linerect)\n        }\n          setGoHome(instance, rect)\n        }\n        setInstance(instance)\n      }\n    })\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [props.imageurl, props.coords])\n\n  const setOverlay = (instance, rect) => {\n    instance.addHandler(\"open\", function () {\n      const id = uuidv4()\n      const elt = document.createElement(\"div\");\n      elt.id = \"runtime-overlay-\" + id;\n      elt.className = \"osdhighlight\";\n      instance.addOverlay({\n        element: elt,\n        location: rect\n      });\n    })\n  }\n  const setBounds = (instance, rect) => {\n    instance.addHandler(\"open\", function () {\n      instance.viewport.fitBounds(rect, true);\n    });\n  }\n  const setGoHome = (instance, rect) => {\n    //OpenSeadragon.Viewport.prototype.goHome = function () {\n    instance.viewport.goHome = function () {\n      // Give it whatever rectangle you want\n      this.fitBounds(rect);\n    }\n  }\n  const getScalarCoordinates = (inputCoords, imageH, imageW) => {\n    const coords = inputCoords.split(\",\")\n    const x = parseInt(coords[0])\n    const y = parseInt(coords[1])\n    const w = parseInt(coords[2])\n    const h = parseInt(coords[3])\n\n    const ar = imageH / imageW\n    const xcomp = x / imageW\n    const ycomp = (y / imageH) * ar\n    const wcomp = w / imageW\n    const hcomp = (h / imageH) * ar\n    return { x: xcomp, y: ycomp, w: wcomp, h: hcomp }\n  }\n  const computeViewerWidthHeight = (w, h) => {\n    const displayWidth = props.displayWidth\n    const newHeight = displayWidth * (parseInt(h) / parseInt(w))\n    return { w: displayWidth, h: newHeight }\n  }\n  return (\n    <div>\n      {\n        //<p onClick={handleAddOverlay}>Add overlay</p>\n      }\n      {\n        props.coords ? <div id={\"osd-\" + viewerId} className=\"open-seadragon-container\" style={{ height: viewerWidthHeight.h + \"px\", width: viewerWidthHeight.w + \"px\" }}></div>\n          : <div id={\"osd-\" + viewerId} className=\"open-seadragon-container\" style={{ height: \"100vh\" }}></div>\n      }\n\n    </div>\n  )\n}\n\nOSDInstance.defaultProps = {\n  imageurl: \"https://loris2.scta.info/vat/V145v.jpg\",\n  displayWidth: 1000\n};\nOSDInstance.propTypes = {\n  /**\n  * imageurl (without iiif parameters) for which logo will be requested\n  **/\n  imageurl: PropTypes.string.isRequired,\n\n}\n\nexport default OSDInstance;","import React from 'react';\nimport OSDInstance from './OSDInstance';\nimport PropTypes from 'prop-types';\n\n// TODO: osd component makes this component fairly obsolete or a least exchangeable\nfunction Image(props) {\n  //TODO comment when ready to build a conditional based on prop to allow switch between using static image or OSDInstance\n    // let newCoords = \"\"\n    // if (props.coords){\n    //   const coordsSplitArray = props.coords.split(\",\")\n    //   //const x = parseInt(coordsSplitArray[0]) - 20\n    //   const x = parseInt(coordsSplitArray[0])\n    //   const y = coordsSplitArray[1]\n    //   //const w = parseInt(coordsSplitArray[2]) + 40\n    //   const w = parseInt(coordsSplitArray[2])\n    //   const h = coordsSplitArray[3]\n    //   newCoords = x + \",\" + y + \",\" + w + \",\" + h\n    // }\n    //const imageLink = props.imageUrl + \"/\" + newCoords + \"/\" + props.displayWidth + \",/0/default.jpg\"\n  return (\n      //<img alt=\"manuscript\" src={imageLink}/>\n      <OSDInstance imageurl={props.imageUrl} coords={props.coords} displayWidth={props.displayWidth} lineFocusCoords={props.lineFocusCoords}/>\n  );\n}\n\nImage.propTypes = {\n  /**\n  * the Url for the image resource\n  **/\n  imageUrl: PropTypes.string.isRequired,\n  /**\n  * width of the image to be displayed\n  *\n  * TODO: might be better to make this a number/integer and not required;\n  * when not preset perhaps it should just default to the widths listed in the coords\n  **/\n  displayWidth: PropTypes.string.isRequired,\n  /**\n  * string in the form of \"x,y,w,h\"\n  *\n  **/\n  coords: PropTypes.string.isRequired\n}\nexport default Image;\n","import React from 'react';\n\nfunction LineText(props) {\n  return (\n    <div className=\"text\" style={{\"whiteSpace\": \"nowrap\"}}>\n    {props.number && <span>{props.label.split(\"(\")[0]}/</span>}     \n    {props.number && <span>{props.number}</span>}\n    <span dangerouslySetInnerHTML={{__html: props.text}} />\n    </div>\n  );\n}\n\nexport default LineText;\n","// Note this component is a near duplicate of Image Text Wrapper in Paleographinator\n// TODO: This shoud be the target for a refactored independent React Component\n\nimport React, { Component } from 'react';\nimport Image from './Image';\nimport LineText from './LineText';\n\nclass ImageTextWrapper extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      searchText: \"\"\n    }\n  }\n  render() {\n    // const getClass = () => {\n    //   if (this.props.targetLabel === this.props.label){\n    //     return \"ImageTextWrapper target\"\n    //   }\n    //   else {\n    //     return \"ImageTextWrapper\"\n    //   }\n    // }\n    return (\n      <div className={this.props.targetLabel === this.props.label ? \"ImageTextWrapper target\" : \"ImageTextWrapper\"}>\n        <div className=\"labelImageWrapper\">\n        <Image\n          imageUrl={this.props.imageUrl}\n          canvas={this.props.canvas}\n          coords={this.props.coords}\n          canvasShort={this.props.canvasShort}\n          displayWidth={this.props.displayWidth}\n          lineFocusCoords={this.props.lineFocusCoords}\n          />\n        </div>\n        <LineText text={this.props.text} number={this.props.number} label={this.props.label}/>\n      </div>\n    );\n  }\n}\n\nexport default ImageTextWrapper;\n","import React, {useState, useEffect} from 'react';\nimport PropTypes from 'prop-types';\nimport Axios from 'axios'\n\nconst ImageLogo = (props) => {\n  const [logoUrl, setLogoUrl] = useState(\"\")\n  useEffect(() => {\n    // conditional set in order prevent ajax request if props.imagurl does not exist\n    if (props.imageurl){\n      Axios.get(props.imageurl + \"/info.json\").then((d) => {\n        const logo = d.data.logo[\"@id\"]\n        setLogoUrl(logo)\n      }).catch((error) => {\n        console.log(\"no logo found\", error)\n        setLogoUrl(\"\")\n      })\n    }\n  }, [props.imageurl])\n  return (\n    <>{logoUrl && <img src={logoUrl} style={{margin: props.margin, height: props.height}} alt=\"imagelogo\"/>}</>\n  )\n}\n\nImageLogo.defaultProps = {\n  height: \"20px\",\n  margin: \"5px\"\n};\n\nImageLogo.propTypes = {\n  /**\n  * imageurl (without iiif parameters) for which logo will be requested\n  **/\n  imageurl: PropTypes.string.isRequired,\n  margin: PropTypes.string,\n  height: PropTypes.string\n\n}\nexport default ImageLogo;\n","//note; each query here represents an attempt an efficient single request for related information\n//each query therefore could be tranformed into a restful api\n\n//NOTE: this query does not work as expected when using Fuseking version 3 it only works as expected using version 2.0\n// with version 3, it seems to get all quotes from the entire corpus, suggested something may not be working with the \"bind\" method\n export function getRelatedExpressions(itemExpressionUri){\n   const query = [\n    \"SELECT DISTINCT ?isRelatedTo ?label ?element ?longTitle ?author ?authorTitle \",\n    \"WHERE\",\n    \"{ \",\n    \"BIND (<\" + itemExpressionUri + \"> as ?resource)\",\n      \"{\",\n        \"?resource ?o ?isRelatedTo .\",\n        \"?o a <http://scta.info/resource/textRelation> .\",\n        \"FILTER (?o != <http://scta.info/property/quotes>)\",\n        \"FILTER (?o != <http://scta.info/property/quotedBy>)\", \n        \"FILTER (?o != <http://scta.info/property/references>)\", \n        \"FILTER (?o != <http://scta.info/property/referencedBy>)\", \n        \"?o <http://www.w3.org/1999/02/22-rdf-syntax-ns#label> ?label . \",\n        \"?isRelatedTo a <http://scta.info/resource/expression> .\",\n      \"}\",\n      \"UNION\",\n      \"{\",\n        \"{\",\n          \"?resource <http://scta.info/property/structureType> <http://scta.info/resource/structureElement> .\",\n          \"BIND (?resource as ?element)\",\n        \"}\",\n        \"UNION\",\n        \"{\",\n          \"?element <http://scta.info/property/isMemberOf> ?resource .\",\n        \"}\",\n        \"{\",\n          \"?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .\",\n          \"?element <http://scta.info/property/source> ?isRelatedTo .\",\n          \"BIND ('quotes' as ?label) .\",\n        \"}\",\n        \"UNION\",\n        \"{\",\n          \"?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementRef> .\",\n          \"?element <http://scta.info/property/source> ?isRelatedTo .\",\n          \"BIND ('refs' as ?label) .\",\n        \"}\",\n      \"}\",\n      \"UNION\", \n      \"{\",\n        \"{\",\n          \"BIND (?resource as ?element)\",\n        \"}\",\n        \"UNION\",\n        \"{\",\n          \"?element <http://scta.info/property/isMemberOf> ?resource .\",\n        \"}\",\n        \"{\",\n          \"?isRelatedTo <http://scta.info/property/source> ?element.\",\n          \"?isRelatedTo <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .\",\n          \"BIND ('isQuotedBy' as ?label) .\",\n        \"}\",\n        \"UNION\",\n        \"{\",\n          \"?isRelatedTo <http://scta.info/property/source> ?element.\",\n          \"?isRelatedTo <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementRef> .\",\n          \"BIND ('isReferencedBy' as ?label) .\",\n        \"}\",\n      \"}\",\n      \"?isRelatedTo <http://scta.info/property/longTitle> ?longTitle .\",\n      \"?isRelatedTo <http://scta.info/property/isMemberOf> ?mem .\",\n      \"?mem <http://scta.info/property/level> '1' .\",\n      \"OPTIONAL\",\n      \"{\",\n        \"?mem <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n        \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle\",\n      \"}\",\n    \"}\",\n    \"ORDER BY ?authorTitle\"\n   ].join('');\n     return query\n }\n//get Related Expressions\n// export function getRelatedExpressions(itemExpressionUri){\n//   const query = [\n//     \"SELECT DISTINCT ?isRelatedTo \",\n//     \"WHERE { \",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/isRelatedTo> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/quotes> ?quote .\",\n//     \"?quote a <http://scta.info/resource/quotation> .\",\n//     \"?quote <http://scta.info/property/source> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/quotes> ?quote .\",\n//     \"?quote a <http://scta.info/resource/expression> .\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/quotes> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/quotedBy> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/abbreviates> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/abbreviatedBy> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/references> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/referencedBy> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/copies> ?isRelatedTo .\",\n//     \"}\",\n//     \"UNION\",\n//     \"{\",\n//     \"<\" + itemExpressionUri + \"> <http://scta.info/property/isCopiedBy> ?isRelatedTo .\",\n//     \"}\",\n//     \"}\"\n//   ].join('');\n//\n//     return query\n// }\n\n// query info block, division, or item (possible also collection)\nexport function basicInfoQuery(itemExpressionUri){\n  const query = [\n    \"SELECT DISTINCT ?title ?structureType ?cmanifestation ?cmanifestationTitle ?manifestation ?manifestationTitle ?ctranscription ?manifestationCTranscription ?cdoc ?cxml ?expressionShortId ?longTitle ?topLevelExpression ?next ?previous ?inbox ?author ?authorTitle \",\n    \"WHERE { \",\n    \"<\" + itemExpressionUri + \"> <http://purl.org/dc/elements/1.1/title> ?title .\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/structureType> ?structureType .\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/hasCanonicalManifestation> ?cmanifestation .\",\n    \"?cmanifestation <http://purl.org/dc/elements/1.1/title> ?cmanifestationTitle .\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/hasManifestation> ?manifestation .\",\n    \"?manifestation <http://purl.org/dc/elements/1.1/title> ?manifestationTitle .\",\n    \"OPTIONAL {\",\n    \"?manifestation <http://scta.info/property/hasCanonicalTranscription> ?manifestationCTranscription .\",\n    \"?cmanifestation <http://scta.info/property/hasCanonicalTranscription> ?ctranscription .\",\n    \"?ctranscription <http://scta.info/property/hasDocument> ?cdoc . \",\n    \"?ctranscription <http://scta.info/property/hasXML> ?cxml . \",\n    \"}\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/shortId> ?expressionShortId .\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/isPartOfTopLevelExpression> ?topLevelExpression .\",\n    \"OPTIONAL {\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/longTitle> ?longTitle .\",\n    \"}\",\n    \"OPTIONAL {\",\n    \"?topLevelExpression <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n    \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n    \"}\",\n    \"OPTIONAL {\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/next> ?next .\",\n    \"}\",\n    \"OPTIONAL {\",\n    \"<\" + itemExpressionUri + \"> <http://scta.info/property/previous> ?previous .\",\n    \"}\",\n    \"<\" + itemExpressionUri + \"> <http://www.w3.org/ns/ldp#inbox> ?inbox . \",\n    \"}\",\n    \"ORDER BY ?title\"].join('');\n\n    return query\n  }\n\n  export function itemTranscriptionInfoQuery(itemTranscriptionUri){\n    const query = [\n      \"SELECT DISTINCT ?title ?manifestation ?doc ?xml ?expression ?expressionShortId ?longTitle ?topLevelExpression ?next ?previous ?inbox ?t \",\n      \"WHERE { \",\n      \"BIND(<\" + itemTranscriptionUri + \"> as ?t) . \",\n      \"?t <http://purl.org/dc/elements/1.1/title> ?title .\",\n      \"?t <http://scta.info/property/isTranscriptionOf> ?manifestation .\",\n      \"?t <http://scta.info/property/hasDocument> ?doc . \",\n      \"?t <http://scta.info/property/hasXML> ?xml . \",\n      \"?manifestation <http://scta.info/property/isManifestationOf> ?expression .\",\n      \"?expression <http://purl.org/dc/elements/1.1/title> ?expressionTitle .\",\n      \"?expression <http://scta.info/property/shortId> ?expressionShortId .\",\n      \"?expression <http://scta.info/property/longTitle> ?longTitle .\",\n      \"?expression <http://scta.info/property/isPartOfTopLevelExpression> ?topLevelExpression .\",\n      \"OPTIONAL {\",\n      \"?expression <http://scta.info/property/next> ?next .\",\n      \"}\",\n      \"OPTIONAL {\",\n      \"?expression <http://scta.info/property/previous> ?previous .\",\n      \"}\",\n      \"?expression <http://www.w3.org/ns/ldp#inbox> ?inbox . \",\n      \"}\",\n      \"ORDER BY ?expressionTitle\"].join('');\n\n      return query\n    }\n  // gets all structure items with basic item information\n  export function basicStructureAllItemsInfoQuery(topLevelExpressionUrl){\n    const query = [\n      \"SELECT DISTINCT ?item ?itemTitle ?topLevel ?itemQuestionTitle ?cm ?cmTitle ?ct ?next ?previous ?itemType ?doc \",\n      \"WHERE { \",\n      \"<\" + topLevelExpressionUrl + \"> <http://scta.info/property/hasStructureItem> ?item .\",\n      \"?item <http://scta.info/property/isPartOfTopLevelExpression> ?topLevel .\",\n      \"?item <http://purl.org/dc/elements/1.1/title> ?itemTitle .\",\n      \"?item <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?itemType . \",\n      \"OPTIONAL {\",\n      \"?item <http://scta.info/property/questionTitle> ?itemQuestionTitle .\",\n      \"}\",\n      \"OPTIONAL\",\n      \"{\",\n      \"?item <http://scta.info/property/next> ?next .\",\n      \"}\",\n      \"OPTIONAL\",\n      \"{\",\n      \"?item <http://scta.info/property/previous> ?previous .\",\n      \"}\",\n      \"?item <http://scta.info/property/hasCanonicalManifestation> ?cm .\",\n      \"?item <http://scta.info/property/totalOrderNumber> ?totalOrderNumber .\",\n      \"?cm <http://purl.org/dc/elements/1.1/title> ?cmTitle .\",\n      \"?cm <http://scta.info/property/hasCanonicalTranscription> ?ct .\",\n      \"?ct <http://scta.info/property/hasDocument> ?doc .\",\n      \"}\",\n      \"ORDER BY ?totalOrderNumber\"].join('');\n      return query\n    }\n    // gets all parts\n    export function partsInfoQuery(resourceurl){\n      const query = [\n        \"SELECT DISTINCT ?title ?description ?part ?partTitle ?partQuestionTitle ?partType ?partLevel \",\n        \"WHERE { \",\n        \"<\" + resourceurl + \"> <http://purl.org/dc/elements/1.1/title> ?title .\",\n        \"<\" + resourceurl + \"> <http://purl.org/dc/elements/1.1/description> ?description .\",\n        \"<\" + resourceurl + \"> <http://purl.org/dc/terms/hasPart> ?part .\",\n        \"?part <http://purl.org/dc/elements/1.1/title> ?partTitle .\",\n        \"?part <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?partType . \",\n        \"OPTIONAL {\",\n        \"?part <http://scta.info/property/questionTitle> ?partQuestionTitle .\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?part <http://scta.info/property/level> ?partLevel .\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?part <http://scta.info/property/totalOrderNumber> ?totalOrderNumber .\",\n        \"}\",\n        \"}\",\n        \"ORDER BY ?totalOrderNumber\"].join('');\n        return query\n      }\n    // gets all expressions for work Group\n    export function workGroupExpressionQuery(resourceurl){\n      const query = [\n        \"SELECT DISTINCT ?item ?itemTitle ?itemAuthor ?itemAuthorTitle ?itemType \",\n        \"WHERE { \",\n        \"<\" + resourceurl + \"> <http://scta.info/property/hasExpression> ?item .\",\n        \"?item <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?itemType . \",\n        \"?item <http://purl.org/dc/elements/1.1/title> ?itemTitle .\",\n        \"?item <http://www.loc.gov/loc.terms/relators/AUT> ?itemAuthor .\",\n        \"?itemAuthor <http://purl.org/dc/elements/1.1/title> ?itemAuthorTitle .\",\n        \"}\",\n        \"ORDER BY ?itemAuthorTitle\"].join('');\n        return query\n      }\n\n  export function getItemTranscription(resourceurl){\n    const query = [\n      \"SELECT DISTINCT ?ctranscription \",\n      \"WHERE { \",\n        \"{\",\n          \"<\" + resourceurl + \"> <http://scta.info/property/hasCanonicalManifestation> ?cmanifestation . \",\n          \"?cmanifestation <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . \",\n        \"}\",\n        \"UNION\",\n        \"{\",\n          \"<\" + resourceurl + \"> <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . \",\n        \"}\",\n      \"}\"].join('');\n      return query\n  }\n  export function getArticleTranscriptionDoc(resourceurl){\n    const query = [\n      \"SELECT DISTINCT ?doc ?articleType \",\n      \"WHERE { \",\n        \"<\" + resourceurl + \"> <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . \",\n        \"<\" + resourceurl + \"> <http://scta.info/property/articleType> ?articleType .\",\n        \"?ctranscription <http://scta.info/property/hasXML> ?doc . \",\n      \"}\"].join('');\n      return query\n  }\n  export function getItemTranscriptionFromBlockDiv(resourceurl){\n    const query = [\n      \"SELECT DISTINCT ?ctranscription ?blockDivExpression \",\n      \"WHERE { \",\n        \"OPTIONAL\",\n        \"{\",\n          //\"<\" + resourceurl + \"> <http://scta.info/property/isPartOfStructureItem> ?itemParent . \",\n          //\"<\" + resourceurl + \"> <http://scta.info/property/isMemberOf> ?itemParent . \",\n          \"{\",\n            \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfStructureItem> ?itemParent . \",\n          \"}\",\n          \"UNION\",\n          \"{\",\n            \"<\" + resourceurl + \">  <http://scta.info/property/isPartOfStructureBlock> ?blockParent .\",\n            \"?blockParent <http://scta.info/property/isPartOfStructureItem> ?itemParent . \",\n          \"}\",\n\n        \"?itemParent <http://scta.info/property/structureType> <http://scta.info/resource/structureItem> . \",\n        \"{\",\n          \"{\",\n            \"?itemParent <http://scta.info/property/hasCanonicalManifestation> ?cmanifestation . \",\n            \"?cmanifestation <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . \",\n          \"}\",\n          \"UNION\",\n          \"{\",\n            \"?itemParent <http://scta.info/property/hasCanonicalTranscription> ?ctranscription . \",\n          \"}\",\n        \"}\",\n        \"}\",\n        \"OPTIONAL\",\n        \"{\",\n        \"{\",\n          \"{\",\n            \"<\" + resourceurl + \"> <http://scta.info/property/isManifestationOf> ?blockDivExpression . \",\n          \"}\",\n          \"UNION\",\n          \"{\",\n            \"<\" + resourceurl + \"> <http://scta.info/property/isTranscriptionOf> ?blockDivManifestation . \",\n            \"?blockDivManifestation <http://scta.info/property/isManifestationOf> ?blockDivExpression . \",\n          \"}\",\n        \"}\",\n        \"}\",\n      \"}\"].join('');\n      return query\n  }\n  //TODO rename to getType\n  export function getStructureType(resourceurl){\n    const query = [\n      \"SELECT DISTINCT ?type ?structureType ?level ?topLevel ?itemParent ?resourceTitle ?author ?authorTitle \",\n      \"WHERE { \",\n      \"<\" + resourceurl + \"> <http://www.w3.org/1999/02/22-rdf-syntax-ns#type> ?type . \",\n      \"OPTIONAL {\",\n        \"<\" + resourceurl + \"> <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n        \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n      \"}\",\n      \"OPTIONAL {\",\n        \"<\" + resourceurl + \"> <http://purl.org/dc/elements/1.1/title> ?resourceTitle .\",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/structureType> ?structureType . \",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/level> ?level . \",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfTopLevelExpression> ?topLevel . \",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfTopLevelManifestation> ?topLevel . \",\n      \"}\",\n      \"OPTIONAL {\",\n      \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfTopLevelTransription> ?topLevel . \",\n      \"}\",\n        \"OPTIONAL {\",\n          \"{\",\n          \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfStructureItem> ?itemParent . \",\n          \"}\",\n        \"UNION\",\n          \"{\",\n          \"<\" + resourceurl + \"> <http://scta.info/property/isPartOfStructureBlock> ?blockParent . \",\n          \"?blockParent  <http://scta.info/property/isPartOfStructureItem> ?itemParent .\",\n          \"}\",\n        \"}\",\n      \"}\"].join('');\n      return query\n    }\n  //surface id query, gets canvas and manifestation\n  export function getSurfaceInfo(surfaceid){\n    const query = [\n      \"SELECT DISTINCT ?surfaceTitle ?isurface ?isurfaceTitle ?icodexTitle ?canvas ?imageurl ?next_surface ?previous_surface \",\n        \"{\",\n  \t\t\t\t\"<\" + surfaceid + \"> <http://purl.org/dc/elements/1.1/title> ?surfaceTitle .\",\n  \t\t\t\t\"<\" + surfaceid + \"> <http://scta.info/property/hasISurface> ?isurface .\",\n  \t\t\t\t\"OPTIONAL {\",\n  \t\t\t\t\t\"<\" + surfaceid + \"> <http://scta.info/property/next> ?next_surface .\",\n  \t\t\t\t\"}\",\n  \t\t\t\t\"OPTIONAL {\",\n  \t\t\t\t\t\"<\" + surfaceid + \"> <http://scta.info/property/previous> ?previous_surface .\",\n          \"}\",\n  \t\t\t\t\"OPTIONAL {\",\n  \t\t\t\t\t\"?isurface <http://purl.org/dc/elements/1.1/title> ?isurfaceTitle .\",\n  \t\t\t\t\t\"?isurface <http://purl.org/dc/elements/1.1/isPartOf> ?icodex .\",\n  \t\t\t\t\t\"?icodex <http://purl.org/dc/elements/1.1/title> ?icodexTitle .\",\n  \t\t\t\t\"}\",\n  \t\t\t\t\"?isurface <http://scta.info/property/hasCanvas> ?canvas .\",\n  \t\t\t\t\"OPTIONAL{\",\n  \t\t\t\t\t\"?canvas <http://iiif.io/api/presentation/2#hasImageAnnotations> ?blank .\",\n  \t\t\t\t\"}\",\n  \t\t\t\t\"OPTIONAL{\",\n  \t\t\t\t\"?canvas <http://www.w3.org/2003/12/exif/ns#height> ?c_height .\",\n          \"}\",\n  \t\t     \"?blank <http://www.w3.org/1999/02/22-rdf-syntax-ns#first> ?o .\",\n  \t\t     \"?o <http://www.w3.org/ns/oa#hasBody> ?o2 .\",\n  \t\t    \"OPTIONAL{\",\n  \t\t\t\t\t \"?o2 <http://rdfs.org/sioc/services#has_service> ?imageurl .\",\n  \t\t\t\t \"}\",\n  \t\t\t\t \"OPTIONAL{\",\n  \t\t\t\t\t \"?o2 <http://www.shared-canvas.org/ns/hasRelatedService> ?imageurl .\",\n  \t\t\t\t \"}\",\n        \"}\"].join('');\n\n      return query\n    }\n\n//surface id query, gets canvas and manifestation\nexport function getAuthorInformation(authorid){\n    const query = [\n      \"CONSTRUCT\",\n      \"{\",\n      \"?author  <http://purl.org/dc/elements/1.1/title> ?authorTitle ;\",\n      \"<http://scta.info/resource/hasTopLevelExpression> ?expression ;\",\n      \"<http://scta.info/property/authorArticle> ?authorArticle;\",\n      \"<http://scta.info/property/textArticle> ?textArticle .\",\n    \t\"?authorArticle <http://purl.org/dc/elements/1.1/title> ?authorArticleTitle . \",\n      \"?textArticle <http://purl.org/dc/elements/1.1/title> ?textArticleTitle . \",\n    \t\"?expression <http://purl.org/dc/elements/1.1/title> ?topLevelExpressionTitle .\",\n      \"}\",\n      \"WHERE \",\n      \"{\",\n      \"BIND(<\" + authorid + \"> as ?author) . \",\n      \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n      \"OPTIONAL\",\n      \"{\",\n      \"?expression <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n      \"?expression a <http://scta.info/resource/expression> .\",\n      \"?expression <http://scta.info/property/level> '1' .\",\n      \"?expression <http://purl.org/dc/elements/1.1/title> ?topLevelExpressionTitle .\",\n      \"}\",\n      \"OPTIONAL\",\n      \"{\",\n      \"?expression2 <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n      \"?textArticle <http://scta.info/property/isArticleOf> ?expression2 .\",\n      \"?textArticle <http://purl.org/dc/elements/1.1/title> ?textArticleTitle .\",\n      \"}\",\n      \"OPTIONAL\",\n      \"{\",\n      \"?authorArticle <http://scta.info/property/isArticleOf> ?author .\",\n      \"?authorArticle <http://purl.org/dc/elements/1.1/title> ?authorArticleTitle\",\n      \"}\",\n      \"}\"].join('');\n      return query\n      }\n\n  export function versionHistoryInfo(transcriptionUri){\n     \t \tconst query = [\n     \t \t\t\"SELECT ?version ?version_shortId ?order_number ?version_label ?review ?doc\",\n     \t    \"{\",\n            \"{\",\n               \"BIND(<\" + transcriptionUri + \"> as ?version) . \",\n     \t         \"?version <http://scta.info/property/shortId> ?version_shortId .\",\n               \"?version <http://scta.info/property/hasDocument> ?doc . \",\n     \t         \"?version <http://scta.info/property/versionOrderNumber> ?order_number .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/versionLabel> ?version_label .\",\n     \t\t\t\t\t \"OPTIONAL {\",\n     \t\t\t\t\t \t\"?version <http://scta.info/property/hasReview> ?review .\",\n     \t\t\t\t   \"}\",\n     \t\t\t\t \"}\",\n     \t       \"UNION\",\n            \"{\",\n     \t         \"<\" + transcriptionUri + \"> <http://scta.info/property/hasAncestor> ?version .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/shortId> ?version_shortId .\",\n               \"?version <http://scta.info/property/hasDocument> ?doc . \",\n     \t         \"?version <http://scta.info/property/versionOrderNumber> ?order_number .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/versionLabel> ?version_label .\",\n     \t\t\t\t\t \"OPTIONAL {\",\n     \t\t\t\t\t \t\"?version <http://scta.info/property/hasReview> ?review .\",\n     \t\t\t\t   \"}\",\n     \t\t\t\t \"}\",\n     \t       \"UNION\",\n     \t       \"{\",\n     \t         \"<\" + transcriptionUri + \"> <http://scta.info/property/hasDescendant> ?version .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/shortId> ?version_shortId .\",\n               \"?version <http://scta.info/property/hasDocument> ?doc . \",\n     \t         \"?version <http://scta.info/property/versionOrderNumber> ?order_number .\",\n     \t\t\t\t\t \"?version <http://scta.info/property/versionLabel> ?version_label .\",\n     \t\t\t\t\t \"OPTIONAL {\",\n     \t\t\t\t\t \t\"?version <http://scta.info/property/hasReview> ?review .\",\n     \t\t\t\t   \"}\",\n     \t\t\t\t \"}\",\n     \t     \"}\",\n     \t     \"ORDER BY DESC(?order_number)\"].join('');\n           return query\n           }\n\n  //gets lines and zone order for\n  export function getBlockLines(manifestationBlockId){\n     const query = [\n       \"SELECT ?first ?last ?order ?surface\",\n       \"{\",\n         \"<\" + manifestationBlockId + \"> <http://scta.info/property/isOnZone> ?zone . \",\n         \"?zone <http://scta.info/property/isOnZone> ?zone2 .\",\n         \"?zone2 <http://scta.info/property/firstLine> ?first .\",\n         \"?zone2 <http://scta.info/property/lastLine> ?last .\",\n         \"?zone2 <http://scta.info/property/isPartOfSurface> ?surface .\",\n         \"?zone <http://scta.info/property/isOnZoneOrder> ?order .\",\n       \"}\"].join('');\n       return query\n     }\n\n   //gets lines and zone order for\n   export function getChildParts(resourceid){\n      const query = [\n        \"SELECT ?part ?title ?level ?order ?structureType ?questionTitle ?author ?authorTitle ?isPartOf ?isPartOfTitle \",\n        \"{\",\n          \"<\" + resourceid + \"> <http://purl.org/dc/terms/hasPart> ?part . \",\n          \"?part <http://purl.org/dc/elements/1.1/title> ?title .\",\n          \"OPTIONAL {\",\n            \"?isPartOf <http://purl.org/dc/terms/hasPart> <\" + resourceid + \"> .\",\n            \"?isPartOf <http://purl.org/dc/elements/1.1/title> ?isPartOfTitle .\",\n          \"}\",\n          \"OPTIONAL {\",\n            \"?part <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n            \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n          \"}\",\n          \"OPTIONAL\",\n          \"{\",\n          \"?part <http://scta.info/property/level> ?level .\",\n          \"}\",\n          \"OPTIONAL\",\n          \"{\",\n          \"?part <http://scta.info/property/structureType> ?structureType .\",\n          \"}\",\n          \"OPTIONAL\",\n          \"{\",\n          \"?part <http://scta.info/property/sectionOrderNumber> ?order .\",\n          \"}\",\n          \"OPTIONAL\",\n          \"{\",\n          \"?part <http://scta.info/property/questionTitle> ?questionTitle .\",\n          \"}\",\n        \"}\",\n        \"ORDER BY ?order\"].join('');\n        return query\n      }\n      //gets lines and zone order for\n    export function getMembersOf(resourceid){\n       const query = [\n         \"SELECT ?memberOf\",\n         \"{\",\n           \"<\" + resourceid + \"> <http://scta.info/property/isMemberOf> ?memberOf . \",\n         \"}\"].join('');\n         return query\n       }\n\n    export function getManifestationCitationInfo(transcriptionid){\n       var query = [\n       \"SELECT DISTINCT ?manifestation ?manifestationTitle ?manifestationSurface ?surfaceTitle ?codexTitle ?datasource ?eLongTitle ?author ?authorTitle ?expression ?editor ?editorTitle\",\n       \"{\",\n       \"<\" + transcriptionid + \"> <http://scta.info/property/isTranscriptionOf> ?manifestation .\",\n       \"<\" + transcriptionid + \"> <http://scta.info/property/hasDocument> ?datasource . \",\n       \"?manifestation <http://purl.org/dc/elements/1.1/title> ?manifestationTitle .\",\n       \"?manifestation <http://scta.info/property/isPartOfTopLevelManifestation> ?topLevelManifestation .\",\n       \"OPTIONAL {\",\n         \"?topLevelManifestation <http://scta.info/property/editor> ?editor .\",\n         \"?editor <http://purl.org/dc/elements/1.1/title> ?editorTitle .\",\n       \"}\",\n       \"?manifestation <http://scta.info/property/isManifestationOf> ?expression .\",\n       \"?expression <http://scta.info/property/isPartOfTopLevelExpression> ?topLevelExpression .\",\n       \"OPTIONAL {\",\n        \"?expression <http://scta.info/property/longTitle> ?eLongTitle\",\n      \"}\",\n       \"OPTIONAL {\",\n         \"?topLevelExpression <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n         \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n       \"}\",\n       \"OPTIONAL\",\n         \"{\",\n         \"?manifestation <http://scta.info/property/isOnSurface> ?manifestationSurface .\",\n         \"?manifestationSurface <http://purl.org/dc/elements/1.1/title> ?surfaceTitle .\",\n         \"?surface <http://scta.info/property/order> ?surface_order .\",\n         \"?codex <http://scta.info/property/hasSurface> ?manifestationSurface .\",\n         \"?codex <http://purl.org/dc/elements/1.1/title> ?codexTitle .\",\n         \"}\",\n       \"}\",\n       \"ORDER BY ?surface_order\"].join('');\n       return query\n     }\n\n    export function getCodices(){\n     const query = [\n       \"SELECT ?codex ?codex_title\",\n \t     \"{\",\n\t\t\t\t \"?codex a <http://scta.info/resource/codex> .\",\n\t\t\t\t \"?codex <http://purl.org/dc/elements/1.1/title> ?codex_title\",\n\t\t\t\t\"}\",\n\t\t\t \"ORDER BY ?codex_title\"].join('')\n       return query\n     }\n     export function getCodexInfo(codexid){\n      const query = [\n        \"SELECT DISTINCT ?codex ?expression ?codex_title ?item_expression_title ?item_expression_question_title ?surface ?surface_title ?surface_order ?manifestation ?manifestation_short_id ?status \",\n        \"{\",\n          \"BIND(<\" + codexid + \"> as ?codex) . \",\n          \"?codex <http://purl.org/dc/elements/1.1/title> ?codex_title .\",\n          \"OPTIONAL {\",\n          \"?icodex <http://scta.info/property/isCodexItemOf> ?codex .\",\n          \"?isurface <http://purl.org/dc/elements/1.1/isPartOf> ?icodex .\",\n          \"?surface <http://scta.info/property/hasISurface> ?isurface .\",\n          \"?surface <http://scta.info/property/order> ?surface_order .\",\n          \"?surface <http://purl.org/dc/elements/1.1/title> ?surface_title .\",\n          \"?manifestation <http://scta.info/property/isOnSurface> ?surface .\",\n          \"?manifestation <http://scta.info/property/structureType> <http://scta.info/resource/structureItem> .\",\n          \"?manifestation <http://scta.info/property/shortId> ?manifestation_short_id .\",\n          \"?manifestation <http://scta.info/property/isManifestationOf> ?expression .\",\n          \"?expression <http://purl.org/dc/elements/1.1/title> ?item_expression_title .\",\n          \"?expression <http://scta.info/property/status> ?status .\",\n          \"OPTIONAL {\",\n             \"?expression <http://scta.info/property/questionTitle> ?item_expression_question_title .\",\n           \"}\",\n         \"}\",\n        \"}\",\n        \"ORDER BY ?surface_order\"].join('')\n     return query\n   }\n   export function getCodexInfoFromManifest(manifestid){\n    const query = [\n      \"SELECT DISTINCT ?codex ?expression ?codex_title ?item_expression_title ?item_expression_question_title ?surface ?surface_title ?surface_order ?manifestation ?manifestation_short_id ?status \",\n      \"{\",\n        \"?icodex <http://scta.info/property/hasOfficialManifest> <\" + manifestid + \"> .\",\n        \"?codex <http://scta.info/property/hasCodexItem> ?icodex .\",\n        \"?codex <http://purl.org/dc/elements/1.1/title> ?codex_title .\",\n        \"OPTIONAL {\",\n        \"?icodex <http://scta.info/property/isCodexItemOf> ?codex .\",\n        \"?isurface <http://purl.org/dc/elements/1.1/isPartOf> ?icodex .\",\n        \"?surface <http://scta.info/property/hasISurface> ?isurface .\",\n        \"?surface <http://scta.info/property/order> ?surface_order .\",\n        \"?surface <http://purl.org/dc/elements/1.1/title> ?surface_title .\",\n        \"?manifestation <http://scta.info/property/isOnSurface> ?surface .\",\n        \"?manifestation <http://scta.info/property/structureType> <http://scta.info/resource/structureItem> .\",\n        \"?manifestation <http://scta.info/property/shortId> ?manifestation_short_id .\",\n        \"?manifestation <http://scta.info/property/isManifestationOf> ?expression .\",\n        \"?expression <http://purl.org/dc/elements/1.1/title> ?item_expression_title .\",\n        \"?expression <http://scta.info/property/status> ?status .\",\n        \"OPTIONAL {\",\n           \"?expression <http://scta.info/property/questionTitle> ?item_expression_question_title .\",\n         \"}\",\n       \"}\",\n      \"}\",\n      \"ORDER BY ?surface_order\"].join('')\n      return query\n    }\n\n     export function getCodexInfoFromSurface(surfaceid){\n      const query = [\n        \"SELECT DISTINCT ?codex ?expression ?codex_title ?item_expression_title ?item_expression_question_title ?surface ?surface_title ?surface_order ?manifestation ?manifestation_short_id ?status \",\n        \"{\",\n          \"?codex <http://scta.info/property/hasSurface> <\" + surfaceid + \"> .\",\n          \"?codex <http://purl.org/dc/elements/1.1/title> ?codex_title .\",\n          \"OPTIONAL {\",\n          \"?icodex <http://scta.info/property/isCodexItemOf> ?codex .\",\n          \"?isurface <http://purl.org/dc/elements/1.1/isPartOf> ?icodex .\",\n          \"?surface <http://scta.info/property/hasISurface> ?isurface .\",\n          \"?surface <http://scta.info/property/order> ?surface_order .\",\n          \"?surface <http://purl.org/dc/elements/1.1/title> ?surface_title .\",\n          \"?manifestation <http://scta.info/property/isOnSurface> ?surface .\",\n          \"?manifestation <http://scta.info/property/structureType> <http://scta.info/resource/structureItem> .\",\n          \"?manifestation <http://scta.info/property/shortId> ?manifestation_short_id .\",\n          \"?manifestation <http://scta.info/property/isManifestationOf> ?expression .\",\n          \"?expression <http://purl.org/dc/elements/1.1/title> ?item_expression_title .\",\n          \"?expression <http://scta.info/property/status> ?status .\",\n          \"OPTIONAL {\",\n             \"?expression <http://scta.info/property/questionTitle> ?item_expression_question_title .\",\n           \"}\",\n         \"}\",\n        \"}\",\n        \"ORDER BY ?surface_order\"].join('')\n     return query\n   }\n\n   export function getCodexInfoFromCanvas(canvasid){\n    const query = [\n      \"SELECT DISTINCT ?codex ?surfaceFocus ?expression ?codex_title ?item_expression_title ?item_expression_question_title ?surface ?surface_title ?surface_order ?manifestation ?manifestation_short_id ?status \",\n      \"{\",\n        \"?isurfaceFocus <http://scta.info/property/hasCanvas> <\" + canvasid + \"> .\",\n        \"?surfaceFocus <http://scta.info/property/hasISurface> ?isurfaceFocus .\",\n        \"?codex <http://scta.info/property/hasSurface> ?surfaceFocus .\",\n        \"?codex <http://purl.org/dc/elements/1.1/title> ?codex_title .\",\n        \"OPTIONAL {\",\n        \"?icodex <http://scta.info/property/isCodexItemOf> ?codex .\",\n        \"?isurface <http://purl.org/dc/elements/1.1/isPartOf> ?icodex .\",\n        \"?surface <http://scta.info/property/hasISurface> ?isurface .\",\n        \"?surface <http://scta.info/property/order> ?surface_order .\",\n        \"?surface <http://purl.org/dc/elements/1.1/title> ?surface_title .\",\n        \"?manifestation <http://scta.info/property/isOnSurface> ?surface .\",\n        \"?manifestation <http://scta.info/property/structureType> <http://scta.info/resource/structureItem> .\",\n        \"?manifestation <http://scta.info/property/shortId> ?manifestation_short_id .\",\n        \"?manifestation <http://scta.info/property/isManifestationOf> ?expression .\",\n        \"?expression <http://purl.org/dc/elements/1.1/title> ?item_expression_title .\",\n        \"?expression <http://scta.info/property/status> ?status .\",\n        \"OPTIONAL {\",\n           \"?expression <http://scta.info/property/questionTitle> ?item_expression_question_title .\",\n         \"}\",\n       \"}\",\n      \"}\",\n      \"ORDER BY ?surface_order\"].join('')\n      return query\n    }\n\n   export function getSearchExpressionList(filters){\n     //filters should be an ojbect\n     let authorFilter = \"\"\n     if (filters.authorId){\n       authorFilter = \"BIND(<\" + filters.authorId + \"> as ?author) . \"\n     }\n     const query = [\n       \"SELECT DISTINCT ?expressionid ?expressionTitle ?author ?authorTitle \",\n       \"{\",\n         authorFilter,\n         \"?author a <http://scta.info/resource/person> .\",\n         \"?expressionid <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n         \"?expressionid a <http://scta.info/resource/expression> .\",\n         \"?expressionid <http://scta.info/property/level> '1' .\",\n         \"?expressionid <http://purl.org/dc/elements/1.1/title> ?expressionTitle .\",\n         \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n       \"}\",\n       \"ORDER BY ?authorTitle\"].join('')\n    return query\n   }\n   export function getSearchAuthorList(filters){\n     //filters should be an ojbect\n     const query = [\n       \"SELECT DISTINCT ?author ?authorTitle \",\n       \"{\",\n          \"?author a <http://scta.info/resource/person> .\",\n          \"?expressionid <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n          \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n\n       \"}\",\n       \"ORDER BY ?authorTitle\"].join('')\n    return query\n   }\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport Axios from 'axios'\nimport Button from 'react-bootstrap/Button';\n\nimport ImageTextWrapper from './ImageTextWrapper';\nimport ImageLogo from './ImageLogo';\nimport OSDInstance from './OSDInstance';\n\nimport {runQuery} from './utils'\nimport {getSurfaceInfo} from './Queries'\n\n\n\nclass Surface2 extends React.Component {\n  constructor(props){\n    super(props)\n    this.mount = false\n    this.handleNext = this.handleNext.bind(this)\n    this.handlePrevious = this.handlePrevious.bind(this)\n    this.handleLineFocusNext = this.handleLineFocusNext.bind(this)\n    this.handleLineFocusPrev = this.handleLineFocusPrev.bind(this)\n    this.isLineNumberLast = this.isLineNumberLast.bind(this)\n    this.isLineNumberFirst = this.isLineNumberFirst.bind(this)\n    this.handleToggleTextLines = this.handleToggleTextLines.bind(this)\n    this.handleToggleAllLines = this.handleToggleAllLines.bind(this)\n    this.state = {\n      currentSurfaceId: \"\",\n      manifest: \"\",\n      canvas: \"\",\n      region: \"full\",\n      width: \"1000\",\n      next: \"\",\n      previous: \"\",\n      imageurl: \"\",\n      annotationsDisplay: true,\n      showAllLines: false\n    }\n\n  }\n  handleNext(){\n    //this.retrieveSurfaceInfo(this.state.next)\n    this.props.handleSurfaceFocusChange(this.state.next)\n  }\n  handlePrevious(){\n    //this.retrieveSurfaceInfo(this.state.previous)\n    this.props.handleSurfaceFocusChange(this.state.previous)\n\n  }\n  handleToggleTextLines(){\n    //this.retrieveSurfaceInfo(this.state.previous)\n    this.setState((prevState) => {\n      return {annotationsDisplay: !prevState.annotationsDisplay}\n    })\n  }\n  handleToggleAllLines(){\n    this.setState((prevState) => {\n      return {showAllLines: !prevState.showAllLines}\n    })\n  }\n  retrieveSurfaceInfo(surfaceid){\n    // manifest id should be retrieved from query\n    // this is a temporary measure until db is corrected and query is posible\n\n    //const manifest = \"http://scta.info/iiif/\" + this.props.topLevel.split(\"/resource/\")[1] + \"/\" + surfaceid.split(\"/resource/\")[1].split(\"/\")[0] + \"/manifest\";\n    const manifest = \"\";\n    const surfaceInfo = runQuery(getSurfaceInfo(surfaceid))\n    surfaceInfo.then((d) => {\n      const b = d.data.results.bindings[0]\n      // only preceed if sparql query returns results\n      if (b){\n        //second nested async call for annotation list\n        const alUrl = \"https://exist.scta.info/exist/apps/scta-app/folio-annotaiton-list-from-simpleXmlCoordinates.xq?surfaceid=\" + surfaceid.split(\"/resource/\")[1] + \"&coords=loose\"\n        Axios.get(alUrl).then((d2) => {\n          if (this.mount){\n              this.setState({\n                currentSurfaceId: surfaceid,\n                surfaceTitle: b.surfaceTitle.value,\n                manifest: manifest,\n                canvas: b.canvas.value,\n                imageurl: b.imageurl.value,\n                next: b.next_surface ? b.next_surface.value : \"\",\n                previous: b.previous_surface ? b.previous_surface.value : \"\",\n                annotations: d2.data ? d2.data.resources : \"\"\n            })\n          }\n        }).catch((error) => {\n          console.log(\"failed retrieving annotationlist: \", error)\n          if (this.mount){\n            this.setState({\n            currentSurfaceId: surfaceid,\n            surfaceTitle: b.surfaceTitle.value,\n            manifest: manifest,\n            canvas: b.canvas.value,\n            imageurl: b.imageurl.value,\n            next: b.next_surface ? b.next_surface.value : \"\",\n            previous: b.previous_surface ? b.previous_surface.value : \"\",\n            annotations: \"\"\n          })\n        }\n      })\n    }\n  })\n}\n// next for functions are used to compute next and previous Lines\n// this is a little bit hacky, since there are no resources for lines yet.\n// thus the line id is computed by breaking the line id apart,\n// using the line number to compute the next and the reassembling the line RDF id.\n// this will become unnecessary if/when each lines become and RDF resource and contains a next previous property\nhandleLineFocusNext() {\n  const currentLineNumber = parseInt(this.props.lineFocusId.split(\"/\")[this.props.lineFocusId.split(\"/\").length - 1])\n  const newLineArray = this.props.lineFocusId.split(\"/\")\n  newLineArray.pop()\n  newLineArray.push((currentLineNumber + 1).toString())\n  this.props.handleLineFocusChange(newLineArray.join(\"/\"))\n}\nhandleLineFocusPrev(){\n  const currentLineNumber = parseInt(this.props.lineFocusId.split(\"/\")[this.props.lineFocusId.split(\"/\").length - 1])\n  const previousLineArray = this.props.lineFocusId.split(\"/\")\n  previousLineArray.pop()\n  previousLineArray.push((currentLineNumber - 1).toString())\n  this.props.handleLineFocusChange(previousLineArray.join(\"/\"))\n}\nisLineNumberFirst(){\n  const lineNumber = parseInt(this.props.lineFocusId.split(\"/\")[this.props.lineFocusId.split(\"/\").length - 1])\n\n  if (lineNumber === 1){\n    return true\n  }\n  else {\n    return false\n  }\n}\nisLineNumberLast(){\n  const total = this.state.annotations ? this.state.annotations.length : \"\"\n  const lineNumber = parseInt(this.props.lineFocusId.split(\"/\")[this.props.lineFocusId.split(\"/\").length - 1])\n  if (lineNumber === total){\n    return true\n  }\n  else{\n    return false\n  }\n}\ncomponentDidMount(){\n  this.mount = true\n    if (this.props.surfaceid){\n      this.retrieveSurfaceInfo(this.props.surfaceid)\n    }\n    this.setState({annotationsDisplay: this.props.annotationsDisplay})\n  }\n  componentDidUpdate(prevProps){\n    if (this.props.surfaceid !== prevProps.surfaceid){\n    this.retrieveSurfaceInfo(this.props.surfaceid)\n    }\n  }\n  componentWillUnmount(){\n    this.mount = false\n  }\n\n  render() {\n    const displayImages = () => {\n      if (this.state.annotations && this.state.annotationsDisplay){\n        const imageTextWrappers = this.state.annotations.map((h, i) => {\n          const text = h.resource.chars;\n          const canvas = h.on.split(\"#xywh=\")[0];\n          const canvasShort = canvas.split(\"/\")[canvas.split(\"/\").length - 1];\n          const coords = h.on.split(\"#xywh=\")[1];\n          const imageUrl = h.imageUrl\n          const label = h.label\n          if (this.state.showAllLines || (parseInt(this.props.lineFocusId.split(\"/\")[this.props.lineFocusId.split(\"/\").length - 1]) === (i + 1) ) || !this.props.lineFocusId){\n          return (\n            <ImageTextWrapper key={i}\n              imageUrl={imageUrl}\n              canvas={canvas}\n              coords={coords}\n              canvasShort={canvasShort}\n              text={text}\n              label={label}\n              number={i + 1}\n              targetLabel={this.props.targetLabel}\n              surfaceButton={false}\n              displayWidth={this.props.width ? this.props.width : this.state.width}\n              />\n            )\n          }\n          else{\n            return null\n          }\n\n        })\n        return imageTextWrappers\n      }\n      else{\n        //TODO uncommnent when ready to make a switch between using OSD or Image\n        //const width = this.props.width ? this.props.width : this.state.width\n        //return <img alt=\"manuscript\" src={this.state.imageurl + \"/\" + this.state.region + \"/\" + width + \",/0/default.jpg\"}/>\n        return <OSDInstance imageurl={this.state.imageurl}/>\n      }\n    }\n    return (\n      <Container className={this.props.hidden ? \"hidden\" : \"showing\"}>\n      {this.state.currentSurfaceId ?\n        <div>\n          <div className=\"surface-navigation\">\n            <p>{this.state.surfaceTitle}</p>\n            {(this.props.handleSurfaceFocusChange) &&\n              <div>\n              {this.state.previous && <Button size=\"sm\" onClick={this.handlePrevious}>Previous Page</Button>}\n              {this.state.next && <Button size=\"sm\" onClick={this.handleNext}>Next Page</Button>}\n              </div>\n            }\n            {(this.props.handleLineFocusChange && !this.state.showAllLines) &&\n              <div>\n              {!this.isLineNumberFirst() && <Button size=\"sm\" onClick={this.handleLineFocusPrev}>Previous Line</Button>}\n              {!this.isLineNumberLast() && <Button size=\"sm\" onClick={this.handleLineFocusNext}>Next Line</Button>}\n              </div>\n            }\n            <div>\n\n            {this.props.lineFocusId && <Button size=\"sm\" onClick={this.handleToggleAllLines}>Toggle All/Focus Lines</Button>}\n            {(this.state.annotations) && <Button size=\"sm\" onClick={this.handleToggleTextLines}>Toggle Show Text Lines</Button>}\n            </div>\n            <ImageLogo imageurl={this.state.imageurl}/>\n          </div>\n          {displayImages()}\n        </div> : <p>No surface selected</p>}\n      </Container>\n\n    );\n  }\n\n}\nSurface2.defaultProps = {\n  annotationsDisplay: true\n};\nexport default Surface2;\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport PropTypes from 'prop-types';\nimport Axios from 'axios'\n\nimport ImageLogo from './ImageLogo';\nimport ImageTextWrapper from './ImageTextWrapper';\n\nimport {runQuery} from './utils'\nimport {getSurfaceInfo, getBlockLines} from './Queries'\n\nclass Surface3 extends React.Component {\n  constructor(props){\n    super(props)\n    this.mounted = \"\"\n    this.handleNext = this.handleNext.bind(this)\n    this.handlePrevious = this.handlePrevious.bind(this)\n    this.state = {\n      region: \"full\",\n      surfaces: [\n      ]\n    }\n\n  }\n  handleNext(){\n    //this.retrieveSurfaceInfo(this.state.next)\n    this.props.handleSurfaceFocusChange(this.state.next)\n  }\n  handlePrevious(){\n    //this.retrieveSurfaceInfo(this.state.previous)\n    this.props.handleSurfaceFocusChange(this.state.previous)\n\n  }\n  retrieveSurfaceInfo(manifestationid){\n    // manifest id should be retrieved from query\n    // this is a temporary measure until db is corrected and query is posible\n    const blockLineInfo = runQuery(getBlockLines(manifestationid))\n    blockLineInfo.then((d1) => {\n      d1.data.results.bindings.forEach((z) => {\n        const surfaceid = z.surface.value\n        const firstLine = z.first.value\n        const lastLine = z.last.value\n        const order = z.order.value\n        //const manifest = \"http://scta.info/iiif/\" + this.props.topLevel.split(\"/resource/\")[1] + \"/\" + surfaceid.split(\"/resource/\")[1].split(\"/\")[0] + \"/\" + \"manifest\";\n        const surfaceInfo = runQuery(getSurfaceInfo(surfaceid))\n        surfaceInfo.then((d) => {\n          const b = d.data.results.bindings[0]\n          // only preceed if sparql query returns results\n          if (b){\n            //second nested async call for annotation list\n            const alUrl = \"https://exist.scta.info/exist/apps/scta-app/folio-annotaiton-list-from-simpleXmlCoordinates.xq?surfaceid=\" + surfaceid.split(\"/resource/\")[1] + \"&coords=loose\"\n            Axios.get(alUrl).then((d2) => {\n              //const resources = d2.data.resources\n              if (this.mounted){\n                this.setState((prevState) => {\n                  const newSurface = {\n                    currentSurfaceId: surfaceid,\n                    surfaceTitle: b.surfaceTitle ? b.surfaceTitle.value : \"\",\n                    //manifest: manifest,\n                    canvas: b.canvas.value,\n                    imageurl: b.imageurl.value,\n                    next: b.next_surface ? b.next_surface.value : \"\",\n                    previous: b.previous_surface ? b.previous_surface.value : \"\",\n                    annotations: d2.data ? d2.data.resources : \"\",\n                    surfaceid: surfaceid,\n                    firstLine: firstLine,\n                    lastLine: lastLine,\n                    order: order\n\n                  }\n                return {\n                  surfaces: [\n                    ...prevState.surfaces,\n                    newSurface\n                    ]\n                  }\n                })\n              }\n            }).catch((error) => {\n              if (this.mounted){\n                this.setState((prevState) => {\n                  const newSurface = {\n                    currentSurfaceId: surfaceid,\n                    surfaceTitle: b.surfaceTitle.value,\n                    //manifest: manifest,\n                    canvas: b.canvas.value,\n                    imageurl: b.imageurl.value,\n                    next: b.next_surface ? b.next_surface.value : \"\",\n                    previous: b.previous_surface ? b.previous_surface.value : \"\",\n                    annotations: \"\",\n                    surfaceid: surfaceid,\n                    firstLine: firstLine,\n                    lastLine: lastLine,\n                    order: order\n\n                  }\n                return {\n                  surfaces: [\n                    ...prevState.surfaces,\n                    newSurface\n                  ]\n                }\n              })\n            }\n          })\n        }\n      })\n    })\n  })\n}\ncomponentDidMount(){\n  this.mounted = true\n    if (this.props.manifestationid){\n      this.setState((prevState) => {\n        return {\n          surfaces: []\n        }\n      },\n      this.retrieveSurfaceInfo(this.props.manifestationid)\n    )\n    }\n  }\n  componentDidUpdate(prevProps){\n    if (this.props.manifestationid !== prevProps.manifestationid){\n      this.setState((prevState) => {\n        return {\n          surfaces: []\n        }\n\n      },\n    this.retrieveSurfaceInfo(this.props.manifestationid))\n    }\n  }\n  componentWillUnmount(){\n    this.mounted = false\n  }\n  render() {\n    const displayAllImages = () => {\n      const sortedSurfaces = this.state.surfaces.sort((a, b) => {\n        if (a.order > b.order) return 1;\n        if (b.order > a.order) return -1;\n        return 0;\n      })\n      const surfacesDisplay = sortedSurfaces.map((surface) => {\n        return displayImages(surface)\n      })\n      return surfacesDisplay\n    }\n    const displayImages = (surface) => {\n      // handle line display\n      if (surface.annotations && this.props.annotationsDisplay === \"lines\"){\n        const imageTextWrappers = surface.annotations.map((h, i) => {\n\n          if (i + 1 >= surface.firstLine && i < surface.lastLine){\n            const text = h.resource.chars;\n            const canvas = h.on.split(\"#xywh=\")[0];\n            const canvasShort = canvas.split(\"/\")[canvas.split(\"/\").length - 1];\n            const coords = h.on.split(\"#xywh=\")[1];\n            const imageUrl = h.imageUrl\n            const label = h.label\n            return (\n              <ImageTextWrapper key={i}\n                imageUrl={imageUrl}\n                canvas={canvas}\n                coords={coords}\n                canvasShort={canvasShort}\n                text={text}\n                label={label}\n                number={i + 1}\n                targetLabel={this.props.targetLabel}\n                surfaceButton={false}\n                displayWidth={this.props.width}\n                />\n              )\n            }\n            else{\n              return null\n            }\n\n        })\n        return imageTextWrappers\n      }\n      // handle paragraph display\n      else if (surface.annotations && this.props.annotationsDisplay === \"paragraph\"){\n        const h = surface.annotations[surface.firstLine - 1]\n        const fl = surface.annotations[surface.firstLine - 1]\n        const flcanvas = fl ? fl.on.split(\"#xywh=\")[0] : \"\"\n        const flcanvasShort = flcanvas.split(\"/\")[flcanvas.split(\"/\").length - 1];\n        const flcoords = fl ? fl.on.split(\"#xywh=\")[1] : \"\"\n        const y = flcoords.split(\",\")[1]\n        const ll = surface.annotations[surface.lastLine - 1]\n        //const llcanvas = ll ? ll.on.split(\"#xywh=\")[0] : \"\"\n        //const llcanvasShort = llcanvas.split(\"/\")[llcanvas.split(\"/\").length - 1];\n        const llcoords = ll ? ll.on.split(\"#xywh=\")[1] : \"\"\n        const lly = llcoords.split(\",\")[1]\n        const llh = llcoords.split(\",\")[3]\n        const llbottom = (parseInt(lly) + parseInt(llh)) - parseInt(y)\n        //x widens the column by 10, but only if the x is greater than 10\n        const x = parseInt(flcoords.split(\",\")[0]) > 10 ? parseInt(flcoords.split(\",\")[0]) - 10 : parseInt(flcoords.split(\",\")[0])\n        const coords = x + \",\" + (parseInt(y)) + \",\" + (parseInt(flcoords.split(\",\")[2]) + 10) + \",\" + (parseInt(llbottom) + 50)\n        const text = \"\"\n        const imageUrl = h ? h.imageUrl : \"\"\n        // check to see if an Image Url has been found.\n        // if not show \"error message\"\n        \n        // get line coordinates for focused line\n        let lineFocusCoords = \"\"\n        if (this.props.lineFocusId){\n          surface.annotations.forEach((h, i) => {\n            if (parseInt(this.props.lineFocusId.split(\"/\")[this.props.lineFocusId.split(\"/\").length - 1]) === (i + 1) ){\n              lineFocusCoords = h.on.split(\"#xywh=\")[1];\n            }\n          })\n        }\n        if (imageUrl){\n\n          return (\n            <ImageTextWrapper\n              key={surface.currentSurfaceId + \"-\" + surface.order}\n              imageUrl={imageUrl}\n              canvas={flcanvas}\n              coords={coords}\n              canvasShort={flcanvasShort}\n              text={text}\n              label={\"\"}\n              targetLabel={\"\"}\n              surfaceButton={false}\n              displayWidth={this.props.width}\n              lineFocusCoords={lineFocusCoords}\n              />\n            )\n          }\n          else {\n            return (<p key={surface.currentSurfaceId + \"-\" + surface.order}>Sorry, this image is not yet ready</p>)\n          }\n        }\n      else{\n        return <img key={surface.currentSurfaceId + \"-\" + surface.order} alt=\"manuscript\" src={surface.imageurl + \"/full/\" + this.props.width + \",/0/default.jpg\"}/>\n      }\n    }\n    return (\n      <Container className={this.props.hidden ? \"hidden\" : \"showing\"}>\n      {displayAllImages()}\n      <ImageLogo imageurl={this.state.surfaces[0] ? this.state.surfaces[0].imageurl : \"\"}/>\n      </Container>\n\n    );\n  }\n\n}\nSurface3.defaultProps = {\n  width: \"501\"\n};\n\nSurface3.propTypes = {\n  /**\n  * a string indicating desired width in pixels for image display\n  *\n  * TODO: it might be desireable to change propType to an integer. I'm not sure.\n  */\n  width: PropTypes.string,\n  /**\n  * manifestation id\n  */\n  manifestationid: PropTypes.string,\n  /**\n  * indicates what kind of display is desired, \"lines, paragraph, surface/null\"\n  */\n  annotationsDisplay: PropTypes.string\n}\n\nexport default Surface3;\n","import React from 'react';\nimport Surface3 from './Surface3';\nimport PropTypes from 'prop-types';\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\nimport { FaList, FaFile, FaParagraph} from 'react-icons/fa';\n\nimport {runQuery} from './utils'\nimport {basicInfoQuery} from './Queries'\n\n//TODO: surface 3 needs to run in a wrapper which allows the user to choose between manifestations.\n//TODO: rdf dbase needs to include first line numbers for paragraphs that start in the middle of al line.\n\nclass Surface3Wrapper extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleChangeManifestation = this.handleChangeManifestation.bind(this)\n    this.handleToggleTextLinesView = this.handleToggleTextLinesView.bind(this)\n    this.handleSetCustomExpressionId = this.handleSetCustomExpressionId.bind(this)\n    this.handleGetCustomManifestations = this.handleGetCustomManifestations.bind(this)\n    this.handleChangeCustomManifestation = this.handleChangeCustomManifestation.bind(this)\n    this.state = {\n      focusedManifestation: \"\",\n      annotationsDisplay: \"lines\",\n      userAddedExpressionId: \"\",\n      userAddedManifestations: [],\n      focusedCustomManifestation: \"\"\n    }\n  }\n  handleChangeCustomManifestation(value){\n    this.setState({focusedCustomManifestation: value})\n  }\n  handleSetCustomExpressionId(value){\n    this.setState({userAddedExpressionId: value})\n  }\n  handleGetCustomManifestations(e){\n    e.preventDefault()\n    const results = runQuery(basicInfoQuery(this.state.userAddedExpressionId))\n    results.then((d) => {\n      const manifestations = d.data.results.bindings.map((b) => {\n        return {\n          manifestation: b.manifestation.value,\n          manifestationTitle: b.manifestationTitle.value,\n          transcription: b.manifestationCTranscription ? b.manifestationCTranscription.value : \"\"\n        }\n      })\n      this.setState({userAddedManifestations: manifestations, focusedCustomManifestation: d.data.results.bindings[0].cmanifestation.value})\n    })\n     \n\n  }\n\n  handleToggleTextLinesView(view){\n    //optional prop to allow parent container to reset default view prop\n    if (this.props.handleToggleTextLinesView){\n      this.props.handleToggleTextLinesView(view)\n    }\n    else{\n      this.setState((prevState) => {\n        return {annotationsDisplay: view}\n      })\n    }\n  }\n  handleChangeManifestation(e){\n    e.preventDefault()\n    //optional prop to allow parent container to reset default view prop\n    if (this.props.handleChangeManifestation){\n      this.props.handleChangeManifestation(e.target.value)\n    }\n    else{\n      this.setState({focusedManifestation: e.target.value})\n    }\n  }\n  componentDidMount(){\n    if (this.props.manifestations){\n      this.setState((prevState) => {\n        return {\n          focusedManifestation: this.props.focusedManifestation,\n          annotationsDisplay: this.props.annotationsDisplay,\n        }\n      })\n    }\n  }\n  // UNSAFE_componentWillReceiveProps(nextProps){\n  //   if (nextProps.focusedManifestation !== this.props.focusedManifestation){\n  //     this.setState((prevState) => {\n  //       return {\n  //         focusedManifestation: nextProps.focusedManifestation,\n  //       }\n  //     })\n  //   }\n  //   if (nextProps.annotationsDisplay !== this.props.annotationsDisplay){\n  //     this.setState((prevState) => {\n  //       return {\n  //         annotationsDisplay: nextProps.annotationsDisplay,\n  //       }\n  //     })\n  //   }\n  // }\n\n  //TODO: is passing of props to state necessary? settingDerivedState is not ideal\n  //thus there should be a good reason for setting a derived state. \n  // the goal here is to allow the component to update the state, but for \n  // the parent component to determine the default state. \n  // unless there is another way to do this, this seems like a sufficient justification for the derived state.\n  componentDidUpdate(prevProps){\n    if (this.props.focusedManifestation !== prevProps.focusedManifestation){\n      this.setState((prevState) => {\n        return {\n          focusedManifestation: this.props.focusedManifestation,\n        }\n      })\n    }\n    if (this.props.annotationsDisplay !== prevProps.annotationsDisplay){\n      this.setState((prevState) => {\n        return {\n          annotationsDisplay: this.props.annotationsDisplay,\n        }\n      })\n    }\n  }\n  render() {\n    const displayManifestationsList = () => {\n      const list = this.props.manifestations.map((m) => {\n        return <option key={\"title-\" + m.manifestation} value={m.manifestation}>{m.manifestationTitle}</option>\n      })\n      return list\n    }\n    const displayManifestation = () => {\n      const manifestation = this.props.manifestations.map((m) => {\n        if (m.manifestation === this.state.focusedManifestation){\n          return <Surface3 key={\"surface-\" + m.manifestation} \n          manifestationid={m.manifestation} \n          annotationsDisplay={this.state.annotationsDisplay} \n          width={this.props.width}\n          lineFocusId={this.props.lineFocusId}/>\n        }\n        else{\n          return null\n        }\n      })\n      return manifestation\n\n    }\n\n    return (\n      <div className={this.props.hidden ? \"hidden\" : \"showing\"}>\n        {!this.props.hideSelectionList &&\n        <div className=\"manifestationsList\">\n          <Form.Control size=\"sm\" as=\"select\" onChange={this.handleChangeManifestation} value={this.state.focusedManifestation}>\n            {displayManifestationsList()}\n          </Form.Control>\n        </div>\n        }\n        <div className=\"surfaceWrapper\">\n          {!this.props.hideDisplayChoice && this.state.focusedManifestation &&\n            <div className=\"image-display-choice\">\n              <p><span title=\"Text Line View\" onClick={() => {this.handleToggleTextLinesView(\"lines\")}}><FaList/></span></p>\n              <p><span title=\"Paragraph View\" onClick={() => {this.handleToggleTextLinesView(\"paragraph\")}}><FaParagraph/></span></p>\n              <p><span title=\"Full Surface View\" onClick={() => {this.handleToggleTextLinesView(\"surface\")}}><FaFile/></span></p>\n            </div>\n          }\n          <div className=\"imagesDisplay\">\n            {displayManifestation()}\n          </div>\n        </div>\n        \n        {\n          this.state.userAddedManifestations.length > 0 && \n          <Surface3Wrapper \n            manifestations={this.state.userAddedManifestations}\n            focusedManifestation={this.state.focusedCustomManifestation}\n            annotationsDisplay={this.state.annotationsDisplay}\n            handleToggleTextLinesView={this.props.handleToggleTextLinesView}\n            handleChangeManifestation={this.handleChangeCustomManifestation}\n            width={this.props.width}\n            lineFocusId={\"\"}\n            hidden={false}\n            isDependentSurface3={true}/>\n        }\n        {!this.props.isDependentSurface3 &&\n        <div style={{\"borderBottom\": \"1px solid rgba(0, 0, 0, 0.1)\", \"borderTop\": \"1px solid rgba(0, 0, 0, 0.1)\", marginTop: \"5px\", padding: \"5px\"}} >\n          <p style={{fontSize: \"12px\"}}>Create custom user compare</p>\n          <Form onSubmit={this.handleGetCustomManifestations} inline> \n            <FormControl inline=\"true\" size=\"sm\" id=\"text\" type=\"text\" value={this.state.userAddedExpressionId} placeholder=\"expression id\" className=\"mr-sm-2\" onChange={(e) => {this.handleSetCustomExpressionId(e.target.value)}}/>\n            <Button inline=\"true\" size=\"sm\"  type=\"submit\" style={{margin: \"2px\"}}>Submit</Button>\n          </Form>\n        </div>\n        }\n\n      </div>\n    );\n  }\n}\n\nSurface3Wrapper.defaultProps = {\n  manifestations: [],\n  hidden: false,\n  focusedManifestation: \"\",\n  annotationsDisplay: \"paragraph\",\n  width: \"500\"\n};\n\nSurface3Wrapper.propTypes = {\n  /**\n  * an array of manifestation ids\n  */\n  manifestations: PropTypes.array,\n  /**\n  * boolean indicating whether or not compoment should be mounted by still hidden\n  */\n  hidden: PropTypes.bool,\n  /**\n  * indicates on which manifestation component to default focus.\n  * manifestation value MUST be included in manifestations array\n  */\n  focusedManifestation: PropTypes.string,\n  /**\n  * indicates what kind of display is desired, \"lines, paragraph, surface/null\"\n  */\n\n  annotationsDisplay: PropTypes.string,\n  /**\n  * optional prop to allow parent container to reset default view prop\n  */\n  handleToggleTextLinesView: PropTypes.func,\n  /**\n  * desired image width\n  */\n  width: PropTypes.string\n}\n\nexport default Surface3Wrapper;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Axios from 'axios'\nimport { Light as SyntaxHighlighter } from 'react-syntax-highlighter';\nimport { docco } from 'react-syntax-highlighter/dist/cjs/styles/hljs';\n/**\n* XML view show component\n**/\nclass XmlView extends React.Component {\n\n  constructor(props){\n    super(props)\n    this.mount = false\n    this.retrieveXML = this.retrieveXML.bind(this)\n    this.state = {\n      xmlstring: \"\"\n    }\n  }\n  retrieveXML(tresourceid){\n    const xmlurl = \"https://exist.scta.info/exist/apps/scta-app/document/\" + tresourceid.split(\"/resource/\")[1]\n    Axios.get(xmlurl).then((d) => {\n      if (this.mount){\n        this.setState({xmlstring: d.data})\n      }\n    })\n\n  }\n  componentDidMount(){\n    this.mount = true\n    //condition to make sure tresourceid is defined before trying to parse and retrieve\n    // though this should never since tresourceid is a required prop\n    if (this.props.tresourceid){\n      this.retrieveXML(this.props.tresourceid)\n    }\n\n  }\n  componentDidUpdate(prevProps){\n    if (this.props.tresourceid !== prevProps.tresourceid){\n      this.retrieveXML(this.props.tresourceid)\n    }\n  }\n  componentWillUnmount(){\n    this.mount = false\n  }\n\n  render(){\n    return (\n      <div className={this.props.hidden ? \"hidden\" : \"showing\"}>\n      <SyntaxHighlighter language=\"xml\" style={docco} showLineNumbers>\n        {this.state.xmlstring}\n      </SyntaxHighlighter>\n      </div>\n    )\n  }\n}\n\nXmlView.propTypes = {\n  /**\n  * transcription resource id of transcription for desired xml view\n  *\n  * TODO: Component is currently splitting the id and constructing the xml based\n  * on a prior knowledge of where xml is; this really should be retrieved from the resource id\n  * but the xml look up should happen outside of the XmlView Component in order to keep this component simple\n  * and making only request directly to the xml file\n  */\n  tresourceid: PropTypes.string.isRequired,\n  /**\n  * hidden designates whether the component should be hidden after mounting\n  */\n  hidden: PropTypes.bool,\n}\nexport default XmlView;\n","import React from 'react';\nimport Nav from 'react-bootstrap/Nav';\n\nimport {FaSearch, FaGripVertical, FaCode, FaInfo, FaRegImage, FaComments, FaRegWindowRestore, FaRegWindowMaximize, FaRegWindowMinimize, FaRegWindowClose, FaClone, FaAlignLeft} from 'react-icons/fa';\n// reimport these if you want to use the chnage window location functions: FaAngleDoubleDown, FaAngleDoubleLeft,\n\nfunction WindowNavBar(props) {\n  return (\n  <Nav variant=\"tabs\">\n  {\n    //<Navbar.Brand href=\"/\">Focus: {props.focus}</Navbar.Brand>\n  }\n  {\n    //props.focusSet && <Nav.Item>\n    //<Nav.Link title=\"Basic Resource Information\" onClick={() => {props.handleTabChange(\"info\", props.windowId)}}><FaInfo/></Nav.Link>\n    //</Nav.Item>\n  }\n  {props.focusSet &&<Nav.Item>\n    <Nav.Link active={props.windowLoad === \"citation\"} title=\"Text Citation\" onClick={() => {props.handleTabChange(\"citation\", props.windowId)}}><FaInfo/></Nav.Link>\n  </Nav.Item>}\n  {props.focusSet && <Nav.Item>\n    <Nav.Link active={props.windowLoad === \"surface3\"} title=\"Images\" onClick={() => {props.handleTabChange(\"surface3\", props.windowId)}}><FaRegImage/></Nav.Link>\n  </Nav.Item>}\n  <Nav.Item>\n    <Nav.Link active={props.windowLoad === \"xml\"} title=\"Text XML Source\" onClick={() => {props.handleTabChange(\"xml\", props.windowId)}}><FaCode/></Nav.Link>\n  </Nav.Item>\n  {props.focusSet && <Nav.Item>\n    <Nav.Link active={props.windowLoad === \"textCompare\"} title=\"Text Comparisons\" onClick={() => {props.handleTabChange(\"textCompare\", props.windowId)}}><FaGripVertical/></Nav.Link>\n  </Nav.Item>}\n  {props.focusSet &&<Nav.Item>\n    <Nav.Link active={props.windowLoad === \"comments\"} title=\"Comments\" onClick={() => {props.handleTabChange(\"comments\", props.windowId)}}><FaComments/></Nav.Link>\n  </Nav.Item>}\n\n  <Nav.Item>\n    <Nav.Link active={props.windowLoad === \"textOutlineWrapper\"} title=\"Text Outline\" onClick={() => {props.handleTabChange(\"textOutlineWrapper\", props.windowId)}}><FaAlignLeft/></Nav.Link>\n  </Nav.Item>\n  <Nav.Item>\n    <Nav.Link active={props.windowLoad === \"search\"} title=\"Text Search\" onClick={() => {props.handleTabChange(\"search\", props.windowId)}}><FaSearch/></Nav.Link>\n  </Nav.Item>\n\n  {props.openWidthHeight !== \"minimum\" &&\n  <Nav.Item>\n    <Nav.Link title=\"Minimize Window\" onClick={() => {props.handleMinimize(props.windowId)}}><FaRegWindowMinimize/></Nav.Link>\n  </Nav.Item>}\n  {props.openWidthHeight !== \"middle\" &&\n  <Nav.Item>\n    <Nav.Link title=\"Half Size Window\" onClick={() => {props.handleMiddlize(props.windowId)}}><FaRegWindowRestore/></Nav.Link>\n  </Nav.Item>\n  }\n  {props.openWidthHeight !== \"maximum\" &&\n  <Nav.Item>\n    <Nav.Link title=\"Maximize Window\" onClick={() => {props.handleMaximize(props.windowId)}}><FaRegWindowMaximize/></Nav.Link>\n  </Nav.Item>\n  }\n  <Nav.Item>\n    <Nav.Link title=\"Close Window\" onClick={() => {props.handleClose(props.windowId)}}><FaRegWindowClose/></Nav.Link>\n  </Nav.Item>\n  {/* commented to prevent window moving; this insures window 1 is always side window and window 2 is bottom window\n    uncomment if this behavior is desired\n    <Nav.Item>\n    <Nav.Link title=\"Move Window\" onClick={() => {props.handleSwitchWindow(props.windowId, props.windowType)}}>{props.windowType === \"sideWindow\" ? <FaAngleDoubleDown/> : <FaAngleDoubleLeft/>}</Nav.Link>\n  </Nav.Item>\n  */\n  }\n  <Nav.Item>\n    {!props.altWindowState && <Nav.Link title=\"Clone Window\" onClick={() => {props.handleDuplicateWindow(props.windowId, props.windowType)}}>{<FaClone/>}</Nav.Link>}\n  </Nav.Item>\n\n\n</Nav>\n\n  );\n}\n\nexport default WindowNavBar;\n","import React from 'react';\n\nimport { FaAngleLeft, FaAngleRight} from 'react-icons/fa';\nimport Nav from 'react-bootstrap/Nav';\n\nfunction NextPrevBar(props) {\n  const displayNextPrevBar = () => {\n    if (props.info){\n      return (\n        <Nav variant=\"tabs\">\n        <Nav.Link onClick={() => {props.handleBlockFocusChange(props.info.resourceid)}}>{props.info.title}</Nav.Link>\n        <Nav.Item>\n          {(props.info.previous && props.info.previous !== \"http://scta.info/resource/\")  && <Nav.Link onClick={() => {props.handleBlockFocusChange(props.info.previous)}}><FaAngleLeft/></Nav.Link>}\n        </Nav.Item>\n        <Nav.Item>\n          {(props.info.next && props.info.next !== \"http://scta.info/resource/\") && <Nav.Link onClick={() => {props.handleBlockFocusChange(props.info.next)}}><FaAngleRight/></Nav.Link>}\n        </Nav.Item>\n\n        </Nav>\n      )\n    }\n    else{\n      return null\n    }\n  }\n  return (\n    displayNextPrevBar()\n  );\n}\n\nexport default NextPrevBar;\n","import React from 'react';\nimport Diff from 'diff-match-patch'\nimport Axios from 'axios'\nimport PropTypes from 'prop-types';\n\nimport Spinner from './Spinner';\nimport {Link} from 'react-router-dom';\nimport { FaEyeSlash, FaEye, FaStar, FaToggleOn, FaToggleOff, FaRegImage} from 'react-icons/fa';\n\nimport Surface3Wrapper from './Surface3Wrapper'\n\nclass TextCompareItem extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleToggleShow = this.handleToggleShow.bind(this)\n    this.handleToggleCompare = this.handleToggleCompare.bind(this)\n    this.mounted = \"\"\n    this.state = {\n      showCompare: false,\n      compareText: \"\",\n      rawText: \"\",\n      show: true,\n      levenshteinDistance: undefined, \n      usedBase: undefined,\n      usedCompareTranscription: undefined\n    }\n  }\n  handleToggleShow(){\n    this.setState((prevState) => {\n      return{\n        show: !prevState.show\n      }\n    })\n  }\n  handleToggleCompare(){\n    this.setState((prevState) => {\n      return{\n        showCompare: !prevState.showCompare\n      }\n    })\n  }\n  textClean(text){\n    const punctuationless = text.replace(/[.,/#!$%^&*;:{}=\\-_`~()]/g,\"\");\n    const finalString = punctuationless.replace(/\\s{2,}/g,\" \");\n    const finalFinalString = finalString.toLowerCase()\n    return finalFinalString\n\n  }\n  createCompare(base, transcription){\n    console.log(\"text compare item async sent for\", transcription)\n    Axios.get(\"https://exist.scta.info/exist/apps/scta-app/csv-pct.xq?resourceid=\" + transcription)\n          .then((text) => {\n            const dmp = new Diff.diff_match_patch();\n            const diff = dmp.diff_main(this.textClean(base), this.textClean(text.data));\n            // Result: [(-1, \"Hell\"), (1, \"G\"), (0, \"o\"), (1, \"odbye\"), (0, \" World.\")]\n            dmp.diff_cleanupSemantic(diff);\n            const levenshteinDistance = dmp.diff_levenshtein(diff)\n            const ds = dmp.diff_prettyHtml(diff);\n            if (this.mounted === true && base){\n              // TODO: setting showCompare to \"derivedState\" is an ANTI-PATTERN. Better would be to let it be entirely controlled by parent. \n              // NOTE: usedBase and usedCompare transcription are used to record data used to make compare \n              // so that componentDidUpdate can efficiently decide if a new comparison is or is not needed\n              this.setState({compareText: ds, rawText: text.data, levenshteinDistance: levenshteinDistance, showCompare: this.props.showCompare, \n                usedBase: this.props.base, usedCompareTranscription: this.props.compareTranscription})\n            }\n            else if(this.mounted){\n              // TODO: setting showCompare to \"derivedState\" is an ANTI-PATTERN. Better would be to let it be entirely controlled by parent.\n              // NOTE: usedBase and usedCompare transcription are used to record data used to make compare \n              // so that componentDidUpdate can efficiently decide if a new comparison is or is not needed\n              this.setState({rawText: text.data, showCompare: this.props.showCompare, \n                usedBase: this.props.base, usedCompareTranscription: this.props.compareTranscription})\n            }\n          }).catch((error) => {\n            console.log(\"text request/comparison error\", error)\n          })\n        }\n\n  componentDidMount(){\n    this.mounted = true;\n    // TODO: setting showCompare to \"derivedState\" is an ANTI-PATTERN. Better would be to let it be entirely controlled by parent.\n    this.setState({rawText: \"\", compareText: \"\", showCompare: this.props.showCompare})  \n    //conditional attempts to restrict async call to only those components who are intended to be visible at mount\n    // NOTE: this conditional will important when scaling. (i.e. when there hundres of references and hundreds of transcriptons)\n    if (this.props.show){\n      this.createCompare(this.props.base, this.props.compareTranscription)\n    }\n  }\n\n  componentDidUpdate(prevProps){\n    // NOTE: conditional attempts to restrict async call to only those components who are intended to be visible \n    // and for whom a previous comparison has not been made or needs to be changed.\n    // need for generation of new comparison is detected by comparing props base and props compare transcription \n    //to base/compare transcription used in previous comparison (or lack there of)\n    // NOTE: this conditional will important when scaling. (i.e. when there are hundreds of references and hundreds of transcriptions)\n    if (this.props.show && \n      (\n        // NOTE: check to see if the current props base/compareTranscription is different than one the last base/compareTranscription when comparison was ran. \n        // If it is different, then re-run compare. If not, don't run because the comparison has already been made.\n        (this.props.base !== this.state.usedBase || this.props.compareTranscription !== this.state.usedCompareTranscription))\n      )\n      {\n        this.createCompare(this.props.base, this.props.compareTranscription)\n      }\n\n  }\n\n\n\n  componentWillUnmount(){\n      this.mounted = false;\n    }\n\n\n  render(){\n    \n\n    const displayImage = () => {\n      const newManifestations = [{\n        manifestation: this.props.manifestation,\n        manifestationTitle: this.props.manifestationTitle,\n        transcription: \"\"\n      }]\n      return (\n            <div>\n              <span onClick={() => {this.setState((prevState)=> {return({showImage: !prevState.showImage})})}}><FaRegImage/></span> \n              {this.state.showImage &&\n                <div>\n                  <Surface3Wrapper\n                  manifestations={newManifestations}\n                  focusedManifestation={this.props.manifestation}\n                  width={this.props.surfaceWidth}\n                  hideSelectionList={true}\n                  isDependentSurface3={true}\n                />\n                </div>\n                }\n            </div>\n      )\n\n    }\n\n    const displayComparison = () => {\n      const isBase = this.props.base === this.state.rawText\n      if (this.state.showCompare && this.props.base && this.state.compareText){\n        const levenNum = this.state.levenshteinDistance\n        const heatColor = levenNum * 5\n        return (\n          <div style={{borderLeft: \"5px solid rgba(\" + heatColor + \", 0, 255, 1)\", paddingLeft: \"5px\"}}>\n            <span><Link to={\"/text?resourceid=\" + this.props.compareTranscription}>{this.props.manifestationTitle}</Link> </span>\n            <span className=\"lbp-span-link\" title=\"show/hide\" onClick={() => this.handleToggleShow()}>{this.state.show ? <FaEyeSlash/> : <FaEye/>}</span>\n            <span className=\"lbp-span-link\" title=\"toggle comparison off\" onClick={() => this.handleToggleCompare()}><FaToggleOn/></span>\n            {!isBase && <span className=\"lbp-span-link\" title=\"set as base\" onClick={() => this.props.handleChangeBase(this.state.rawText)}><FaStar/></span>}\n            <span style={{fontSize: \"14px\", paddingLeft: \"4px\"}} title=\"levenshtein distance\">{levenNum}</span>\n            <div className={this.state.show ? \"unhidden\" : \"hidden\"}>\n              <div ref=\"text\" dangerouslySetInnerHTML={{ __html: this.state.compareText}}></div>\n              {displayImage()}\n\n            </div>\n          </div>\n        )\n      }\n      else if (this.state.rawText){\n        \n        return (\n          <div>\n            <span><Link to={\"/text?resourceid=\" + this.props.compareTranscription}>{this.props.manifestationTitle}</Link></span> |\n            <span className=\"lbp-span-link\" title=\"show/hide\" onClick={() => this.handleToggleShow()}>{this.state.show ? <FaEyeSlash/> : <FaEye/>}</span>\n            <span className=\"lbp-span-link\" title=\"toggle comparison on\" onClick={() => this.handleToggleCompare()}><FaToggleOff/></span>\n            {!isBase && <span className=\"lbp-span-link\" title=\"set as base\" onClick={() => this.props.handleChangeBase(this.state.rawText)}><FaStar/></span>}\n\n            <div className={this.state.show ? \"unhidden\" : \"hidden\"}>\n              <div ref=\"text\" dangerouslySetInnerHTML={{ __html: this.state.rawText}}></div>\n              {displayImage()}\n            </div>\n          </div>\n        )\n      }\n      else{\n        return <Spinner/>\n      }\n    }\n\n    return (\n      displayComparison()\n    );\n  }\n}\n\nTextCompareItem.propTypes = {\n  /**\n  * text comparison component\n  **/\n  base: PropTypes.string, // base text to perform comparison against\n  compareTranscription: PropTypes.string, // transcription id of text to be used in comparison against base text\n  handleChangeBase: PropTypes.func, // function to trigger base text change\n  show: PropTypes.bool, // boolean to state whether text should be shown. TODO: currently competing with derivedState \"show\", needs to be resolved\n  showCompare: PropTypes.bool //boolean to state whether should be shown with comparison markup. TODO: currently competing with derivedState \"showCompare\" needs to be resolved\n}\n\nexport default TextCompareItem;\n","import React from 'react';\nimport {Link} from 'react-router-dom';\nimport { FaEyeSlash, FaEye } from 'react-icons/fa';\n\nimport {runQuery} from './utils'\nimport {basicInfoQuery} from './Queries'\nimport TextCompareItem from './TextCompareItem'\n\nclass TextCompare extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleToggleShowAll = this.handleToggleShowAll.bind(this)\n    this.mounted = \"\"\n    this.state = {\n      info: \"\",\n      show: false,\n      baseText: \"\"\n    }\n  }\n\n  handleToggleShowAll(){\n    this.setState((prevState) => {\n      return{\n        show: !prevState.show\n      }\n    })\n  }\n\n  // TODO dupblicate of function in Text Component\n  // needs refactoring\n  arrangeTextInfo(info, resourceid){\n    info.then((d) => {\n      const bindings = d.data.results.bindings[0]\n      const manifestations = d.data.results.bindings.map((b) => {\n        return {\n          manifestation: b.manifestation.value,\n          manifestationTitle: b.manifestationTitle.value,\n          transcription: b.manifestationCTranscription ? b.manifestationCTranscription.value : \"\"\n        }\n      })\n      if (this.mounted === true && bindings){\n        this.setState({\n          info: {\n            resourceid: resourceid,\n            title: bindings.title.value,\n            structureType: bindings.structureType.value,\n            inbox: bindings.inbox.value,\n            next: bindings.next ? bindings.next.value : \"\",\n            previous: bindings.previous ? bindings.previous.value : \"\",\n            cdoc: bindings.cdoc ? bindings.cdoc.value : \"\",\n            cxml: bindings.cxml ? bindings.cxml.value : \"\",\n            topLevel: bindings.topLevelExpression.value,\n            cmanifestation: bindings.cmanifestation ? bindings.cmanifestation.value : \"\",\n            ctranscription: bindings.ctranscription ? bindings.ctranscription.value : \"\",\n            manifestations: manifestations\n          }\n        });\n      }\n    });\n  }\n  getTextInfo(id){\n    const info = runQuery(basicInfoQuery(id))\n    this.arrangeTextInfo(info, id)\n  }\n  componentDidMount(){\n    this.mounted = true;\n    //TODO: setting \"derivative state\" here is an anti-pattern\n    //instead this should probably be controlled by parent \n    //(handleToggleShowAll should probably change parent which would then pass down the required prop rather than setting prop to state)\n    this.setState({show: this.props.show})\n    //NOTE: this conditional, does set prop to state, but there is a reason. \n    // the point is that the information has already been achieved, thus we save one async call by using props. \n    // otherwise an async request is called.\n    // I think the \"derivate state is acceptable in this case\"\n    if (this.props.isMainText){\n      this.setState({info: this.props.info})\n    }\n    else{\n      this.getTextInfo(this.props.expressionid)\n    }\n  }\n  componentDidUpdate(prevProps){\n    // conditional try to restrict new async calls to only when props.info changes\n    if ((this.props.info.resourceid !== prevProps.info.resourceid) || (this.props.info.relatedExpressions !== prevProps.info.relatedExpressions)){\n      if (this.props.isMainText){\n        this.setState({info: this.props.info})\n      }\n      else{\n        this.getTextInfo(this.props.expressionid)\n      }\n    }\n  }\n  componentWillUnmount(){\n    this.mounted = false;\n  }\n  render(){\n    const displayComparisons = () => {\n      if (this.state.info.manifestations){\n        const texts = this.state.info.manifestations.map((m) => {\n          return (\n            <TextCompareItem\n            key={m.transcription}\n            base={this.props.baseText}\n            compareTranscription={m.transcription}\n            manifestationTitle={m.manifestationTitle}\n            manifestation={m.manifestation}\n            handleChangeBase={this.props.handleChangeBase}\n            show={this.state.show}\n            showCompare={this.props.isMainText ? true : false}\n            surfaceWidth={this.props.surfaceWidth}\n            />\n          )\n        })\n        return texts\n      }\n    }\n  return (\n    <div style={{\"borderBottom\": \"1px solid rgba(0, 0, 0, 0.1)\", padding: \"5px\"}}>\n      {\n        // the link to reroute is not quite working, because the base Text is not resetting, focusBlockChange might be better; but item structure will also need to be changed.\n      }\n      \n      <div style={{fontSize: \"12px\"}}>\n        {this.props.isMainText && <span>[Target] </span>}\n        <span>{this.props.relationLabel}</span> \n        {(this.props.referringResource && this.props.referringResource !== this.props.info.resourceid) \n        && <span> (<Link to={\"/text?resourceid=\" + this.props.referringResource}>via</Link>)</span>}\n      </div>\n      <div>\n        {this.state.info.resourceid ?\n        <Link to={\"/text?resourceid=\" + this.state.info.resourceid}>\n          {this.props.authorTitle || this.props.longTitle ? <span> {this.props.authorTitle} {this.props.longTitle}</span> : this.state.info.resourceid}\n        </Link> :\n        this.props.authorTitle || this.props.longTitle ? <span> {this.props.authorTitle} {this.props.longTitle}</span> : this.state.info.resourceid\n        }\n        {this.state.info.resourceid && <span onClick={() => this.handleToggleShowAll()}>{this.state.show ? <FaEyeSlash/> : <FaEye/>}</span>}\n      </div>\n      <div className={this.state.show ? \"unhidden\" : \"hidden\"} style={{\"paddingLeft\": \"10px\"}}>\n        {displayComparisons()}\n      </div>\n    </div>\n    );\n  }\n}\nexport default TextCompare;\n","import React from 'react';\nimport Axios from 'axios'\nimport Container from 'react-bootstrap/Container';\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\nimport TextCompare from './TextCompare'\n\n\nclass TextCompareWrapper extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleToggleCompare = this.handleToggleCompare.bind(this)\n    this.handleChangeBase = this.handleChangeBase.bind(this)\n    this.handleCustomUpdateRelatedExpressions = this.handleCustomUpdateRelatedExpressions.bind(this)\n    this.handleSetCustomExpressionId = this.handleSetCustomExpressionId.bind(this)\n    this.getText = this.getText.bind(this)\n    this.mounted = \"\"\n    this.state = {\n      expressions: {},\n      baseText: \"\",\n      customExpressionId: \"\", \n      customExpressionObject: {}\n    }\n\n  }\n  handleSetCustomExpressionId(customExpressionId){\n    this.setState({customExpressionId: customExpressionId})\n  }\n  handleCustomUpdateRelatedExpressions(e){\n    e.preventDefault()\n    const expressionObject = {\n      resourceid: this.state.customExpressionId,\n      relationLabel: \"user added comparison\"\n    }\n    this.setState({customExpressionObject: expressionObject})\n  }\n  handleChangeBase(rawText){\n    this.setState({baseText: rawText})\n  }\n  //TODO: Doesn't seem to be called; should be deleted\n  handleToggleCompare(expressionid){\n    this.setState((prevState) => {\n      const newExpressions = {...prevState.expressions}\n      newExpressions[expressionid].show = !newExpressions[expressionid].show\n      return {\n        expressions: newExpressions\n      }\n    })\n  }\n  getText(ctranscription){\n    const _this = this;\n    Axios.get(\"https://exist.scta.info/exist/apps/scta-app/csv-pct.xq?resourceid=\" + ctranscription)\n      .then((text) => {\n        if (this.mounted){\n          _this.setState({baseText: text.data})\n        }\n      })\n    }\n\n  componentDidMount(){\n    this.mounted = true\n    // prevents check when prop.info is not set\n    if (this.props.info){\n      // prevents check when prop.info.relatedExpressions is not set\n      if (this.props.info.relatedExpressions){\n        this.getText(this.props.info.ctranscription)\n        //create empty expressions object\n        const expressions = {}\n        // add first object which should be compare item for first/target resource\n        expressions[this.props.info.resourceid] = {\n          id: this.props.info.resourceid, \n          authorTitle: this.props.info.authorTitle, \n          longTitle: this.props.info.longTitle, \n          show: false\n        }\n        this.props.info.relatedExpressions.forEach((r) => {\n          expressions[r.resourceid] = {\n            id: r.resourceid, \n            relationLabel: r.relationLabel, \n            referringResource: r.referringResource, \n            author: r.author,\n            authorTitle: r.authorTitle, \n            longTitle: r.longTitle,\n            show: false}\n        })\n        this.setState({expressions: expressions})\n      }\n    }\n  }\n  componentDidUpdate(prevProps, prevState){\n    // only fire reload if \"info resource\" has changed\"\n    if ((prevProps.info.resourceid !== this.props.info.resourceid) || (prevState.customExpressionObject !== this.state.customExpressionObject)){\n    // this conditional is needed, because props are waiting on multiple async calls.\n    // when an async call finishes it will up; and the related Expression query last,\n    // it will use the old ctranscription prop overriding the the update from the prop update from the other async call\n    // TODO: above message is unclear; but this conditional seems important. Needs better explanation of why it is necessary\n    if (prevProps.info.relatedExpressions){\n      // this conditional may no longer be necessary based on first conditional check\n      if (prevProps.info.ctranscription !== this.props.info.ctranscription){\n        this.getText(this.props.info.ctranscription)\n      }\n      //create empty expressions object\n      const expressions = {}\n      // add first object which should be compare item for first/target resource\n      expressions[this.props.info.resourceid] = {\n        id: this.props.info.resourceid, \n          authorTitle: this.props.info.authorTitle, \n          longTitle: this.props.info.longTitle, \n          show: false,\n      }\n      //combine info.relatedExpressions with customExpression\n      const newRelatedExpressions = this.props.info.relatedExpressions.concat(this.state.customExpressionObject)\n      newRelatedExpressions.forEach((r) => {\n        expressions[r.resourceid] = {\n          id: r.resourceid, \n          relationLabel: r.relationLabel, \n          referringResource: r.referringResource, \n          author: r.author,\n          authorTitle: r.authorTitle, \n          longTitle: r.longTitle,\n          show: false}\n      })\n      this.setState({expressions: expressions})\n    }\n  }\n  }\n  componentWillUnmount(){\n    this.mounted = false\n  }\n\n\n  render(){\n    const displayExpressions = () => {\n      const exObject = this.state.expressions\n      const expressions = Object.keys(exObject).map((key) => {\n        const isMainText = this.props.info.resourceid === exObject[key].id ? true : false\n        return (\n          <div key={this.state.expressions[key].id}>\n            {<TextCompare\n              info={this.props.info}\n              expressionid={exObject[key].id}\n              relationLabel={exObject[key].relationLabel}\n              referringResource={exObject[key].referringResource}\n              author={exObject[key].author}\n              authorTitle={exObject[key].authorTitle}\n              longTitle={exObject[key].longTitle}\n              isMainText={isMainText}\n              handleChangeBase={this.handleChangeBase}\n              baseText={this.state.baseText}\n              show={exObject[key].show}\n              surfaceWidth={this.props.surfaceWidth}\n              />}\n          </div>\n        )\n      })\n      return expressions\n    }\n\n  return (\n    <Container className={this.props.hidden ? \"hidden\" : \"showing\"}>\n    <h4>Text Comparisons</h4>\n    {displayExpressions()}\n    <div style={{\"borderBottom\": \"1px solid rgba(0, 0, 0, 0.1)\", padding: \"5px\"}}>\n      <p style={{fontSize: \"12px\"}}>Create custom user compare</p>\n      <Form onSubmit={this.handleCustomUpdateRelatedExpressions} inline=\"true\" > \n      <FormControl inline=\"true\" size=\"sm\" id=\"text\" type=\"text\" value={this.state.customExpressionId} placeholder=\"expression id\" className=\"mr-sm-2\" onChange={(e) => {this.handleSetCustomExpressionId(e.target.value)}}/>\n      <Button inline=\"true\" size=\"sm\"  type=\"submit\" style={{margin: \"2px\"}}>Submit</Button>\n    </Form>\n   </div>\n\n    <hr/>\n    <div>\n      <p>Other Comparison/Connection Visualizations</p>\n      <p><a target=\"_blank\" rel=\"noopener noreferrer\" href={\"http://lombardpress.org/collation-vizualizer/index.html?id=\" + this.props.info.resourceid}>Collation Overlay</a></p>\n      <p><a target=\"_blank\" rel=\"noopener noreferrer\" href={\"https://scta.github.io/networks-explorer/?resourceid=\" + this.props.info.resourceid}>View Reference Connections</a></p>\n      <p><a target=\"_blank\" rel=\"noopener noreferrer\" href={\"https://scta.github.io/networks-explorer/topicconnections.html?resourceid=\" + this.props.info.resourceid}>View Topic Connections</a></p>\n    </div>\n    </Container>\n\n  );\n  }\n}\n\nexport default TextCompareWrapper;\n","import React, {useState, useEffect} from 'react';\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\nimport {useTranslation} from 'react-i18next'\nimport {FaEdit, FaComment} from 'react-icons/fa';\n\nfunction Comment2Create(props) {\n  const {t} = useTranslation();\n  const [comment, setComment] = useState(props.comment);\n  const [motivation, setMotivation] = useState(props.motivation || \"commenting\") // \"commenting\" vs \"editing\"; default \"commenting\"\n  const editedTextDefault = props.selectionRange && props.selectionRange.text ? props.selectionRange.text : \"\"\n  const [editedText, setEditedText] = useState((props.selectionRange && props.selectionRange.textEdited) ? props.selectionRange.textEdited : editedTextDefault);\n  const [noTarget, setNoTarget] = useState(props.noTarget || false); // if noTarget is set to true, annotation is made without a target\n  const [orderNumber, setOrderNumber] = useState(props.orderNumber);\n  \n  \n  const handleCommentUpdate = (e) => {\n    e.preventDefault()\n    const commentType = motivation;\n    props.submitComment(comment, commentType, editedText, props.selectionRange, orderNumber, noTarget)\n    setComment('')\n  }\n  useEffect(() => {\n    const editedTextDefault = props.selectionRange && props.selectionRange.text ? props.selectionRange.text : \"\"\n    setEditedText((props.selectionRange && props.selectionRange.textEdited) ? props.selectionRange.textEdited : editedTextDefault)\n  }, [props.selectionRange])\n  useEffect(() => {\n    if (motivation === \"commenting\"){\n      setEditedText(props.selectionRange ? props.selectionRange.text : \"\")\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [motivation])\n\n  const wordRange = (props.selectionRange && props.selectionRange.wordRange) ? props.selectionRange.wordRange.start + \"-\" + props.selectionRange.wordRange.end : \"\"\n  return (\n    <Form onSubmit={handleCommentUpdate}>\n      \n      {motivation === \"editing\" && \n      <div>\n        <span>Suggest Edit for : \n          <i>{props.selectionRange.text} </i> \n          <span className=\"lbp-span-link\" title=\"leave simple comment on text\" onClick={()=>{setMotivation(\"commenting\")}}> <FaComment/> </span>\n          <span> ({wordRange}) </span>\n        </span> \n        <FormControl as=\"textarea\" type=\"text\" id=\"editedText\" rows=\"3\" \n        value={editedText} placeholder={t(\"comment\")} className=\"mr-sm-2\" onChange={(e) => {setEditedText(e.target.value)}}/>\n      </div>\n      }\n        <div>\n        {(props.selectionRange && props.selectionRange.text) &&\n        <div>\n        {motivation === \"editing\" ? \n        <span>Leave comment on edit</span> \n        : \n        <span>\n          Comment on: \n          <i>{props.selectionRange.text} </i> \n          <span className=\"lbp-span-link\" title=\"edit text\" onClick={()=>{setMotivation(\"editing\")}}> <FaEdit/> </span>\n          <span> ({wordRange}) </span>\n        </span>\n        }\n        </div>\n        }\n        <FormControl as=\"textarea\" type=\"text\" id=\"comment\" rows=\"3\" value={comment} placeholder={t(\"comment\")} className=\"mr-sm-2\" onChange={(e) => {setComment(e.target.value)}}/>\n        <span>Position: <Form.Text as=\"input\" inline=\"true\" type=\"input\" id=\"orderNumber\" value={orderNumber} className=\"mr-sm-2\" onChange={(e) => {setOrderNumber(e.target.value)}} style={{border: 0, width: \"25px\", display: \"inline\"}}/></span>\n        <span>Has Target: <input type=\"checkbox\" inline=\"true\" label=\"has target\" checked={!noTarget} onChange={(e) => {setNoTarget(!noTarget)}} style={{display: \"inline\"}}/></span>\n      </div>\n      <Button size=\"sm\"  type=\"submit\" block style={{margin: \"2px\"}}>{t(\"Submit\")}</Button>\n   </Form>\n  );\n}\n\nexport default Comment2Create;\n","import React, {useState} from 'react';\nimport {Link} from 'react-router-dom';\nimport {FaTrash, FaEdit, FaClipboard} from 'react-icons/fa';\nimport Comment2Create from './Comment2Create.js'\nimport {useTranslation} from 'react-i18next'\nimport {copyToClipboard} from './utils'\n\nfunction Comment2Item(props) {\n  const {t} = useTranslation();\n  const [editable, setEditable] = useState(false);\n  \n  const submitUpdate = (update, motivation, editedText, selectionRange, orderNumber, noTarget) => {\n    props.updateComment(props.comment.id, update, editedText, motivation, selectionRange, orderNumber, noTarget)\n    setEditable(false)\n  }\n  const addSCTALinksToValue = (value) => {\n    // conversion template source: http://talkerscode.com/webtricks/convert-url-text-into-clickable-html-links-using-javascript.php \n    const link = value.match(/(\\b(https?|ftp|file):\\/\\/[-A-Z0-9+&@#/%?=~_|!:,.;]*[-A-Z0-9+&@#/%=~_|])/ig)\n    if (link){\n      const firstString = value.split(link[0])[0]\n      let strings = [firstString]\n      link.forEach((l, i) => {\n        const linkComponent = <Link key={l} to={\"/res?resourceid=\" + l}>{l}</Link> \n        const linkCopy = <span key={\"s-\" + l} className=\"lbp-span-link\" title=\"Copy Resource Url Clipboard\" onClick={(e) => {e.preventDefault(); copyToClipboard(l)}}><FaClipboard /></span>\n        strings.push(linkComponent)\n        strings.push(linkCopy)\n        const afterString = value.split(l)[1]\n        const prunedString = afterString.split(link[i+1])[0]\n        strings.push(prunedString)\n      })\n      return strings\n    }\n    else{\n      return value\n    }\n  }\n  \n  \n  let target =  typeof(props.comment.target) === 'string' ? props.comment.target : props.comment.target.source;\n  \n\n  let selectedFragment = undefined;\n  let selectedFragmentRange = undefined;\n  if (props.comment.target.selector){\n    selectedFragment = props.comment.target.selector.filter((i) => (i.type === \"TextQuoteSelector\"))[0].exact;\n    selectedFragmentRange = props.comment.target.selector.filter((i) => (i.type === \"TextPositionSelector\"))[0];\n    //selectedCharacterRange = props.comment.target.selector.filter((i) => (i.type === \"TextPositionSelector\"))[0];\n    target = selectedFragmentRange.start ? target + \"@\" + selectedFragmentRange.start + \"-\" + selectedFragmentRange.end : target;\n\n  }\n  \n  const selectionRange = {\n    text: selectedFragment, \n    textEdited: props.comment.body.editedValue,\n    wordRange: selectedFragmentRange\n  }\n  \n  return (\n      <div>\n        {/* {!props.focused && <p>{t(\"For\")}: <Link to={\"/text?resourceid=\" + target}>{target}</Link></p>} */}\n        {/* <span className=\"lbp-span-link\" onClick={() => props.handleOnClickComment(target.split(\"/resource/\")[1], selectedFragment, props.comment.body.editedValue, selectedFragmentRange, selectedCharacterRange)}>{target} {selectedFragmentRange && <span> ({selectedFragmentRange.start}-{selectedFragmentRange.end})</span>}</span> */}\n        \n        <p><span>{props.orderNumber}</span>: {t(\"For\")}: <Link to={\"/text?resourceid=\" + target}>{target}</Link></p>\n        {\n          editable ?\n          <Comment2Create submitComment={submitUpdate} \n          comment={props.comment.body.value} \n          selectionRange={selectionRange} \n          motivation={props.comment.motivation}\n          noTarget={props.comment.target ? false : true}\n          orderNumber={props.orderNumber}\n          /> :\n          <p>\n          {\n          //<span dangerouslySetInnerHTML={{ __html: addSCTALinksToValue(props.comment.body.value)}}/>\n          }\n          {selectedFragment && <span>Comment on: <i>{selectedFragment}</i></span>}\n          <br/>\n          {props.comment.motivation === \"editing\" && <span>Suggested Correction: {props.comment.body.editedValue}<br/></span>}\n          \n          <span>{addSCTALinksToValue(props.comment.body.value)}</span>\n          <br/>\n          <span>Submitted: </span> {props.comment.created && props.comment.created.split(\"T\")[0]} | \n          <span className=\"lbp-span-link\" onClick={() => {props.removeComment(props.comment.id)}}><FaTrash/> </span> | \n          <span className=\"lbp-span-link\" onClick={() => setEditable(true)}> <FaEdit/></span>\n          </p>\n        }\n        <hr/>\n      </div>\n    );\n}\n\nexport default Comment2Item;\n","import React, {useState} from 'react'\nimport Axios from 'axios'\nimport {FaDownload, FaCloudDownloadAlt, FaUpload, FaPlusCircle} from 'react-icons/fa';\n\nconst ImportExport = (props) =>{\n  const [newListName, setNewListName] = useState('');\n  const [newListUrl, setNewListUrl] = useState('');\n  const [showImport, setShowImport] = useState(false);\n\n  const handleFileImport = (e) => {\n    var reader = new FileReader();\n\n    reader.readAsText(e.target.files[0]);\n    const fileName = e.target.files[0].name\n    // define callback function; aka actions to be peerformed after file is read\n    reader.onload = function(e) {\n      var list = reader.result;\n      \n      props.handleImportList(JSON.parse(list), fileName)\n    }\n\n\n  }\n  const handleUrlImport = (e) => {\n    e.preventDefault()\n    Axios.get(newListUrl).then((d) => {\n      console.log(\"data\", d)\n      props.handleImportList(d.data, newListUrl)\n    })\n\n\n  }\n  const createNewList = (e) => {\n    e.preventDefault();\n    //NOTE: first argument needs to be string that will be parsed in the parent component, in this case to an array\n    props.handleImportList([], newListName)\n    setNewListName('')\n  }\n  const packageData = () =>\n   {\n    const data = JSON.stringify(props.currentList, null, 2);\n    const dataLink = \"data:application/json;charset=utf-8,\" + encodeURI(data)\n    return dataLink\n  }\n  const downloadTitle = () =>\n   {\n    const title = props.currentListName.split('.json')[0] + \"-\" + new Date().toISOString().slice(0, 10)\n    return title\n  }\n  return (\n    <div>\n      <span className=\"lbp-span-link\" onClick={() => setShowImport(!showImport)}>Import <FaUpload/></span> \n      {showImport &&\n        <div>\n          <span className=\"lbp-span-link\"><FaUpload/> Load from local file</span> \n          <br/>\n          <input type=\"file\" id=\"files\" name=\"files[]\" onChange={handleFileImport}/>\n          <br/>\n          <span className=\"lbp-span-link\"><FaCloudDownloadAlt/> Load from Cloud</span>\n          <form onSubmit={handleUrlImport}><input type=\"text\" value={newListUrl} onChange={(e) => {setNewListUrl(e.target.value)}}></input><input type=\"submit\"/></form>\n          \n          <span className=\"lbp-span-link\"><FaPlusCircle/> Create New List</span> \n          <form onSubmit={createNewList}><input type=\"text\" value={newListName} onChange={(e) => {setNewListName(e.target.value)}}></input><input type=\"submit\"/></form>\n        </div>\n      }\n      <br/> \n      <a href={packageData()} download={downloadTitle()}><span className=\"lbp-span-link\">Export <FaDownload/></span></a>\n      \n    </div>\n  );\n}\n\nexport default ImportExport","import React, {useState, useEffect} from 'react';\nimport {Link} from 'react-router-dom';\nimport Container from 'react-bootstrap/Container';\nimport FormControl from 'react-bootstrap/FormControl';\nimport PropTypes from 'prop-types';\nimport Comment2Create from './Comment2Create.js'\nimport Comment2Item from './Comment2Item.js'\nimport Comments2ImportExport from './Comments2ImportExport'\nimport uuidv4 from 'uuid/v4';\nimport Button from 'react-bootstrap/Button';\nimport {FaClipboard, FaFilter} from 'react-icons/fa';\nimport {useTranslation} from 'react-i18next'\nimport {copyToClipboard} from './utils'\n\n\n/**\n * \n * A comment wrapper for submitting comments to local storage\n * \n */\n\nfunction Comments2(props) {\n  const {t} = useTranslation();\n  const [lists, setLists] = useState(JSON.parse(localStorage.getItem(\"sctaCommentsState2\"))|| {\"local\": []})\n  const [comments, setComments] = useState(\"local\");\n  const [showFocusComments, setShowFocusComments] = useState(true)\n  const [commentFilter, setCommentFilter] = useState(\"\")\n  const [mentionedBy, setMentionedBy] = useState([])\n  const [showFilters, setShowFilters] = useState(false)\n  \n  \n  \n\n  /**\n   * submit the comment\n   * \n   * @param {string} comment \n   * @public\n   */\n  const submitComment = (comment, motivation, editedText, selectionRange, orderNumber, noTarget) => {\n    const randomid = uuidv4();\n    const annoId = \"http://inbox.scta.info/notifications/\" + randomid\n    const dateObject = new Date();\n\n    const selector = [\n      {\n        \"type\": \"TextQuoteSelector\",\n        \"exact\": selectionRange.text\n      },\n      {\n        \"type\": \"TextPositionSelector\",\n        \"start\": selectionRange.wordRange && selectionRange.wordRange.start,\n        \"end\": selectionRange.wordRange && selectionRange.wordRange.end\n      }\n    ]\n    const annotation = {\n      \"@context\": \"http://www.w3.org/ns/anno.jsonld\",\n      \"id\": annoId,\n      \"type\": \"Annotation\",\n      \"created\": dateObject.toISOString(),\n      \"motivation\": motivation,\n      \"body\": {\n        \"type\": \"TextualBody\",\n        \"value\": comment\n      },\n      \"target\": !noTarget && { // changing target to object rather than string will break retrieval\n        source: props.resourceid, \n        selector: selector\n      }\n      \n    }\n    // conditionally add editedValue only if motivation is editing\n    if (motivation === \"editing\"){\n      annotation.body.editedValue = editedText;\n    }\n    else {\n      delete annotation.body[\"editedValue\"];\n    }\n    //lists[comments].push(annotation) \n    lists[comments].splice(orderNumber, 0, annotation);\n    setLists({\n      ...lists,\n    })\n    setCommentFilter('')\n  }\n  const removeComment = (id) => {\n    //filter current list\n    const newLists = lists[comments].filter((c) => (c.id !== id))\n    // replace current list value with filtered list\n    lists[comments] = newLists\n      setLists({\n        ...lists\n      })\n  }\n  const updateComment = (id, update, editedText, motivation, selectionRange, orderNumber, noTarget) => {\n    const targetComment = lists[comments].filter((c) => (c.id === id))[0]\n    targetComment.body.value = update\n    targetComment.body.editedValue = editedText\n    targetComment.motivation = motivation\n    targetComment.orderNumber = orderNumber\n    targetComment.target = noTarget ? false : targetComment.target\n    const old_index = lists[comments].indexOf(targetComment);\n    \n    //reposition comment\n    //see https://stackoverflow.com/questions/5306680/move-an-array-element-from-one-array-position-to-another\n    //todo: this could/should be a utility function\n    if (orderNumber >= lists[comments].length) {\n      var k = orderNumber - lists[comments].length + 1;\n      while (k--) {\n        lists[comments].push(undefined);\n      }\n    }\n    \n    lists[comments].splice(orderNumber, 0, lists[comments].splice(old_index, 1)[0]);\n\n    setLists({\n      ...lists\n    })\n  }\n  useEffect(() => {\n    setMentionedBy(getMentionedBy())\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [props.resourceid])\n  \n  const getMentionedBy = () => {\n    if (lists[comments].length > 0){\n      let mentionedBy = lists[comments].map((c) => {\n        if (c.body.value && c.body.value.includes(props.resourceid)){\n          const target =  typeof(c.target) === 'string' ? c.target : c.target.source;\n          return target\n        }\n        else{\n          return undefined\n        }\n      })\n      mentionedBy = mentionedBy.filter((i) => {return i !== undefined})\n      return mentionedBy\n    }\n    else{\n      return []\n    }\n  }\n  // expect list to be in already parsed JSON\n  const handleImportList = (list, listname) => {\n    // try to load data from local storage\n    try {\n      const parsedList = list;\n      const name = listname || uuidv4();\n      lists[name] = parsedList\n      setLists({\n        ...lists\n      })\n    }\n    // if import update fails do nothing and proceed with the default state\n    catch (e) {\n      console.log(\"error\", e)\n    }\n  }\n\n  useEffect(() => {\n    localStorage.setItem(\"sctaCommentsState2\", JSON.stringify(lists))\n  })\n  \n  return (\n    <Container className={props.hidden ? \"hidden\" : \"showing\"}>\n      <Comment2Create \n        submitComment={submitComment} \n        selectionRange={props.selectionRange}\n        textEdit={props.textEdit}\n        orderNumber={lists[comments].length}\n        />\n      <Button size=\"sm\" style={{margin: \"2px\"}} block onClick={() => setShowFilters(!showFilters)}><FaFilter/> Filters</Button>\n      { showFilters &&\n      <div>\n        <span>Select Annotation List</span>\n      <FormControl size=\"sm\" as=\"select\" onChange={(e) => {setComments(e.target.value)}} value={comments}>\n                {lists && Object.keys(lists).map((e, i) => {\n                    return (<option key={e} value={e}>{e}</option>)\n                  })\n                }\n      </FormControl>\n      <FormControl size=\"sm\" style={{margin: \"10px 0\"}} type=\"text\" value={commentFilter} placeholder={t(\"filter comments by text\")} className=\"mr-sm-2\" onChange={(e) => {setCommentFilter(e.target.value)}}/>\n      <Button id=\"btnAllCommentsToggle\" size=\"sm\" style={{margin: \"2px\"}} block onClick={() => setShowFocusComments(!showFocusComments)}>{showFocusComments ? t(\"Show All Comments\") : t(\"Show Comments For Focused Passage\") }</Button>\n      </div>\n      }\n      <hr/>\n      {mentionedBy.length > 0 && \n      <div>\n        <span>Discussed By:</span>\n        {mentionedBy.map((m) => {\n            return(\n              <div>\n              <Link key={m} to={\"/res?resourceid=\" + m}>{m}</Link>\n              <span className=\"lbp-span-link\" title=\"Copy Resource Url Clipboard\" onClick={(e) => {e.preventDefault(); copyToClipboard(m)}}><FaClipboard /></span>\n              </div>\n            )\n          })\n          }\n        <hr/>\n      </div>\n      }\n      <div>\n        {lists[comments].length > 0 && lists[comments].slice(0).map((c,i) => {\n          \n          const target = typeof(c.target) === 'string' ? c.target : c.target.source;\n          if (showFocusComments){\n            if (target && target.includes(props.expressionid) && (c.body.value && c.body.value.includes(commentFilter))){\n              return (\n                <div key={i}>\n                  <Comment2Item comment={c} focused={true} removeComment={removeComment} updateComment={updateComment}\n                  handleOnClickComment={props.handleOnClickComment} orderNumber={lists[comments].indexOf(c)}/>\n                  {\n                  //<button onClick={() => {removeNote(n.title)}}>x</button>\n                  }\n                </div>\n              )\n            }\n            else{\n              return null\n            }\n          }\n          else{\n            if (target && target.includes(props.expressionid) && (c.body.value && c.body.value.includes(commentFilter))){\n              return (\n                <div key={i} style={{borderLeft: \"1px solid black\"}}>\n                  <Comment2Item comment={c} removeComment={removeComment} updateComment={updateComment} orderNumber={lists[comments].indexOf(c)}/>\n                  {\n                  //<button onClick={() => {removeNote(n.title)}}>x</button>\n                  }\n                </div>\n                )\n            }\n            else if (c.body.value && c.body.value.includes(commentFilter)){\n              return (\n                <div key={i}>\n                  <Comment2Item comment={c} removeComment={removeComment} updateComment={updateComment} orderNumber={lists[comments].indexOf(c)}/>\n                  {\n                  //<button onClick={() => {removeNote(n.title)}}>x</button>\n                  }\n                </div>\n              )\n            }\n            else{\n              return null\n            }\n          }\n        })}\n      </div>\n      {\n      <Comments2ImportExport currentList={lists[comments]} currentListName={comments} handleImportList={handleImportList} />\n    }\n\n    </Container>\n  );\n}\n\nComments2.propTypes = {\n  /**\n  * \n  * resourceid to serve as target of annotation\n  *\n  */\n  resourceid: PropTypes.string.isRequired,\n\n}\n\nexport default Comments2;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Container from 'react-bootstrap/Container';\nimport Spinner from './Spinner';\nimport { FaClipboard} from 'react-icons/fa';\nimport {runQuery, copyToClipboard} from './utils'\nimport {getManifestationCitationInfo} from './Queries'\n\n/**\n* citation component\n*\n* TODO: it would be better to separate the citation display, manifestation picker, citation explation\n* into three differen compoments wrapped in a citation Wrapper.\n* This way the citation display could be truly independent\n*/\nclass Citation extends React.Component{\n  constructor(props){\n    super(props)\n    this.mounted = \"\"\n    this.state = {\n      eurl: \"\",\n      etitle: \"\",\n      murl: \"\",\n      mtitle: \"\",\n      turl: \"\",\n\n      fetching: false\n    }\n  }\n\n  retrieveCitation(tresourceid){\n    if (tresourceid){\n      this.setState({fetching: true})\n      const manifestationCitationInfo = runQuery(getManifestationCitationInfo(tresourceid))\n      manifestationCitationInfo.then((data) => {\n        const allBindings = data.data.results.bindings\n        if (allBindings.length > 0){\n          const bindings = allBindings[0]\n          const expressionid = bindings.expression ? bindings.expression.value : \"\"\n          const manifestationid = bindings.manifestation ? bindings.manifestation.value : \"\"\n          const eLongTitle = bindings.eLongTitle ? bindings.eLongTitle.value : \"\"\n          const authorTitle = bindings.authorTitle ? bindings.authorTitle.value : \"\"\n          const author = bindings.author ? bindings.author.value : \"\"\n          const editorTitle = bindings.editorTitle ? bindings.editorTitle.value : \"\"\n          const editor = bindings.editor ? bindings.editor.value : \"\"\n          const datasource = bindings.datasource ? bindings.datasource.value : \"\"\n          const title = bindings.codexTitle ? bindings.codexTitle.value : \"\"\n          const start = bindings.surfaceTitle ? bindings.surfaceTitle.value : \"\"\n          const end = allBindings[allBindings.length - 1].surfaceTitle ? allBindings[allBindings.length - 1].surfaceTitle.value : \"\"\n          if (this.mounted){\n            this.setState(\n              {\n                author: author,\n                authorTitle: authorTitle,\n                editor: editor,\n                editorTitle: editorTitle,\n                eurl: expressionid,\n                etitle: eLongTitle,\n                murl: manifestationid,\n                mtitle: start !== end ? title + \", \" + start + \"-\" + end : title + \", \" + start,\n                turl: tresourceid,\n                datasource: datasource,\n                fetching: false\n              }\n            )\n          }\n        }\n      })\n    }\n  }\n  componentDidMount(){\n    this.mounted = true\n    this.retrieveCitation(this.props.tresourceid)\n\n  }\n  \n  componentDidUpdate(prevProps){\n    if (this.props.tresourceid !== prevProps.tresourceid){\n      this.retrieveCitation(this.props.tresourceid)\n    }\n  }\n  componentWillUnmount(){\n    this.mounted = false\n  }\n  render(){\n\n    const fullCitationString = this.state.authorTitle + \", \" + this.state.etitle + \"(\" + this.state.mtitle + \") Data source: \" + this.state.datasource + \".\"\n    const wordRange = this.props.selectionRange.wordRange && \n      this.props.selectionRange.wordRange.start + \"-\" + this.props.selectionRange.wordRange.end;\n    return (\n      <Container>\n      <h4>Citation</h4>\n      {this.state.fetching ?\n        <Spinner/> :\n      <div>\n        <p className=\"etitle\">{this.state.authorTitle}, {this.state.etitle} (<a href={this.state.eurl} target=\"_blank\" rel=\"noopener noreferrer\">{this.state.eurl}</a> <span className=\"lbp-span-link\" title=\"Copy Citation to Clipboard\" onClick={(e) => {e.preventDefault(); copyToClipboard(this.state.eurl)}}><FaClipboard /></span>)</p>\n\n        <p className=\"mtitle\">\n          {this.state.editor && <span>Ed. {this.state.editorTitle}, </span>}\n          {this.state.mtitle} {wordRange && <span>, words {wordRange} </span>}\n          (<a href={this.state.murl} target=\"_blank\" rel=\"noopener noreferrer\">{this.state.murl}</a> \n          \n          <span className=\"lbp-span-link\" title=\"Copy Citation to Clipboard\" onClick={(e) => {e.preventDefault(); copyToClipboard(this.state.murl)}}><FaClipboard /></span>)\n        </p>\n\n        <p className=\"ttitle\">\n          <span>Transcription Resource: </span>\n          <a href={this.state.turl} target=\"_blank\" rel=\"noopener noreferrer\">{this.state.turl}</a>\n          <span className=\"lbp-span-link\" title=\"Copy Citation to Clipboard\" onClick={(e) => {e.preventDefault(); copyToClipboard(this.state.turl)}}><FaClipboard /></span>\n          <br/>\n          <span>Data source: </span>\n          <a href={this.state.datasource} target=\"_blank\" rel=\"noopener noreferrer\"> {this.state.datasource}</a> \n          <span className=\"lbp-span-link\" title=\"Copy Citation to Clipboard\" onClick={(e) => {e.preventDefault(); copyToClipboard(this.state.datasource)}}><FaClipboard /></span>\n          </p>\n        <p className=\"lbp-span-link\" title=\"Copy Citation to Clipboard\" onClick={(e) => {e.preventDefault(); copyToClipboard(fullCitationString)}}><FaClipboard /> Copy Full Citation to Clipboard</p>\n      </div>\n      }\n      </Container>\n    );\n  }\n}\n\nCitation.propTypes = {\n  /**\n  * transcription resource id of focused passage,\n  * transcription id is required, because a specific text passage is being complicated\n  *\n  * TODO: perhaps it would be good to allow the expression or manifestation id to be given\n  * but the citation component would need to know what kind of resource this and would\n  * need to produce a different query in each case\n  */\n  tresourceid: PropTypes.string.isRequired,\n\n}\n\nexport default Citation;\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport {FaChevronDown, FaChevronUp} from 'react-icons/fa';\n\nclass CitationExplanation extends React.Component {\n  constructor(props){\n    super(props)\n    this.toggleCitationExplanation = this.toggleCitationExplanation.bind(this)\n    this.state = {\n      showCitationExplanation: false,\n    }\n  }\n  toggleCitationExplanation(){\n    this.setState((prevState) => {\n      return {showCitationExplanation: !prevState.showCitationExplanation}\n    })\n  }\n  render(){\n    return (\n      <Container className=\"CitationExplanation\">\n      <p onClick={this.toggleCitationExplanation}>{this.state.showCitationExplanation ? <span><FaChevronDown/>Hide Explanation of Citation Practices</span> : <span><FaChevronUp/>View Explanation of Citation Practices</span>} </p>\n      {this.state.showCitationExplanation &&\n        <div>\n          <p>The citation of a text that has survived through a historical succession of manifestations is a complicated endeavor.\n          Today, when transcriptions of these manifestations\n          can be published as data, separate from any presentation,\n          and thereby can be presented in a variety of ways,\n          a full citation inevitably becomes even more complex.\n          In order to identify the content hierarchy of the text,\n          the specifical material or born digital manifestation of that text,\n          and the data sources used to represent and display that manifestation,\n          specificity and precision are needed.</p>\n\n          <p>Full citations therefore identify three aspects of the text currently being viewed.</p>\n\n          <p className=\"etitle\">First (blue) it identifies the idea of the paragraph in question situated within the conceptual hierarchy of the text.</p>\n\n          <p className=\"mtitle\">Second (red) it identifies the manifestation of the text in a historical or born digital edition.</p>\n\n          <p className=\"ttitle\">Third (purple) it identifies the transcription and transcription data source used to power the current text presentation.</p>\n        </div>}\n      </Container>\n\n    );\n  }\n}\n\nexport default CitationExplanation;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Container from 'react-bootstrap/Container';\nimport {FaChevronDown, FaChevronUp} from 'react-icons/fa';\n\nclass ManifestationList extends React.Component {\n  constructor(props){\n    super(props)\n    this.toggleAlternativeManifestations = this.toggleAlternativeManifestations.bind(this)\n    this.state = {\n      showAlternativeManifestations: true\n    }\n  }\n  toggleAlternativeManifestations(){\n    this.setState((prevState) => {\n      return {showAlternativeManifestations: !prevState.showAlternativeManifestations}\n    })\n  }\n  render(){\n    const displayManifestations = () => {\n      if (this.props.manifestations){\n        const manifestations = this.props.manifestations.map((i) => {\n          return <p key={i.manifestation}>{i.manifestationTitle} : <span className=\"lbp-span-link\" onClick={() => {this.props.handleFocusChange(i.manifestation)}}>{i.manifestation}</span></p>\n        })\n        return manifestations\n      }\n    }\n    return (\n      <Container className=\"ManifestationList\">\n      {this.props.optionalDisplay ?\n        <h4 onClick={this.toggleAlternativeManifestations}>{this.state.showAlternativeManifestations ? <span><FaChevronDown/>Hide Alternative Manifestations</span> : <span><FaChevronUp/>View Alternative Manifestations</span>} </h4>\n        :\n        <h4>Alternative Manifestations</h4>\n      }\n\n        {this.state.showAlternativeManifestations && displayManifestations()}\n      </Container>\n    );\n  }\n}\nManifestationList.propTypes = {\n/**\n  * manifestations provides list of other mnaifestations for focused expression\n\n  * TODO: it seems desireable not to require a manifestations property so that\n  * one can simply provide the transcription resource id, but if the propery is not\n  * the component could look it up itself. But information could also be supplied a prop\n  * in the case the parent component already has the information. In this case,\n  * a second look up by the component would be needless\n  */\n  manifestations: PropTypes.array,\n  /**\n  * function to handle response when new manifestaiton is picked.\n  *\n  */\n  handleFocusChange: PropTypes.func,\n  /**\n  * boolean; if true; turns manifestation header into trigger to hide and display manifestation list\n  */\n  optionalDisplay: PropTypes.bool\n}\nexport default ManifestationList;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Container from 'react-bootstrap/Container';\nimport Citation from './Citation'\nimport CitationExplanation from './CitationExplanation'\nimport ManifestationList from './ManifestationList'\n\nfunction CitationWrapper(props) {\n  return (\n    <Container className={props.hidden ? \"CitationWrapper hidden\" : \"CitationWrapper showing\"}>\n      <Citation tresourceid={props.tresourceid} selectionRange={props.selectionRange}/>\n      <CitationExplanation/>\n      <hr/>\n      <ManifestationList manifestations={props.manifestations} handleFocusChange={props.handleFocusChange}/>\n    </Container>\n  );\n}\n\nCitation.propTypes = {\n  /**\n  * transcription resource id of focused passage,\n  * transcription id is required to be passed down to Citaiton Component\n  */\n  tresourceid: PropTypes.string.isRequired,\n  /**\n  * manifestations provides list of other mnaifestations for focused expression\n\n  * TODO: it seems desireable not to require a manifestations property so that\n  * one can simply provide the transcription resource id, but if the propery is not\n  * the component could look it up itself. But information could also be supplied a prop\n  * in the case the parent component already has the information. In this case,\n  * a second look up by the component would be needless\n  */\n  manifestations: PropTypes.array,\n  /**\n  * hidden designates whether the component should be hidden after mounting\n  */\n  hidden: PropTypes.bool,\n  /**\n  * function to handle response when new manifestaiton is picked.\n  * should be passed down to ManifestationList component\n  */\n  handleFocusChange: PropTypes.func\n}\nexport default CitationWrapper;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {FaExternalLinkAlt, FaChevronDown, FaChevronUp} from 'react-icons/fa';\nimport {Link} from 'react-router-dom';\n\nimport {runQuery} from './utils'\nimport {getChildParts} from './Queries'\n\n/**\n* creates a text outline section\n*/\nclass TextOutline extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleToggleChildren = this.handleToggleChildren.bind(this)\n    this.mounted = \"\"\n    this.state = {\n      parts: [],\n      showChildren: false,\n      isPartOf: {}\n    }\n\n  }\n  /**\n    @public\n    * toggles state.showChildren indicating whether or not section children should be mounted\n  */\n  handleToggleChildren(e){\n    e.preventDefault();\n    this.setState((prevState) => {\n      return {showChildren: !prevState.showChildren}\n    })\n  }\n  retrieveParts(resourceid){\n\n    const partsInfo = runQuery(getChildParts(resourceid))\n    partsInfo.then((data) => {\n\n      // async seems to be working pretty well and efficiently.\n      // if a section has many parts, it will be fired several times.\n      // if it has a 100 parts, it will fire 100 times.\n      // But 100 doesn't seem to causing serious performance issues.\n      //console.log(\"async test; fired\")\n      const newData = data.data.results.bindings.map((d) => {\n\n        return {\n          part: d.part.value,\n          title: d.title.value,\n          level: d.level ? d.level.value : \"\",\n          author: d.author ? d.author.value : \"\",\n          authorTitle: d.authorTitle ? d.authorTitle.value : \"\",\n          structureType: d.structureType ? d.structureType.value : \"\",\n          questionTitle: d.questionTitle ? d.questionTitle.value : \"\"\n        }\n      })\n\n      let isPartOf = {isPartOfId: \"\", isPartOfTitle: \"\"}\n      if (data.data.results.bindings[0]){\n        if (data.data.results.bindings[0].isPartOf){\n        isPartOf.isPartOfId = data.data.results.bindings[0].isPartOf.value\n        isPartOf.isPartOfTitle = data.data.results.bindings[0].isPartOfTitle.value\n        }\n      }\n\n\n      if (this.mounted){\n        this.setState({parts: newData, isPartOf: isPartOf})\n      }\n    })\n  }\n  componentDidMount(){\n    //this.setState({showChildren: this.props.showChildren})\n    this.mounted = true;\n    this.retrieveParts(this.props.resourceid)\n\n    if (this.props.membersOf){\n      if (this.props.membersOf.includes(this.props.resourceid)) {\n        this.setState({showChildren: true})\n\n      }\n    }\n\n  }\n  // UNSAFE_componentWillReceiveProps(newProps){\n  //   if (newProps.resourceid !== this.props.resourceid){\n  //     this.retrieveParts(this.props.resourceid)\n  //   }\n  //   if (newProps.resourceid !== this.props.resourceid || newProps.membersOf !== this.props.membersOf){\n  //     if (newProps.membersOf){\n  //       if (newProps.membersOf.includes(newProps.resourceid)) {\n  //         this.setState({showChildren: true})\n  //       }\n  //       // else{\n  //       //   this.setState({showChildren: false})\n  //       // }\n  //     }\n  //   }\n\n  // }\n  componentDidUpdate(prevProps){\n    if (this.props.resourceid !== prevProps.resourceid){\n      this.retrieveParts(this.props.resourceid)\n    }\n    if (this.props.resourceid !== prevProps.resourceid || this.props.membersOf !== prevProps.membersOf){\n      if (this.props.membersOf){\n        if (this.props.membersOf.includes(this.props.resourceid)) {\n          this.setState({showChildren: true})\n        }\n        // else{\n        //   this.setState({showChildren: false})\n        // }\n      }\n    }\n\n  }\n  componentWillUnmount(){\n    this.mounted = false;\n  }\n  render(){\n    const displayChildren = () => {\n      const parts = this.state.parts.map((p) => {\n        let bold = \"\"\n        if (this.props.membersOf){\n          if (this.props.membersOf.includes(p.part) || p.part === this.props.focusResourceid) {\n            bold = \"bold\"\n            //showChildren = true;\n          }\n        }\n        return <TextOutline\n        bold={bold}\n        key={p.part}\n        focusResourceid={this.props.focusResourceid}\n        showChildren={this.state.showChildren}\n        resourceid={p.part}\n        title={p.title}\n        level={p.level}\n        author={p.author}\n        authorTitle={p.authorTitle}\n        structureType={p.structureType}\n        membersOf={this.props.membersOf}\n        questionTitle={p.questionTitle}\n        mtFocus={this.props.mtFocus}\n        showAuthor={this.props.showAuthor}\n        collectionLink={p.structureType === \"http://scta.info/resource/structureCollection\" ? this.props.collectionLink : true}\n        showParentLink={false}\n        />\n\n\n      })\n      return parts\n    }\n    const indent = this.props.level * 5\n    return (\n      <div id=\"outline\" style={{\"paddingLeft\": indent + \"px\"}}>\n        <p className={this.props.bold}>\n        {(this.state.isPartOf.isPartOfId && this.props.showParentLink) && <Link to={\"/text?resourceid=\" + this.state.isPartOf.isPartOfId}><FaChevronUp/></Link>}\n        {(this.props.author && this.props.showAuthor && this.props.level === \"1\") &&\n          <span>\n            <span>{this.props.authorTitle}: </span>\n            <Link to={\"/text?resourceid=\" + this.props.author}><FaExternalLinkAlt/></Link>\n          </span>\n        }\n        {this.props.title}\n        {this.props.questionTitle && <span>: {this.props.questionTitle}</span>}\n        {(this.state.parts.length > 0 && !this.state.showChildren) && <span className=\"outlineArrow\" onClick={this.handleToggleChildren}><FaChevronDown/></span>}\n        {(this.state.parts.length > 0 && this.state.showChildren) && <span className=\"outlineArrow\" onClick={this.handleToggleChildren}><FaChevronUp/></span>}\n        {this.props.collectionLink && <Link to={\"/text?resourceid=\" + this.props.resourceid + this.props.mtFocus} ><FaExternalLinkAlt/></Link>}\n        </p>\n        {this.state.showChildren && displayChildren()}\n      </div>\n    );\n  }\n}\n\nTextOutline.propTypes = {\n  /**\n  * resource id of focused passage, e.g. paragraph or div structure\n  */\n  focusedResourceid: PropTypes.string,\n  /**\n  * resource id of current section\n  */\n  resourceid: PropTypes.string,\n  /**\n  * title of current section\n  */\n  title: PropTypes.string,\n  /**\n  * hide entire outline\n  */\n  hidden: PropTypes.bool,\n  /**\n  * manifestation and transcription slug\n  * used to create links in outline to specific manifestation\n  * or transcription\n\n  */\n  mtFocus: PropTypes.string,\n  /**\n  * indicates if section heading should be bold with string \"bold\", indicating that focusedResourceId falls within this section\n\n  * TODO: \"bold\" value would be better as boolean, true false\n  */\n  bold: PropTypes.string,\n  /**\n  * indicates whether children should be shown\n  */\n  showChildren: PropTypes.bool,\n  /**\n  * indicates whether level of section with number as string\n\n  * TODO: would be better if level propType was number.\n  */\n  level: PropTypes.string,\n  /**\n  * indicates structureType of current section (e.g. collection, item, division, block)\n  */\n  structureType: PropTypes.string,\n  /**\n  * an array of ids, that focused section is a member of\n  */\n  membersOf: PropTypes.array,\n  /**\n  * question title associated with section\n  */\n  questionTitle: PropTypes.string,\n  /**\n  * indications whether a link at the collection level should be set or not\n  */\n  collectionLink: PropTypes.bool\n}\n\nexport default TextOutline;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport TextOutline from './TextOutline'\n\nimport {runQuery} from './utils'\nimport {getMembersOf} from './Queries'\n\n/**\n* creates a text outline starting from top level expression\n\n*/\nclass TextOutlineWrapper extends React.Component {\n  constructor(props){\n    super(props)\n    this.mounted = \"\"\n    this.state = {\n      membersOf: [],\n    }\n  }\n  retrieveMembersOf(resourceid){\n    const membersOfInfo = runQuery(getMembersOf(resourceid))\n    membersOfInfo.then((data) => {\n      const newData = data.data.results.bindings.map((d) => {\n        return d.memberOf.value\n      })\n      if (this.mounted){\n        this.setState({membersOf: newData})\n      }\n    })\n  }\n  componentDidMount(){\n    this.mounted = true;\n    this.retrieveMembersOf(this.props.focusResourceid)\n  }\n  componentDidUpdate(prevProps){\n    if (this.props.focusResourceid !== prevProps.focusResourceid){\n      this.retrieveMembersOf(this.props.focusResourceid)\n    }\n  }\n  componentWillUnmount(){\n    this.mounted = false;\n}\n  render(){\n    return (\n      <div className={this.props.hidden ? \"hidden\" : \"showing\"}>\n\n        <TextOutline\n          key={this.props.resourceid}\n          showChildren={true}\n          focusResourceid={this.props.focusResourceid}\n          resourceid={this.props.resourceid}\n          title={this.props.title}\n          level={\"1\"}\n          structureType={\"http://scta.info/resource/structureCollection\"}\n          membersOf={this.state.membersOf}\n          mtFocus={this.props.mtFocus}\n          collectionLink={this.props.collectionLink}\n          showAuthor={this.props.showAuthor}\n          showParentLink={this.props.showParentLink}\n          />\n      </div>\n    );\n  }\n}\n\nTextOutlineWrapper.propTypes = {\n  /**\n  * resource id of focused passage, e.g. paragraph or div structure\n  */\n  focusedResourceid: PropTypes.string,\n  /**\n  * resource id of current section\n  */\n  resourceid: PropTypes.string,\n  /**\n  * title of current section\n  */\n  title: PropTypes.string,\n  /**\n  * hide entire outline\n  */\n  hidden: PropTypes.bool,\n  /**\n  * manifestation and transcription slug\n  * used to create links in outline to specific manifestation\n  * or transcription\n  */\n  mtFoucs: PropTypes.string,\n  /**\n  * indications whether a link at the collection level should be set or not\n  */\n  collectionLink: PropTypes.bool\n}\nexport default TextOutlineWrapper;\n","import React from 'react';\nimport {Link} from 'react-router-dom';\nimport Container from 'react-bootstrap/Container';\nimport TextPreview from '@bit/jeffreycwitt.lbp.text-preview'\nimport {runQuery} from './utils'\nimport {getCanonicalTranscription} from '../queries/TextPreviewWrapperQueries'\nimport {FaToggleOn, FaToggleOff} from 'react-icons/fa';\n\nclass TextPreviewWrapper extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleToggleShowTokenPosition = this.handleToggleShowTokenPosition.bind(this)\n    this.mounted = false\n    this.state = {\n      tresourceid: \"\",\n      showTokenPosition: false\n    }\n  }\n  handleToggleShowTokenPosition(){\n    this.setState((prevState)=> {\n      return {showTokenPosition: !prevState.showTokenPosition}\n    })\n  }\n  getTranscriptionId(textPreviewResourceId){\n    const info = runQuery(getCanonicalTranscription(textPreviewResourceId))\n\n    info.then((d) => {\n      if (this.mounted){\n        this.setState({tresourceid: d.data.results.bindings[0].ctranscription.value})\n      }\n    })\n    .catch((e) => {\n      this.setState({tresourceid: \"\"})\n      //console.log(\"transcription id could not be found\", e)\n      // uncomment if you want to automatically redirect\n        //this.props.handleFocusChange(textPreviewResourceId)\n    })\n\n\n  }\n  componentDidMount(){\n    this.mounted = true\n    this.getTranscriptionId(this.props.textPreviewResourceId)\n  }\n  componentDidUpdate(prevProps){\n    if (prevProps.textPreviewResourceId !== this.props.textPreviewResourceId){\n      this.getTranscriptionId(this.props.textPreviewResourceId)\n    }\n  }\n  componentWillUnmount()\n  {\n    this.mounted = false\n  }\n  render(){\n    const link = (this.props.textPreviewStart && this.props.textPreviewEnd) \n    ? this.state.tresourceid + \"@\" + this.props.textPreviewStart + \"-\" + this.props.textPreviewEnd\n    : this.state.tresourceid\n    const referringStart = (this.props.referringSelectionRange && this.props.referringSelectionRange.wordRange) && this.props.referringSelectionRange.wordRange.start\n    const referringEnd = (this.props.referringSelectionRange && this.props.referringSelectionRange.wordRange) && this.props.referringSelectionRange.wordRange.end\n    return (\n      <Container className={this.props.hidden ? \"hidden\" : \"showing\"}>\n      {/* <p>Go to: <span className=\"lbp-span-link\" onClick={() => this.props.handleFocusChange(this.state.tresourceid)}>{this.state.tresourceid}</span></p> */}\n      <p>Go to: <Link onClick={() => {this.props.handleTextPreviewFocusChange(this.props.referringResource, referringStart, referringEnd)}} to={\"/text?resourceid=\" + link}>{link}</Link></p>\n      {\n       this.state.tresourceid && \n       <div>\n         <TextPreview tresourceid={this.state.tresourceid} start={parseInt(this.props.textPreviewStart)} stop={parseInt(this.props.textPreviewEnd)} context={true} showTokenPosition={this.state.showTokenPosition}/>\n      <span className=\"lbp-span-link\" alt=\"show word token position\" onClick={this.handleToggleShowTokenPosition}>{this.state.showTokenPosition ? <FaToggleOn/> : <FaToggleOff/>}</span>\n       </div>\n      }\n      </Container>\n    );\n  }\n}\n\nexport default TextPreviewWrapper;\n"," export function getCanonicalTranscription(resourceid){\n   const query = [\n      \"SELECT DISTINCT ?ctranscription \",\n      \"WHERE { \",\n        \"{\",\n          \"<\" + resourceid + \"> <http://scta.info/property/hasCanonicalManifestation> ?manifestation .\",\n          \"?manifestation <http://scta.info/property/hasCanonicalTranscription> ?ctranscription .\",\n        \"}\",\n        \"UNION\",\n        \"{\",\n          \"BIND(<\" + resourceid + \"> AS ?ctranscription ) . \",\n          \"?ctranscription a <http://scta.info/resource/transcription> .\",\n        \"}\",\n        \"UNION\",\n        \"{\",\n          \"<\" + resourceid + \"> <http://scta.info/property/hasCanonicalTranscription> ?ctranscription .\",\n        \"}\",\n      \"}\"\n      ].join('');\n  return query\n }\n","import React, {useState} from 'react';\n//import Nav from 'react-bootstrap/Nav';\n//import {FaBook} from 'react-icons/fa';\n\nfunction Dictionary(props) {\n  //const [dictionary, setDictionary] = useState(\"logeion\")\n  const [dictionary] = useState(\"logeion\")\n\n  return (\n    <div className={props.hidden ? \"hidden dict-container\" : \"showing dict-container\"} >\n      {/* commented out because whitaker's words does not run over https and therefore is not accessible as iframe on https sites<Nav>\n        {(dictionary === 'whitakerswords') ? \n        <Nav.Link title=\"select logeion\" onClick={()=>setDictionary(\"logeion\")}><FaBook/> Logeion</Nav.Link>\n        : \n        <Nav.Link title=\"select whitaker's words\" onClick={()=>setDictionary(\"whitakerswords\")}><FaBook/> Whitaker's Words</Nav.Link>}\n      </Nav> */}\n      {(props.text && props.text.split(\" \").length === 1) && \n      <div className=\"dict-container2\">\n        {\n        dictionary === \"logeion\" ? <iframe className=\"dict-iframe\" title=\"logeion\" src={\"https://logeion.uchicago.edu/\" + props.text }></iframe> \n        : \n        <iframe className=\"dict-iframe\" title=\"whitakerswords\" src={\"http://archives.nd.edu/cgi-bin/wordz.pl?keyword=\" + props.text }></iframe> \n        }\n        </div>\n      }\n    </div>\n\n    \n  );\n}\n\nexport default Dictionary;","import React from 'react';\nimport Surface2 from \"./Surface2\"\nimport Surface3Wrapper from \"./Surface3Wrapper\"\nimport XmlView from \"./XmlView\"\nimport WindowNavBar from \"./WindowNavBar\"\nimport NextPrevBar from \"./NextPrevBar\"\nimport TextCompareWrapper from \"./TextCompareWrapper\"\nimport Search3 from \"./Search3\"\nimport Comments2 from \"./Comments2\"\nimport CitationWrapper from \"./CitationWrapper\"\nimport TextOutlineWrapper from \"./TextOutlineWrapper\"\nimport TextPreviewWrapper from \"./TextPreviewWrapper\"\nimport Dictionary from \"./Dictionary\"\n\n\n\n\nclass Window extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleToggleTextLinesView = this.handleToggleTextLinesView.bind(this)\n    this.handleChangeManifestation = this.handleChangeManifestation.bind(this)\n    this.state = {\n      windowLoad: \"\",\n      mountStatus: {\n        textCompare: false,\n        surface3: false,\n        comments: false,\n        xml: false,\n        search:  false,\n        textOutline: false,\n        citation: false\n      }\n\n    }\n  }\n  // used to control default iamge view prop for surface3 component\n  handleToggleTextLinesView(view){\n    this.props.handleToggleTextLinesView(this.props.windowId, view)\n  }\n  // used to control default manifestation prop for surface3 component\n  handleChangeManifestation(manifestation){\n    // to do getting manifestation slug, to apply as default view\n    // TODO: it is precarious to get info like this by deconstructing identifier\n    // it would better if this information were being passed from original db look up\n    const manifestationSlug = manifestation.split(\"/resource/\")[1].split(\"/\")[1]\n    this.props.handleChangeManifestation(this.props.windowId, manifestationSlug)\n  }\n  componentDidMount(){\n    this.setState(\n      {windowLoad: this.props.windowLoad}\n    )\n\n\n  }\n  //TODO: delete; after newly added replacement componentDidUpdate continues to work reliablys\n  // UNSAFE_componentWillReceiveProps(newProps){\n  //   //when receiving props we check first to see if a new resource id is present,\n  //   // if so, mounting status for all window child components is set back to false\n  //   let newMountStatus = {}\n  //   if (newProps.info.resourceid !== this.props.info.resourceid){\n  //     newMountStatus = {\n  //       textCompare: false,\n  //       surface3: false,\n  //       comments: false,\n  //       xml: false,\n  //       search:  false,\n  //       textOutline: false,\n  //       citation: false\n  //     }\n  //     // then, the mount status of the opening window load is changed to true\n  //     newMountStatus[newProps.windowLoad] = true\n  //   }\n  //   else if (newProps.windowLoad !== this.props.windowLoad){\n  //     const tempNewMount = this.state.mountStatus\n  //     tempNewMount[newProps.windowLoad] = true\n  //     newMountStatus = tempNewMount\n  //   }\n  //   else{\n  //     newMountStatus = this.state.mountStatus\n  //   }\n  //   this.setState(\n  //     {windowLoad: newProps.windowLoad,\n  //     mountStatus: newMountStatus}\n  //   )\n  // }\n\n  componentDidUpdate(prevProps){\n    //when receiving props we check first to see if a new resource id is present,\n    // if so, mounting status for all window child components is set back to false\n    let newMountStatus = {}\n    if (this.props.info.resourceid !== prevProps.info.resourceid){\n      newMountStatus = {\n        textCompare: false,\n        surface3: false,\n        comments: false,\n        xml: false,\n        search:  false,\n        textOutline: false,\n        citation: false\n      }\n      // then, the mount status of the opening window load is changed to true\n      newMountStatus[this.props.windowLoad] = true\n      this.setState(\n        {windowLoad: this.props.windowLoad,\n        mountStatus: newMountStatus}\n      )\n    }\n    else if (this.props.windowLoad !== prevProps.windowLoad){\n      const tempNewMount = this.state.mountStatus\n      tempNewMount[this.props.windowLoad] = true\n      newMountStatus = tempNewMount\n      this.setState(\n        {windowLoad: this.props.windowLoad,\n        mountStatus: newMountStatus}\n      )\n    }\n    else{\n      newMountStatus = this.state.mountStatus\n    }\n    \n  }\n\n\n  render(){\n    const displayChild = () => {\n      return(\n        <div>\n\n          {// components that are only avialable if blockDiv focus and this.props.info is set\n            this.props.info &&\n          <div>\n          {\n            // NOTE: performance seems a lot better when these mount only when clicked on\n            // some downside as it was nice to have them pre-loaded\n            // and the state doesn't remain when leaving tab and returning back to tab.\n            // for this reason search is always loaded, so that search results remain when moving between tabs.\n            // a compromise approach could be made for similar resources, where some components are dismounted and some are hiddden\n          }\n            {(this.state.windowLoad === \"textCompare\" || this.state.mountStatus.textCompare) && \n            <TextCompareWrapper info={this.props.info}  \n            surfaceWidth={this.props.windowType === 'bottomWindow' ? \"1000\" : \"501\"}\n            hidden={this.state.windowLoad !== \"textCompare\"}/>}\n            {\n              //this.state.windowLoad === \"info\" &&  <Info info={this.props.info} relatedExpressions={this.props.relatedExpressions} topLevel={this.props.topLevel} hidden={this.state.windowLoad !== \"info\"}/>\n            }\n            {\n              //always load search to keep search results present even when navigating two diffferent tabs\n              // uncomment to prevent auto mounting this.state.windowLoad === \"citation\" &&\n            }\n            {(this.state.windowLoad === \"citation\" || this.state.mountStatus.citation) &&\n            <CitationWrapper tresourceid={this.props.info.resourceid + this.props.mtFocus} \n            manifestations={this.props.info.manifestations} \n            handleFocusChange={this.props.handleFocusChange} \n            hidden={this.state.windowLoad !== \"citation\"}\n            selectionRange={this.props.selectionRange}\n            />}\n            {this.state.windowLoad === \"surface2\" &&  <Surface2 surfaceid={this.props.surfaceid} lineFocusId={this.props.lineFocusId} topLevel={this.props.topLevel} handleSurfaceFocusChange={this.props.handleSurfaceFocusChange} handleLineFocusChange={this.props.handleLineFocusChange} hidden={this.state.windowLoad !== \"surface2\"}/>}\n            {(this.state.windowLoad === \"surface3\" || this.state.mountStatus.surface3) &&  <Surface3Wrapper\n            manifestations={this.props.info.manifestations}\n            focusedManifestation={this.props.defaultManifestationSlug ? this.props.resourceid + \"/\" + this.props.defaultManifestationSlug : this.props.resourceid + \"/\" + this.props.mtFocus.split(\"/\")[1]}\n            annotationsDisplay={this.props.annotationsDisplay}\n            handleToggleTextLinesView={this.handleToggleTextLinesView}\n            handleChangeManifestation={this.handleChangeManifestation}\n            width={this.props.windowType === 'bottomWindow' ? \"1000\" : \"501\"}\n            lineFocusId={this.props.lineFocusId}\n            hidden={this.state.windowLoad !== \"surface3\"}/>}\n\n            {\n              //(this.state.windowLoad === \"comments\" || this.state.mountStatus.comments) &&  <Comments resourceid={this.props.info.resourceid} inbox={this.props.info.inbox} hidden={this.state.windowLoad !== \"comments\"}/>\n            }\n            {\n              ((this.state.windowLoad === \"comments\") \n              || this.state.mountStatus.comments) &&  \n              <Comments2 \n              resourceid={this.props.info.resourceid + this.props.mtFocus}\n              expressionid={this.props.info.resourceid} \n              hidden={this.state.windowLoad !== \"comments\"}\n              selectionRange={this.props.selectionRange}\n              />\n            }\n          </div>\n          }\n          {\n            //TODO: use of info, topLevel, itemFocus, focusResearceid, resourceid, needs to be better organized and clarified\n          }\n          {(this.state.windowLoad === \"xml\" || this.state.mountStatus.xml) &&  <XmlView tresourceid={this.props.info ? this.props.info.resourceid + this.props.mtFocus : this.props.itemFocus.expression + this.props.mtFocus} hidden={this.state.windowLoad !== \"xml\"}/>}\n          {\n            //always load outline since it reduces number of calls, as most info is the same for all paragraphs\n          }\n          <TextOutlineWrapper focusResourceid={this.props.info ? this.props.info.resourceid : this.props.itemFocus.expression} resourceid={this.props.topLevel} title={this.props.topLevel} hidden={this.state.windowLoad !== \"textOutlineWrapper\"} mtFocus={this.props.mtFocus}/>\n          {\n            //always load search to keep search results present even when navigating two diffferent tabs\n          }\n          {\n            //<SearchWrapper hidden={this.state.windowLoad !== \"search\"} topLevel={this.props.topLevel} authorId={this.props.info.author}/>\n          }\n          <Search3\n            hidden={this.state.windowLoad !== \"search\"}\n            searchEid={this.props.topLevel}\n            searchAuthor={this.props.info.author}\n            searchType=\"text\"\n            showSubmit={true}\n            showAdvancedParameters={true}\n            showLabels={false}\n            searchTerm={(this.props.selectionRange && this.props.selectionRange.text) ? '\"' + this.props.selectionRange.text + '\"' : \"\"}\n            />\n          {\n            //<Surface surfaceid={this.props.surfaceid} topLevel={this.props.topLevel}/>\n          }\n          {\n            // text preview wrapper -- loads a text preview from expression resource id\n            this.state.windowLoad === \"textPreview\" &&  <TextPreviewWrapper \n              textPreviewResourceId={this.props.textPreviewResourceId} \n              textPreviewStart={this.props.textPreviewStart} \n              textPreviewEnd={this.props.textPreviewEnd} \n              handleFocusChange={this.props.handleFocusChange} \n              hidden={this.state.windowLoad !== \"textPreview\"}\n              handleTextPreviewFocusChange={this.props.handleTextPreviewFocusChange}\n              referringResource={this.props.info.ctranscription}\n              referringSelectionRange={this.props.selectionRange}\n              />\n          }\n          {\n            (this.state.windowLoad === \"dictionary\" && this.props.selectionRange.text) &&\n            <Dictionary text={this.props.selectionRange.text} hidden={this.state.windowLoad !== \"dictionary\"}/>}\n\n          \n        </div>\n      )\n\n    }\n\n  return (\n    <div className={this.props.windowType + \" \" + this.props.windowType + this.props.openWidthHeight}>\n      <WindowNavBar handleTabChange={this.props.handleTabChange}\n      handleClose={this.props.handleClose}\n      handleMinimize={this.props.handleMinimize}\n      handleMaximize={this.props.handleMaximize}\n      handleMiddlize={this.props.handleMiddlize}\n      windowType={this.props.windowType}\n      openWidthHeight={this.props.openWidthHeight}\n      windowId={this.props.windowId}\n      windowLoad={this.props.windowLoad}\n      focus={this.props.resourceid}\n      handleSwitchWindow={this.props.handleSwitchWindow}\n      handleDuplicateWindow={this.props.handleDuplicateWindow}\n      altWindowState={this.props.altWindowState}\n      focusSet={!!this.props.info}\n      />\n      {(this.state.windowLoad !== \"surface2\" && this.state.windowLoad !== \"dictionary\" ) \n      && <NextPrevBar info={this.props.info} handleBlockFocusChange={this.props.handleBlockFocusChange}/>}\n\n      {displayChild()}\n\n    </div>\n    );\n  }\n}\n\nexport default Window;\n","import React from 'react';\nimport {NavLink} from 'react-router-dom';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\nimport { withTranslation } from 'react-i18next';\n\n\nconst TextNavBar = (props) => {\n  \n    const { t } = props;\n    return (\n      <Navbar bg=\"light\" variant=\"light\" expand=\"lg\" fixed=\"bottom\">\n        <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n        <Navbar.Collapse id=\"basic-navbar-nav\">\n        <Nav>\n          {props.previous && <NavLink className=\"nav-link\" to={\"/text?resourceid=\" + props.previous + props.mtFocus}>{t(\"Previous\")}</NavLink>}\n          {props.next && <NavLink className=\"nav-link\" to={\"/text?resourceid=\" + props.next + props.mtFocus}>{t(\"Next\")}</NavLink>}\n          {props.topLevel && <NavLink className=\"nav-link\" to={\"/text?resourceid=\" + props.topLevel}>{t(\"Text Home\")}</NavLink>}\n          {props.pdfView ? <span className=\"nav-link\" onClick={()=>props.handleTogglePdfView()}>{t(\"Web View\")}</span> : <span className=\"nav-link\" onClick={()=>props.handleTogglePdfView()}>{t(\"Print View\")}</span>}\n        </Nav>\n        </Navbar.Collapse>\n      </Navbar>\n\n    );\n}\n\nexport default withTranslation()(TextNavBar);\n","\nimport React from 'react';\nimport Spinner from './Spinner';\nimport $ from 'jquery';\nimport {convertXMLDoc, scrollToParagraph, loadHtmlResultDocFromExist, toRange, cleanText, getContainingP, getRangeWordCount, createRange, goToGitHubEdit} from './utils'\nimport ReactTooltip from 'react-tooltip';\nimport Nav from 'react-bootstrap/Nav';\nimport {FaComments, FaEdit, FaInfo, FaBook, FaSearch} from 'react-icons/fa';\n\nclass Text extends React.Component {\n  constructor(props){\n    super(props)\n    this.retrieveText = this.retrieveText.bind(this)\n    this.handleShowToolTip = this.handleShowToolTip.bind(this)\n    this.handleHideToolTip = this.handleHideToolTip.bind(this)\n    this.handleHideFootnoteToolTip = this.handleHideFootnoteToolTip.bind(this)\n    this.handleShowFootnoteToolTip = this.handleShowFootnoteToolTip.bind(this)\n    this.handleOnToolTipClick = this.handleOnToolTipClick.bind(this)\n    this.state = {\n      fetching: false,\n      // state.selectionRange is puposevively different than props.selection Range\n      // it governs selection state of component without yet changing focus selection State of the entire app\n      selectionRange: \"\", \n      selectionCoords: \"\",\n      dictionary: \"\"\n    }\n  }\n  retrieveText(doc, topLevel, scrollTo, selectionRange){\n    const _this = this;\n    \n    if (doc){\n      //construct file url request ot exist db to get a cors enabled copy of the text (github does not serve files with cors enabled)\n      const doc = this.props.doc;\n      const topLevel = this.props.topLevel;\n      const docFragment = doc.split(\"/master/\")[1]\n      const topLevelFragment = topLevel.split(\"/resource/\")[1]\n      \n      let xmlurl = \"\"\n      if (doc.includes(\"ipfs\")){\n        xmlurl = doc\n      }\n      else{\n        xmlurl = \"https://exist.scta.info/exist/apps/scta-app/text/\" + topLevelFragment + \"/\" + docFragment;\n      }\n      const xslurl = \"/xslt/main_view.xsl\"\n\n      //Begin fetch and conversion\n      this.setState({fetching: true})\n      //frist try to request html converted by eXist\n      const resultDocument = loadHtmlResultDocFromExist(xmlurl)\n      resultDocument.then((data) => {\n        //uncomment \"throw\" to force use of local xslt\n        //throw \"test exception\" \n        this.setState({fetching: false})\n        //appendage to file\n        //and event binding\n        //happens inside promise call back\n        document.getElementById(\"text\").innerHTML = \"\";\n        document.getElementById(\"text\").innerHTML = data.data;\n        // add event binding\n        this.setEvents(_this, scrollTo, selectionRange)\n      })\n      .catch((e) => {\n        // if eXist conversion fails, do conversion in browser\n        const resultDocument = convertXMLDoc(xmlurl, xslurl)\n        resultDocument.then((data) => {\n          this.setState({fetching: false})\n          document.getElementById(\"text\").innerHTML = \"\";\n          document.getElementById(\"text\").appendChild(data)\n          // add event binding\n          this.setEvents(_this, scrollTo, selectionRange)\n          }).catch((e) => {\n            //if browswer conversion fails, log error message\n            console.log(\"something went wrong\", e)\n            document.getElementById(\"text\").innerHTML = \"\";\n            document.getElementById(\"text\").innerHTML = \"<p>Apologies, the document is not able to be loaded at this time</p>\";\n          })\n        })\n      }\n  }\n\n  setEvents(_this, scrollTo, selectionRange){\n\n    $('.paragraphnumber').click(function(e) {\n      e.preventDefault();\n      const id = $(this).parent(\"p\").attr('id')\n      _this.props.setFocus(id)\n      _this.props.openWindow(\"window1\")\n    });\n    if (scrollTo){\n     scrollToParagraph(scrollTo, true)\n   }\n   if(selectionRange){\n    _this.markWithElement(selectionRange)\n  }\n\n   $('.js-show-folio-image').click(function(e) {\n     e.preventDefault();\n     const surfaceid = $(this).attr('data-surfaceid');\n     const paragraphid = $(this).closest('.plaoulparagraph').attr(\"id\");\n\n     _this.props.setFocus(paragraphid)\n     _this.props.handleSurfaceFocusChange(\"http://scta.info/resource/\" + surfaceid)\n     _this.props.openWindow(\"window2\", \"surface2\")\n   });\n\n   $('.lbp-line-number').click(function(e) {\n     e.preventDefault();\n     const surfaceid = $(this).attr('data-surfaceid');\n     const ln = $(this).attr('data-ln');\n     const paragraphid = $(this).closest('.plaoulparagraph').attr(\"id\");\n\n     _this.props.setFocus(paragraphid)\n     _this.props.handleSurfaceFocusChange(\"http://scta.info/resource/\" + surfaceid)\n     _this.props.handleLineFocusChange(\"http://scta.info/resource/\" + surfaceid + \"/\" + ln)\n     _this.props.openWindow(\"window2\", \"surface2\")\n   });\n\n   $('.appnote, .footnote').click(function(e) {\n        e.preventDefault();\n        $(this).attr(\"data-tip\", \"hello world\")\n        const link = $(this).parent().children('.appnote, .footnote')\n        const target = $(link).attr('href')\n        const text = $(target).html()\n        const footnoteOffset = this.getBoundingClientRect()\n        _this.setState({footnoteText: text, footnoteOffset: footnoteOffset})\n        _this.handleShowFootnoteToolTip()\n        const targetText = $(this).parent().children(\".note-display\").attr('data-target-id')\n        $(\".highlight\").removeClass(\"highlight\")\n        $(\"#\" + targetText).addClass(\"highlight\")\n        $(\"span[data-corresp=\" + targetText + \"]\").addClass(\"highlight\")\n          \n      \n      });\n\n      $(document).on(\"click\", '.js-show-info', function(e) {\n         e.preventDefault();\n         const id = $(this).attr('data-pid')\n         _this.props.setFocus(id)\n         _this.props.openWindow(\"window1\")\n       });\n       // this seems like a repetition of line 88\n       if (scrollTo){\n        scrollToParagraph(scrollTo, true)\n      }\n\n      $(document).on(\"click\", '.show-line-witness', function(e) {\n\n        e.preventDefault();\n        const surfaceid = $(this).attr('data-surfaceid');\n        const ln = $(this).attr('data-ln');\n        \n\n        //const paragraphid = $(this).closest('.plaoulparagraph').attr(\"id\");\n        //_this.props.setFocus(paragraphid)\n\n        _this.props.handleSurfaceFocusChange(\"http://scta.info/resource/\" + surfaceid)\n        _this.props.handleLineFocusChange(\"http://scta.info/resource/\" + surfaceid + \"/\" + ln)\n        _this.props.openWindow(\"window2\", \"surface2\")\n      });\n\n      $(document).on(\"click\", '.js-show-reference-paragraph', function(e){\n       e.preventDefault();\n       const target = $(this).attr('data-url')\n       const targetParagraph = $(this).attr('data-target-resource')\n       const start = $(this).attr('data-start')\n       const end = $(this).attr('data-end')\n\n       // set the desired text preview focus to the target of the reference\n       _this.props.handleTextPreviewFocusChange(target, start, end)\n       //opening bottomw window 2 to textPreview\n       _this.props.openWindow(\"window2\", \"textPreview\")\n\n   // NOTE: Order seems to make a difference here (at least in the production version)\n   // calling this.props.setFocus before handleTextPreviewFocusChange and openWindow\n   // was causing a reload that prevented desired functionality (but not on local version, only on production/deployed version)\n   // TODO: investigate further, because even thought the re-arranged order seems to be working\n   // the problem is likely to do with async timing (i.e. on job finish before another)\n   //which could vary in different enviornments\n\n       //setting paragraph focus for paragraph containing target footnote\n       _this.props.setFocus(targetParagraph)\n     })\n\n\n\n     \n      function mark(e) {\n        // hide tooltip\n        _this.handleHideToolTip();\n        //get selection object\n        var sel = document.getSelection();\n        // condition to test against invalid getRangeAt index\n        if (window.getSelection().rangeCount >= 1){\n          var rng = sel && sel.getRangeAt(0);\n          const pAncestor = getContainingP(rng.commonAncestorContainer)\n          //if selection is in a text paragraph\n          //TODO: improve this so that selections within .appnote or .footnote get excluded\n          if (pAncestor && pAncestor.className.includes(\"plaoulparagraph\")){\n            const selectedElementTargetId = pAncestor.id;\n            var cnt = rng.cloneContents();\n            $(cnt).find(\".lbp-line-number, .paragraphnumber, br, .lbp-folionumber, .appnote, .footnote, .lbp-reg\").remove();\n            // if selection is greater than 0 \n            if (cnt.textContent.length > 0){\n              //get ancestor p text\n              const pClone = $(pAncestor).clone()\n              pClone.find(\".lbp-line-number, .paragraphnumber, br, .lbp-folionumber, .appnote, .footnote, .lbp-reg\").remove();\n              \n              \n              const selectionText = cleanText(cnt.textContent)\n              \n              \n              // Get preceding word token length in order to identify start word position of selected range.\n                // NOTE: this replaces  \n                //let precedingTextArray = pText.split(cleanText(selectionText))[0].split(\" \").filter(n=>n); \n                // the above split approach was finding previous instances of the select word and giving false results.\n              let startOffset;\n              let startContainer;\n              if (rng.startOffset === 0){\n                startOffset = rng.startOffset;\n                startContainer = rng.startContainer;\n              }\n              else{\n                startOffset = rng.startOffset - 1;\n                startContainer = rng.startContainer;\n\n              }\n              const precedingRange = createRange(pAncestor, pAncestor, 0, startContainer, startOffset)\n              const precedingTextLength = getRangeWordCount(precedingRange);\n              const startToken = precedingTextLength + 1\n              const endToken = precedingTextLength + (selectionText.split(\" \").filter(n=>n).length) \n              const wordRange = {start: startToken, end: endToken}\n              \n              const oRect = rng.getBoundingClientRect();\n              const selectionRange = {\n                text: selectionText,\n                wordRange, \n                selectedElementTargetId, \n              }\n\n              _this.handleShowToolTip(selectionRange, oRect);\n            }\n          }\n        }\n      }\n      document.addEventListener('keyup', mark); // ctrl+keyup\n      document.addEventListener('mouseup', mark);// ctrl+mouseup\n    }\n  /**\n  * \n  * @param {object} selectionRange    \n  */\n  markWithElement(selectionRange){\n    // remove existing mark elements\n    this.markElementRemove()\n    //only attempt to set mark if container can be found\n    const container = document.getElementById(selectionRange.selectedElementTargetId);\n    // NOTE: this conditional is a backup test, \n    //required properties should already be check in didUpdate method\n    if (container && selectionRange.wordRange){\n      const range = toRange(container, selectionRange.wordRange.start, selectionRange.wordRange.end)\n      const cnt = range.extractContents();\n      const node = document.createElement('mark');\n      node.style.backgroundColor = \"#BBCEBE\";\n      node.appendChild(cnt);\n      range.insertNode(node);\n      //get selection text from clone\n      const clone = $(node).clone();\n      $(clone).find(\".lbp-line-number, .paragraphnumber, br, .lbp-folionumber, .appnote, .footnote, .lbp-reg\").remove();\n      selectionRange.text = cleanText($(clone).text());\n      this.props.handleUpdateSelectionRange(selectionRange)\n    }\n  }\n  /**\n   * @description finds any exiting mark element and removes it\n   */\n  markElementRemove(){\n    $('mark').contents().unwrap();\n  }\n  handleOnToolTipClick(windowLoad, window = \"window1\"){\n    const selectionRange = this.state.selectionRange\n    // send selectionRange up to App State\n    this.markWithElement(selectionRange);\n    const s = selectionRange;\n    this.props.setFocus(s.selectedElementTargetId + \"@\" + s.wordRange.start + \"-\" + s.wordRange.end)\n    // open display window\n    this.props.openWindow(window, windowLoad)\n  }\n  handleHideToolTip(){\n    ReactTooltip.hide(this.fooRef)\n  }\n  handleHideFootnoteToolTip(){\n    ReactTooltip.hide(this.foonoteRef)\n  }\n  /**\n   * @description show tool tip relative to selected text\n   * @param {{\n      text: string,\n      wordRange: object, \n      selectedElementTargetId: string,\n    }} selectionRange - object contain needed if about selectedRange\n   * @param {object} - coords object resulting from from current selection\n   */\n  handleShowToolTip(selectionRange, selectionCoords){\n    this.setState({selectionRange: selectionRange, selectionCoords: selectionCoords})\n    ReactTooltip.show(this.fooRef)\n  }\n  handleShowFootnoteToolTip(){\n    ReactTooltip.show(this.foonoteRef)\n  }\n  componentDidMount(){\n    // NOTE: ScrollToNew helps ensure that scrollTo id is SCTA ShortID, \n    // since TextWrapper is (at present) sometimes sending the shortid and sometimes the full url id\n    // TODO: when TextWrapper is refactored and consistently sending the same ID type. this should be removed\n    const scrollToNew = this.props.scrollTo && this.props.scrollTo.includes(\"/resource/\") ? this.props.scrollTo.split(\"/resource/\")[1] : this.props.scrollTo\n    this.retrieveText(this.props.doc, this.props.topLevel, scrollToNew, this.props.selectionRange)\n  }\n\n  componentDidUpdate(prevProps, prevState){\n\n    //check to see if doc has changed\n    if (prevProps.doc !== this.props.doc){\n      // NOTE: ScrollToNew helps ensure that scrollTo id is SCTA ShortID, \n      // since TextWrapper is (at present) sometimes sending the shortid and sometimes the full url id\n      // TODO: when TextWrapper is refactored and consistently sending the same ID type. this should be removed\n      const scrollToNew = this.props.scrollTo && this.props.scrollTo.includes(\"/resource/\") ? this.props.scrollTo.split(\"/resource/\")[1] : this.props.scrollTo\n      this.retrieveText(this.props.doc, this.props.topLevel, scrollToNew, this.props.selectionRange)\n    }\n    // if doc has already been appended, still scroll to target block\n    else{\n      if (this.props.scrollTo !== prevProps.scrollTo){\n        // NOTE: ScrollToNew helps ensure that scrollTo id is SCTA ShortID, \n        // since TextWrapper is (at present) sometimes sending the shortid and sometimes the full url id\n        // TODO: when TextWrapper is refactored and consistently sending the same ID type. this should be removed\n        const scrollToNew = this.props.scrollTo && this.props.scrollTo.includes(\"/resource/\") ? this.props.scrollTo.split(\"/resource/\")[1] : this.props.scrollTo\n        scrollToParagraph(scrollToNew, true)\n        \n        // set mark if object is present with required properties\n        if (this.props.selectionRange.selectedElementTargetId && this.props.selectionRange.wordRange){\n          this.markWithElement(this.props.selectionRange)\n        }\n        else{\n          this.markElementRemove()\n        }\n      }\n      // TODO/Note: this seems to be firing even when it seems like the prevProps.doc !== this.props.doc\n      // perhaps props are not changing/updating at the same time. So the doc prop has already changed\n      // then the range changes and tries to mark element, but the retrieve text asynch request has not finished \n      // and so the marking container element cannot be found. \n      // NOTE: error solved by preventing attempt to mark if container cannot be found. \n      // but it doesn't seem great that this is firing at undesired times.\n      else if (this.props.selectionRange.wordRange !== prevProps.selectionRange.wordRange && this.props.selectionRange.selectedElementTargetId){\n        this.markWithElement(this.props.selectionRange)\n      }\n      //final check if selection range required properties are removed then remove existing mark\n      else if (!this.props.selectionRange.selectedElementTargetId && !this.props.selectionRange.wordRange) {\n        this.markElementRemove()\n      }\n    }\n    \n  }\n  \n  render(){\n    const displayText = this.state.fetching ? \"none\" : \"block\"\n\n    return (\n      <div>\n        {\n          this.state.fetching\n          &&\n          <div style={{position: \"fixed\", top: \"50%\", left: \"50%\"}}>\n          <Spinner/>\n          </div>\n        }\n        \n        {this.state.selectionRange && <p ref={ref => this.fooRef = ref} data-tip='tooltip' data-for=\"selection\" style={{position: \"fixed\", top: this.state.selectionCoords.top + 10, left: this.state.selectionCoords.left}}></p>}\n        {this.state.footnoteText && <p ref={ref => this.foonoteRef = ref} data-tip='tooltip' data-for=\"footnote\" style={{position: \"fixed\", top: this.state.footnoteOffset.top + 10, left: this.state.footnoteOffset.left}}></p>}\n        <ReactTooltip clickable={true} place=\"top\" id=\"selection\">\n            {this.state.selectionRange &&\n            <Nav>\n              <Nav.Link title={this.state.selectionRange.wordRange.start + \"-\" +this.state.selectionRange.wordRange.end} onClick={() => {this.handleOnToolTipClick(\"citation\")}}><FaInfo/></Nav.Link>\n              <Nav.Link onClick={() => {this.handleOnToolTipClick(\"comments\")}}><FaComments/></Nav.Link>\n              {(this.state.selectionRange.text && this.state.selectionRange.text.split(\" \").length === 1) && \n              <Nav.Link onClick={() => {goToGitHubEdit(this.props.doc, this.state.selectionRange.text, this.state.selectionRange.selectedElementTargetId)}}><FaEdit/></Nav.Link>\n              }\n              <Nav.Link onClick={() => {this.handleOnToolTipClick(\"search\")}}><FaSearch/></Nav.Link>\n              {(this.state.selectionRange.text && this.state.selectionRange.text.split(\" \").length === 1) && \n              <Nav.Link title=\"look up word\" onClick={()=>this.handleOnToolTipClick(\"dictionary\", \"window2\")}><FaBook/></Nav.Link>\n              }\n              \n            </Nav>\n            }\n        </ReactTooltip>\n        <ReactTooltip id=\"footnote\" clickable={true} place=\"top\">\n        \n          <p dangerouslySetInnerHTML={{ __html: this.state.footnoteText}}></p>\n        </ReactTooltip>\n        <div id=\"text\" style={{display: displayText}}></div>\n      </div>\n\n    );\n  }\n}\n\nexport default Text;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Axios from 'axios'\nimport Alert from 'react-bootstrap/Alert';\nimport { withTranslation } from 'react-i18next';\n\nimport {runQuery} from './utils'\nimport {versionHistoryInfo} from './Queries'\n\nclass VersionChain extends React.Component {\n  constructor(props){\n    super(props)\n    this.getVersionHistory = this.getVersionHistory.bind(this)\n    this.handleToggleShowVersions = this.handleToggleShowVersions.bind(this)\n    this.state = {\n      versions: [],\n      currentVersion: \"\",\n      showVersions: false\n    }\n  }\n  handleToggleShowVersions(){\n    this.setState((prevState) => {\n      return {showVersions: !prevState.showVersions}\n    })\n  }\n  getVersionHistory(transcriptionid){\n      const versionChainInfo = runQuery(versionHistoryInfo(transcriptionid))\n      versionChainInfo.then((d) => {\n        const b = d.data.results.bindings\n        b.forEach((b, i) => {\n          var reviewUrl = \"https://dll-review-registry.scta.info/api/v1/reviews/?url=\" + b.doc.value + \"?society=MAA\"\n          Axios(reviewUrl).then((d2) => {\n            const data = d2.data\n            var reviewObject = {}\n            if (data.length > 0){\n              reviewObject = {\n                img_url: data[0][\"badge-url\"],\n                reviewid: data[0][\"id\"],\n                ipfsHash: data[0][\"ipfs-hash\"],\n                html_link: \"https://dll-review-registry.scta.info/reviews/\" + data[0][\"id\"] + \".html\",\n                rubric_link: data[0][\"badge-rubric\"],\n                summary: data[0][\"review-summary\"]\n              }\n            }\n            this.setState((prevState) => {\n              const newVersion = {\n                versionTranscription: b.version ? b.version.value : \"\",\n                versionLabel: b.version_label ? b.version_label.value : \"\",\n                versionOrderNumber: b.order_number ? b.order_number.value : \"\",\n                versionReview: b.review ? b.review.value : \"\",\n                versionDoc: b.doc ? b.doc.value : \"\",\n                versionReviewInfo: reviewObject,\n              }\n              return {\n                versions: [...prevState.versions, newVersion],\n                currentVersion: transcriptionid\n              }\n            })\n          })\n        })\n      })\n    }\n  componentDidMount(){\n    //prevents call when itemInfo prop is not present\n    if (this.props.transcriptionid){\n      this.getVersionHistory(this.props.transcriptionid)\n    }\n  }\n  componentDidUpdate(prevProps, prevState){\n    if (this.props.transcriptionid !== prevProps.transcriptionid){\n      console.log('running fetch')\n      this.setState({versions: []}, () => {\n        this.getVersionHistory(this.props.transcriptionid)\n      })\n    }\n}\n  render(){\n    const { t } = this.props;\n    const displayVersions = () => {\n      const versions = this.state.versions.map((v) => {\n        const currentlyViewing = v.versionTranscription === this.state.currentVersion ? \"currentlyViewing\" : \"\"\n        const gitHubEdit = v.versionDoc.includes(\"github.com\") && v.versionDoc.replace(\"/raw/\", \"/edit/\")\n        return (<p key={v.versionTranscription} className={currentlyViewing + \" small\"}>\n          {currentlyViewing ? <span>{v.versionLabel} {t(\"(Currently Viewing)\")}</span> : <span className=\"lbp-span-link\" onClick={()=>{this.props.handleFocusChange(v.versionTranscription)}}>{v.versionLabel}</span>}\n          {v.versionReviewInfo.html_link && <span> {t(\"Peer Reviewed\")}: <a href={v.versionReviewInfo.html_link}><img alt=\"review\" src={v.versionReviewInfo.img_url}/></a> </span>}\n          <span className=\"small\"> {t(\"Data Source\")}: <a href={v.versionDoc}>{v.versionDoc}</a> </span>\n          {gitHubEdit && <span className=\"small\"> | <a href={gitHubEdit} target=\"_blank\" rel=\"noopener noreferrer\"> Edit on <img src=\"github-octocat-logo.png\" alt=\"github\" height=\"25px\"/> Github</a></span>}\n          </p>)\n      })\n      return versions\n    }\n    const displayAlert = () => {\n      if (this.state.versions){\n        if (this.state.versions.length > 1){\n          return (\n            <Alert variant=\"info\">\n              <p onClick={this.handleToggleShowVersions} className=\"small\">{t(\"This Text Has Multiple Indexed Versions\")}</p>\n              {this.state.showVersions && displayVersions()}\n            </Alert>\n          )\n        }\n        else if (this.state.versions.length === 1){\n          const version = this.state.versions[0]\n          const gitHubEdit = version.versionDoc.includes(\"github.com\") && version.versionDoc.replace(\"/raw/\", \"/edit/\")\n          return (<Alert variant=\"info\">\n            <span className=\"small\">{t(\"Version\")}: {version.versionLabel} \n            | \n            {t(\"Data Source\")}: <a href={version.versionDoc}>{version.versionDoc}</a> \n            </span>\n            {gitHubEdit && <span className=\"small\"> | <a href={gitHubEdit} target=\"_blank\" rel=\"noopener noreferrer\"> Edit on <img src=\"github-octocat-logo.png\" alt=\"github\" height=\"25px\"/> Github</a></span>}\n          </Alert>\n          )\n        }\n        else{\n          return null\n        }\n      }\n      else {\n        return null\n      }\n    }\n    return (\n      displayAlert()\n    );\n  }\n}\nVersionChain.propTypes = {\n  /**\n  * transcription resource id of focused passage,\n  * transcription id is required, because a specific text passage is being complicated\n  */\n  transcriptionid: PropTypes.string.isRequired,\n  /**\n  * handleFocusChange; a function carrying desired behavior\n  * when you user selects non-current version\n  */\n  handleFocusChange: PropTypes.func.isRequired\n}\n\nexport default withTranslation()(VersionChain);\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport Print from \"./Print\"\n\n\nimport Window from \"./Window\"\nimport TextNavBar from \"./TextNavBar\"\nimport Text from \"./Text\"\nimport VersionChain from \"./VersionChain\"\nimport {runQuery, scrollToParagraph} from './utils'\n\nimport {getRelatedExpressions, basicInfoQuery, itemTranscriptionInfoQuery} from './Queries'\n\n\nclass TextWrapper extends React.Component {\n  constructor(props){\n    super(props)\n    this.mount = false\n    this.openWindow = this.openWindow.bind(this)\n    this.setFocus = this.setFocus.bind(this)\n    this.setFocus2 = this.setFocus2.bind(this)\n    this.handleTabChange = this.handleTabChange.bind(this)\n    this.handleClose = this.handleClose.bind(this)\n    this.handleMinimize = this.handleMinimize.bind(this)\n    this.handleMaximize = this.handleMaximize.bind(this)\n    this.handleMiddlize = this.handleMiddlize.bind(this)\n    this.handleSwitchWindow = this.handleSwitchWindow.bind(this)\n    this.handleDuplicateWindow = this.handleDuplicateWindow.bind(this)\n    this.handleSurfaceFocusChange = this.handleSurfaceFocusChange.bind(this)\n    this.handleLineFocusChange = this.handleLineFocusChange.bind(this)\n    this.handleToggleTextLinesView = this.handleToggleTextLinesView.bind(this)\n    this.handleChangeManifestation = this.handleChangeManifestation.bind(this)\n    this.handleTextPreviewFocusChange = this.handleTextPreviewFocusChange.bind(this)\n    this.handleTogglePdfView = this.handleTogglePdfView.bind(this)\n    this.handleUpdateSelectionRange = this.handleUpdateSelectionRange.bind(this)\n    this.state = {\n      doc: \"\",\n      focus: \"\",\n      //focusRelatedExpressions: \"\",\n      mtFocus: \"\",\n      itemFocus: \"\",\n      surfaceid: \"\",\n      lineFocusId: \"\",\n      textPreviewResourceId: \"\",\n      textPreviewStart: \"\",\n      textPreviewEnd: \"\",\n      pdfView: false,\n      selectionRange: undefined, // should be undefined or object\n      windows: {\n        window1: {\n          windowId: \"window1\",\n          open: true,\n          windowLoad: \"citation\",\n          position: \"sideWindow\",\n          openWidthHeight: \"middle\",\n          annotationsDisplay: \"paragraph\",\n          defaultManifestationSlug: \"\"\n        },\n        window2: {\n          windowId: \"window2\",\n          open: false,\n          windowLoad: \"citation\",\n          position: \"bottomWindow\",\n          openWidthHeight: \"middle\",\n          annotationsDisplay: \"paragraph\",\n          defaultManifestationSlug: \"\"\n        }\n      }\n    }\n  }\n  handleTogglePdfView(){\n    this.setState((prevState) => {\n        return {\n          pdfView: !prevState.pdfView\n        }\n    })\n  }\n  handleToggleTextLinesView(windowId, value){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].annotationsDisplay = value\n      return {windows: windows}\n    })\n  }\n  handleChangeManifestation(windowId, manifestationSlug){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].defaultManifestationSlug = manifestationSlug\n      return {windows: windows}\n    })\n  }\n\n  openWindow(id, windowLoad){\n    if (!this.state.windows[id].open || this.state.windows[id].windowLoad !== windowLoad){\n      this.setState((prevState) => {\n        const windows = prevState.windows\n        windows[id].open = true\n        if (windowLoad){\n          windows[id].windowLoad = windowLoad\n        }\n        return {\n          windows: windows,\n        }\n      })\n    }\n  }\n  handleClose(windowId){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].open = false\n      return {windows: windows}\n\n    })\n    //scroll is supposed to re-align text scroll to focused paragraph after side bar close.\n    //but it is not quite working\n    scrollToParagraph(this.state.blockFocus, true)\n\n  }\n  \n  handleMinimize(windowId){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].openWidthHeight = \"minimum\"\n      return {windows: windows}\n\n    })\n  }\n  handleMaximize(windowId){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].openWidthHeight = \"maximum\"\n      return {windows: windows}\n\n    })\n  }\n  handleMiddlize(windowId){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].openWidthHeight = \"middle\"\n      return {windows: windows}\n\n    })\n  }\n  \n  /**\n   * @description update state with selectionRangeObject\n   * @param {object} selectionRange\n   */\n  handleUpdateSelectionRange(selectionRange){\n    const s = selectionRange\n    this.setState({selectionRange: s})\n  }\n  handleSwitchWindow(windowId, windowType){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      if (windows[windowId].position === \"sideWindow\"){\n        windows[windowId].position = \"bottomWindow\"\n        // these conditionals control whether an already existing window will be closed when the other is moved\n        // while commented they allow window1 and window2 to stack on top of each other\n\n        // if (windowId === \"window1\"){\n        //   windows[\"window2\"].open = false\n        // }\n        // else if ((windowId === \"window2\")){\n        //   windows[\"window1\"].open = false\n        // }\n      }\n      else if (windows[windowId].position === \"bottomWindow\"){\n        windows[windowId].position = \"sideWindow\"\n        // these conditionals control whether an already existing window will be closed when the other is moved\n        // while commented they allow window1 and window2 to stack on top of each other\n\n        // if (windowId === \"window1\"){\n        //   windows[\"window2\"].open = false\n        // }\n        // else if ((windowId === \"window2\")){\n        //   windows[\"window1\"].open = false\n        // }\n      }\n      return {windows: windows}\n\n    })\n  }\n  handleDuplicateWindow(windowId, windowType){\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      const altWindowId = windowId === \"window1\" ? \"window2\" : \"window1\"\n      if (windows[windowId].position === \"sideWindow\"){\n        windows[altWindowId].position = \"bottomWindow\"\n        windows[altWindowId].open = true\n      }\n      else if (windows[windowId].position === \"bottomWindow\"){\n        windows[altWindowId].position = \"sideWindow\"\n        windows[altWindowId].open = true\n      }\n      return {windows: windows}\n    })\n  }\n  handleTabChange(windowLoad, windowId){\n\n    this.setState((prevState) => {\n      const windows = prevState.windows\n      windows[windowId].windowLoad = windowLoad\n      return {windows: windows}\n\n    })\n\n  }\n\n  handleSurfaceFocusChange(surfaceid){\n    this.setState({surfaceid: surfaceid})\n  }\n  handleLineFocusChange(lineFocusId){\n    this.setState({lineFocusId: lineFocusId})\n  }\n  handleTextPreviewFocusChange(textPreviewResourceId, start, end){\n    this.setState({textPreviewResourceId: textPreviewResourceId, textPreviewStart: start, textPreviewEnd: end})\n  }\n  //TODO\n  //These two function should be refactored into one\n  setFocus(id){\n    const range = id.split(\"@\")[1] ? \"@\" + id.split(\"@\")[1] : \"\"\n    id = id.split(\"@\")[0];\n    const fullid = id.includes(\"http\") ? id + this.state.mtFocus + range : \"http://scta.info/resource/\" + id + this.state.mtFocus + range;\n    this.props.handleUpdateUrlResource(fullid)\n  }\n  setFocus2(newid){\n    this.props.handleUpdateUrlResource(newid)\n  }\n  //END TODO\n\n\n  retrieveFocusInfo(id){\n    const fullid = id.includes(\"http\") ? id : \"http://scta.info/resource/\" + id\n    // get info\n    const info = runQuery(basicInfoQuery(fullid))\n    //arrange info and set it to state\n\n    this.arrangeFocusInfo(info, fullid)\n    // get related expressions info\n    // removed these second calls and embed the query in arrange focus info to keep information in sync.\n    // TODO remove below three lines\n    //const relatedExpressions = runQuery(getRelatedExpressions(fullid))\n    //arrange info and set it to state\n    //this.arrangeFocusRelatedInfo(relatedExpressions)\n\n    //scrollToParagraph(shortid, true)\n\n  }\n\n  arrangeFocusInfo(info, resourceid){\n      info.then((d) => {\n        const bindings = d.data.results.bindings[0]\n        const manifestations = d.data.results.bindings.map((b) => {\n          return {\n            manifestation: b.manifestation.value,\n            manifestationTitle: b.manifestationTitle.value,\n            transcription: b.manifestationCTranscription ? b.manifestationCTranscription.value : \"\"\n          }\n        })\n        // TODO the need for this 2nd query and async call might\n        // be able to be removed using a construct query\n        // see example pattern in articles collection\n        const relatedExpressions = runQuery(getRelatedExpressions(resourceid))\n        relatedExpressions.then((d) => {\n          const bindings2 = d.data.results.bindings\n          const relatedExpressions = bindings2.map((r) => {\n              return {\n                resourceid: r.isRelatedTo.value,\n                relationLabel: r.label.value,\n                referringResource: r.element ? r.element.value : \"\",\n                author: r.author ? r.author.value : \"\",\n                authorTitle: r.authorTitle ? r.authorTitle.value : \"\",\n                longTitle: r.longTitle ? r.longTitle.value : \"\"\n              }\n            });\n\n          if (this.mount && bindings){\n            this.setState({\n              focus: {\n                resourceid: resourceid,\n                title: bindings.title.value,\n                longTitle: bindings.longTitle ? bindings.longTitle.value : \"\",\n                author: bindings.author ? bindings.author.value : \"\",\n                authorTitle: bindings.authorTitle ? bindings.authorTitle.value : \"\",\n                structureType: bindings.structureType.value,\n                inbox: bindings.inbox.value,\n                next: bindings.next ? bindings.next.value : \"\",\n                previous: bindings.previous ? bindings.previous.value : \"\",\n                cdoc: bindings.cdoc ? bindings.cdoc.value : \"\",\n                cxml: bindings.cxml ? bindings.cxml.value : \"\",\n                topLevel: bindings.topLevelExpression.value,\n                cmanifestation: bindings.cmanifestation.value,\n                ctranscription: bindings.ctranscription ? bindings.ctranscription.value : \"\",\n                manifestations: manifestations,\n                relatedExpressions: relatedExpressions\n              }\n            });\n          }\n        })\n      });\n    }\n  // embeded this within arrang focus info, so that information remains in sync\n  // TODO remove this\n    // arrangeFocusRelatedInfo(relatedInfo){\n    //     relatedInfo.then((d) => {\n    //       console.log(\"new data\", d)\n    //       const bindings = d.data.results.bindings\n    //       const relatedExpressions = bindings.map((r) => {\n    //           return {\n    //             resourceid: r.isRelatedTo.value,\n    //             relationLabel: r.label.value\n    //           }\n    //         });\n    //     if (this.mount){\n    //       this.setState({\n    //         focusRelatedExpressions: relatedExpressions\n    //       });\n    //       }\n    //     });\n    //   }\n    setItemFocus(id){\n      const fullid = id.includes(\"http\") ? id : \"http://scta.info/resource/\" + id\n      // get info\n      const info = runQuery(itemTranscriptionInfoQuery(fullid))\n      this.arrangeItemFocusInfo(info)\n    }\n    arrangeItemFocusInfo(itemFocusInfo){\n        itemFocusInfo.then((d) => {\n          const bindings = d.data.results.bindings[0]\n          if (this.mount){\n            this.setState({\n              itemFocus: {\n                title: bindings.title.value,\n                manifestation: bindings.manifestation.value,\n                expression: bindings.expression.value,\n                doc: bindings.doc.value,\n                xml: bindings.xml.value,\n                next: bindings.next ? bindings.next.value : \"\",\n                previous: bindings.previous ? bindings.previous.value : \"\",\n                inbox: bindings.inbox.value,\n                topLevel: bindings.topLevelExpression.value,\n                transcriptionid: bindings.t.value\n              }\n            });\n          }\n        });\n      }\n\n  componentDidMount(){\n    this.mount = true\n    //transcriptionid should be required Prop\n    //conditional here to reinfurce that rule\n    if (this.props.transcriptionid){\n      this.setItemFocus(this.props.transcriptionid)\n      //TODO: splitting strings for this information is not ideal.\n      //info should be part of original query\n      const mFocus = this.props.transcriptionid.split(\"/resource/\")[1].split(\"/\")[1]\n      const tFocus = this.props.transcriptionid.split(\"/resource/\")[1].split(\"/\")[2]\n      const selectionRange = this.props.tokenRange ? {\n        wordRange: this.props.tokenRange,\n        selectedElementTargetId: this.props.blockDivFocus && this.props.blockDivFocus.split(\"/resource/\")[1],\n      } : {}\n      this.setState(\n        {mtFocus: \"/\" + mFocus + \"/\" + tFocus, \n        selectionRange: selectionRange\n      })\n\n      if (this.props.blockDivFocus){\n        this.retrieveFocusInfo(this.props.blockDivFocus)\n      }\n    }\n  }\n  //TODO: delete; after newly added replacement componentDidUpdate continues to work reliably\n  // UNSAFE_componentWillReceiveProps(newProps){\n  //   //Keep testing, but it seems like this look up only needs to fire, when the transcription id prop changes\n  //   // not when other props changes.\n  //   if (newProps.transcriptionid !== this.props.transcriptionid){\n  //     this.setItemFocus(newProps.transcriptionid)\n  //     const mFocus = newProps.transcriptionid.split(\"/resource/\")[1].split(\"/\")[1]\n  //     const tFocus = newProps.transcriptionid.split(\"/resource/\")[1].split(\"/\")[2]\n  //     //clear or set parts of state when new transcription file is loaded\n  //     this.setState((prevState) => {\n  //       const windows = prevState.windows\n  //       windows[\"window1\"].defaultManifestationSlug = \"\"\n  //       windows[\"window2\"].defaultManifestationSlug = \"\"\n  //       return {\n  //         mtFocus: \"/\" + mFocus + \"/\" + tFocus,\n  //         windows: windows\n  //       }\n  //     })\n  //   }\n    componentDidUpdate(prevProps){\n      //Keep testing, but it seems like this look up only needs to fire, when the transcription id prop changes\n      // not when other props changes.\n      if (this.props.transcriptionid !== prevProps.transcriptionid){\n        this.setItemFocus(this.props.transcriptionid)\n        const mFocus = this.props.transcriptionid.split(\"/resource/\")[1].split(\"/\")[1]\n        const tFocus = this.props.transcriptionid.split(\"/resource/\")[1].split(\"/\")[2]\n        //clear or set parts of state when new transcription file is loaded\n        this.setState((prevState) => {\n          const windows = prevState.windows\n          windows[\"window1\"].defaultManifestationSlug = \"\"\n          windows[\"window2\"].defaultManifestationSlug = \"\"\n          const selectionRange = this.props.tokenRange ? {\n            ...prevState.selectionRange, \n            wordRange: this.props.tokenRange,\n            selectedElementTargetId: this.props.blockDivFocus && this.props.blockDivFocus.split(\"/resource/\")[1],\n          } : {}\n          return {\n            mtFocus: \"/\" + mFocus + \"/\" + tFocus,\n            selectionRange: selectionRange,\n            windows: windows\n          }\n        })\n      }\n      //TODO: seems a little dangerous to have these two different setState/async calls \n      //if one depends on the other, this is a good place for things to get out of sync\n      if (this.props.blockDivFocus !== prevProps.blockDivFocus){\n        if (!this.props.blockDivFocus){\n          this.setState(\n            {\n              focus: \"\",\n              selectionRange: \"\"\n          });\n        }\n        else {\n          this.setState((prevState) => {\n            const selectionRange = this.props.tokenRange ? {\n              ...prevState.selectionRange, \n              wordRange: this.props.tokenRange,\n              selectedElementTargetId: this.props.blockDivFocus && this.props.blockDivFocus.split(\"/resource/\")[1],\n            } : {}\n            return({\n            selectionRange: selectionRange\n            })  \n          })\n          this.retrieveFocusInfo(this.props.blockDivFocus,)\n        }\n      }\n      if (this.props.tokenRange !== prevProps.tokenRange){\n        this.setState((prevState)=>{\n          const selectionRange = this.props.tokenRange ? {\n            ...prevState.selectionRange, \n            wordRange: this.props.tokenRange,\n            selectedElementTargetId: this.props.blockDivFocus && this.props.blockDivFocus.split(\"/resource/\")[1],\n          } : {}\n          return({\n          selectionRange: selectionRange\n        })\n        })\n      }\n\n\n\n\n  }\n  componentWillUnmount(){\n    this.mount = false\n  }\n  render(){\n    const displayWindows = () => {\n      const windows = Object.keys(this.state.windows).map((key) => {\n        if (this.state.windows[key].open){\n          return (<Window\n              key={key}\n              handleClose={this.handleClose}\n              handleMinimize={this.handleMinimize}\n              handleMaximize={this.handleMaximize}\n              handleMiddlize={this.handleMiddlize}\n              handleTabChange={this.handleTabChange}\n              handleBlockFocusChange={this.setFocus}\n              handleFocusChange={this.setFocus2}\n              handleSurfaceFocusChange={this.handleSurfaceFocusChange}\n              handleSwitchWindow={this.handleSwitchWindow}\n              handleDuplicateWindow={this.handleDuplicateWindow}\n              resourceid={this.state.focus ? this.state.focus.resourceid : this.props.resourceid}\n              windowType={this.state.windows[key].position}\n              windowId={this.state.windows[key].windowId}\n              windowLoad={this.state.windows[key].windowLoad}\n              openWidthHeight={this.state.windows[key].openWidthHeight}\n              surfaceid={this.state.surfaceid}\n              lineFocusId={this.state.lineFocusId}\n              info={this.state.focus}\n              itemFocus={this.state.itemFocus}\n              topLevel={this.state.itemFocus.topLevel}\n              altWindowState={this.state.windows[key].windowId === \"window1\" ? this.state.windows[\"window2\"].open : this.state.windows[\"window1\"].open}\n              mtFocus={this.state.mtFocus}\n              handleToggleTextLinesView={this.handleToggleTextLinesView}\n              annotationsDisplay={this.state.windows[key].annotationsDisplay}\n              handleChangeManifestation={this.handleChangeManifestation}\n              defaultManifestationSlug={this.state.windows[key].defaultManifestationSlug}\n              textPreviewResourceId={this.state.textPreviewResourceId}\n              textPreviewStart={this.state.textPreviewStart}\n              textPreviewEnd={this.state.textPreviewEnd}\n              handleTextPreviewFocusChange={this.handleTextPreviewFocusChange}\n              handleLineFocusChange={this.handleLineFocusChange}\n              selectionRange={this.state.selectionRange}\n              />\n            )\n          }\n          else{\n            return null\n          }\n        })\n        return windows\n      }\n    const textClass = () => {\n      let aSideWindowOpen = false;\n      if (this.state.windows.window1.open && this.state.windows.window1.position === \"sideWindow\" && this.state.windows.window1.openWidthHeight === \"middle\"){\n        aSideWindowOpen = true\n      }\n      else if (this.state.windows.window2.open && this.state.windows.window2.position === \"sideWindow\"){\n        aSideWindowOpen = true\n      }\n      return aSideWindowOpen\n    }\n\n    const textHide = this.state.pdfView ? \"hidden\" : \"showing\"\n\n    return (\n      <div>\n        {this.state.itemFocus &&\n          <VersionChain transcriptionid={this.state.itemFocus.transcriptionid} handleFocusChange={this.setFocus2}/>\n        }\n        { this.state.pdfView && <Print url={this.state.itemFocus.doc}/>}\n        {\n          // Text Container and Text are always loaded to avoid unnecessary re-mounting\n          // textHide variable is used to hide or show textContainer depending on whether this.statePdfView is true or false\n        }\n        <Container className={textClass() ? \"lbp-text skinnyText \" + textHide : \"lbp-text fullText \" + textHide}>\n\n        {this.state.itemFocus &&\n          <Text\n            doc={this.state.itemFocus.doc}\n            topLevel={this.state.itemFocus.topLevel}\n            setFocus={this.setFocus}\n            handleSurfaceFocusChange={this.handleSurfaceFocusChange}\n            handleLineFocusChange={this.handleLineFocusChange}\n            openWindow={this.openWindow}\n            // NOTE: using props instead of state; seems better, but needs full documentation\n            // NOTE: itemid is shortid of item: TODO: needs documentation; or better, refactoring!\n            // TODO: when scrollTo id type is consistent, remove id checker in didMount and didUpdate of Text component\n            scrollTo={this.props.blockDivFocus ? this.props.blockDivFocus : this.props.itemid}\n            handleTextPreviewFocusChange={this.handleTextPreviewFocusChange}\n            handleUpdateSelectionRange={this.handleUpdateSelectionRange}\n            selectionRange={this.state.selectionRange}\n            />\n          }\n        </Container>\n\n        <TextNavBar\n          next={this.state.itemFocus && this.state.itemFocus.next}\n          previous={this.state.itemFocus && this.state.itemFocus.previous}\n          topLevel={this.state.itemFocus && this.state.itemFocus.topLevel}\n          handleClose={this.handleClose}\n          pdfView={this.state.pdfView}\n          handleTogglePdfView={this.handleTogglePdfView}\n          mtFocus={this.state.mtFocus}\n        />\n        <div>\n        {\n        // <TextNavBar\n        // next={this.state.items[this.state.itemFocus] && this.state.items[this.state.itemFocus].next}\n        // previous={this.state.items[this.state.itemFocus] && this.state.items[this.state.itemFocus].previous}\n        // topLevel={this.state.items[this.state.itemFocus] && this.state.items[this.state.itemFocus].topLevel}\n        // handleClose={this.handleClose}\n        // />\n        }\n        {!this.state.pdfView && displayWindows()}\n        </div>\n      </div>\n    );\n  }\n}\nexport default TextWrapper;\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\n\nimport '../styles/timelinelist.scss';\nimport $ from 'jquery';\n\nimport {convertXMLDoc, scrollToParagraph} from './utils'\n\n///TODO: Not this is very similar to the Text component\n//it would be nice if this could be refactored to be a more generic component that could handle both\n//however, the edition text will\n\n//TODO: article componet needs to retrieve and article type and then pick a different style sheet for different types.\n\nclass TextArticle extends React.Component {\n  constructor(props){\n    super(props)\n    this.retrieveText = this.retrieveText.bind(this)\n\n\n  }\n  retrieveText(doc, scrollTo, articleType){\n    const _this = this;\n    if (doc){\n      //construct file url request ot exist db to get a cors enabled copy of the text (github does not serve files with cors enabled)\n      const doc = this.props.doc;\n      \n\n\n      let xmlurl = \"\"\n      if (doc.includes(\"ipfs\") || (doc.includes(\"zotero\"))){\n         xmlurl = doc\n       }\n       else{\n        const docFragment = doc.split(\"/master/\")[1].split(\"/\")[1]\n         xmlurl = \"https://exist.scta.info/exist/apps/scta-app/text/scta-articles/\" + docFragment\n       }\n      let xslurl = \"\"\n      if (articleType === \"http://scta.info/resource/timeline\"){\n         xslurl = \"/xslt/articles/timeline.xsl\"\n      }\n      else if (articleType === \"http://scta.info/resource/bibliography\"){\n        xslurl = \"/xslt/articles/bibliography.xsl\"\n      }\n      else if (articleType === \"http://scta.info/resource/biography\"){\n        xslurl = \"/xslt/articles/biography.xsl\"\n      }\n      else{\n        xslurl = \"/xslt/articles/standard.xsl\"\n      }\n\n      //conversion done in promise in utils.js file\n      const resultDocument = convertXMLDoc(xmlurl, xslurl)\n      resultDocument.then((data) => {\n        //appendage to file\n        //and event binding\n        //happens inside promise call back\n        document.getElementById(\"text\").innerHTML = \"\";\n        document.getElementById(\"text\").appendChild(data);\n\n        // $('.paragraphnumber').click(function(e) {\n        //    e.preventDefault();\n        //    const id = $(this).parent(\"p\").attr('id')\n        //    _this.props.setFocus(id)\n        //    _this.props.openWindow(\"window1\")\n        //  });\n        //  if (scrollTo){\n        //   scrollToParagraph(scrollTo, true)\n        // }\n        //\n        // $('.js-show-folio-image').click(function(e) {\n        //   e.preventDefault();\n        //   const surfaceid = $(this).attr('data-surfaceid');\n        //   const paragraphid = $(this).closest('.plaoulparagraph').attr(\"id\");\n        //\n        //   _this.props.setFocus(paragraphid)\n        //   _this.props.handleSurfaceFocusChange(\"http://scta.info/resource/\" + surfaceid)\n        //   _this.props.openWindow(\"window2\", \"surface2\")\n        // });\n        //\n        // $('.lbp-line-number').click(function(e) {\n        //   e.preventDefault();\n        //   const surfaceid = $(this).attr('data-surfaceid');\n        //   const ln = $(this).attr('data-ln');\n        //   const paragraphid = $(this).closest('.plaoulparagraph').attr(\"id\");\n        //\n        //   _this.props.setFocus(paragraphid)\n        //   _this.props.handleSurfaceFocusChange(\"http://scta.info/resource/\" + surfaceid)\n        //   _this.props.handleLineFocusChange(\"http://scta.info/resource/\" + surfaceid + \"/\" + ln)\n        //   _this.props.openWindow(\"window2\", \"surface2\")\n        // });\n\n        $('.appnote, .footnote').click(function(e) {\n          e.preventDefault();\n\n        });\n        $('.appnote, .footnote').parent().click(function(e) {\n             e.preventDefault();\n             const link = $(this).children('.appnote, .footnote')\n             const target = $(link).attr('href')\n             const text = $(target).html()\n             const targetText = $(this).children(\".note-display\").attr('data-target-id')\n             /// toggles highlight for select text segemnts\n             if (targetText){\n               $(\"#\" + targetText).toggleClass(\"highlight\")\n               $(\"span[data-corresp=\" + targetText + \"]\").toggleClass(\"highlight\")\n             }\n\n             //adds footnote text to noteDisplay Div and toggles hidden class\n             const noteDisplay = $(this).children(\".note-display\")\n             noteDisplay.toggleClass(\"hidden\")\n             noteDisplay.html(text)\n           });\n           $(document).on(\"click\", '.js-show-reference-paragraph', function(e){\n            e.preventDefault();\n            const target = $(this).attr('data-url')\n            const targetParagraph = $(this).attr('data-target-paragraph')\n            //setting paragraph focus for paragraph containing target footnote\n            _this.props.setFocus(targetParagraph)\n            // set the desired text preview focus to the target of the reference\n            _this.props.handleTextPreviewFocusChange(target)\n            //opening bottomw window 2 to textPreview\n            _this.props.openWindow(\"window2\", \"textPreview\")\n          })\n        })\n        .catch((e) => {\n          console.log(\"something went wrong\", e)\n          document.getElementById(\"text\").innerHTML = \"\";\n          document.getElementById(\"text\").innerHTML = \"<p>Apologies, the document is not able to be loaded at this time</p>\";\n        })\n      }\n  }\n\n  componentDidUpdate(prevProps, prevState){\n\n    //check to see if doc has changed\n    if (prevProps.doc !== this.props.doc){\n      this.retrieveText(this.props.doc, this.props.scrollTo, this.props.articleType)\n    }\n    // if doc has already been appended, still scroll to target block\n    else{\n      if (this.props.scrollTo !== prevProps.scrollTo){\n        scrollToParagraph(this.props.scrollTo, true)\n      }\n    }\n\n\n    //this.retrieveText(this.props.doc, this.props.topLevel, this.props.scrollTo)\n  }\n\n  componentDidMount(){\n    this.retrieveText(this.props.doc, this.props.scrollTo, this.props.articleType)\n  }\n\n  render(){\n\n    return (\n      <Container>\n        <div id=\"text\"></div>\n      </Container>\n    );\n  }\n}\n\nexport default TextArticle;\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport {runQuery} from './utils'\nimport {basicStructureAllItemsInfoQuery, partsInfoQuery,workGroupExpressionQuery} from './Queries'\nimport Search3 from \"./Search3\"\nimport TextOutlineWrapper from \"./TextOutlineWrapper\"\n//import Lbp from \"lbp.js/lib\"\n\n\nclass Collection extends React.Component {\n  constructor(props){\n    super(props)\n    this.retrieveCollectionInfo = this.retrieveCollectionInfo.bind(this)\n    this.makeRequests = this.makeRequests.bind(this)\n    this.handleFilter = this.handleFilter.bind(this)\n    this.filter = React.createRef();\n    this.mount = false\n    this.state = {\n      title: \"\",\n      description: \"\",\n      items: {},\n      parts: {},\n      filter: \"\"\n    }\n\n  }\n  handleFilter(e){\n    const item = e.target.value\n    this.setState({filter: item})\n\n  }\n  arrangeParts(partsPromise){\n    const _this = this\n    partsPromise.then((d) => {\n        const bindings = d.data.results.bindings\n        const title = bindings[0].title.value\n        const description = bindings[0].description.value\n        let partsObject = {}\n        bindings.forEach((b) => {\n          const pId = b.part.value\n          partsObject[pId] = {\n            id: b.part.value,\n            title: b.partTitle.value,\n            type: b.partType.value,\n            questionTitle: b.partQuestionTitle ? b.partQuestionTitle.value : null,\n            level: b.partLevel ? b.partLevel.value : \"unknown\",\n        }\n      });\n      if (this.mount){\n        _this.setState(\n          {\n            title,\n            description,\n            parts: partsObject\n          }\n        )\n      }\n    });\n  }\n  arrangeItems(itemsPromise){\n    const _this = this\n    itemsPromise.then((d) => {\n      const bindings = d.data.results.bindings\n      let itemsObject = {}\n      bindings.forEach((b) => {\n        const itemId = b.item.value\n        itemsObject[itemId] = {\n          title: b.itemTitle.value,\n          id: b.item.value,\n          type: b.itemType.value,\n          questionTitle: b.itemQuestionTitle ? b.itemQuestionTitle.value : null,\n          author: b.itemAuthor ? b.itemAuthor.value : null,\n          authorTitle: b.itemAuthorTitle ? b.itemAuthorTitle.value : null,\n          next: b.next ? b.next.value : null,\n          previous: b.previous ? b.previous.value : null,\n          cm: b.cm ? b.cm.value : null,\n          cmTitle: b.cmTitle ? b.cmTitle.value : null,\n          ct: b.ct ? b.ct.value : null,\n          topLevel: b.topLevel ? b.topLevel.value : null,\n          doc: b.doc ? b.doc.value : null\n        }\n      });\n      if (this.mount){\n        _this.setState(\n          {\n            items: itemsObject\n          }\n        )\n      }\n    })\n    .catch((err) => {\n      console.log(err)\n    })\n  }\n\n  retrieveWorkGroupInfo(resourceid){\n    const expressionsInfo = runQuery(workGroupExpressionQuery(resourceid))\n    const partsInfo = runQuery(partsInfoQuery(resourceid))\n    this.arrangeParts(partsInfo)\n    this.arrangeItems(expressionsInfo)\n  }\n  retrieveCollectionInfo(resourceid, structureType, topLevel){\n    const collectionInfo = runQuery(basicStructureAllItemsInfoQuery(topLevel))\n    const partsInfo = runQuery(partsInfoQuery(resourceid))\n\n    //add parts to state\n    this.arrangeParts(partsInfo)\n    /// add items to state\n    this.arrangeItems(collectionInfo)\n  }\n  makeRequests(newResourceId, structureType, topLevel, type){\n\n    //\n    //   // get all expressions for this workGroup\n      if (type === \"http://scta.info/resource/workGroup\"){\n          this.retrieveWorkGroupInfo(newResourceId, structureType, topLevel)\n          //this.setState({itemFocus: \"\"})\n      }\n      // get all items for this collection\n      else if (structureType === \"http://scta.info/resource/structureCollection\"){\n          this.retrieveCollectionInfo(newResourceId, structureType, topLevel)\n          //this.setState({itemFocus: \"\"})\n      }\n\n  }\n  \n  componentDidMount(){\n    this.mount = true\n    this.setState({resourceid: this.props.resourceid})\n    this.makeRequests(this.props.resourceid, this.props.structureType, this.props.topLevel, this.props.type)\n\n  }\n\n  // UNSAFE_componentWillReceiveProps(nextProps) {\n\n  //   // conditional prevents new information requestion if resource id has not changed\n  //   if (nextProps.resourceid !== this.props.resourceid){\n  //     this.setState({resourceid: nextProps.resourceid, filter: \"\"})\n  //     // this conditional resets form value if ref is present\n  //     // if (this.filter){\n  //     //   this.filter.current.value = \"\"\n  //     // }\n  //     this.makeRequests(nextProps.resourceid, nextProps.structureType, nextProps.topLevel, nextProps.type)\n  //   }\n  // }\n  componentDidUpdate(prevProps) {\n\n    // conditional prevents new information requestion if resource id has not changed\n    if (this.props.resourceid !== prevProps.resourceid){\n      this.setState({resourceid: this.props.resourceid, filter: \"\"})\n      // this conditional resets form value if ref is present\n      // if (this.filter){\n      //   this.filter.current.value = \"\"\n      // }\n      this.makeRequests(this.props.resourceid, this.props.structureType, this.props.topLevel, this.props.type)\n    }\n  }\n  componentWillUnmount(){\n    this.mount = false\n  }\n  render(){\n    //const resourceid = Qs.parse(this.props.location.search, { ignoreQueryPrefix: true }).resourceid;\n\n    // const displayQuestions = () => {\n    //   const questions = []\n    //   Object.keys(this.state.items).forEach((key) => {\n    //     const filterCheck = this.state.items[key].title + \" \" + this.state.items[key].authorTitle + \" \" + this.state.items[key].questionTitle\n    //     if (filterCheck.toLowerCase().includes(this.state.filter.toLowerCase())){\n    //     questions.push(\n    //       <Item key={key} item={this.state.items[key]}/>\n    //     )}\n    //   });\n    //   return (\n    //     <Container>\n    //\n    //     <h1>Available Texts</h1>\n    //     <br/>\n    //     <Table striped bordered hover size=\"sm\">\n    //     <tbody>\n    //     {questions}\n    //     </tbody>\n    //     </Table>\n    //     </Container>\n    //   )\n    // }\n    // const displayParts = () => {\n    //     const questions = []\n    //     Object.keys(this.state.parts).forEach((key) => {\n    //       //check against filter\n    //         if (this.state.parts[key].title.toLowerCase().includes(this.state.filter.toLowerCase())){\n    //         questions.push(\n    //           <Item key={key} item={this.state.parts[key]}/>\n    //           )\n    //         }\n    //\n    //     });\n    //     //check against top level expression as parts; if parts are top level expression; don't display parts\n    //     const testPart = this.state.parts[Object.keys(this.state.parts)[0]]\n    //     if (testPart){\n    //       if (!(testPart.type === \"http://scta.info/resource/expression\" && testPart.level === \"1\")){\n    //         return (\n    //           <Container>\n    //           <h1>Available Text Collections</h1>\n    //           <br/>\n    //           <Table striped bordered hover size=\"sm\">\n    //           <tbody>\n    //           {questions}\n    //           </tbody>\n    //           </Table>\n    //           </Container>\n    //         )\n    //       }\n    //     }\n    //   }\n\n    return (\n      <Container className=\"collectionBody\">\n      {this.state.title && <h1>{this.state.title}</h1>}\n      {this.state.title && <p style={{\"textAlign\": \"center\"}}>{this.state.description}</p>}\n      {\n        //<p style={{\"textAlign\": \"center\"}}><Link to={\"/text?resourceid=http://scta.info/resource/scta\"}>Back to Top Level</Link></p>\n      }\n\n      <Row>\n        <Col xs={9}>\n          <Container>\n\n              <TextOutlineWrapper\n                focusResourceid={this.state.resourceid}\n                resourceid={this.state.resourceid}\n                title={this.state.title}\n                hidden={false}\n                mtFocus={\"\"}\n                collectionLink={true}\n                showAuthor={true}\n                showParentLink={true}\n                />\n                {\n              /* <Container className=\"collectionFilter\">\n              <FormControl ref={this.filter} id=\"filter\" placeholder=\"type to filter by title\" onChange={this.handleFilter}/>\n            </Container>\n            {displayParts()}\n            {displayQuestions()}\n            */\n          }\n          </Container>\n        </Col>\n        <Col>\n          <Container>\n          <Search3 searchWorkGroup={this.props.resourceid}\n          showSubmit={true}\n          showAdvancedParameters={true}\n          showLabels={false}/>\n          </Container>\n        </Col>\n      </Row>\n      </Container>\n\n    );\n  }\n}\n\nexport default Collection;\n","import React from 'react';\nimport {Link} from 'react-router-dom';\nfunction Item(props) {\n  const displayItem = () => {\n    // conditions prevents attempt to render when props.item is not present\n    if (props.item){\n      return (\n        <tr>\n          {props.item.author && <td><Link to={\"/text?resourceid=\" + props.item.author}>{props.item.authorTitle}</Link></td>}\n          <td><Link to={\"/text?resourceid=\" + props.item.id}>{props.item.title}</Link></td>\n          {props.item.questionTitle ? <td><Link to={\"/text?resourceid=\" + props.item.id}>{props.item.questionTitle}</Link></td> : <td/>}\n        </tr>\n      )\n    }\n    else{\n      return null\n    }\n  }\n  return (\n    displayItem()\n  );\n}\n\nexport default Item;\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport Table from 'react-bootstrap/Table';\nimport {runQuery} from './utils'\nimport {getAuthorInformation} from './Queries'\nimport Item from \"./Item\"\nimport Search3 from \"./Search3\"\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\n\n//import Lbp from \"lbp.js/lib\"\n\n\nclass AuthorCollection extends React.Component {\n  constructor(props){\n    super(props)\n\n    this.retrieveAuthorCollectionInfo = this.retrieveAuthorCollectionInfo.bind(this)\n    this.handleItemFilter = this.handleItemFilter.bind(this)\n    this.itemFilter = React.createRef();\n\n    this.mount = false\n    this.state = {\n      authorTitle: \"\",\n      authorArticles: [],\n      textArticles: [],\n      expressions: [],\n      itemFilter: \"\",\n    }\n\n  }\n  handleItemFilter(e){\n    const item = e.target.value\n    this.setState({itemFilter: item})\n\n  }\n  arrangeItems(itemsPromise, resourceid){\n    itemsPromise.then((d) => {\n      const author = d.data[\"@graph\"].filter((i) => i[\"@id\"] === resourceid)[0]\n      //const authorExpressions = d.data[\"@graph\"].filter((i) => {i[\"@id\"] === author.hasTopLevelExpression})\n      const authorTitle = author[\"http://purl.org/dc/elements/1.1/title\"]\n      let authorArticles = null\n      if(Array.isArray(author.authorArticle)){\n        authorArticles =  author.authorArticle.map((a) => {\n          return {\n            id: a,\n            title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === a)[0][\"http://purl.org/dc/elements/1.1/title\"]\n          }\n        })\n      }\n      else if (author.authorArticle){\n        authorArticles = [{id: author.authorArticle, title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === author.authorArticle)[0][\"http://purl.org/dc/elements/1.1/title\"]}]\n      }\n      let textArticles = null\n      if(Array.isArray(author.textArticle)){\n          textArticles =  author.textArticle.map((a) => {\n          return {\n            id: a,\n            title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === a)[0][\"http://purl.org/dc/elements/1.1/title\"]\n          }\n        })\n      }\n      else if (author.textArticle){\n        textArticles = [{id: author.textArticle, title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === author.textArticle)[0][\"http://purl.org/dc/elements/1.1/title\"]}]\n      }\n\n      let expressions = null\n      if(Array.isArray(author.hasTopLevelExpression)){\n        expressions =  author.hasTopLevelExpression.map((a) => {\n          return {\n            id: a,\n            title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === a)[0][\"http://purl.org/dc/elements/1.1/title\"]\n          }\n        })\n      }\n      else if (author.hasTopLevelExpression){\n        expressions = [{id: author.hasTopLevelExpression, title: d.data[\"@graph\"].filter((i) => i[\"@id\"] === author.hasTopLevelExpression)[0][\"http://purl.org/dc/elements/1.1/title\"]}]\n      }\n      if (this.mount){\n        this.setState({authorArticles: authorArticles, textArticles: textArticles, expressions: expressions, authorTitle: authorTitle })\n      }\n    })\n    .catch((err) => {\n      console.log(err)\n    })\n  }\n  retrieveAuthorCollectionInfo(resourceid){\n    const authorCollectionInfo = runQuery(getAuthorInformation(resourceid))\n    /// add items to state\n    this.arrangeItems(authorCollectionInfo, resourceid)\n  }\n  componentDidUpdate(prevProps){\n    if (this.props.resourceid !== prevProps.resourceid){\n      this.refs.itemFilter ? this.refs.itemFilter.value = \"\" :\n      this.retrieveAuthorCollectionInfo(this.props.resourceid)\n    }\n  }\n  componentDidMount(){\n    this.mount = true\n    this.retrieveAuthorCollectionInfo(this.props.resourceid)\n\n  }\n  componentWillUnmount(){\n    this.mount = false\n  }\n  render(){\n    //const resourceid = Qs.parse(this.props.location.search, { ignoreQueryPrefix: true }).resourceid;\n\n    const displayItems = (list) => {\n      const items = list.map((i) => {\n        return (\n\n          <Item key={i.id} item={i}/>\n\n        )\n      });\n      return items\n    }\n\n\n\n\n\n\n    return (\n      <Container className=\"collectionBody\">\n      <h1>{this.state.authorTitle}</h1>\n      <Row>\n        <Col xs={9}>\n        {this.state.expressions &&\n        <Container>\n        <h1>Expressions</h1>\n        <br/>\n        <Table striped bordered hover size=\"sm\">\n        <tbody>\n        {displayItems(this.state.expressions)}\n        </tbody>\n        </Table>\n        </Container>\n      }\n      {this.state.authorArticles &&\n        <Container>\n        <h1>Author Related Articles</h1>\n        <br/>\n        <Table striped bordered hover size=\"sm\">\n        <tbody>\n        {displayItems(this.state.authorArticles)}\n        </tbody>\n        </Table>\n        </Container>\n      }\n      {this.state.textArticles &&\n        <Container>\n        <h1>Text Related Articles</h1>\n        <br/>\n        <Table striped bordered hover size=\"sm\">\n        <tbody>\n        {displayItems(this.state.textArticles)}\n        </tbody>\n        </Table>\n        </Container>\n      }\n      </Col>\n      <Col>\n      <br/>\n      <br/>\n      <Search3 searchAuthor={this.props.resourceid}\n        showSubmit={true}\n        showAdvancedParameters={true}\n        showLabels={false}/>\n      </Col>\n      </Row>\n      </Container>\n    );\n  }\n}\n\nexport default AuthorCollection;\n","import React from 'react';\n\nfunction CommentItem(props) {\n  return (\n    <div className=\"comment\">\n     {\n       props.n.motivation === \"discussing\"\n       ? <p>{props.n.body.value} at: <a href={props.n.body.id} target=\"_blank\" rel=\"noopener noreferrer\">{props.n.body.id}</a></p>\n       : <p>{props.n && props.n.body.value}</p>\n     }\n    </div>\n  );\n}\n\nexport default CommentItem;\n","import React from 'react';\nimport Form from 'react-bootstrap/Form';\nimport FormControl from 'react-bootstrap/FormControl';\nimport Button from 'react-bootstrap/Button';\n\nclass CommentCreate extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleCommentUpdate = this.handleCommentUpdate.bind(this)\n    this.handleSubmitComment = this.handleSubmitComment.bind(this)\n    this.state = {\n      comment: \"\"\n    }\n  }\n  handleCommentUpdate(e){\n    e.preventDefault()\n    this.setState({comment: e.target.value})\n\n  }\n  handleSubmitComment(e){\n    e.preventDefault()\n    this.props.handleSumbitComment(this.state.comment)\n  }\n  render(){\n    return (\n      <div className=\"comment\">\n        <Form onSubmit={this.handleSubmitComment}>\n         <FormControl type=\"text\" id=\"comment\" placeholder=\"comment\" className=\"mr-sm-2\" onChange={this.handleCommentUpdate} />\n         <hr/>\n         <Button type=\"submit\" block>Submit</Button>\n       </Form>\n      </div>\n    );\n  }\n}\n\nexport default CommentCreate;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Axios from 'axios';\nimport uuidv4 from 'uuid/v4';\n\nimport Container from 'react-bootstrap/Container';\n\nimport CommentItem from \"./CommentItem\"\nimport CommentCreate from \"./CommentCreate\"\n\nclass Comments extends React.Component {\n  constructor(props){\n  super(props)\n  this.handleSumbitComment = this.handleSumbitComment.bind(this)\n  this.state = {\n    notifications: [],\n    inbox: \"\",\n    resourceid: \"\"\n  }\n}\nhandleSumbitComment(comment){\n  const _this = this;\n\n  const randomid = uuidv4();\n  const annotat = {\n    \"@context\": \"http://www.w3.org/ns/anno.jsonld\",\n    \"id\": \"http://inbox.scta.info/notifications/\" + randomid,\n    \"type\": \"Annotation\",\n    \"motivation\": \"commenting\",\n    \"body\": {\n      \"type\": \"TextualBody\",\n      \"value\": comment\n    },\n    \"target\": this.state.resourceid\n  }\n  Axios({\n    method: 'post',\n    url: this.state.inbox,\n    data: annotat,\n    config: { headers: {'Content-Type': 'application/json+ld' }}\n    })\n    .then(function (response) {\n      _this.setState((prevState) => {\n        return {notifications: [annotat, ...prevState.notifications, ]}\n      });\n    })\n    .catch(function (response) {\n        //handle error\n        console.log(response);\n    });\n\n\n  }\n  retrieveComments(inbox){\n    // using callback here to make sure state is set before making second a sync call.\n    // TODO: consider using this in other components to prevent out of sync behavior\n    // especially is TextCompareComponents\n    this.setState({notifications: []}, function() {\n      Axios.get(inbox).then((d) => {\n        d.data[\"ldp:contains\"].forEach((n) => {\n          //TODO annoying that each comment has to be requestd.\n          // if inbox main list included full comment, only one request would be needed\n          Axios.get(n[\"@id\"]).then((d2) => {\n            this.setState((prevState) => {\n              return {notifications: [...prevState.notifications, d2.data]}\n            });\n          });\n        })\n      }).catch((e) => {\n        console.log(e)\n      })\n    })\n  }\n  componentDidMount(){\n    // conditional prevents against needless attempt to retreive comments with info is not present\n    if (this.props.resourceid){\n      this.setState({inbox: this.props.inbox, resourceid: this.props.resourceid})\n      this.retrieveComments(this.props.inbox)\n    }\n  }\n  UNSAFE_componentWillReceiveProps(newProps){\n    // conditional prevents against needlessly rerequesting information when \"info\" is the same\n    if (newProps.resourceid !== this.props.resourceid){\n      this.setState({inbox: newProps.inbox, resourceid: newProps.resourceid})\n      this.retrieveComments(newProps.inbox)\n    }\n  }\n  render(){\n    const displayComments = () => {\n      const comments = this.state.notifications.map((n, i) => {\n        if (n.motivation === \"commenting\"){\n          return (\n            <CommentItem key={\"commenting-\" + i} n={n}/>\n          )\n        }\n        else{\n          return null\n        }\n      })\n      return comments\n    }\n    const displayDiscussions = () => {\n      const comments = this.state.notifications.map((n, i) => {\n        if (n.motivation === \"discussing\"){\n          return (\n            <CommentItem key={\"discussion-\" + i} n={n}/>\n          )\n        }\n        else{\n          return null\n        }\n      })\n      return comments\n    }\n    return (\n      <Container className={this.props.hidden ? \"hidden\" : \"showing\"}>\n        <h1>Comments</h1>\n        <CommentCreate handleSumbitComment={this.handleSumbitComment}/>\n        <hr/>\n        <div>\n          <h4>Previous Comments</h4>\n          {displayComments()}\n        </div>\n        <hr/>\n        <div>\n          <h4>Web Discussions/Quotations</h4>\n          {displayDiscussions()}\n        </div>\n      </Container>\n    );\n\n  }\n}\n\nComments.propTypes = {\n  /**\n  * resource id; comments will be assigned to this resourceid\n  */\n  resourceid: PropTypes.string.isRequired,\n  /**\n  * inbox;\n  * IDEA: inbox url is currently required; but it is retrievable\n  * just from the resource. Thus it would be good to be able to supply it if already known\n  * but if it is not supplied the component should be able to look it up.\n  */\n  inbox: PropTypes.string.isRequired,\n  /**\n  * hidden designates whether the component should be hidden after mounting\n  */\n  hidden: PropTypes.bool\n}\n\nexport default Comments;\n","//vendor imports\nimport React from 'react';\nimport PropTypes from 'prop-types';\n\nimport Button from 'react-bootstrap/Button';\nimport {Link} from 'react-router-dom';\nimport {FaExternalLinkAlt} from 'react-icons/fa';\n\n//internal imports\nimport Comments from './Comments'\nimport {runQuery} from './utils'\nimport {getSurfaceInfo} from '../queries/SurfaceInfoQuery'\n\nclass SurfaceInfo extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleToggleRelatedDiscussion = this.handleToggleRelatedDiscussion.bind(this)\n    this.handleSurface3Manifestations = this.handleSurface3Manifestations.bind(this)\n    this.handleToggleShowQuery = this.handleToggleShowQuery.bind(this)\n    this.state = {\n      expressions: [],\n      surfaceMap: {},\n      showTextRegion: false,\n      showQuery: false,\n      query: \"\"\n    }\n  }\n  handleToggleShowQuery(){\n    this.setState((prevState) => {\n      return {\n        showQuery: !prevState.showQuery\n      }\n    })\n  }\n  handleSurface3Manifestations(manifestations, eid){\n    let newManifestations = \"\"\n    if (typeof manifestations === \"object\"){\n      newManifestations = manifestations.map((m) =>{\n        return {\n          manifestation: m,\n          manifestationTitle: m.split(\"/resource/\")[1],\n          transcription: \"\"\n        }\n      })\n    }\n    // sometimes there is only manifestation not in an array\n    else if (manifestations){\n      newManifestations = [{\n        manifestation: manifestations,\n        manifestationTitle: manifestations.split(\"/resource/\")[1],\n        transcription: \"\"\n      }]\n    }\n    this.setState((prevState) => {\n      return {\n        showTextRegion: eid\n      }\n    })\n    this.props.handleSurface3Manifestations(newManifestations)\n  }\n  handleToggleRelatedDiscussion(eid){\n    this.setState((prevState) => {\n      const target = prevState.expressions.find((e) => e[\"@id\"] === eid )\n      target.showComments = !target.showComments\n      const newExpressions = [...prevState.expressions]\n      return {\n        expressions: newExpressions\n      }\n    })\n\n  }\n  handleToggleRelatedSurfaces(eid){\n    this.setState((prevState) => {\n      const target = prevState.expressions.find((e) => e[\"@id\"] === eid )\n      target.showRelatedSurfaces = !target.showRelatedSurfaces\n      const newExpressions = [...prevState.expressions]\n      return {\n        expressions: newExpressions\n      }\n    })\n\n  }\n  retrieveSurfaceInfo(surfaceid){\n    const query = getSurfaceInfo(surfaceid)\n    const surfaceInfo = runQuery(query)\n    surfaceInfo.then((d) => {\n      if (d.data[\"@graph\"]){\n        const data = d.data[\"@graph\"]\n        const expressions = data.filter((e) => {\n          if (e.hasManifestation){\n            return {\n              expressionid: e[\"@id\"],\n              manifestations: e.hasManifestation,\n              showComments: false,\n              showRelatedSurfaces: false,\n            }\n          }\n          else{\n            return null\n          }\n        })\n        let surfaceMap = {}\n        data.forEach((e) => {\n          if (e.isOnSurface){\n            surfaceMap[e[\"@id\"]] = e.isOnSurface\n          }\n        })\n        this.setState({\n          expressions: expressions,\n          surfaceMap: surfaceMap,\n          query: query\n        })\n      }\n    })\n  }\n\n  componentDidMount(){\n    this.retrieveSurfaceInfo(this.props.surfaceid)\n  }\n  componentDidUpdate(prevProps){\n    if (this.props.surfaceid !== prevProps.surfaceid){\n      this.retrieveSurfaceInfo(this.props.surfaceid)\n    }\n  }\n  render(){\n    const displayExpressions = () => {\n      if (this.state.expressions.length > 0){\n        const expressions = this.state.expressions.map((e) => {\n          let manifestations = \"\"\n          // sometimes there are several manifestations\n          if (typeof(e.hasManifestation) === \"object\"){\n            manifestations = e.hasManifestation.map((m) => {\n              return (\n                  <div key={m}>\n                  <span>{m} <Link to={\"/text?resourceid=\" + m}><FaExternalLinkAlt/></Link></span>\n                  <br/>\n                  <span style={{\"textIndent\": \"10px\"}}>...Appearing on Surface {this.state.surfaceMap[m]} <Link to={\"/text?resourceid=\" + this.state.surfaceMap[m]}><FaExternalLinkAlt/></Link></span>\n                  <br/>\n                  <br/>\n                  </div>\n                )\n              })\n            }\n            // sometimes there is only manifestation\n            else if (e.hasManifestation){\n              manifestations = (\n                  <div key={e.hasManifestation}>\n                  <span>{e.hasManifestation} <Link to={\"/text?resourceid=\" + e.hasManifestation}><FaExternalLinkAlt/></Link></span>\n                  <br/>\n                  <span style={{\"textIndent\": \"10px\"}}>...Appearing on Surface {this.state.surfaceMap[e.hasManifestation]} <Link to={\"/text?resourceid=\" + this.state.surfaceMap[e.hasManifestation]}><FaExternalLinkAlt/></Link></span>\n                  <br/>\n                  <br/>\n                  </div>\n                )\n              }\n              else{\n                manifestations = []\n              }\n          return (\n            <div key={e[\"@id\"]}>\n            <hr/>\n            <p>{e[\"@id\"]} <Link to={\"/text?resourceid=\" + e[\"@id\"]}><FaExternalLinkAlt/></Link></p>\n            {e.showRelatedSurfaces ?\n              <div>\n\n              <Button variant=\"outline-primary\" size=\"sm\" block onClick={() => {this.handleToggleRelatedSurfaces(e[\"@id\"])}}>Hide Related Codices</Button>\n              <br/>\n              {this.state.showTextRegion !== e[\"@id\"] ?\n                <Button variant=\"outline-primary\" size=\"sm\" block onClick={() => this.handleSurface3Manifestations(e.hasManifestation, e[\"@id\"])}>View Focused Text Region</Button>\n                :\n                <Button variant=\"outline-primary\" size=\"sm\" block onClick={() => this.handleSurface3Manifestations(\"\", \"\")}>Hide Focused Text Region</Button>\n              }\n              <br/>\n              {manifestations}\n              </div> :\n              <div>\n                <Button variant=\"outline-primary\" size=\"sm\" block onClick={() => {this.handleToggleRelatedSurfaces(e[\"@id\"])}}>Show Related Codices</Button>\n                <br/>\n              </div>\n            }\n            {e.showComments ?\n              <div>\n              <Button variant=\"outline-primary\" size=\"sm\" block onClick={() => {this.handleToggleRelatedDiscussion(e[\"@id\"])}}>Hide Related Discussions</Button>\n              <br/>\n              <Comments resourceid={e[\"@id\"]} inbox={\"http://inbox.scta.info/notifications?resourceid=\" + e[\"@id\"]}/>\n              </div> :\n              <div>\n                <Button variant=\"outline-primary\" size=\"sm\" block onClick={() => {this.handleToggleRelatedDiscussion(e[\"@id\"])}}>Show Related Discussions</Button>\n                <br/>\n              </div>\n            }\n            </div>\n          )\n        })\n        return expressions\n      }\n      else{\n        return null\n      }\n    }\n\n    return (\n      <div className=\"SurfaceInfo\">\n      <h1>Page Info</h1>\n        <div style={{\"fontSize\": \"16px\"}}>\n        <h1>Text objects on this page <Button size=\"sm\" className=\"lbp-span-link\" onClick={this.handleToggleShowQuery}>{this.state.showQuery ? \"Hide Proof\" : \"Prove It!\"}</Button></h1>\n        {this.state.showQuery && <p>{this.state.query}</p>}\n        {displayExpressions()}\n        </div>\n\n      </div>\n    );\n  }\n}\n\nSurfaceInfo.propTypes = {\n  /**\n  * SCTA rdf url surfaceid to use when performing SPARQL query\n  */\n surfaceid: PropTypes.string.isRequired,\n /**\n  * a parent function to be triggered to indicate a new view display; namely \"swithc to viewTextFocused Region\"\n  */\n handleSurface3Manifestations: PropTypes.func\n}\n\n\nexport default SurfaceInfo;\n","//note; each query here represents an attempt an efficient single request for related information\n//each query therefore could be tranformed into a restful api\n\n\n export function getSurfaceInfo(surfaceid){\n   const query = [\n     \"CONSTRUCT\",\n     \"{\",\n     \"?expression <http://scta.info/property/hasManifestation> ?manifestation2 .\",\n     \"?manifestation2 <http://scta.info/property/isOnSurface> ?surface2 .\",\n     \"}\",\n     \"WHERE\",\n     \"{\",\n     \"?manifestation <http://scta.info/property/isOnSurface> <\" + surfaceid + \"> .\",\n     \"?manifestation <http://scta.info/property/structureType> <http://scta.info/resource/structureBlock> .\",\n     \"?manifestation <http://scta.info/property/isManifestationOf> ?expression .\",\n     \"?expression <http://scta.info/property/hasManifestation> ?manifestation2 .\",\n     \"?manifestation2 <http://scta.info/property/isOnSurface> ?surface2 .\",\n     \"?codex <http://scta.info/property/hasSurface> ?surface2 .\",\n     \"}\"\n   ].join('');\n   return query\n }\n","import React from 'react';\nimport Container from 'react-bootstrap/Container';\nimport Surface2 from './Surface2'\nimport Surface3Wrapper from './Surface3Wrapper'\nimport SurfaceInfo from './SurfaceInfo'\nimport {Link} from 'react-router-dom';\n\nimport {runQuery} from './utils'\nimport {getCodexInfo, getCodexInfoFromSurface, getCodexInfoFromCanvas, getCodexInfoFromManifest} from './Queries'\n\nclass Codex extends React.Component {\n  constructor(props){\n    super(props)\n    this.retrieveCodexInfo = this.retrieveCodexInfo.bind(this)\n    this.handleSurfaceFocusChange = this.handleSurfaceFocusChange.bind(this)\n    this.handleToggleShowContents = this.handleToggleShowContents.bind(this)\n    this.handleSurface3Manifestations = this.handleSurface3Manifestations.bind(this)\n    this.state = {\n      items: {},\n      title: \"\",\n      focusedSurface: \"\",\n      relatedCodices: [],\n      showContents: true,\n      surface3Manifestations: [],\n      surface3FocusedManifestation: \"\"\n    }\n  }\n  handleToggleShowContents(){\n    this.setState((prevState) => {\n      return{\n        showContents: !prevState.showContents\n      }\n    })\n  }\n  handleSurface3Manifestations(manifestations){\n    // construct target manifestation from codex slug in focused surface\n    // then use slug to find matching manifestation in manifestation list\n    // TODO: not ideal to be constructing the manifestation id\n    // TODO: it would better to begetting this directly from a lookup request\n    const split1 = this.state.focusedSurface.split(\"/resource/\")[1]\n    const codexSlug = split1.split(\"/\")[0]\n    const surface3FocusedManifestation = manifestations ? manifestations.filter((m) => m.manifestation.includes(codexSlug))[0].manifestation : \"\"\n\n    this.setState({\n        surface3Manifestations: manifestations,\n        surface3FocusedManifestation: surface3FocusedManifestation\n      })\n  }\n  handleSurfaceFocusChange(surfaceid){\n    this.setState({focusedSurface: surfaceid})\n  }\n  retrieveCodexInfo(id, type){\n    let codexInfo = undefined\n    if (type === \"surface\"){\n      codexInfo = runQuery(getCodexInfoFromSurface(id))\n    }\n    else if (type === \"canvas\"){\n      codexInfo = runQuery(getCodexInfoFromCanvas(id))\n    }\n    else if (type === \"manifest\"){\n      codexInfo = runQuery(getCodexInfoFromManifest(id))\n    }\n    else{\n      codexInfo = runQuery(getCodexInfo(id))\n    }\n    codexInfo.then((d) => {\n      const data = d.data.results.bindings\n      if (data.length > 0 && data[0].surface){\n        const expressionIdMap = data.map((d) => {\n          return d.expression ? d.expression.value : \"\"\n        })\n        var unique = expressionIdMap.filter((v, i, a) => a.indexOf(v) === i);\n        let expressionList = {}\n        unique.forEach((e) => {\n           expressionList[e] = []\n        })\n        data.forEach((d) => {\n            const info = {\n              expression: d.expression.value,\n              expressionTitle: d.item_expression_title.value,\n              manifestation: d.manifestation.value,\n              surface: d.surface.value,\n              surfaceTitle: d.surface_title.value,\n              questionTitle: d.item_expression_question_title ? d.item_expression_question_title.value : ''\n            }\n          expressionList[d.expression.value].push(info)\n        })\n        let focusedSurface = \"\"\n        if (type === \"surface\"){\n           focusedSurface = id\n         }\n         else if (type === \"canvas\"){\n           focusedSurface = data[0].surfaceFocus.value\n         }\n         else{\n           focusedSurface = data[0].surface.value\n         }\n        this.setState({items: expressionList, focusedSurface: focusedSurface})\n\n      }\n    })\n  }\n  componentDidMount(){\n    if (this.props.surfaceid){\n      this.retrieveCodexInfo(this.props.surfaceid, \"surface\")\n    }\n    else if (this.props.canvasid){\n      this.retrieveCodexInfo(this.props.canvasid, \"canvas\")\n    }\n    else if (this.props.manifestid){\n      this.retrieveCodexInfo(this.props.manifestid, \"manifest\")\n    }\n    else{\n      this.retrieveCodexInfo(this.props.codexid, \"codex\")\n    }\n  }\n  UNSAFE_componentWillReceiveProps(newProps){\n    if (newProps.surfaceid && newProps.surfaceid !== this.props.surfaceid){\n      this.retrieveCodexInfo(newProps.surfaceid, \"surface\")\n    }\n    else if (newProps.canvasid && newProps.canvasid !== this.props.canvasid){\n      this.retrieveCodexInfo(newProps.canvasid, \"canvas\")\n    }\n    else if (newProps.manifestid && newProps.manifestid !== this.props.manifestid){\n      this.retrieveCodexInfo(newProps.manifest, \"manifest\")\n    }\n    else if (newProps.codexid !== this.props.codexid){\n      this.retrieveCodexInfo(newProps.codexid, \"codex\")\n    }\n  }\n\n  render(){\n    const displayItems = () => {\n      const items = Object.keys(this.state.items).map((key) => {\n        return (\n          <p key={this.state.items[key][0].expression}>\n          <span>\n              <span className=\"codexLink\" onClick={() => {this.handleSurfaceFocusChange(this.state.items[key][0].surface)}}>\n                {this.state.items[key][0].surfaceTitle}</span>{\" - \"}\n              <span className=\"codexLink\" onClick={() => {this.handleSurfaceFocusChange(this.state.items[key][this.state.items[key].length - 1].surface)}}>\n                {this.state.items[key][this.state.items[key].length - 1].surfaceTitle}\n              </span>\n            </span>{\": \"}\n            <Link to={\"/text?resourceid=\" + this.state.items[key][0].manifestation}>{this.state.items[key][0].expressionTitle}</Link>{\": \"}\n            {this.state.items[key][0].questionTitle && this.state.items[key][0].questionTitle}\n          </p>\n\n        )\n      })\n      return items\n    }\n    const displayImages = () => {\n      if (this.state.surface3Manifestations.length > 0){\n        return <Surface3Wrapper manifestations={this.state.surface3Manifestations} focusedManifestation={this.state.surface3FocusedManifestation} annotationsDisplay=\"paragraph\" width=\"501\" hidden={false}/>\n      }\n      else if (this.state.focusedSurface){\n        return <Surface2 surfaceid={this.state.focusedSurface} lineFocusId=\"\" topLevel={this.props.topLevel} handleSurfaceFocusChange={this.handleSurfaceFocusChange} width={\"501\"} annotationsDisplay={false} hidden={false}/>\n      }\n      else{\n        return null\n      }\n\n    }\n    return (\n      <Container fluid={true} className=\"Codex\">\n      <h1>{this.props.codexid}</h1>\n      <div className=\"codexWrapper\">\n        <div className=\"codexContentsWrapper\">\n          <div className=\"codexContents\">\n          {\n            // uncomment if show hide contents toggle is desired\n            //<h2 onClick={this.handleToggleShowContents}>{this.state.showContents ? \"Hide Contents\" : \"View Contents\"}</h2>\n          }\n          <h2>Codex Contents</h2>\n          {this.state.showContents && this.state.items && displayItems()}\n          </div>\n        </div>\n        <div className=\"codexImage\">\n          <h1>Codex Pages</h1>\n          {displayImages()}\n         </div>\n         <div className=\"surfaceInfo\">\n         {this.state.focusedSurface &&\n          <SurfaceInfo surfaceid={this.state.focusedSurface} handleSurface3Manifestations={this.handleSurface3Manifestations}/>\n         }\n        </div>\n      </div>\n\n      </Container>\n    );\n  }\n}\n\nexport default Codex;\n","import React, {useState, useEffect} from 'react';\nimport {runQuery} from './utils'\nimport {getExpressionTypeInfo} from '../queries/expressionTypeQuery'\nimport TextOutlineWrapper from \"./TextOutlineWrapper\"\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Search3 from './Search3';\n\nconst ExpressionType = (props) => {\n  const [expressions, setExpressions] = useState([])\n  useEffect(()=> {\n    const results = runQuery(getExpressionTypeInfo(props.expressionTypeId))\n    results.then((d) => {\n      const bindings = d.data.results.bindings\n      setExpressions(bindings)\n    })\n  }, [props.expressionTypeId])\n  return (\n    <Container className=\"collectionBody\">\n      <h1>{props.expressionTypeId}</h1>\n      <Row>\n        <Col xs={9}>\n      {expressions.map((e)=> {\n        return (\n          <Container>\n          <TextOutlineWrapper\n          focusResourceid={e.expression.value}\n          resourceid={e.expression.value}\n          title={e.authorTitle ? e.authorTitle.value + \", \" + e.eLongTitle.value : e.eLongTitle.value }\n          hidden={false}\n          mtFocus={\"\"}\n          collectionLink={true}\n          showParentLink={true}/>\n          </Container>\n        )\n      })}\n      </Col>\n      <Col>\n        <Search3\n        searchEid={\"\"}\n        searchEType={props.expressionTypeId}\n        showSubmit={true}\n        showAdvancedParameters={true}\n        showLabels={false}/>\n      </Col>\n    </Row>\n  </Container>\n\n  );\n}\n\nexport default ExpressionType;\n","export function getExpressionTypeInfo(id){\n   const query = [\n     \"SELECT ?expression ?eLongTitle ?expressionAuthor ?expressionAuthorTitle ?author ?authorTitle \",\n     \"{\",\n       \"{\",\n         \"?expression <http://scta.info/property/expressionType> <\" + id + \"> .\",\n       \"}\",\n       \"UNION\",\n       \"{\",\n         \"?expression <http://scta.info/property/expressionType> ?expressionType .\",\n         \"?expressionType <http://scta.info/property/isMemberOf> <\" + id + \"> .\",\n       \"}\",\n       \"?expression <http://scta.info/property/longTitle> ?eLongTitle .\",\n       \"OPTIONAL {\",\n       \"?expression <http://www.loc.gov/loc.terms/relators/AUT> ?author . \",\n       \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n       \"}\",\n      \"}\",\n      \n\n     \"ORDER BY ?authorTitle\"].join(' ')\n  return query\n}\n","import React, {useState, useEffect} from 'react';\nimport Container from 'react-bootstrap/Container';\nimport Form from 'react-bootstrap/Form';\nimport {Link} from 'react-router-dom';\nimport Spinner from './Spinner';\nimport {runQuery} from './utils'\nimport {getResources} from '../queries/resourceTypeQuery'\n\n\nconst ResourceTypeList = (props) => {\n  const [resources, setResources] = useState([])\n  const [filter, setFilter] = useState(\"\")\n\n  useEffect(() => {\n    const results = runQuery(getResources(props.resourceTypeId))\n    setResources(\"fetching\")\n    results.then((d) => {\n      setResources(d.data.results.bindings)\n    })\n  }, [props.resourceTypeId])\n  return (\n    <Container className=\"collectionBody\">\n      <h1>{props.resourceTypeId}</h1>\n      <Form.Control as=\"input\" type=\"text\" placeholder=\"filter\" onChange={(e) => setFilter(e.target.value)} value={filter}/>\n      {resources === \"fetching\" ? <Spinner/> :\n      resources.map((r) => {\n        if (r.resourceTitle.value.includes(filter)){\n          return <p key={r.resource.value}><Link to={\"/text?resourceid=\" + r.resource.value}>{r.resourceTitle.value}</Link></p>\n        }\n        else{\n          return null\n        }\n      })\n    }\n    </Container>\n\n  )\n}\n\nexport default ResourceTypeList;\n","export function getResources(resourceType){\n   const query = [\n     \"SELECT ?resource ?resourceTitle\",\n     \"{\",\n       \"?resource a <\" + resourceType + \"> .\",\n       \"?resource <http://purl.org/dc/elements/1.1/title> ?resourceTitle\",\n      \"}\",\n     \"ORDER BY ?resourceTitle\"].join('')\n  return query\n}\n","import React from 'react';\nimport Qs from \"query-string\";\nimport {Helmet} from \"react-helmet\";\nimport TextWrapper from \"./TextWrapper\"\nimport TextArticle from \"./TextArticle\"\nimport Collection from \"./Collection\"\nimport AuthorCollection from \"./AuthorCollection\"\nimport Codex from \"./Codex\"\nimport TextOutlineWrapper from \"./TextOutlineWrapper\"\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Search3 from './Search3';\nimport ExpressionType from './ExpressionType';\nimport ResourceTypeList from './ResourceTypeList';\nimport {Link} from 'react-router-dom';\n\nimport {runQuery} from './utils'\nimport {getArticleTranscriptionDoc, getItemTranscription, getItemTranscriptionFromBlockDiv, getStructureType} from './Queries'\n\nclass TextSwitch extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleUpdateUrlResource = this.handleUpdateUrlResource.bind(this)\n    this.state = {\n      displayType: \"\",\n      resourceid: \"\",\n      itemTranscriptionId: \"\",\n      blockDivFocus: \"\",\n      resourceTitle: \"\",\n      author: \"\",\n      authorTitle: \"\",\n      tokenRange: \"\"\n\n    }\n  }\n  handleUpdateUrlResource(fullid){\n    this.props.history.push({search: '?resourceid=' + fullid})\n  }\n  getInfo(resourceid){\n    let tokenRange;\n    if (resourceid.split(\"@\")[1]){\n      tokenRange = {start: parseInt(resourceid.split(\"@\")[1].split(\"-\")[0]), end: parseInt(resourceid.split(\"@\")[1].split(\"-\")[1])}\n    }\n    \n    resourceid = resourceid.split(\"@\")[0]\n    \n    \n\n    const structureTypePromise = runQuery(getStructureType(resourceid))\n    structureTypePromise.then((t) => {\n      // reduce results to bindings variable\n      const bindings = t.data.results.bindings.length > 0 ? t.data.results.bindings[0] : \"\"\n      // get specific results from bindings data\n      const type = bindings.type ? bindings.type.value : null\n      const structureType = bindings.structureType ? bindings.structureType.value : null\n      //const level = bindings.level ? bindings.level.value : null\n      const topLevel = bindings.topLevel ? bindings.topLevel.value : resourceid\n      const itemParent = bindings.itemParent ? bindings.itemParent.value : null\n      const resourceTitle = bindings.resourceTitle ? bindings.resourceTitle.value : \"\"\n      const author = bindings.author ? bindings.author.value : \"\"\n      const authorTitle = bindings.authorTitle ? bindings.authorTitle.value : \"\"\n\n      //const itemTranscriptionId = t.data.results.bindings[0].ctranscription ? t.data.results.bindings[0].ctranscription.value : null\n      if (resourceid === \"http://scta.info/resource/person\"){\n        this.setState({displayType: \"personList\", resourceid: resourceid, structureType: \"\", topLevel: \"\", type: \"\", resourceTitle: \"\"})\n      }\n      else if (resourceid === \"http://scta.info/resource/codex\"){\n        this.setState({displayType: \"codexList\", resourceid: resourceid, structureType: \"\", topLevel: \"\", type: \"\", resourceTitle: \"\"})\n      }\n      else if (resourceid === \"http://scta.info/resource/expressionType\"){\n        this.setState({displayType: \"expressionTypeList\", resourceid: resourceid, structureType: \"\", topLevel: \"\", type: \"\", resourceTitle: \"\"})\n      }\n      else if (type === \"http://scta.info/resource/expressionType\"){\n        this.setState({displayType: \"expressionType\", resourceid: resourceid, structureType: \"\", topLevel: \"\", type: \"\", resourceTitle: \"\"})\n      }\n      else if (type === \"http://scta.info/resource/person\"){\n        this.setState({displayType: \"person\", resourceid: resourceid, structureType: \"\", topLevel: \"\", type: type, resourceTitle: resourceTitle})\n      }\n      else if (type === \"http://scta.info/resource/article\"){\n        const structureTypePromise = runQuery(getArticleTranscriptionDoc(resourceid))\n        structureTypePromise.then((t) => {\n          this.setState(\n            {displayType: \"article\",\n            articleDoc: t.data.results.bindings[0] ? t.data.results.bindings[0].doc.value : \"\", // conditional checks in case the query comes up empty; if empty it sets transcription id to \"\"\n            articleType: t.data.results.bindings[0] ? t.data.results.bindings[0].articleType.value : \"\", // conditional checks in case the query comes up empty; if empty it sets transcription id to \"\"\n            resourceid: resourceid,\n            structureType: \"\", topLevel: \"\",\n            type: type,\n            resourceTitle: resourceTitle}\n          )\n        })\n\n      }\n      else if (type === \"http://scta.info/resource/codex\"){\n          this.setState({displayType: \"codex\", resourceid: resourceid, structureType: \"\", topLevel: \"\", type: type, resourceTitle: resourceTitle})\n      }\n      else if (type === \"http://scta.info/resource/surface\"){\n          this.setState({displayType: \"surface\", resourceid: resourceid, structureType: \"\", topLevel: \"\", type: type, resourceTitle: resourceTitle})\n      }\n      else if (type === \"http://iiif.io/api/presentation/2#Manifest\"){\n          this.setState({displayType: \"manifest\", resourceid: resourceid, structureType: \"\", topLevel: \"\", type: type, resourceTitle: resourceTitle})\n      }\n      else if (type === \"http://iiif.io/api/presentation/2#Canvas\"){\n          this.setState({displayType: \"canvas\", resourceid: resourceid, structureType: \"\", topLevel: \"\", type: type, resourceTitle: resourceTitle})\n      }\n      else if (type === \"http://scta.info/resource/workGroup\"){\n          this.setState({displayType: \"workGroup\", resourceid: resourceid, structureType: structureType, topLevel: topLevel, type: type, resourceTitle: resourceTitle})\n      }\n      else if (structureType === \"http://scta.info/resource/structureCollection\"){\n          this.setState({displayType: \"collection\", resourceid: resourceid, structureType: structureType, topLevel: topLevel, type: type, resourceTitle: resourceTitle, author: author, authorTitle: authorTitle})\n      }\n      else if (structureType === \"http://scta.info/resource/structureItem\" ){\n        if (type === \"http://scta.info/resource/transcription\"){\n          this.setState({\n            itemTranscriptionId: resourceid, \n            displayType: \"item\", \n            blockDivFocus: resourceid.split(\"/resource/\")[1].split(\"/\")[0], \n            resourceTitle: resourceTitle, \n            tokenRange: tokenRange\n          })\n        }\n        else {\n          const structureTypePromise = runQuery(getItemTranscription(resourceid))\n          structureTypePromise.then((t) => {\n            this.setState(\n              {\n                itemTranscriptionId: t.data.results.bindings[0] ? t.data.results.bindings[0].ctranscription.value : \"\", // conditional checks in case the query comes up empty; if empty it sets transcription id to \"\"\n                displayType: \"item\",\n                blockDivFocus: resourceid.split(\"/resource/\")[1].split(\"/\")[0], // this string split is a bad way to be getting the expression level id\n                resourceTitle: resourceTitle,\n                tokenRange: tokenRange\n              })\n              });\n            }\n          }\n      else if (structureType === \"http://scta.info/resource/structureElement\" || structureType === \"http://scta.info/resource/structureBlock\" || structureType === \"http://scta.info/resource/structureDivision\" ){\n        const structureTypePromise = runQuery(getItemTranscriptionFromBlockDiv(resourceid))\n        structureTypePromise.then((t) => {\n          // if transcription\n          if (type === \"http://scta.info/resource/transcription\"){\n            this.setState({itemTranscriptionId: itemParent, \n              blockDivFocus: t.data.results.bindings[0].blockDivExpression.value, \n              displayType: \"item\", resourceTitle: resourceTitle, \n              tokenRange: tokenRange\n            })\n          }\n          // if expression\n          else if (type === \"http://scta.info/resource/expression\"){\n            if (t.data.results.bindings[0].ctranscription){\n              this.setState({\n                itemTranscriptionId: t.data.results.bindings[0].ctranscription.value, \n                blockDivFocus: resourceid, displayType: \"item\", \n                resourceTitle: resourceTitle, \n                tokenRange: tokenRange})\n            }\n            else{\n              this.setState({displayType: \"notFound\"})\n            }\n          }\n          // if manifestation\n          else {\n            this.setState(\n              {itemTranscriptionId: t.data.results.bindings[0].ctranscription.value, \n              blockDivFocus: t.data.results.bindings[0].blockDivExpression.value, \n              displayType: \"item\", \n              resourceTitle: resourceTitle, \n              tokenRange: tokenRange})\n          }\n        });\n      }\n      else{\n        this.setState({displayType: \"notFound\"})\n      }\n    });\n  }\n\n  componentDidMount(){\n    // conditional to only get info when props.location exists\n    if (this.props.location){\n      const newResourceId = Qs.parse(this.props.location.search, { ignoreQueryPrefix: true }).resourceid\n      if (newResourceId.includes(\"https://scta.info/\")){\n        this.handleUpdateUrlResource(newResourceId.replace(\"https://scta.info/\", \"http://scta.info/\"))\n      }\n      else{\n        this.getInfo(newResourceId)\n      }\n    }\n  }\n  // UNSAFE_componentWillReceiveProps(nextProps) {\n  //   const newResourceId = Qs.parse(nextProps.location.search, { ignoreQueryPrefix: true }).resourceid\n  //   if (newResourceId.includes(\"https://scta.info/\")){\n  //     this.handleUpdateUrlResource(newResourceId.replace(\"https://scta.info/\", \"http://scta.info/\"))\n  //   }\n  //   else{\n  //     this.getInfo(newResourceId)\n  //   }\n  // }\n  componentDidUpdate(prevProps) {\n    const newResourceId = Qs.parse(this.props.location.search, { ignoreQueryPrefix: true }).resourceid\n    const oldResourceId = Qs.parse(prevProps.location.search, { ignoreQueryPrefix: true }).resourceid\n    if (newResourceId !== oldResourceId){\n      if (newResourceId.includes(\"https://scta.info/\")){\n        this.handleUpdateUrlResource(newResourceId.replace(\"https://scta.info/\", \"http://scta.info/\"))\n      }\n      else{\n        this.getInfo(newResourceId)\n      }\n    }\n  }\n\n\n\n  render(){\n    const display = () => {\n      if (this.state.displayType === \"personList\"){\n        return (<ResourceTypeList resourceTypeId=\"http://scta.info/resource/person\"/>)\n      }\n      else if (this.state.displayType === \"codexList\"){\n        return (<ResourceTypeList resourceTypeId=\"http://scta.info/resource/codex\"/>)\n      }\n      else if (this.state.displayType === \"expressionTypeList\"){\n        return (<ResourceTypeList resourceTypeId=\"http://scta.info/resource/expressionType\"/>)\n      }\n      else if (this.state.displayType === \"person\"){\n        return (<AuthorCollection resourceid={this.state.resourceid}/>)\n\n      }\n      else if (this.state.displayType === \"article\"){\n        return (<TextArticle doc={this.state.articleDoc} articleType={this.state.articleType}/>)\n\n      }\n      else if (this.state.displayType === \"workGroup\"){\n        //TODO: this conditional should be comined with the conditional below\n        return (\n          <Collection resourceid={this.state.resourceid} structureType={this.state.structureType} topLevel={this.state.topLevel} type={this.state.type}/>\n        )\n      }\n      else if (this.state.displayType === \"collection\"){\n        //TODO: this should be moved out to its own component\n        //TODO: now that workGroup is using TextOutlineWrapper i'm not sure there is any need for separation\n        // the above conditional and this one should be combined\n        return (\n          <Container className=\"collectionBody\">   \n          <h1>{this.state.resourceTitle}</h1>\n          <p style={{\"textAlign\": \"center\"}}>By <Link to={\"/text?resourceid=\" + this.state.author}>{this.state.authorTitle}</Link></p>\n          <Row>\n            <Col xs={9}>\n              <TextOutlineWrapper\n                focusResourceid={this.state.resourceid}\n                resourceid={this.state.resourceid}\n                title={this.state.resourceTitle}\n                hidden={false}\n                mtFocus={\"\"}\n                collectionLink={true}\n                showParentLink={true}/>\n            </Col>\n            <Col>\n              <Search3 searchEid={this.state.topLevel}\n              showSubmit={true}\n              showAdvancedParameters={true}\n              showLabels={false}/>\n            </Col>\n          </Row>\n        </Container>\n        )\n\n\n      }\n      else if (this.state.displayType === \"item\"){\n        // check to see if a transcription for this text has been found\n        if (this.state.itemTranscriptionId){\n          //TODO: item id is shortItemId pull from transcription id.\n          // it would be better to be getting this from query rather than string deconstruction\n          return (\n            <TextWrapper itemid={this.state.itemTranscriptionId.split(\"/resource/\")[1].split(\"/\")[0]}\n            transcriptionid={this.state.itemTranscriptionId}\n            blockDivFocus={this.state.blockDivFocus}\n            handleUpdateUrlResource={this.handleUpdateUrlResource}\n            tokenRange={this.state.tokenRange}\n            />\n          )\n        }\n        // if no transcription resource id, exists return message\n        else{\n          return (<p>Apologies, no transcriptions of this text are currently available.</p>)\n\n\n        }\n      }\n      else if (this.state.displayType === \"codex\"){\n        return (<Codex codexid={this.state.resourceid}/>)\n      }\n      else if (this.state.displayType === \"surface\"){\n        return (<Codex surfaceid={this.state.resourceid}/>)\n      }\n      else if (this.state.displayType === \"canvas\"){\n        return (<Codex canvasid={this.state.resourceid}/>)\n      }\n      else if (this.state.displayType === \"manifest\"){\n        return (<Codex manifestid={this.state.resourceid}/>)\n      }\n      else if (this.state.displayType === \"expressionType\"){\n        return (<ExpressionType expressionTypeId={this.state.resourceid}/>)\n      }\n      else if (this.state.displayType === \"notFound\"){\n        return (<p>Apologies, this resource could not be found</p>)\n      }\n      else{\n        return null\n      }\n    }\n  const dctype = () => {\n    if (this.state.displayType === \"codex\"){\n      return <meta name=\"BIB.type\" content=\"Manuscript\"/>\n    }\n    else{\n      return <meta name=\"DC.type\" content=\"document\"/>\n    }\n  }\n  return (\n    <div>\n      <Helmet>\n        <title>{this.state.resourceTitle}</title>\n        <link rel=\"schema.DC\" href=\"http://purl.org/dc/elements/1.1/\" ></link>\n        <link rel=\"schema.DCTERMS\" href=\"http://purl.org/dc/terms/\"/>\n        <link rel=\"schema.BIB\" href=\"http://purl.org/net/biblio#\"/>\n        {dctype()}\n        <meta name=\"DC.identifier\" content={this.state.resourceid}/>\n        {//<meta name=\"DC.description\" content=\"test description\"/>\n        }\n        <meta name=\"DC.title\" content={this.state.resourceTitle}/>\n        <meta name=\"DC.creator\" content={this.state.authorTitle}/>\n        <meta name=\"DC.Language\" content=\"la\"/>\n        <meta name=\"DC.Publisher\" content=\"SCTA\"/>\n        \n      </Helmet>\n      {display()}\n    </div>\n    \n    );\n  }\n\n}\n\nexport default TextSwitch;\n","import React from 'react';\n\nfunction About() {\n  return (\n    <div className=\"About\">\n    <h1>About</h1>\n\n    </div>\n  );\n}\n\nexport default About;\n","import React from 'react';\nimport {NavLink} from 'react-router-dom';\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\nimport {resourceEndpoint} from './config';\nimport {useTranslation} from 'react-i18next'\n\nfunction NavBar() {\n  const {t} = useTranslation();\n  return (\n    <Navbar bg=\"dark\" variant=\"light\" expand=\"lg\" fixed=\"top\">\n      <Nav>\n        <NavLink className=\"nav-link\" to=\"/\">{t(\"Title\")}</NavLink>\n      </Nav>\n      <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n      <Navbar.Collapse id=\"basic-navbar-nav\">\n      <Nav>\n\n\n\n        <NavLink className=\"nav-link\" to={\"/res?resourceid=\" + resourceEndpoint}>{t(\"Texts\")}</NavLink>\n        <NavLink className=\"nav-link\" to={\"/res?resourceid=http://scta.info/resource/person\"}>{t(\"People\")}</NavLink>\n        <NavLink className=\"nav-link\" to={\"/res?resourceid=http://scta.info/resource/codex\"}>{t(\"Codices\")}</NavLink>\n        {// example drop down\n          // <NavDropdown title=\"Dropdown\" id=\"basic-nav-dropdown\">\n        //   <NavDropdown.Item href=\"#action/3.1\">Action</NavDropdown.Item>\n        //   <NavDropdown.Item href=\"#action/3.2\">Another action</NavDropdown.Item>\n        //   <NavDropdown.Item href=\"#action/3.3\">Something</NavDropdown.Item>\n        //   <NavDropdown.Divider />\n        //   <NavDropdown.Item href=\"#action/3.4\">Separated link</NavDropdown.Item>\n        // </NavDropdown>\n      }\n      <NavLink className=\"nav-link\" to=\"/search\">{t(\"Search\")}</NavLink>\n      </Nav>\n\n      <Nav>\n        {\n          //<NavLink className=\"nav-link\" to=\"/about\">{t(\"About\")}</NavLink>\n        }\n        <a className=\"nav-link\" href=\"https://scta.info/donate\">{t(\"Donate\")}</a>\n      </Nav>\n      </Navbar.Collapse>\n    </Navbar>\n\n  );\n}\n\nexport default NavBar;\n","import React from 'react';\n\nimport Navbar from 'react-bootstrap/Navbar';\nimport Nav from 'react-bootstrap/Nav';\nimport {useTranslation} from 'react-i18next'\n\n\n\n\n\nfunction Footer() {\n  const {t} = useTranslation();\n  return (\n\n    <Navbar bg=\"light\" variant=\"light\" expand=\"lg\" fixed=\"bottom\" style={{\"zIndex\": \"0\"}}>\n    <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n    <Navbar.Collapse id=\"basic-navbar-nav\">\n\n    <Nav style={{\"display\": \"flex\", \"justifyContent\": \"space-around\", \"width\": \"100%\"}}>\n      <Nav.Link href=\"http://github.com/lombardpress/lombardpress-webjs\">Lbp-Web.js</Nav.Link>\n      <Nav.Link href=\"http://lombardpress.org\">{t(\"A LombardPress Publication\")}</Nav.Link>\n      <Nav.Link href=\"http://scta.info\">{t(\"Powered by SCTA Data\")} </Nav.Link>\n      <Nav.Link href=\"http://jeffreycwitt.com\">{t(\"Designed by Jeffrey C Witt\")}</Nav.Link>\n    </Nav>\n    </Navbar.Collapse>\n\n    </Navbar>\n\n  );\n}\n\nexport default Footer;\n","import React, {Suspense} from 'react';\nimport {HashRouter, Route, Switch} from 'react-router-dom';\nimport Home from \"./Home\"\nimport Search3 from \"./Search3\"\nimport TextSwitch from \"./TextSwitch\"\nimport About from \"./About\"\nimport NavBar from './NavBar';\nimport Spinner from './Spinner';\nimport Footer from './Footer';\nimport OSDInstance from './OSDInstance';\n\nimport 'bootstrap/dist/css/bootstrap.css'\nimport '../styles/App.scss';\n//import '../styles/index.scss';\n\nconst AppRouter = () => {\n  return (\n  <Suspense fallback={<Spinner/>}>\n    <HashRouter forceRefresh={false}>\n      <div>\n        <NavBar/>\n        <Switch>\n          <Route path=\"/\" exact={true} component={Home}/>\n          <Route path=\"/res\" exact={true} component={TextSwitch}/>\n          <Route path=\"/text\"  exact={true} component={TextSwitch}/>\n          <Route path=\"/about\" exact={true} component={About}/>\n          <Route path=\"/search\" exact={true} component={Search3}/>\n          <Route path=\"/osd\" exact={true} component={OSDInstance}/>\n          {\n            //<Route path=\"/edit/:id\" exact={true} component={EditExpensePage}/>\n          //<Route path=\"/help\" exact={true} component={HelpPage}/>\n          // <Route component={NotFoundPage}/>\n          }\n        </Switch>\n        <Footer/>\n      </div>\n    </HashRouter>\n  </Suspense>\n)\n}\n\nexport default AppRouter\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import i18n from 'i18next';\nimport { initReactI18next } from 'react-i18next';\n\nimport Backend from 'i18next-xhr-backend';\nimport LanguageDetector from 'i18next-browser-languagedetector';\n// not like to use this?\n// have a look at the Quick start guide\n// for passing in lng and translations on init\n\ni18n\n  // load translation using xhr -> see /public/locales\n  // learn more: https://github.com/i18next/i18next-xhr-backend\n  .use(Backend)\n  // detect user language\n  // learn more: https://github.com/i18next/i18next-browser-languageDetector\n  .use(LanguageDetector)\n  // pass the i18n instance to react-i18next.\n  .use(initReactI18next)\n  // init i18next\n  // for all options read: https://www.i18next.com/overview/configuration-options\n  .init({\n    fallbackLng: \"en\",\n    debug: true,\n\n    interpolation: {\n      escapeValue: false, // not needed for react as it escapes by default\n    }\n  });\n\n\nexport default i18n;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n//import './styles/index.scss';\nimport AppRouter from './components/AppRouter';\nimport * as serviceWorker from './serviceWorker';\nimport './i18n';\n\nReactDOM.render(<AppRouter/>, document.getElementById('root'));\n\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}